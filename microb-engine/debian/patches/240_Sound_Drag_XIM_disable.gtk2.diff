# Footprint race
# Removing services wich probably useless on our device
Index: mozilla/widget/src/gtk2/Makefile.in
===================================================================
--- mozilla.orig/widget/src/gtk2/Makefile.in
+++ mozilla/widget/src/gtk2/Makefile.in
@@ -100,32 +100,32 @@ CPPSRCS		= \
 		nsAppShell.cpp \
 		nsWidgetFactory.cpp \
 		nsToolkit.cpp \
 		nsBidiKeyboard.cpp \
 		nsCommonWidget.cpp \
 		nsLookAndFeel.cpp \
 		nsGtkKeyUtils.cpp \
 		nsClipboard.cpp \
-		nsDragService.cpp \
-		nsSound.cpp \
 		nsNativeKeyBindings.cpp \
 		nsScreenGtk.cpp \
 		nsScreenManagerGtk.cpp \
 		nsImageToPixbuf.cpp \
 		nsAccessibilityHelper.cpp \
 		nsTempfilePS.cpp \
 		nsIdleServiceGTK.cpp \
 		$(NULL)
 
 ifndef MOZ_MICROB
 CPPSRCS		+= \
 		nsFilePicker.cpp \
 		nsDeviceContextSpecG.cpp \
 		nsPrintOptionsGTK.cpp \
+		nsDragService.cpp \
+		nsSound.cpp \
 		$(NULL)
 endif
 
 ifdef MOZ_ENABLE_POSTSCRIPT
 CPPSRCS        += \
 		nsPrintJobFactoryGTK.cpp \
 		nsPrintJobGTK.cpp \
 		$(NULL)
@@ -168,17 +168,17 @@ CPPSRCS		+= nsNativeThemeGTK.cpp
 DEFINES		+= -DNATIVE_THEME_SUPPORT
 endif
 
 include $(topsrcdir)/config/rules.mk
 
 CFLAGS          += $(MOZ_GTK2_CFLAGS) $(MOZ_STARTUP_NOTIFICATION_CFLAGS)
 CXXFLAGS        += $(MOZ_GTK2_CFLAGS) $(MOZ_STARTUP_NOTIFICATION_CFLAGS)
 
-DEFINES         += -DUSE_XIM
+#DEFINES         += -DUSE_XIM
 
 ifdef MOZ_ENABLE_CAIRO_GFX
 DEFINES		+= -DCAIRO_GFX
 endif
 
 ifdef MOZ_ENABLE_POSTSCRIPT
 DEFINES         += -DUSE_POSTSCRIPT
 EXTRA_DSO_LDOPTS += -lgfxpsshar
Index: mozilla/widget/src/gtk2/nsWidgetFactory.cpp
===================================================================
--- mozilla.orig/widget/src/gtk2/nsWidgetFactory.cpp
+++ mozilla/widget/src/gtk2/nsWidgetFactory.cpp
@@ -42,29 +42,27 @@
 #include "nsAppShellSingleton.h"
 #include "nsBaseWidget.h"
 #include "nsLookAndFeel.h"
 #include "nsWindow.h"
 #include "nsTransferable.h"
 #include "nsClipboardHelper.h"
 #include "nsHTMLFormatConverter.h"
 #include "nsClipboard.h"
-#include "nsDragService.h"
 #ifndef MOZ_MICROB
+#include "nsDragService.h"
 #include "nsFilePicker.h"
-#endif
 #include "nsSound.h"
-#include "nsBidiKeyboard.h"
-#include "nsNativeKeyBindings.h"
-#include "nsScreenManagerGtk.h"
-#ifndef MOZ_MICROB
 #include "nsPrintOptionsGTK.h"
 #include "nsPrintSession.h"
 #include "nsDeviceContextSpecG.h"
 #endif
+#include "nsBidiKeyboard.h"
+#include "nsNativeKeyBindings.h"
+#include "nsScreenManagerGtk.h"
 #include "nsIPrefService.h"
 #include "nsIPrefBranch.h"
 #include "nsImageToPixbuf.h"
 #include "nsIdleServiceGTK.h"
 
 #ifdef NATIVE_THEME_SUPPORT
 #include "nsNativeThemeGTK.h"
 #endif
@@ -86,18 +84,20 @@ static NS_DEFINE_CID(kNativeFilePickerCI
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsWindow)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsChildWindow)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsLookAndFeel)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsTransferable)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsBidiKeyboard)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsClipboardHelper)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsHTMLFormatConverter)
 NS_GENERIC_FACTORY_CONSTRUCTOR_INIT(nsClipboard, Init)
+#ifndef MOZ_MICROB
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsDragService)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsSound)
+#endif
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsScreenManagerGtk)
 #ifndef MOZ_MICROB
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsDeviceContextSpecGTK)
 #endif
 #ifdef NATIVE_THEME_SUPPORT
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsNativeThemeGTK)
 #endif
 #ifndef MOZ_MICROB
@@ -206,37 +206,39 @@ static const nsModuleComponentInfo compo
       NS_LOOKANDFEEL_CID,
       "@mozilla.org/widget/lookandfeel;1",
       nsLookAndFeelConstructor },
 #ifndef MOZ_MICROB
     { "Gtk2 File Picker",
       NS_FILEPICKER_CID,
       "@mozilla.org/filepicker;1",
       nsFilePickerConstructor },
-#endif
     { "Gtk2 Sound",
       NS_SOUND_CID,
       "@mozilla.org/sound;1",
       nsSoundConstructor },
+#endif
   { "Transferable",
     NS_TRANSFERABLE_CID,
     "@mozilla.org/widget/transferable;1",
     nsTransferableConstructor },
   { "Gtk Clipboard",
     NS_CLIPBOARD_CID,
     "@mozilla.org/widget/clipboard;1",
     nsClipboardConstructor },
   { "Clipboard Helper",
     NS_CLIPBOARDHELPER_CID,
     "@mozilla.org/widget/clipboardhelper;1",
     nsClipboardHelperConstructor },
+#ifndef MOZ_MICROB
   { "Gtk Drag Service",
     NS_DRAGSERVICE_CID,
     "@mozilla.org/widget/dragservice;1",
     nsDragServiceConstructor },
+#endif
   { "HTML Format Converter",
     NS_HTMLFORMATCONVERTER_CID,
     "@mozilla.org/widget/htmlformatconverter;1",
     nsHTMLFormatConverterConstructor },
   { "Gtk2 Bidi Keyboard",
     NS_BIDIKEYBOARD_CID,
     "@mozilla.org/widget/bidikeyboard;1",
     nsBidiKeyboardConstructor },
