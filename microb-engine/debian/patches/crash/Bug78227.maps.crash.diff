#Bug 78227 Browser crashes while zooming maps in mapquest.com web page.
#Bug 390219  Trunk topcrash [@ nsXMLHttpRequest::OnStartRequest]
Index: mozilla/content/base/src/nsXMLHttpRequest.cpp
===================================================================
--- mozilla.orig/content/base/src/nsXMLHttpRequest.cpp
+++ mozilla/content/base/src/nsXMLHttpRequest.cpp
@@ -1270,30 +1270,33 @@
     NS_ERROR("Ugh, still getting data on an aborted XMLHttpRequest!");
 
     return NS_ERROR_UNEXPECTED;
   }
 
   nsCOMPtr<nsIChannel> channel(do_QueryInterface(request));
   NS_ENSURE_TRUE(channel, NS_ERROR_UNEXPECTED);
 
-  mChannel->SetOwner(mPrincipal);
+	nsresult rv = mChannel?
+                   mChannel->SetOwner(mPrincipal):
+                   channel->SetOwner(mPrincipal);
+  NS_ENSURE_SUCCESS(rv, rv);
 
   mReadRequest = request;
   mContext = ctxt;
   mState |= XML_HTTP_REQUEST_PARSEBODY;
   ChangeState(XML_HTTP_REQUEST_LOADED);
 
   nsIURI* uri = GetBaseURI();
 
   // Create an empty document from it 
   const nsAString& emptyStr = EmptyString();
-  nsresult rv = nsContentUtils::CreateDocument(emptyStr, emptyStr, nsnull, uri,
-                                               uri, mPrincipal,
-                                               getter_AddRefs(mDocument));
+  rv = nsContentUtils::CreateDocument(emptyStr, emptyStr, nsnull, uri,
+                                               uri, mPrincipal,
+                                               getter_AddRefs(mDocument));
   NS_ENSURE_SUCCESS(rv, rv);
 
   // Reset responseBody
   mResponseBody.Truncate();
 
   // Register as a load listener on the document
   nsCOMPtr<nsPIDOMEventTarget> target(do_QueryInterface(mDocument));
   if (target) {
