diff --git a/accessible/src/base/nsAccessible.cpp b/accessible/src/base/nsAccessible.cpp
--- a/accessible/src/base/nsAccessible.cpp
+++ b/accessible/src/base/nsAccessible.cpp
@@ -2040,16 +2040,19 @@ NS_IMETHODIMP nsAccessible::GetFinalRole
   return mDOMNode ? GetRole(aRole) : NS_ERROR_FAILURE;  // Node already shut down
 }
 
 NS_IMETHODIMP
 nsAccessible::GetAttributes(nsIPersistentProperties **aAttributes)
 {
   NS_ENSURE_ARG_POINTER(aAttributes);  // In/out param. Created if necessary.
   
+  if (IsDefunct())
+    return NS_ERROR_FAILURE;
+
   nsCOMPtr<nsIContent> content = GetRoleContent(mDOMNode);
   if (!content) {
     return NS_ERROR_FAILURE;
   }
 
   nsCOMPtr<nsIPersistentProperties> attributes = *aAttributes;
   if (!attributes) {
     // Create only if an array wasn't already passed in
diff --git a/accessible/src/base/nsOuterDocAccessible.cpp b/accessible/src/base/nsOuterDocAccessible.cpp
--- a/accessible/src/base/nsOuterDocAccessible.cpp
+++ b/accessible/src/base/nsOuterDocAccessible.cpp
@@ -143,8 +143,40 @@ nsOuterDocAccessible::GetAttributesInter
   aAttributes->GetStringProperty(NS_LITERAL_CSTRING("tag"), tag);
   if (!tag.IsEmpty()) {
     // We're overriding the ARIA attributes on an sub document, but we don't want to
     // override the other attributes
     return NS_OK;
   }
   return nsAccessible::GetAttributesInternal(aAttributes);
 }
+
+// Internal frame, which is the doc's parent, should not have a click action
+NS_IMETHODIMP
+nsOuterDocAccessible::GetNumActions(PRUint8 *aNumActions)
+{
+  NS_ENSURE_ARG_POINTER(aNumActions);
+  *aNumActions = 0;
+
+  return NS_OK;
+}
+
+NS_IMETHODIMP
+nsOuterDocAccessible::GetActionName(PRUint8 aIndex, nsAString& aName)
+{
+  aName.Truncate();
+
+  return NS_ERROR_INVALID_ARG;
+}
+
+NS_IMETHODIMP
+nsOuterDocAccessible::GetActionDescription(PRUint8 aIndex, nsAString& aDescription)
+{
+  aDescription.Truncate();
+
+  return NS_ERROR_INVALID_ARG;
+}
+
+NS_IMETHODIMP
+nsOuterDocAccessible::DoAction(PRUint8 aIndex)
+{
+  return NS_ERROR_INVALID_ARG;
+}
diff --git a/accessible/src/base/nsOuterDocAccessible.h b/accessible/src/base/nsOuterDocAccessible.h
--- a/accessible/src/base/nsOuterDocAccessible.h
+++ b/accessible/src/base/nsOuterDocAccessible.h
@@ -53,11 +53,15 @@ class nsOuterDocAccessible : public nsAc
                          nsIWeakReference* aShell);
 
     NS_IMETHOD GetRole(PRUint32 *aRole);
     NS_IMETHOD GetState(PRUint32 *aState, PRUint32 *aExtraState);
     NS_IMETHOD GetChildAtPoint(PRInt32 aX, PRInt32 aY,
                                nsIAccessible **aAccessible);
     void CacheChildren();
     nsresult GetAttributesInternal(nsIPersistentProperties *aAttributes);
+    NS_IMETHOD GetNumActions(PRUint8 *aNumActions);
+    NS_IMETHOD GetActionName(PRUint8 aIndex, nsAString& aName);
+    NS_IMETHODIMP GetActionDescription(PRUint8 aIndex, nsAString& aDescription);
+    NS_IMETHOD DoAction(PRUint8 aIndex);
 };
 
 #endif  
diff --git a/accessible/src/msaa/nsAccessibleWrap.cpp b/accessible/src/msaa/nsAccessibleWrap.cpp
--- a/accessible/src/msaa/nsAccessibleWrap.cpp
+++ b/accessible/src/msaa/nsAccessibleWrap.cpp
@@ -327,16 +327,22 @@ __try {
 __try {
   *pszValue = NULL;
   nsCOMPtr<nsIAccessible> xpAccessible;
   GetXPAccessibleFor(varChild, getter_AddRefs(xpAccessible));
   if (xpAccessible) {
     nsAutoString value;
     if (NS_FAILED(xpAccessible->GetValue(value)))
       return E_FAIL;
+
+    // see bug 438784: Need to expose URL on doc's value attribute.
+    // For this, reverting part of fix for bug 425693 to make this MSAA method 
+    // behave IAccessible2-style.
+    if (value.IsEmpty())
+      return S_FALSE;
 
     *pszValue = ::SysAllocStringLen(value.get(), value.Length());
     if (!*pszValue)
       return E_OUTOFMEMORY;
   }
 } __except(FilterA11yExceptions(::GetExceptionCode(), GetExceptionInformation())) { }
   return S_OK;
 }
diff --git a/accessible/src/other/nsAccessibleWrap.h b/accessible/src/other/nsAccessibleWrap.h
--- a/accessible/src/other/nsAccessibleWrap.h
+++ b/accessible/src/other/nsAccessibleWrap.h
@@ -46,11 +46,16 @@
 #include "nsCOMPtr.h"
 #include "nsAccessible.h"
 
 class nsAccessibleWrap : public nsAccessible
 {
   public: // construction, destruction
     nsAccessibleWrap(nsIDOMNode*, nsIWeakReference *aShell);
     virtual ~nsAccessibleWrap();
+
+  protected:
+    virtual nsresult FirePlatformEvent(nsIAccessibleEvent *aEvent) {
+      return NS_OK;
+    }
 };
 
 #endif
diff --git a/accessible/tests/mochitest/Makefile.in b/accessible/tests/mochitest/Makefile.in
--- a/accessible/tests/mochitest/Makefile.in
+++ b/accessible/tests/mochitest/Makefile.in
@@ -53,18 +53,20 @@ _TEST_FILES =\
 		test_bug420863.html \
 		test_groupattrs.xul \
 		test_table_indexes.html \
 		test_nsIAccessibleTable_1.html \
 		test_nsIAccessibleTable_2.html \
 		test_nsIAccessibleTable_3.html \
 		test_nsIAccessibleTable_4.html \
 		test_nsIAccessibleTable_listboxes.xul \
+		test_nsIAccessibleDocument.html \
 		test_nsIAccessibleHyperLink.html \
 		test_nsIAccessibleHyperLink.xul \
 		test_nsIAccessibleHyperText.html \
 		test_nsIAccessibleImage.html \
+		test_nsOuterDocAccessible.html \
 		test_bug428479.html \
 		test_bug429285.html \
 		$(NULL)
 
 libs:: $(_TEST_FILES)
 	$(INSTALL) $(foreach f,$^,"$f") $(DEPTH)/_tests/testing/mochitest/a11y/$(relativesrcdir)
diff --git a/accessible/tests/mochitest/test_nsIAccessibleDocument.html b/accessible/tests/mochitest/test_nsIAccessibleDocument.html
new file mode 100644
--- /dev/null
+++ b/accessible/tests/mochitest/test_nsIAccessibleDocument.html
@@ -0,0 +1,111 @@
+<html>
+<!--
+https://bugzilla.mozilla.org/show_bug.cgi?id=441737
+-->
+<head>
+  <title>nsIAccessibleDocument chrome tests</title>
+  <link rel="stylesheet" type="text/css" href="chrome://mochikit/content/tests/SimpleTest/test.css" />
+
+  <script type="application/javascript" src="chrome://mochikit/content/MochiKit/packed.js"></script>
+  <script type="application/javascript" src="chrome://mochikit/content/tests/SimpleTest/SimpleTest.js"></script>
+
+  <script type="application/javascript">
+    const nsIAccessibleRetrieval = Components.interfaces.nsIAccessibleRetrieval;
+    const nsIAccessibleRole = Components.interfaces.nsIAccessibleRole;
+    const nsIAccessibleDocument = Components.interfaces.nsIAccessibleDocument;
+    const nsIDOMDocument = Components.interfaces.nsIDOMDocument;
+    const nsIDOMWindow = Components.interfaces.nsIDOMWindow;
+
+    // needed state flag
+    const state_focusable =
+          Components.interfaces.nsIAccessibleStates.STATE_FOCUSABLE;
+    const state_readonly =
+          Components.interfaces.nsIAccessibleStates.STATE_READONLY;
+
+    var gAccRetrieval = null;
+
+    function doTest()
+    {
+      gAccRetrieval = Components.classes["@mozilla.org/accessibleRetrieval;1"].
+                      getService(nsIAccessibleRetrieval);
+
+      // Get accessible for body tag.
+      var docAcc = null;
+      try {
+        docAcc = gAccRetrieval.getAccessibleFor(document).
+                 QueryInterface(nsIAccessibleDocument);
+      } catch(e) {}
+      ok(docAcc, "No accessible with interface for document!");
+
+      if (docAcc) {
+        // nsIAccessible
+        is(docAcc.name, "nsIAccessibleDocument chrome tests",
+           "Name for document accessible not correct!");
+        is(docAcc.role, nsIAccessibleRole.ROLE_DOCUMENT,
+           "Wrong role for document!");
+
+        // check if it is focusable, read-only.
+        var state = {}, extraState = {}
+        docAcc.getFinalState(state, extraState);
+        var desiredStates = (state_focusable | state_readonly);
+        is(state.value & desiredStates, desiredStates,
+           "Wrong state bits for document!");
+
+        // No actions wanted on doc
+        is(docAcc.numActions, 0, "Wrong number of actions for document!");
+
+        // attributes should contain tag:body
+        attributes = docAcc.attributes;
+        is(attributes.getStringProperty("tag"), "BODY",
+           "Wrong attribute on document!");
+
+        // nsIAccessibleDocument
+        is(docAcc.URL, "chrome://mochikit/content/a11y/accessible/test_nsIAccessibleDocument.html",
+           "Wrong URL for document!");
+        is(docAcc.title, "nsIAccessibleDocument chrome tests",        
+           "Wrong title for document!");
+        is(docAcc.mimeType, "text/html",
+           "Wrong mime type for document!");
+        // nsDocAccessible::getDocType currently returns NS_ERROR_FAILURE.
+        // See bug 442005. After fixing, please remove this comment and
+        // uncomment the below two lines to enable the test.
+//        is(docAcc.docType, "HTML",
+//           "Wrong type of document!");
+
+        // Test for correct nsIDOMDocument retrieval.
+        var domDoc = null;
+        try {
+          domDoc = docAcc.document.QueryInterface(nsIDOMDocument);
+        } catch(e) {}
+        ok(domDoc, "no nsIDOMDocument for this doc accessible!");
+        is(domDoc, document, "Document nodes do not match!");
+
+        // Test for correct nsIDOMWindow retrieval.
+        var domWindow = null;
+        try {
+          domWindow = docAcc.window.QueryInterface(nsIDOMWindow);
+        } catch(e) {}
+        ok(domWindow, "no nsIDOMWindow for this doc accessible!");
+        is(domWindow, window, "Window nodes do not match!");
+      }
+
+      SimpleTest.finish();
+    }
+
+    SimpleTest.waitForExplicitFinish();
+    addLoadEvent(doTest);
+  </script>
+</head>
+<body>
+
+  <a target="_blank"
+     href="https://bugzilla.mozilla.org/show_bug.cgi?id=441737"
+     title="nsAccessibleDocument chrome tests">
+    Mozilla Bug 441737
+  </a>
+  <p id="display"></p>
+  <div id="content" style="display: none"></div>
+  <pre id="test">
+  </pre>
+</body>
+</html>
diff --git a/accessible/tests/mochitest/test_nsOuterDocAccessible.html b/accessible/tests/mochitest/test_nsOuterDocAccessible.html
new file mode 100644
--- /dev/null
+++ b/accessible/tests/mochitest/test_nsOuterDocAccessible.html
@@ -0,0 +1,106 @@
+<html>
+<!--
+https://bugzilla.mozilla.org/show_bug.cgi?id=441519
+-->
+<head>
+  <title>nsOuterDocAccessible chrome tests</title>
+  <link rel="stylesheet" type="text/css" href="chrome://mochikit/content/tests/SimpleTest/test.css" />
+
+  <script type="application/javascript" src="chrome://mochikit/content/MochiKit/packed.js"></script>
+  <script type="application/javascript" src="chrome://mochikit/content/tests/SimpleTest/SimpleTest.js"></script>
+
+  <script type="application/javascript">
+    const nsIAccessibleRetrieval = Components.interfaces.nsIAccessibleRetrieval;
+    const nsIAccessibleRole = Components.interfaces.nsIAccessibleRole;
+
+    // needed state flag
+    const state_focusable =
+          Components.interfaces.nsIAccessibleStates.STATE_FOCUSABLE;
+
+    // needed error return value
+    const ns_error_invalid_arg = Components.results.NS_ERROR_INVALID_ARG;
+
+    var gAccRetrieval = null;
+
+    function doTest()
+    {
+      gAccRetrieval = Components.classes["@mozilla.org/accessibleRetrieval;1"].
+                      getService(nsIAccessibleRetrieval);
+
+      // Get accessible for body tag.
+      var docAcc = null;
+      try {
+        docAcc = gAccRetrieval.getAccessibleFor(document);
+      } catch(e) {}
+      ok(docAcc, "No accessible for document!");
+
+      if (docAcc) {
+        var outerDocAcc = null;
+        try {
+          outerDocAcc = docAcc.parent;
+        } catch(e) {}
+        ok(outerDocAcc, "No internal frame parent for document!");
+
+        if (outerDocAcc) {
+          is(outerDocAcc.role, nsIAccessibleRole.ROLE_INTERNAL_FRAME,
+             "Wrong role for internal frame!");
+
+          // check if it is focusable, not desired.
+          var state = {}, extraState = {}
+          outerDocAcc.getFinalState(state, extraState);
+          is(state.value & state_focusable, 0,
+             "Wrong focusable state bit for internal frame!");
+
+          // see bug 428954: No name wanted for internal frame
+          is(outerDocAcc.name, "", "Wrong name for internal frame!");
+
+          // see bug 440770, no actions wanted on outer doc
+          is(outerDocAcc.numActions, 0,
+             "Wrong number of actions for internal frame!");
+          var actionTempStr; // not really used, just needs to receive a value
+          try {
+            actionTempStr = outerDocAcc.getActionName(0);
+            do_throw("No exception thrown for actionName!");
+          } catch(e) {
+            ok(e.result, ns_error_invalid_arg,
+               "Wrong return value for actionName call!");
+          }
+
+          try {
+            actionTempStr = outerDocAcc.getActionDescription(0);
+            do_throw("No exception thrown for actionDescription!");
+          } catch(e) {
+            ok(e.result, ns_error_invalid_arg,
+               "Wrong return value for actionDescription call!");
+          }
+
+          try {
+            outerDocAcc.doAction(0);
+            do_throw("No exception thrown for doAction!");
+          } catch(e) {
+            ok(e.result, ns_error_invalid_arg,
+               "Wrong return value for doAction call!");
+          }
+        }
+      }
+
+      SimpleTest.finish();
+    }
+
+    SimpleTest.waitForExplicitFinish();
+    addLoadEvent(doTest);
+  </script>
+</head>
+<body>
+
+  <a target="_blank"
+     href="https://bugzilla.mozilla.org/show_bug.cgi?id=441519"
+     title="nsOuterDocAccessible chrome tests">
+    Mozilla Bug 441519
+  </a>
+  <p id="display"></p>
+  <div id="content" style="display: none"></div>
+  <pre id="test">
+  </pre>
+</body>
+</html>
diff --git a/browser/app/Makefile.in b/browser/app/Makefile.in
--- a/browser/app/Makefile.in
+++ b/browser/app/Makefile.in
@@ -155,26 +155,17 @@ include $(topsrcdir)/config/config.mk
 include $(topsrcdir)/config/config.mk
 
 ifdef _MSC_VER
 # Always enter a Windows program through wmain, whether or not we're
 # a console application.
 WIN32_EXE_LDFLAGS += -ENTRY:wmainCRTStartup
 endif
 
-ifndef BUILD_STATIC_LIBS
-
-ifdef NS_TRACE_MALLOC
-# when libxul is enabled, trace-malloc is part of it
-ifndef MOZ_ENABLE_LIBXUL
-EXTRA_DSO_LIBS += tracemalloc
-endif
-endif
-
-else
+ifdef BUILD_STATIC_LIBS
 include $(topsrcdir)/config/static-config.mk
 
 EXTRA_DEPS	+= \
 	$(STATIC_EXTRA_DEPS) \
 	$(NULL)
 DEFINES		+= $(STATIC_DEFINES)
 CPPSRCS		+= $(STATIC_CPPSRCS)
 EXTRA_DSO_LIBS	+= $(STATIC_EXTRA_DSO_LIBS)
diff --git a/browser/app/profile/firefox.js b/browser/app/profile/firefox.js
--- a/browser/app/profile/firefox.js
+++ b/browser/app/profile/firefox.js
@@ -234,19 +234,17 @@ pref("browser.download.saveLinkAsFilenam
 pref("browser.download.saveLinkAsFilenameTimeout", 1000);
 
 pref("browser.download.useDownloadDir", true);
 pref("browser.download.folderList", 0);
 pref("browser.download.manager.showAlertOnComplete", true);
 pref("browser.download.manager.showAlertInterval", 2000);
 pref("browser.download.manager.retention", 2);
 pref("browser.download.manager.showWhenStarting", true);
-pref("browser.download.manager.useWindow", true);
 pref("browser.download.manager.closeWhenDone", false);
-pref("browser.download.manager.openDelay", 0);
 pref("browser.download.manager.focusWhenStarting", false);
 pref("browser.download.manager.flashCount", 2);
 pref("browser.download.manager.addToRecentDocs", true);
 pref("browser.download.manager.quitBehavior", 0);
 pref("browser.download.manager.scanWhenDone", true);
 pref("browser.download.manager.resumeOnWakeDelay", 10000);
 
 // search engines URL
diff --git a/browser/base/content/browser.xul b/browser/base/content/browser.xul
--- a/browser/base/content/browser.xul
+++ b/browser/base/content/browser.xul
@@ -359,29 +359,24 @@
                     id="feed-button"
                     chromedir="&locale.dir;"
                     onclick="return FeedHandler.onFeedButtonClick(event);">
               <menupopup position="after_end"
                          onpopupshowing="return FeedHandler.buildFeedList(this);"
                          oncommand="return FeedHandler.subscribeToFeed(null, event);"
                          onclick="checkForMiddleClick(this, event);"/>
             </button>
-#ifdef MOZ_SAFE_BROWSING
-            <image id="safebrowsing-urlbar-icon" tooltiptext="&safeb.urlbaricon.tooltip;"
-                   level="safe"
+            <image id="star-button"
                    class="urlbar-icon"
-                   onclick="goDoCommand('safebrowsing-show-warning')"/>
-#endif
-          <image id="star-button"
-                 class="urlbar-icon"
-                 onclick="PlacesStarButton.onClick(event);"/>
-          <image id="go-button" chromedir="&locale.dir;"
-                 class="urlbar-icon"
-                 tooltiptext="&goEndCap.tooltip;"
-                 onclick="handleURLBarCommand(event);"/>
+                   onclick="PlacesStarButton.onClick(event);"/>
+            <image id="go-button"
+                   chromedir="&locale.dir;"
+                   class="urlbar-icon"
+                   tooltiptext="&goEndCap.tooltip;"
+                   onclick="handleURLBarCommand(event);"/>
           </hbox>
         </textbox>
       </toolbaritem>
 
       <toolbaritem id="search-container" title="&searchItem.title;"
                    align="center" class="chromeclass-toolbar-additional"
                    flex="100" persist="width">
         <searchbar id="searchbar" flex="1" chromedir="&locale.dir;"
diff --git a/browser/branding/unofficial/locales/jar.mn b/browser/branding/unofficial/locales/jar.mn
--- a/browser/branding/unofficial/locales/jar.mn
+++ b/browser/branding/unofficial/locales/jar.mn
@@ -1,6 +1,7 @@
 #filter substitution
 
 @AB_CD@.jar:
 % locale branding @AB_CD@ %locale/branding/
-  locale/branding/brand.dtd        (%brand.dtd)
-* locale/branding/brand.properties (%brand.properties)
+# Gran Paradiso branding only exists in en-US
+  locale/branding/brand.dtd        (en-US/brand.dtd)
+* locale/branding/brand.properties (en-US/brand.properties)
diff --git a/browser/locales/en-US/chrome/browser/safebrowsing/phishing-afterload-warning-message.dtd b/browser/locales/en-US/chrome/browser/safebrowsing/phishing-afterload-warning-message.dtd
--- a/browser/locales/en-US/chrome/browser/safebrowsing/phishing-afterload-warning-message.dtd
+++ b/browser/locales/en-US/chrome/browser/safebrowsing/phishing-afterload-warning-message.dtd
@@ -10,18 +10,16 @@
 
 <!ENTITY safeb.palm.accept.label "Get me out of here!">
 <!ENTITY safeb.palm.accept.statustext "Navigate to my home page">
 <!ENTITY safeb.palm.decline.label "Ignore this warning">
 <!ENTITY safeb.palm.decline.statustext "Close warning" >
 <!ENTITY safeb.palm.notforgery.label2 "This isn't a web forgeryâ€¦">
 <!ENTITY safeb.palm.report.label "Why was this site blocked?">
 
-<!ENTITY safeb.urlbaricon.tooltip "This page might be dangerous; click for details.">
-
 <!ENTITY safeb.blocked.malware.title "Reported Attack Site!">
 <!-- Localization note (safeb.blocked.malware.shortDesc) - Please don't translate the contents of the <span id="malware_sitename"/> tag.  It will be replaced at runtime with a domain name (e.g. www.badsite.com) -->
 <!ENTITY safeb.blocked.malware.shortDesc "This web site at <span id='malware_sitename'/> has been reported as an attack site and has been blocked based on your security preferences.">
 <!ENTITY safeb.blocked.malware.longDesc "<p>Attack sites try to install programs that steal private information, use your computer to attack others, or damage your system.</p><p>Some attack sites intentionally distribute harmful software, but many are compromised without the knowledge or permission of their owners.</p>">
 
 <!ENTITY safeb.blocked.phishing.title "Reported Web Forgery!">
 <!-- Localization note (safeb.blocked.phishing.shortDesc) - Please don't translate the contents of the <span id="phishing_sitename"/> tag. It will be replaced at runtime with a domain name (e.g. www.badsite.com) -->
 <!ENTITY safeb.blocked.phishing.shortDesc "This web site at <span id='phishing_sitename'/> has been reported as a web forgery and has been blocked based on your security preferences.">
diff --git a/client.mk b/client.mk
--- a/client.mk
+++ b/client.mk
@@ -38,21 +38,20 @@
 #
 # ***** END LICENSE BLOCK *****
 
 # Build a mozilla application.
 #
 # To build a tree,
 #    1. hg clone ssh://hg.mozilla.org/mozilla-central mozilla
 #    2. cd mozilla
-#    3. python client.py checkout
-#    4. create your .mozconfig file with
+#    3. create your .mozconfig file with
 #       mk_add_options MOZ_CO_PROJECT=
 #         suite,browser
-#    5. gmake -f client.mk 
+#    4. gmake -f client.mk 
 #
 # Other targets (gmake -f client.mk [targets...]),
 #    build
 #    clean (realclean is now the same as clean)
 #    distclean
 #
 # See http://developer.mozilla.org/en/docs/Build_Documentation for 
 # more information.
diff --git a/config/Makefile.in b/config/Makefile.in
--- a/config/Makefile.in
+++ b/config/Makefile.in
@@ -161,11 +161,12 @@ check-preprocessor::
 	@$(EXIT_ON_ERROR) \
 	for test in $(PYUNITS); do \
 	  $(PYTHON) $(srcdir)/tests/$$test ; \
 	done
 
 check-jar-mn::
 	make -C tests/src-simple check-jar
 	make -C tests/src-simple check-flat
+	make -C tests/src-simple check-flat USE_EXTENSION_MANIFEST=1
 ifneq ($(OS_ARCH), WINNT)
 	make -C tests/src-simple check-symlink
 endif
diff --git a/config/tests/chrome.manifest.flat b/config/tests/chrome.manifest.flat
new file mode 100644
--- /dev/null
+++ b/config/tests/chrome.manifest.flat
@@ -0,0 +1,4 @@
+content test chrome/test/one xpcnativewrappers=no
+locale ab-X-stuff chrome/test/three
+overlay chrome://one/file.xml chrome://two/otherfile.xml
+skin test classic chrome/test/one
diff --git a/config/tests/src-simple/Makefile.in b/config/tests/src-simple/Makefile.in
--- a/config/tests/src-simple/Makefile.in
+++ b/config/tests/src-simple/Makefile.in
@@ -47,21 +47,24 @@ include $(topsrcdir)/config/config.mk
 include $(topsrcdir)/config/config.mk
 
 XPI_NAME = test_jar_mn
 
 DEFINES += \
 	-DAB_CD=ab-X-stuff \
 	$(NULL)
 
+MY_MANIFEST = $(if $(USE_EXTENSION_MANIFEST), $(FINAL_TARGET)/chrome.manifest, $(FINAL_TARGET)/chrome/test.manifest)
+REF_MANIFEST = $(if $(USE_EXTENSION_MANIFEST),chrome.manifest,test.manifest)
+
 check-%::
 	if test -d $(FINAL_TARGET); then rm -rf $(FINAL_TARGET); fi;
 	make realchrome MOZ_CHROME_FILE_FORMAT=$*
 	@echo "Comparing manifests..."
-	@if ! sort $(FINAL_TARGET)/chrome/test.manifest | diff -u $(srcdir)/../test.manifest.$* - ; then \
+	@if ! sort $(MY_MANIFEST) | diff -u $(srcdir)/../$(REF_MANIFEST).$* - ; then \
 	  echo "FAIL: different content in manifest!" ; \
 	fi
 	@if [ $* == "jar" ]; then \
 	  $(UNZIP) -d $(FINAL_TARGET)/chrome/test $(FINAL_TARGET)/chrome/test.jar; \
 	fi
 	@echo "Comparing packages..."
 	@if ! diff -ur $(srcdir)/../ref-simple $(FINAL_TARGET)/chrome/test ; then\
 	  echo "FAIL: different content in jar!" ; \
diff --git a/content/base/public/Makefile.in b/content/base/public/Makefile.in
--- a/content/base/public/Makefile.in
+++ b/content/base/public/Makefile.in
@@ -67,20 +67,21 @@ nsIContentSerializer.h \
 nsIContentSerializer.h \
 nsIHTMLToTextSink.h \
 nsIXPathEvaluatorInternal.h \
 mozISanitizingSerializer.h \
 nsCaseTreatment.h \
 nsContentCID.h \
 nsCopySupport.h \
 nsContentCreatorFunctions.h \
+nsDOMFile.h \
 nsLineBreaker.h \
+nsPresShellIterator.h \
+nsReferencedElement.h \
 nsXMLNameSpaceMap.h \
-nsPresShellIterator.h \
-nsDOMFile.h \
 $(NULL)
 
 ifndef DISABLE_XFORMS_HOOKS
 EXPORTS += nsIXFormsUtilityService.h
 endif
 
 SDK_XPIDLSRCS   = \
 		nsISelection.idl  \
diff --git a/content/base/public/nsContentUtils.h b/content/base/public/nsContentUtils.h
--- a/content/base/public/nsContentUtils.h
+++ b/content/base/public/nsContentUtils.h
@@ -1206,16 +1206,22 @@ public:
   static void HidePopupsInDocument(nsIDocument* aDocument);
 
   /**
    * Return true if aURI is a local file URI (i.e. file://).
    */
   static PRBool URIIsLocalFile(nsIURI *aURI);
 
   /**
+   * If aContent is an HTML element with a DOM level 0 'name', then
+   * return the name. Otherwise return null.
+   */
+  static nsIAtom* IsNamedItem(nsIContent* aContent);
+
+  /**
    * Get the application manifest URI for this context.  The manifest URI
    * is specified in the manifest= attribute of the root element of the
    * toplevel window.
    *
    * @param aWindow The context to check.
    * @param aURI The manifest URI.
    */
   static void GetOfflineAppManifest(nsIDOMWindow *aWindow, nsIURI **aURI);
diff --git a/content/base/public/nsIDocument.h b/content/base/public/nsIDocument.h
--- a/content/base/public/nsIDocument.h
+++ b/content/base/public/nsIDocument.h
@@ -92,18 +92,18 @@ class nsBindingManager;
 class nsBindingManager;
 class nsIDOMNodeList;
 class mozAutoSubtreeModified;
 struct JSObject;
 class nsFrameLoader;
 
 // IID for the nsIDocument interface
 #define NS_IDOCUMENT_IID      \
-{ 0xc81acf0b, 0x2539, 0x47ab, \
-  { 0xa6, 0x04, 0x64, 0x04, 0x07, 0x63, 0xc8, 0x3d } }
+{ 0xc45a4a53, 0x0485, 0x43d5, \
+  { 0x85, 0x95, 0x9f, 0x0b, 0xf4, 0x0d, 0xe9, 0x34 } }
 
 // Flag for AddStyleSheet().
 #define NS_STYLESHEET_FROM_CATALOG                (1 << 0)
 
 //----------------------------------------------------------------------
 
 // Document interface.  This is implemented by all document objects in
 // Gecko.
@@ -254,16 +254,42 @@ public:
    * Add an observer that gets notified whenever the charset changes.
    */
   virtual nsresult AddCharSetObserver(nsIObserver* aObserver) = 0;
 
   /**
    * Remove a charset observer.
    */
   virtual void RemoveCharSetObserver(nsIObserver* aObserver) = 0;
+
+  /**
+   * This gets fired when the element that an id refers to changes.
+   * This fires at difficult times. It is generally not safe to do anything
+   * which could modify the DOM in any way. Use
+   * nsContentUtils::AddScriptRunner.
+   * @return PR_TRUE to keep the callback in the callback set, PR_FALSE
+   * to remove it.
+   */
+  typedef PRBool (* IDTargetObserver)(nsIContent* aOldContent,
+                                      nsIContent* aNewContent, void* aData);
+
+  /**
+   * Add an IDTargetObserver for a specific ID. The IDTargetObserver
+   * will be fired whenever the content associated with the ID changes
+   * in the future. At most one (aObserver, aData) pair can be registered
+   * for each ID.
+   * @return the content currently associated with the ID.
+   */
+  virtual nsIContent* AddIDTargetObserver(nsIAtom* aID,
+                                          IDTargetObserver aObserver, void* aData) = 0;
+  /**
+   * Remove the (aObserver, aData) pair for a specific ID, if registered.
+   */
+  virtual void RemoveIDTargetObserver(nsIAtom* aID,
+                                      IDTargetObserver aObserver, void* aData) = 0;
 
   /**
    * Get the Content-Type of this document.
    * (This will always return NS_OK, but has this signature to be compatible
    *  with nsIDOMNSDocument::GetContentType())
    */
   NS_IMETHOD GetContentType(nsAString& aContentType) = 0;
 
diff --git a/content/base/public/nsReferencedElement.h b/content/base/public/nsReferencedElement.h
new file mode 100644
--- /dev/null
+++ b/content/base/public/nsReferencedElement.h
@@ -0,0 +1,120 @@
+/* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
+/* vim: set ts=2 sw=2 et tw=78: */
+/* ***** BEGIN LICENSE BLOCK *****
+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1
+ *
+ * The contents of this file are subject to the Mozilla Public License Version
+ * 1.1 (the "License"); you may not use this file except in compliance with
+ * the License. You may obtain a copy of the License at
+ * http://www.mozilla.org/MPL/
+ *
+ * Software distributed under the License is distributed on an "AS IS" basis,
+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+ * for the specific language governing rights and limitations under the
+ * License.
+ *
+ * The Original Code is mozilla.org code.
+ *
+ * The Initial Developer of the Original Code is Mozilla.org.
+ * Portions created by the Initial Developer are Copyright (C) 2008
+ * the Initial Developer. All Rights Reserved.
+ *
+ * Contributor(s):
+ *   Robert O'Callahan   <robert@ocallahan.org>
+ *
+ * Alternatively, the contents of this file may be used under the terms of
+ * either of the GNU General Public License Version 2 or later (the "GPL"),
+ * or the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+ * in which case the provisions of the GPL or the LGPL are applicable instead
+ * of those above. If you wish to allow use of your version of this file only
+ * under the terms of either the GPL or the LGPL, and not to allow others to
+ * use your version of this file under the terms of the MPL, indicate your
+ * decision by deleting the provisions above and replace them with the notice
+ * and other provisions required by the GPL or the LGPL. If you do not delete
+ * the provisions above, a recipient may use your version of this file under
+ * the terms of any one of the MPL, the GPL or the LGPL.
+ *
+ * ***** END LICENSE BLOCK ***** */
+
+#ifndef NSREFERENCEDELEMENT_H_
+#define NSREFERENCEDELEMENT_H_
+
+#include "nsIContent.h"
+#include "nsIAtom.h"
+#include "nsIDocument.h"
+#include "nsThreadUtils.h"
+#include "nsAutoPtr.h"
+
+class nsIURI;
+class nsCycleCollectionCallback;
+
+/**
+ * Class to track what content is referenced by a given ID.
+ * 
+ * By default this is a single-shot tracker --- i.e., when ContentChanged
+ * fires, we will automatically stop tracking. Override IsPersistent
+ * to return PR_TRUE if you want to keep tracking after the content for
+ * an ID has changed.
+ */
+class nsReferencedElement {
+public:
+  nsReferencedElement() {}
+  ~nsReferencedElement() {
+    Unlink();
+    if (mPendingNotification) {
+      mPendingNotification->Clear();
+    }
+  }
+  nsIContent* get() { return mContent; }
+
+  void Reset(nsIContent* aFrom, nsIURI* aURI, PRBool aWatch = PR_TRUE);
+  void Unlink();
+
+  void Traverse(nsCycleCollectionTraversalCallback* aCB);
+  
+protected:
+  /**
+   * Override this to be notified of content changes. Don't forget
+   * to call this method to change mContent.
+   */
+  virtual void ContentChanged(nsIContent* aFrom, nsIContent* aTo) {
+    mContent = aTo;
+  }
+
+  /**
+   * Override this to convert from a single-shot notification to
+   * a persistent notification.
+   */
+  virtual PRBool IsPersistent() { return PR_FALSE; }
+  
+private:
+  static PRBool Observe(nsIContent* aOldContent,
+                        nsIContent* aNewContent, void* aData);
+
+  class Notification : public nsRunnable {
+  public:
+    Notification(nsReferencedElement* aTarget, nsIContent* aFrom, nsIContent* aTo)
+      : mTarget(aTarget), mFrom(aFrom), mTo(aTo) {}
+    NS_IMETHOD Run() {
+      if (mTarget) {
+        mTarget->mPendingNotification = nsnull;
+        mTarget->ContentChanged(mFrom, mTo);
+      }
+      return NS_OK;
+    }
+    void SetTo(nsIContent* aTo) { mTo = aTo; }
+    void Clear() { mTarget = nsnull; mFrom = nsnull; mTo = nsnull; }
+  private:
+    nsReferencedElement* mTarget;
+    nsCOMPtr<nsIContent> mFrom;
+    nsCOMPtr<nsIContent> mTo;
+  };
+  friend class Notification;
+
+  nsCOMPtr<nsIAtom>      mWatchID;
+  nsCOMPtr<nsIDocument>  mWatchDocument;
+  nsCOMPtr<nsIContent>   mContent;
+  nsRefPtr<Notification> mPendingNotification;
+};
+
+#endif /*NSREFERENCEDELEMENT_H_*/
diff --git a/content/base/src/Makefile.in b/content/base/src/Makefile.in
--- a/content/base/src/Makefile.in
+++ b/content/base/src/Makefile.in
@@ -147,16 +147,17 @@ CPPSRCS		= \
 		nsNodeInfo.cpp \
 		nsNodeInfoManager.cpp \
 		nsNodeUtils.cpp \
 		nsObjectLoadingContent.cpp \
 		nsParserUtils.cpp \
 		nsPlainTextSerializer.cpp \
 		nsPropertyTable.cpp \
 		nsRange.cpp \
+		nsReferencedElement.cpp \
 		nsScriptElement.cpp \
 		nsScriptEventManager.cpp \
 		nsScriptLoader.cpp \
 		nsStubDocumentObserver.cpp \
 		nsStubImageDecoderObserver.cpp \
 		nsStubMutationObserver.cpp \
 		nsStyledElement.cpp \
 		nsStyleLinkElement.cpp \
diff --git a/content/base/src/nsContentUtils.cpp b/content/base/src/nsContentUtils.cpp
--- a/content/base/src/nsContentUtils.cpp
+++ b/content/base/src/nsContentUtils.cpp
@@ -146,16 +146,19 @@ static NS_DEFINE_CID(kXTFServiceCID, NS_
 #include "nsIDOMNSUIEvent.h"
 #include "nsIDOMNSEvent.h"
 #include "nsIPrivateDOMEvent.h"
 #include "nsXULPopupManager.h"
 #include "nsIPermissionManager.h"
 #include "nsIScriptObjectPrincipal.h"
 #include "nsIRunnable.h"
 #include "nsDOMJSUtils.h"
+#include "nsGenericHTMLElement.h"
+#include "nsAttrValue.h"
+#include "nsReferencedElement.h"
 
 #ifdef IBMBIDI
 #include "nsIBidiKeyboard.h"
 #endif
 #include "nsCycleCollectionParticipant.h"
 
 // for ReportToConsole
 #include "nsIStringBundle.h"
@@ -3080,130 +3083,23 @@ nsContentUtils::CheckForBOM(const unsign
     aCharset = "UTF-16LE";
   } else {
     found = PR_FALSE;
   }
 
   return found;
 }
 
-static PRBool EqualExceptRef(nsIURL* aURL1, nsIURL* aURL2)
-{
-  nsCOMPtr<nsIURI> u1;
-  nsCOMPtr<nsIURI> u2;
-
-  nsresult rv = aURL1->Clone(getter_AddRefs(u1));
-  if (NS_SUCCEEDED(rv)) {
-    rv = aURL2->Clone(getter_AddRefs(u2));
-  }
-  if (NS_FAILED(rv))
-    return PR_FALSE;
-
-  nsCOMPtr<nsIURL> url1 = do_QueryInterface(u1);
-  nsCOMPtr<nsIURL> url2 = do_QueryInterface(u2);
-  if (!url1 || !url2) {
-    NS_WARNING("Cloning a URL produced a non-URL");
-    return PR_FALSE;
-  }
-  url1->SetRef(EmptyCString());
-  url2->SetRef(EmptyCString());
-
-  PRBool equal;
-  rv = url1->Equals(url2, &equal);
-  return NS_SUCCEEDED(rv) && equal;
-}
-
 /* static */
 nsIContent*
 nsContentUtils::GetReferencedElement(nsIURI* aURI, nsIContent *aFromContent)
 {
-  nsCOMPtr<nsIURL> url = do_QueryInterface(aURI);
-  if (!url)
-    return nsnull;
-
-  nsCAutoString refPart;
-  url->GetRef(refPart);
-  // Unescape %-escapes in the reference. The result will be in the
-  // origin charset of the URL, hopefully...
-  NS_UnescapeURL(refPart);
-
-  nsCAutoString charset;
-  url->GetOriginCharset(charset);
-  nsAutoString ref;
-  nsresult rv = ConvertStringFromCharset(charset, refPart, ref);
-  if (NS_FAILED(rv)) {
-    CopyUTF8toUTF16(refPart, ref);
-  }
-  if (ref.IsEmpty())
-    return nsnull;
-
-  // Get the current document
-  nsIDocument *doc = aFromContent->GetCurrentDoc();
-  if (!doc)
-    return nsnull;
-
-  // This will be the URI of the document the content belongs to
-  // (the URI of the XBL document if the content is anonymous
-  // XBL content)
-  nsCOMPtr<nsIURL> documentURL = do_QueryInterface(doc->GetDocumentURI());
-  nsIContent* bindingParent = aFromContent->GetBindingParent();
-  PRBool isXBL = PR_FALSE;
-  if (bindingParent) {
-    nsXBLBinding* binding = doc->BindingManager()->GetBinding(bindingParent);
-    if (binding) {
-      // XXX sXBL/XBL2 issue
-      // If this is an anonymous XBL element then the URI is
-      // relative to the binding document. A full fix requires a
-      // proper XBL2 implementation but for now URIs that are
-      // relative to the binding document should be resolve to the
-      // copy of the target element that has been inserted into the
-      // bound document.
-      documentURL = do_QueryInterface(binding->PrototypeBinding()->DocURI());
-      isXBL = PR_TRUE;
-    }
-  }
-  if (!documentURL)
-    return nsnull;
-
-  if (!EqualExceptRef(url, documentURL)) {
-    // Oops -- we don't support off-document references
-    return nsnull;
-  }
-
-  // Get the element
-  nsCOMPtr<nsIContent> content;
-  if (isXBL) {
-    nsCOMPtr<nsIDOMNodeList> anonymousChildren;
-    doc->BindingManager()->
-      GetAnonymousNodesFor(bindingParent, getter_AddRefs(anonymousChildren));
-
-    if (anonymousChildren) {
-      PRUint32 length;
-      anonymousChildren->GetLength(&length);
-      for (PRUint32 i = 0; i < length && !content; ++i) {
-        nsCOMPtr<nsIDOMNode> node;
-        anonymousChildren->Item(i, getter_AddRefs(node));
-        nsCOMPtr<nsIContent> c = do_QueryInterface(node);
-        if (c) {
-          content = MatchElementId(c, ref);
-        }
-      }
-    }
-  } else {
-    nsCOMPtr<nsIDOMDocument> domDoc = do_QueryInterface(doc);
-    NS_ASSERTION(domDoc, "Content doesn't reference a dom Document");
-
-    nsCOMPtr<nsIDOMElement> element;
-    rv = domDoc->GetElementById(ref, getter_AddRefs(element));
-    if (element) {
-      content = do_QueryInterface(element);
-    }
-  }
-
-  return content;
+  nsReferencedElement ref;
+  ref.Reset(aFromContent, aURI);
+  return ref.get();
 }
 
 /* static */
 PRBool
 nsContentUtils::HasNonEmptyAttr(nsIContent* aContent, PRInt32 aNameSpaceID,
                                 nsIAtom* aName)
 {
   static nsIContent::AttrValuesArray strings[] = {&nsGkAtoms::_empty, nsnull};
@@ -4288,8 +4184,37 @@ nsContentUtils::URIIsLocalFile(nsIURI *a
 }
 
 /* static */
 void
 nsAutoGCRoot::Shutdown()
 {
   NS_IF_RELEASE(sJSRuntimeService);
 }
+
+nsIAtom*
+nsContentUtils::IsNamedItem(nsIContent* aContent)
+{
+  // Only the content types reflected in Level 0 with a NAME
+  // attribute are registered. Images, layers and forms always get
+  // reflected up to the document. Applets and embeds only go
+  // to the closest container (which could be a form).
+  nsGenericHTMLElement* elm = nsGenericHTMLElement::FromContent(aContent);
+  if (!elm) {
+    return nsnull;
+  }
+
+  nsIAtom* tag = elm->Tag();
+  if (tag != nsGkAtoms::img    &&
+      tag != nsGkAtoms::form   &&
+      tag != nsGkAtoms::applet &&
+      tag != nsGkAtoms::embed  &&
+      tag != nsGkAtoms::object) {
+    return nsnull;
+  }
+
+  const nsAttrValue* val = elm->GetParsedAttr(nsGkAtoms::name);
+  if (val && val->Type() == nsAttrValue::eAtom) {
+    return val->GetAtomValue();
+  }
+
+  return nsnull;
+}
diff --git a/content/base/src/nsDocument.cpp b/content/base/src/nsDocument.cpp
--- a/content/base/src/nsDocument.cpp
+++ b/content/base/src/nsDocument.cpp
@@ -280,16 +280,233 @@ nsUint32ToContentHashEntry::VisitContent
       mValOrHash = nsnull;
     }
     return;
   }
 
   nsIContent* v = GetContent();
   if (v) {
     aVisitor->Visit(v);
+  }
+}
+
+#define ID_NOT_IN_DOCUMENT ((nsIContent *)2)
+#define NAME_NOT_VALID ((nsBaseContentList*)1)
+
+nsIdentifierMapEntry::~nsIdentifierMapEntry()
+{
+  if (mNameContentList && mNameContentList != NAME_NOT_VALID) {
+    NS_RELEASE(mNameContentList);
+  }
+}
+
+void
+nsIdentifierMapEntry::Traverse(nsCycleCollectionTraversalCallback* aCallback)
+{
+  if (mNameContentList != NAME_NOT_VALID)
+    aCallback->NoteXPCOMChild(mNameContentList);
+
+  aCallback->NoteXPCOMChild(static_cast<nsIDOMNodeList*>(mDocAllList));
+}
+
+void
+nsIdentifierMapEntry::SetInvalidName()
+{
+  mNameContentList = NAME_NOT_VALID;
+}
+
+PRBool
+nsIdentifierMapEntry::IsInvalidName()
+{
+  return mNameContentList == NAME_NOT_VALID;
+}
+
+nsresult
+nsIdentifierMapEntry::CreateNameContentList()
+{
+  mNameContentList = new nsBaseContentList();
+  NS_ENSURE_TRUE(mNameContentList, NS_ERROR_OUT_OF_MEMORY);
+  NS_ADDREF(mNameContentList);
+  return NS_OK;
+}
+
+nsIContent*
+nsIdentifierMapEntry::GetIdContent(PRBool* aNotInDocument)
+{
+  nsIContent* c = static_cast<nsIContent*>(mIdContentList.SafeElementAt(0));
+  if (aNotInDocument) {
+    *aNotInDocument = c == ID_NOT_IN_DOCUMENT;
+  }
+  return c != ID_NOT_IN_DOCUMENT ? c : nsnull;
+}
+
+void
+nsIdentifierMapEntry::AppendAllIdContent(nsCOMArray<nsIContent>* aElements)
+{
+  for (PRInt32 i = 0; i < mIdContentList.Count(); ++i) {
+    aElements->AppendObject(static_cast<nsIContent*>(mIdContentList[i]));
+  }
+}
+
+void
+nsIdentifierMapEntry::AddContentChangeCallback(nsIDocument::IDTargetObserver aCallback,
+                                               void* aData)
+{
+  if (!mChangeCallbacks) {
+    mChangeCallbacks = new nsTHashtable<ChangeCallbackEntry>;
+    if (!mChangeCallbacks)
+      return;
+    mChangeCallbacks->Init();
+  }
+
+  ChangeCallback cc = { aCallback, aData };
+  mChangeCallbacks->PutEntry(cc);
+}
+
+void
+nsIdentifierMapEntry::RemoveContentChangeCallback(nsIDocument::IDTargetObserver aCallback,
+                                                  void* aData)
+{
+  if (!mChangeCallbacks)
+    return;
+  ChangeCallback cc = { aCallback, aData };
+  mChangeCallbacks->RemoveEntry(cc);
+  if (mChangeCallbacks->Count() == 0) {
+    mChangeCallbacks = nsnull;
+  }
+}
+
+struct FireChangeArgs {
+  nsIContent* mFrom;
+  nsIContent* mTo;
+};
+
+PR_STATIC_CALLBACK(PLDHashOperator)
+FireChangeEnumerator(nsIdentifierMapEntry::ChangeCallbackEntry *aEntry, void *aArg)
+{
+  FireChangeArgs* args = static_cast<FireChangeArgs*>(aArg);
+  return aEntry->mKey.mCallback(args->mFrom, args->mTo, aEntry->mKey.mData)
+      ? PL_DHASH_NEXT : PL_DHASH_REMOVE;
+}
+
+void
+nsIdentifierMapEntry::FireChangeCallbacks(nsIContent* aOldContent,
+                                          nsIContent* aNewContent)
+{
+  if (!mChangeCallbacks)
+    return;
+
+  FireChangeArgs args = { aOldContent, aNewContent };
+  mChangeCallbacks->EnumerateEntries(FireChangeEnumerator, &args);
+}
+
+PRBool
+nsIdentifierMapEntry::AddIdContent(nsIContent* aContent)
+{
+  NS_PRECONDITION(aContent, "Must have content");
+  NS_PRECONDITION(mIdContentList.IndexOf(nsnull) < 0,
+                  "Why is null in our list?");
+  NS_PRECONDITION(aContent != ID_NOT_IN_DOCUMENT,
+                  "Bogus content pointer");
+
+  nsIContent* currentContent = static_cast<nsIContent*>(mIdContentList.SafeElementAt(0));
+  if (currentContent == ID_NOT_IN_DOCUMENT) {
+    NS_ASSERTION(mIdContentList.Count() == 1, "Bogus count");
+    mIdContentList.ReplaceElementAt(aContent, 0);
+    FireChangeCallbacks(nsnull, aContent);
+    return PR_TRUE;
+  }
+
+  // Common case
+  if (mIdContentList.Count() == 0) {
+    if (!mIdContentList.AppendElement(aContent))
+      return PR_FALSE;
+    FireChangeCallbacks(nsnull, aContent);
+    return PR_TRUE;
+  }
+
+  // We seem to have multiple content nodes for the same id, or we're doing our
+  // top-down registration when the id table is going live.  Search for the
+  // right place to insert the content.
+  PRInt32 start = 0;
+  PRInt32 end = mIdContentList.Count();
+  do {
+    NS_ASSERTION(start < end, "Bogus start/end");
+    
+    PRInt32 cur = (start + end) / 2;
+    NS_ASSERTION(cur >= start && cur < end, "What happened here?");
+
+    nsIContent* curContent = static_cast<nsIContent*>(mIdContentList[cur]);
+    if (curContent == aContent) {
+      // Already in the list, so already in the right spot.  Get out of here.
+      return PR_TRUE;
+    }
+
+    if (nsContentUtils::PositionIsBefore(aContent, curContent)) {
+      end = cur;
+    } else {
+      start = cur + 1;
+    }
+  } while (start != end);
+
+  if (!mIdContentList.InsertElementAt(aContent, start))
+    return PR_FALSE;
+  if (start == 0) {
+    FireChangeCallbacks(currentContent, aContent);
+  }
+  return PR_TRUE;
+}
+
+PRBool
+nsIdentifierMapEntry::RemoveIdContent(nsIContent* aContent)
+{
+  // This should only be called while the document is in an update.
+  // Assertions near the call to this method guarantee this.
+
+  // XXXbz should this ever Compact() I guess when all the content is gone
+  // we'll just get cleaned up in the natural order of things...
+  nsIContent* currentContent = static_cast<nsIContent*>(mIdContentList.SafeElementAt(0));
+  if (!mIdContentList.RemoveElement(aContent))
+    return PR_FALSE;
+  if (currentContent == aContent) {
+    FireChangeCallbacks(currentContent,
+                        static_cast<nsIContent*>(mIdContentList.SafeElementAt(0)));
+  }
+  return mIdContentList.Count() == 0 && !mNameContentList && !mChangeCallbacks;
+}
+
+void
+nsIdentifierMapEntry::FlagIDNotInDocument()
+{
+  NS_ASSERTION(mIdContentList.Count() == 0,
+               "Flagging ID not in document when we have content?");
+  // Note that if this fails that's OK; this is just an optimization
+  mIdContentList.AppendElement(ID_NOT_IN_DOCUMENT);
+}
+
+void
+nsIdentifierMapEntry::AddNameContent(nsIContent* aContent)
+{
+  if (!mNameContentList || mNameContentList == NAME_NOT_VALID)
+    return;
+
+  // NOTE: this indexof is absolutely needed, since we don't flush
+  // content notifications when we do document.foo resolution.  So
+  // aContent may be in our list already and just now getting notified
+  // for!
+  if (mNameContentList->IndexOf(aContent, PR_FALSE) < 0) {
+    mNameContentList->AppendElement(aContent);
+  }
+}
+
+void
+nsIdentifierMapEntry::RemoveNameContent(nsIContent* aContent)
+{
+  if (mNameContentList && mNameContentList != NAME_NOT_VALID) {
+    mNameContentList->RemoveElement(aContent);
   }
 }
 
 // Helper structs for the content->subdoc map
 
 class SubDocMapEntry : public PLDHashEntryHdr
 {
 public:
@@ -1007,30 +1224,41 @@ public:
 public:
   nsCycleCollectionTraversalCallback *mCb;
   virtual void Visit(nsIContent* aContent)
   {
     mCb->NoteXPCOMChild(aContent);
   }
 };
 
-PLDHashOperator PR_CALLBACK
+PR_STATIC_CALLBACK(PLDHashOperator)
 LinkMapTraverser(nsUint32ToContentHashEntry* aEntry, void* userArg)
 {
   LinkMapTraversalVisitor visitor;
   visitor.mCb = static_cast<nsCycleCollectionTraversalCallback*>(userArg);
   NS_CYCLE_COLLECTION_NOTE_EDGE_NAME(*visitor.mCb, "mLinkMap entry");
   aEntry->VisitContent(&visitor);
   return PL_DHASH_NEXT;
 }
 
+PR_STATIC_CALLBACK(PLDHashOperator)
+IdentifierMapEntryTraverse(nsIdentifierMapEntry *aEntry, void *aArg)
+{
+  nsCycleCollectionTraversalCallback *cb =
+    static_cast<nsCycleCollectionTraversalCallback*>(aArg);
+  aEntry->Traverse(cb);
+  return PL_DHASH_NEXT;
+}
+
 NS_IMPL_CYCLE_COLLECTION_TRAVERSE_BEGIN(nsDocument)
   if (nsCCUncollectableMarker::InGeneration(tmp->GetMarkedCCGeneration())) {
     return NS_OK;
   }
+
+  tmp->mIdentifierMap.EnumerateEntries(IdentifierMapEntryTraverse, &cb);
 
   NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMPTR(mNodeInfo)
 
   // Traverse the mChildren nsAttrAndChildArray.
   for (PRInt32 indx = PRInt32(tmp->mChildren.ChildCount()); indx > 0; --indx) {
     NS_CYCLE_COLLECTION_NOTE_EDGE_NAME(cb, "mChildren[i]");
     cb.NoteXPCOMChild(tmp->mChildren.ChildAt(indx - 1));
   }
@@ -1122,16 +1350,17 @@ NS_IMPL_CYCLE_COLLECTION_UNLINK_END
 
 nsresult
 nsDocument::Init()
 {
   if (mCSSLoader || mNodeInfoManager || mScriptLoader) {
     return NS_ERROR_ALREADY_INITIALIZED;
   }
 
+  mIdentifierMap.Init();
   mLinkMap.Init();
   mRadioGroups.Init();
 
   // Force initialization.
   nsINode::nsSlots* slots = GetSlots();
   NS_ENSURE_TRUE(slots,NS_ERROR_OUT_OF_MEMORY);
 
   // Prepend self as mutation-observer whether we need it or not (some
@@ -1216,16 +1445,17 @@ nsDocument::ResetToURI(nsIURI *aURI, nsI
   if (gDocumentLeakPRLog && PR_LOG_TEST(gDocumentLeakPRLog, PR_LOG_DEBUG)) {
     nsCAutoString spec;
     aURI->GetSpec(spec);
     PR_LogPrint("DOCUMENT %p ResetToURI %s", this, spec.get());
   }
 #endif
 
   mDocumentTitle.SetIsVoid(PR_TRUE);
+  mIdentifierMap.Clear();
 
   SetPrincipal(nsnull);
   mSecurityInfo = nsnull;
 
   mDocumentLoadGroup = nsnull;
 
   // Delete references to sub-documents and kill the subdocument map,
   // if any. It holds strong references
@@ -1523,16 +1753,195 @@ nsDocument::GetLastModified(nsAString& a
     aLastModified.Assign(mLastModified);
   } else {
     // If we for whatever reason failed to find the last modified time
     // (or even the current time), fall back to what NS4.x returned.
     aLastModified.Assign(NS_LITERAL_STRING("01/01/1970 00:00:00"));
   }
 
   return NS_OK;
+}
+
+void
+nsDocument::UpdateNameTableEntry(nsIContent *aContent)
+{
+  if (!mIsRegularHTML)
+    return;
+
+  nsIAtom* name = nsContentUtils::IsNamedItem(aContent);
+  if (!name)
+    return;
+
+  nsIdentifierMapEntry *entry = mIdentifierMap.GetEntry(name);
+  if (!entry) {
+    // We're not tracking the elements with this name
+    return;
+  }
+
+  entry->AddNameContent(aContent);
+}
+
+void
+nsDocument::RemoveFromNameTable(nsIContent *aContent)
+{
+  if (!mIsRegularHTML)
+    return;
+
+  nsIAtom* name = nsContentUtils::IsNamedItem(aContent);
+  if (!name)
+    return;
+
+  nsIdentifierMapEntry *entry = mIdentifierMap.GetEntry(name);
+  if (!entry) {
+    // We're not tracking the elements with this name
+    return;
+  }
+
+  entry->RemoveNameContent(aContent);
+}
+
+void
+nsDocument::UpdateIdTableEntry(nsIContent *aContent)
+{
+  nsIAtom* id = aContent->GetID();
+  if (!id)
+    return;
+
+  PRBool liveTable = IdTableIsLive();
+  nsIdentifierMapEntry *entry =
+    liveTable ? mIdentifierMap.PutEntry(id) : mIdentifierMap.GetEntry(id);
+
+  if (entry) {
+    entry->AddIdContent(aContent);
+  }
+}
+
+void
+nsDocument::RemoveFromIdTable(nsIContent *aContent)
+{
+  nsIAtom* id = aContent->GetID();
+  if (!id)
+    return;
+
+  nsIdentifierMapEntry *entry = mIdentifierMap.GetEntry(id);
+  if (!entry)
+    return;
+
+  if (entry->RemoveIdContent(aContent)) {
+    mIdentifierMap.RemoveEntry(id);
+  }
+}
+
+void
+nsDocument::UnregisterNamedItems(nsIContent *aContent)
+{
+  if (aContent->IsNodeOfType(nsINode::eTEXT)) {
+    // Text nodes are not named items nor can they have children.
+    return;
+  }
+
+  RemoveFromNameTable(aContent);
+  RemoveFromIdTable(aContent);
+
+  PRUint32 i, count = aContent->GetChildCount();
+  for (i = 0; i < count; ++i) {
+    UnregisterNamedItems(aContent->GetChildAt(i));
+  }
+}
+
+void
+nsDocument::RegisterNamedItems(nsIContent *aContent)
+{
+  if (aContent->IsNodeOfType(nsINode::eTEXT)) {
+    // Text nodes are not named items nor can they have children.
+    return;
+  }
+
+  UpdateNameTableEntry(aContent);
+  UpdateIdTableEntry(aContent);
+
+  PRUint32 i, count = aContent->GetChildCount();
+  for (i = 0; i < count; ++i) {
+    RegisterNamedItems(aContent->GetChildAt(i));
+  }
+}
+
+void
+nsDocument::ContentAppended(nsIDocument* aDocument,
+                            nsIContent* aContainer,
+                            PRInt32 aNewIndexInContainer)
+{
+  NS_ASSERTION(aDocument == this, "unexpected doc");
+
+  PRUint32 count = aContainer->GetChildCount();
+  for (PRUint32 i = aNewIndexInContainer; i < count; ++i) {
+    RegisterNamedItems(aContainer->GetChildAt(i));
+  }
+}
+
+void
+nsDocument::ContentInserted(nsIDocument* aDocument,
+                            nsIContent* aContainer,
+                            nsIContent* aContent,
+                            PRInt32 aIndexInContainer)
+{
+  NS_ASSERTION(aDocument == this, "unexpected doc");
+
+  NS_ABORT_IF_FALSE(aContent, "Null content!");
+
+  RegisterNamedItems(aContent);
+}
+
+void
+nsDocument::ContentRemoved(nsIDocument* aDocument,
+                           nsIContent* aContainer,
+                           nsIContent* aChild,
+                           PRInt32 aIndexInContainer)
+{
+  NS_ASSERTION(aDocument == this, "unexpected doc");
+
+  NS_ABORT_IF_FALSE(aChild, "Null content!");
+
+  UnregisterNamedItems(aChild);
+}
+
+void
+nsDocument::AttributeWillChange(nsIContent* aContent, PRInt32 aNameSpaceID,
+                                nsIAtom* aAttribute)
+{
+  NS_ABORT_IF_FALSE(aContent, "Null content!");
+  NS_PRECONDITION(aAttribute, "Must have an attribute that's changing!");
+
+  if (aNameSpaceID != kNameSpaceID_None)
+    return;
+  if (aAttribute == nsGkAtoms::name) {
+    RemoveFromNameTable(aContent);
+  } else if (aAttribute == aContent->GetIDAttributeName()) {
+    RemoveFromIdTable(aContent);
+  }
+}
+
+void
+nsDocument::AttributeChanged(nsIDocument* aDocument,
+                             nsIContent* aContent, PRInt32 aNameSpaceID,
+                             nsIAtom* aAttribute, PRInt32 aModType,
+                             PRUint32 aStateMask)
+{
+  NS_ASSERTION(aDocument == this, "unexpected doc");
+
+  NS_ABORT_IF_FALSE(aContent, "Null content!");
+  NS_PRECONDITION(aAttribute, "Must have an attribute that's changing!");
+
+  if (aNameSpaceID != kNameSpaceID_None)
+    return;
+  if (aAttribute == nsGkAtoms::name) {
+    UpdateNameTableEntry(aContent);
+  } else if (aAttribute == aContent->GetIDAttributeName()) {
+    UpdateIdTableEntry(aContent);
+  }
 }
 
 nsIPrincipal*
 nsDocument::GetPrincipal()
 {
   return NodePrincipal();
 }
 
@@ -2756,32 +3165,178 @@ nsDocument::BeginLoad()
   // Block onload here to prevent having to deal with blocking and
   // unblocking it while we know the document is loading.
   BlockOnload();
 
   NS_DOCUMENT_NOTIFY_OBSERVERS(BeginLoad, (this));
 }
 
 PRBool
-nsDocument::CheckGetElementByIdArg(const nsAString& aId)
-{
-  if (aId.IsEmpty()) {
+nsDocument::CheckGetElementByIdArg(const nsIAtom* aId)
+{
+  if (aId == nsGkAtoms::_empty) {
     nsContentUtils::ReportToConsole(
         nsContentUtils::eDOM_PROPERTIES,
         "EmptyGetElementByIdParam",
         nsnull, 0,
         nsnull,
         EmptyString(), 0, 0,
         nsIScriptError::warningFlag,
         "DOM");
     return PR_FALSE;
   }
   return PR_TRUE;
 }
 
+static void
+MatchAllElementsId(nsIContent* aContent, nsIAtom* aId, nsIdentifierMapEntry* aEntry)
+{
+  if (aId == aContent->GetID()) {
+    aEntry->AddIdContent(aContent);
+  }
+
+  PRUint32 i, count = aContent->GetChildCount();
+  for (i = 0; i < count; i++) {
+    MatchAllElementsId(aContent->GetChildAt(i), aId, aEntry);
+  }
+}
+
+nsIdentifierMapEntry*
+nsDocument::GetElementByIdInternal(nsIAtom* aID)
+{
+  // We don't have to flush before we do the initial hashtable lookup, since if
+  // the id is already in the hashtable it couldn't have been removed without
+  // us being notified (all removals notify immediately, as far as I can tell).
+  // So do the lookup first.
+  nsIdentifierMapEntry *entry = mIdentifierMap.PutEntry(aID);
+  NS_ENSURE_TRUE(entry, nsnull);
+
+  if (entry->GetIdContent())
+    return entry;
+
+  // Now we have to flush.  It could be that we have a cached "not in
+  // document" or know nothing about this ID yet but more content has been
+  // added to the document since.  Note that we have to flush notifications,
+  // so that the entry will get updated properly.
+
+  // Make sure to stash away the current generation so we can check whether
+  // the table changes when we flush.
+  PRUint32 generation = mIdentifierMap.GetGeneration();
+  
+  FlushPendingNotifications(Flush_ContentAndNotify);
+
+  if (generation != mIdentifierMap.GetGeneration()) {
+    // Table changed, so the entry pointer is no longer valid; look up the
+    // entry again, adding if necessary (the adding may be necessary in case
+    // the flush actually deleted entries).
+    entry = mIdentifierMap.PutEntry(aID);
+  }
+  
+  PRBool isNotInDocument;
+  nsIContent *e = entry->GetIdContent(&isNotInDocument);
+  if (e || isNotInDocument)
+    return entry;
+
+  // Status of this id is unknown, search document
+  nsIContent* root = GetRootContent();
+  if (!IdTableIsLive()) {
+    if (IdTableShouldBecomeLive()) {
+      // Just make sure our table is up to date and call this method again
+      // to look up in the hashtable.
+      if (root) {
+        RegisterNamedItems(root);
+      }
+      return GetElementByIdInternal(aID);
+    }
+
+    if (root) {
+      // No-one should have registered an ID change callback yet. We don't
+      // want to fire one as a side-effect of getElementById! This shouldn't
+      // happen, since if someone called AddIDTargetObserver already for
+      // this ID, we should have filled in this entry with content or
+      // not-in-document.
+      NS_ASSERTION(!entry->HasContentChangeCallback(),
+                   "No callbacks should be registered while we set up this entry");
+      MatchAllElementsId(root, aID, entry);
+      e = entry->GetIdContent();
+    }
+  }
+
+  if (!e) {
+#ifdef DEBUG
+    // No reason to call MatchElementId if !IdTableIsLive, since
+    // we'd have done just that already
+    if (IdTableIsLive() && root && aID != nsGkAtoms::_empty) {
+      nsIContent* eDebug =
+        nsContentUtils::MatchElementId(root, aID);
+      NS_ASSERTION(!eDebug,
+                   "We got null for |e| but MatchElementId found something?");
+    }
+#endif
+    // There is no element with the given id in the document, cache
+    // the fact that it's not in the document
+    entry->FlagIDNotInDocument();
+    return entry;
+  }
+
+  return entry;
+}
+
+NS_IMETHODIMP
+nsDocument::GetElementById(const nsAString& aElementId,
+                           nsIDOMElement** aReturn)
+{
+  NS_ENSURE_ARG_POINTER(aReturn);
+  *aReturn = nsnull;
+
+  nsCOMPtr<nsIAtom> idAtom(do_GetAtom(aElementId));
+  NS_ENSURE_TRUE(idAtom, NS_ERROR_OUT_OF_MEMORY);
+  if (!CheckGetElementByIdArg(idAtom))
+    return NS_OK;
+
+  nsIdentifierMapEntry *entry = GetElementByIdInternal(idAtom);
+  NS_ENSURE_TRUE(entry, NS_ERROR_OUT_OF_MEMORY);
+
+  PRBool isNotInDocument;
+  nsIContent *e = entry->GetIdContent(&isNotInDocument);
+  NS_ASSERTION(e || isNotInDocument, "Incomplete map entry!");
+  if (isNotInDocument)
+    return NS_OK;
+
+  return CallQueryInterface(e, aReturn);
+}
+
+nsIContent*
+nsDocument::AddIDTargetObserver(nsIAtom* aID, IDTargetObserver aObserver,
+                                void* aData)
+{
+  if (!CheckGetElementByIdArg(aID))
+    return nsnull;
+
+  nsIdentifierMapEntry *entry = GetElementByIdInternal(aID);
+  NS_ENSURE_TRUE(entry, nsnull);
+
+  entry->AddContentChangeCallback(aObserver, aData);
+  return entry->GetIdContent();
+}
+
+void
+nsDocument::RemoveIDTargetObserver(nsIAtom* aID,
+                                   IDTargetObserver aObserver, void* aData)
+{
+  if (!CheckGetElementByIdArg(aID))
+    return;
+
+  nsIdentifierMapEntry *entry = GetElementByIdInternal(aID);
+  if (!entry)
+    return;
+
+  entry->RemoveContentChangeCallback(aObserver, aData);
+}
+
 void
 nsDocument::DispatchContentLoadedEvents()
 {
   // If you add early returns from this method, make sure you're
   // calling UnblockOnload properly.
   
   // Fire a DOM event notifying listeners that this document has been
   // loaded (excluding images and other loads initiated by this
@@ -2877,23 +3432,16 @@ nsDocument::EndLoad()
 }
 
 void
 nsDocument::ContentStatesChanged(nsIContent* aContent1, nsIContent* aContent2,
                                  PRInt32 aStateMask)
 {
   NS_DOCUMENT_NOTIFY_OBSERVERS(ContentStatesChanged,
                                (this, aContent1, aContent2, aStateMask));
-}
-
-void
-nsDocument::AttributeWillChange(nsIContent* aChild, PRInt32 aNameSpaceID,
-                                nsIAtom* aAttribute)
-{
-  NS_ASSERTION(aChild, "Null child!");
 }
 
 void
 nsDocument::StyleRuleChanged(nsIStyleSheet* aStyleSheet,
                              nsIStyleRule* aOldStyleRule,
                              nsIStyleRule* aNewStyleRule)
 {
   NS_DOCUMENT_NOTIFY_OBSERVERS(StyleRuleChanged,
@@ -3209,24 +3757,16 @@ nsDocument::GetElementsByTagNameNS(const
   NS_ENSURE_TRUE(nameAtom, NS_ERROR_OUT_OF_MEMORY);
 
   nsContentList *list = NS_GetContentList(this, nameAtom, nameSpaceId).get();
   NS_ENSURE_TRUE(list, NS_ERROR_OUT_OF_MEMORY);
 
   // transfer ref to aReturn
   *aReturn = list;
   return NS_OK;
-}
-
-NS_IMETHODIMP
-nsDocument::GetElementById(const nsAString & elementId,
-                           nsIDOMElement **_retval)
-{
-  // Should be implemented by subclass
-  return NS_ERROR_NOT_IMPLEMENTED;
 }
 
 NS_IMETHODIMP
 nsDocument::GetAsync(PRBool *aAsync)
 {
   NS_ERROR("nsDocument::GetAsync() should be overriden by subclass!");
 
   return NS_ERROR_NOT_IMPLEMENTED;
diff --git a/content/base/src/nsDocument.h b/content/base/src/nsDocument.h
--- a/content/base/src/nsDocument.h
+++ b/content/base/src/nsDocument.h
@@ -85,16 +85,17 @@
 #include "nsIScriptEventManager.h"
 #include "nsILayoutHistoryState.h"
 #include "nsIRequest.h"
 #include "nsILoadGroup.h"
 #include "nsTObserverArray.h"
 #include "nsStubMutationObserver.h"
 #include "nsIChannel.h"
 #include "nsCycleCollectionParticipant.h"
+#include "nsContentList.h"
 
 // Put these here so all document impls get them automatically
 #include "nsHTMLStyleSheet.h"
 #include "nsIHTMLCSSStyleSheet.h"
 
 #include "nsStyleSet.h"
 #include "nsXMLEventsManager.h"
 #include "pldhash.h"
@@ -205,16 +206,126 @@ class nsUint32ToContentHashEntry : publi
     void Destroy();
 
   private:
     const PRUint32 mValue;
     /** A hash or nsIContent ptr, depending on the lower bit (0=hash, 1=ptr) */
     void* mValOrHash;
 };
 
+/**
+ * Right now our identifier map entries contain information for 'name'
+ * and 'id' mappings of a given string. This is so that
+ * nsHTMLDocument::ResolveName only has to do one hash lookup instead
+ * of two. It's not clear whether this still matters for performance.
+ * 
+ * We also store the document.all result list here. This is mainly so that
+ * when all elements with the given ID are removed and we remove
+ * the ID's nsIdentifierMapEntry, the document.all result is released too.
+ * Perhaps the document.all results should have their own hashtable
+ * in nsHTMLDocument.
+ */
+class nsIdentifierMapEntry : public nsISupportsHashKey
+{
+public:
+  nsIdentifierMapEntry(const nsISupports* aKey) :
+    nsISupportsHashKey(aKey), mNameContentList(nsnull)
+  {
+  }
+  nsIdentifierMapEntry(const nsIdentifierMapEntry& aOther) :
+    nsISupportsHashKey(GetKey())
+  {
+    NS_ERROR("Should never be called");
+  }
+  ~nsIdentifierMapEntry();
+
+  void SetInvalidName();
+  PRBool IsInvalidName();
+  void AddNameContent(nsIContent* aContent);
+  void RemoveNameContent(nsIContent* aContent);
+  PRBool HasNameContentList() {
+    return mNameContentList != nsnull;
+  }
+  nsBaseContentList* GetNameContentList() {
+    return mNameContentList;
+  }
+  nsresult CreateNameContentList();
+
+  /**
+   * Returns the element if we know the element associated with this
+   * id. Otherwise returns null.
+   * @param aIsNotInDocument if non-null, we set the output to true
+   * if we know for sure the element is not in the document.
+   */
+  nsIContent* GetIdContent(PRBool* aIsNotInDocument = nsnull);
+  void AppendAllIdContent(nsCOMArray<nsIContent>* aElements);
+  /**
+   * This can fire ID change callbacks.
+   * @return true if the content could be added, false if we failed due
+   * to OOM.
+   */
+  PRBool AddIdContent(nsIContent* aContent);
+  /**
+   * This can fire ID change callbacks.
+   * @return true if this map entry should be removed
+   */
+  PRBool RemoveIdContent(nsIContent* aContent);
+  void FlagIDNotInDocument();
+
+  PRBool HasContentChangeCallback() { return mChangeCallbacks != nsnull; }
+  void AddContentChangeCallback(nsIDocument::IDTargetObserver aCallback, void* aData);
+  void RemoveContentChangeCallback(nsIDocument::IDTargetObserver aCallback, void* aData);
+
+  void Traverse(nsCycleCollectionTraversalCallback* aCallback);
+
+  void SetDocAllList(nsContentList* aContentList) { mDocAllList = aContentList; }
+  nsContentList* GetDocAllList() { return mDocAllList; }
+
+  struct ChangeCallback {
+    nsIDocument::IDTargetObserver mCallback;
+    void* mData;
+  };
+
+  struct ChangeCallbackEntry : public PLDHashEntryHdr {
+    typedef const ChangeCallback KeyType;
+    typedef const ChangeCallback* KeyTypePointer;
+
+    ChangeCallbackEntry(const ChangeCallback* key) :
+      mKey(*key) { }
+    ChangeCallbackEntry(const ChangeCallbackEntry& toCopy) :
+      mKey(toCopy.mKey) { }
+
+    KeyType GetKey() const { return mKey; }
+    PRBool KeyEquals(KeyTypePointer aKey) const {
+      return aKey->mCallback == mKey.mCallback &&
+             aKey->mData == mKey.mData;
+    }
+
+    static KeyTypePointer KeyToPointer(KeyType& aKey) { return &aKey; }
+    static PLDHashNumber HashKey(KeyTypePointer aKey)
+    {
+      return NS_PTR_TO_INT32(aKey->mCallback) >> 2 +
+             NS_PTR_TO_INT32(aKey->mData);
+    }
+    enum { ALLOW_MEMMOVE = PR_TRUE };
+    
+    ChangeCallback mKey;
+  };
+
+private:
+  void FireChangeCallbacks(nsIContent* aOldContent, nsIContent* aNewContent);
+
+  // The single element ID_NOT_IN_DOCUMENT, or empty to indicate we
+  // don't know what element(s) have this key as an ID
+  nsSmallVoidArray mIdContentList;
+  // NAME_NOT_VALID if this id cannot be used as a 'name'
+  nsBaseContentList *mNameContentList;
+  nsRefPtr<nsContentList> mDocAllList;
+  nsAutoPtr<nsTHashtable<ChangeCallbackEntry> > mChangeCallbacks;
+};
 
 class nsDocHeaderData
 {
 public:
   nsDocHeaderData(nsIAtom* aField, const nsAString& aData)
     : mField(aField), mData(aData), mNext(nsnull)
   {
   }
@@ -350,16 +461,21 @@ public:
    * Add an observer that gets notified whenever the charset changes.
    */
   virtual nsresult AddCharSetObserver(nsIObserver* aObserver);
 
   /**
    * Remove a charset observer.
    */
   virtual void RemoveCharSetObserver(nsIObserver* aObserver);
+
+  virtual nsIContent* AddIDTargetObserver(nsIAtom* aID,
+                                          IDTargetObserver aObserver, void* aData);
+  virtual void RemoveIDTargetObserver(nsIAtom* aID,
+                                      IDTargetObserver aObserver, void* aData);
 
   /**
    * Access HTTP header data (this may also get set from other sources, like
    * HTML META tags).
    */
   virtual void GetHeaderData(nsIAtom* aHeaderField, nsAString& aData) const;
   virtual void SetHeaderData(nsIAtom* aheaderField,
                              const nsAString& aData);
@@ -607,16 +723,22 @@ public:
   NS_DECL_NSIDOMEVENTTARGET
 
   // nsIDOM3EventTarget
   NS_DECL_NSIDOM3EVENTTARGET
 
   // nsIDOMNSEventTarget
   NS_DECL_NSIDOMNSEVENTTARGET
 
+  // nsIMutationObserver
+  NS_DECL_NSIMUTATIONOBSERVER_CONTENTAPPENDED
+  NS_DECL_NSIMUTATIONOBSERVER_CONTENTINSERTED
+  NS_DECL_NSIMUTATIONOBSERVER_CONTENTREMOVED
+  NS_DECL_NSIMUTATIONOBSERVER_ATTRIBUTECHANGED
+
   // nsIScriptObjectPrincipal
   virtual nsIPrincipal* GetPrincipal();
 
   virtual nsresult Init();
   
   virtual nsresult AddXMLEventsContent(nsIContent * aXMLEventsElement);
 
   virtual nsresult CreateElem(nsIAtom *aName, nsIAtom *aPrefix,
@@ -660,22 +782,30 @@ public:
    * Utility method for getElementsByClassName.  aRootNode is the node (either
    * document or element), which getElementsByClassName was called on.
    */
   static nsresult GetElementsByClassNameHelper(nsINode* aRootNode,
                                                const nsAString& aClasses,
                                                nsIDOMNodeList** aReturn);
 protected:
 
+  void RegisterNamedItems(nsIContent *aContent);
+  void UnregisterNamedItems(nsIContent *aContent);
+  void UpdateNameTableEntry(nsIContent *aContent);
+  void UpdateIdTableEntry(nsIContent *aContent);
+  void RemoveFromNameTable(nsIContent *aContent);
+  void RemoveFromIdTable(nsIContent *aContent);
+
   /**
    * Check that aId is not empty and log a message to the console
    * service if it is.
    * @returns PR_TRUE if aId looks correct, PR_FALSE otherwise.
    */
-  static PRBool CheckGetElementByIdArg(const nsAString& aId);
+  static PRBool CheckGetElementByIdArg(const nsIAtom* aId);
+  nsIdentifierMapEntry* GetElementByIdInternal(nsIAtom* aID);
 
   void DispatchContentLoadedEvents();
 
   void InitializeFinalizeFrameLoaders();
 
   void RetrieveRelevantHeaders(nsIChannel *aChannel);
 
   static PRBool TryChannelCharset(nsIChannel *aChannel,
@@ -767,39 +897,67 @@ protected:
   // is a weak reference to avoid leaks due to circular references.
   nsWeakPtr mScopeObject;
 
   nsCOMPtr<nsIEventListenerManager> mListenerManager;
   nsCOMPtr<nsIDOMStyleSheetList> mDOMStyleSheets;
   nsRefPtr<nsDOMStyleSheetSetList> mStyleSheetSetList;
   nsRefPtr<nsScriptLoader> mScriptLoader;
   nsDocHeaderData* mHeaderData;
+  /* mIdentifierMap works as follows for IDs:
+   * 1) Attribute changes affect the table immediately (removing and adding
+   *    entries as needed).
+   * 2) Removals from the DOM affect the table immediately
+   * 3) Additions to the DOM always update existing entries, but only add new
+   *    ones if IdTableIsLive() is true.
+   */
+  nsTHashtable<nsIdentifierMapEntry> mIdentifierMap;
 
   nsClassHashtable<nsStringHashKey, nsRadioGroupStruct> mRadioGroups;
 
   // True if the document has been detached from its content viewer.
   PRPackedBool mIsGoingAway:1;
   // True if our content viewer has been removed from the docshell
   // (it may still be displayed, but in zombie state). Form control data
   // has been saved.
   PRPackedBool mRemovedFromDocShell:1;
   // True if the document is being destroyed.
   PRPackedBool mInDestructor:1;
   // True if the document "page" is not hidden
   PRPackedBool mVisible:1;
   // True if document has ever had script handling object.
   PRPackedBool mHasHadScriptHandlingObject:1;
+  // True if this is a regular (non-XHTML) HTML document
+  // XXXbz should this be reset if someone manually calls
+  // SetContentType() on this document?
+  PRPackedBool mIsRegularHTML:1;
 
   PRPackedBool mHasWarnedAboutBoxObjects:1;
 
   PRPackedBool mDelayFrameLoaderInitialization:1;
 
   PRUint8 mXMLDeclarationBits;
 
   PRUint8 mDefaultElementType;
+
+  PRBool IdTableIsLive() const {
+    // live if we've had over 63 misses
+    return (mIdMissCount & 0x40) != 0;
+  }
+  void SetIdTableLive() {
+    mIdMissCount = 0x40;
+  }
+  PRBool IdTableShouldBecomeLive() {
+    NS_ASSERTION(!IdTableIsLive(),
+                 "Shouldn't be called if table is already live!");
+    ++mIdMissCount;
+    return IdTableIsLive();
+  }
+
+  PRUint8 mIdMissCount;
 
   nsInterfaceHashtable<nsVoidPtrHashKey, nsPIBoxObject> *mBoxObjectTable;
   nsInterfaceHashtable<nsVoidPtrHashKey, nsISupports> *mContentWrapperHash;
 
   // The channel that got passed to StartDocumentLoad(), if any
   nsCOMPtr<nsIChannel> mChannel;
   nsRefPtr<nsHTMLStyleSheet> mAttrStyleSheet;
   nsCOMPtr<nsIHTMLCSSStyleSheet> mStyleAttrStyleSheet;
diff --git a/content/base/src/nsGenericElement.cpp b/content/base/src/nsGenericElement.cpp
--- a/content/base/src/nsGenericElement.cpp
+++ b/content/base/src/nsGenericElement.cpp
@@ -2227,62 +2227,85 @@ nsGenericElement::UnbindFromTree(PRBool 
 
 nsresult
 nsGenericElement::PreHandleEvent(nsEventChainPreVisitor& aVisitor)
 {
   return nsGenericElement::doPreHandleEvent(this, aVisitor);
 }
 
 static nsIContent*
-FindFirstNonNativeAnonymousAncestor(nsIContent* aContent)
-{
-  while (aContent && aContent->IsNativeAnonymous()) {
-    aContent = aContent->GetParent();
+FindNativeAnonymousSubtreeOwner(nsIContent* aContent)
+{
+  if (aContent->IsInNativeAnonymousSubtree()) {
+    PRBool isNativeAnon = PR_FALSE;
+    while (aContent && !isNativeAnon) {
+      isNativeAnon = aContent->IsNativeAnonymous();
+      aContent = aContent->GetParent();
+    }
   }
   return aContent;
 }
 
 nsresult
 nsGenericElement::doPreHandleEvent(nsIContent* aContent,
                                    nsEventChainPreVisitor& aVisitor)
 {
   //FIXME! Document how this event retargeting works, Bug 329124.
   aVisitor.mCanHandle = PR_TRUE;
 
   // Don't propagate mouseover and mouseout events when mouse is moving
   // inside native anonymous content.
   PRBool isAnonForEvents = aContent->IsNativeAnonymous();
-  if (aVisitor.mEvent->message == NS_MOUSE_ENTER_SYNTH ||
-      aVisitor.mEvent->message == NS_MOUSE_EXIT_SYNTH) {
+  if ((aVisitor.mEvent->message == NS_MOUSE_ENTER_SYNTH ||
+       aVisitor.mEvent->message == NS_MOUSE_EXIT_SYNTH) &&
+      // This is an optimization - try to stop event propagation when
+      // event has just possibly been retargeted.
+      static_cast<nsISupports*>(aContent) == aVisitor.mEvent->target) {
      nsCOMPtr<nsIContent> relatedTarget =
        do_QueryInterface(static_cast<nsMouseEvent*>
                                     (aVisitor.mEvent)->relatedTarget);
     if (relatedTarget &&
         relatedTarget->GetOwnerDoc() == aContent->GetOwnerDoc()) {
 
       // If current target is anonymous for events or we know that related
       // target is descendant of an element which is anonymous for events,
       // we may want to stop event propagation.
       // If aContent is the original target, aVisitor.mRelatedTargetIsInAnon
       // must be updated.
       if (isAnonForEvents || aVisitor.mRelatedTargetIsInAnon ||
           (aVisitor.mEvent->originalTarget == aContent &&
            (aVisitor.mRelatedTargetIsInAnon =
             relatedTarget->IsInNativeAnonymousSubtree()))) {
-        nsIContent* nonAnon = FindFirstNonNativeAnonymousAncestor(aContent);
-        if (nonAnon) {
-          nsIContent* nonAnonRelated =
-            FindFirstNonNativeAnonymousAncestor(relatedTarget);
-          if (nonAnonRelated) {
-            if (nonAnon == nonAnonRelated ||
-                nsContentUtils::ContentIsDescendantOf(nonAnonRelated, nonAnon)) {
-              aVisitor.mParentTarget = nsnull;
-              // Event should not propagate to non-anon content.
-              aVisitor.mCanHandle = isAnonForEvents;
-              return NS_OK;
+        nsIContent* anonOwner = FindNativeAnonymousSubtreeOwner(aContent);
+        if (anonOwner) {
+          nsIContent* anonOwnerRelated =
+            FindNativeAnonymousSubtreeOwner(relatedTarget);
+          if (anonOwnerRelated) {
+            // Note, anonOwnerRelated may still be inside some other
+            // native anonymous subtree. The case where anonOwner is still
+            // inside native anonymous subtree will be handled when event
+            // propagates up in the DOM tree.
+            while (anonOwner != anonOwnerRelated &&
+                   anonOwnerRelated->IsInNativeAnonymousSubtree()) {
+              anonOwnerRelated = FindNativeAnonymousSubtreeOwner(anonOwnerRelated);
+            }
+            if (anonOwner == anonOwnerRelated) {
+              nsCOMPtr<nsIContent> target =
+                do_QueryInterface(aVisitor.mEvent->originalTarget);
+              // Because XBL and native anon content both do event re-targeting,
+              // static_cast<nsISupports*>(aContent) == aVisitor.mEvent->target
+              // optimization may not always work. So be paranoid and make
+              // sure we never stop event propagation when we shouldn't!
+              if (relatedTarget->FindFirstNonNativeAnonymous() ==
+                  target->FindFirstNonNativeAnonymous()) {
+                aVisitor.mParentTarget = nsnull;
+                // Event should not propagate to non-anon content.
+                aVisitor.mCanHandle = isAnonForEvents;
+                return NS_OK;
+              }
             }
           }
         }
       }
     }
   }
 
   nsCOMPtr<nsIContent> parent = aContent->GetParent();
diff --git a/content/base/src/nsReferencedElement.cpp b/content/base/src/nsReferencedElement.cpp
new file mode 100644
--- /dev/null
+++ b/content/base/src/nsReferencedElement.cpp
@@ -0,0 +1,212 @@
+/* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
+/* vim: set ts=2 sw=2 et tw=78: */
+/* ***** BEGIN LICENSE BLOCK *****
+ * Version: MPL 1.1/GPL 2.0/LGPL 2.1
+ *
+ * The contents of this file are subject to the Mozilla Public License Version
+ * 1.1 (the "License"); you may not use this file except in compliance with
+ * the License. You may obtain a copy of the License at
+ * http://www.mozilla.org/MPL/
+ *
+ * Software distributed under the License is distributed on an "AS IS" basis,
+ * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+ * for the specific language governing rights and limitations under the
+ * License.
+ *
+ * The Original Code is mozilla.org code.
+ *
+ * The Initial Developer of the Original Code is Mozilla.org.
+ * Portions created by the Initial Developer are Copyright (C) 2008
+ * the Initial Developer. All Rights Reserved.
+ *
+ * Contributor(s):
+ *   Robert O'Callahan   <robert@ocallahan.org>
+ *
+ * Alternatively, the contents of this file may be used under the terms of
+ * either of the GNU General Public License Version 2 or later (the "GPL"),
+ * or the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+ * in which case the provisions of the GPL or the LGPL are applicable instead
+ * of those above. If you wish to allow use of your version of this file only
+ * under the terms of either the GPL or the LGPL, and not to allow others to
+ * use your version of this file under the terms of the MPL, indicate your
+ * decision by deleting the provisions above and replace them with the notice
+ * and other provisions required by the GPL or the LGPL. If you do not delete
+ * the provisions above, a recipient may use your version of this file under
+ * the terms of any one of the MPL, the GPL or the LGPL.
+ *
+ * ***** END LICENSE BLOCK ***** */
+
+#include "nsReferencedElement.h"
+#include "nsContentUtils.h"
+#include "nsIURI.h"
+#include "nsBindingManager.h"
+#include "nsIURL.h"
+#include "nsEscape.h"
+#include "nsXBLPrototypeBinding.h"
+#include "nsIDOMNode.h"
+#include "nsIDOMDocument.h"
+#include "nsIDOMElement.h"
+#include "nsCycleCollectionParticipant.h"
+
+static PRBool EqualExceptRef(nsIURL* aURL1, nsIURL* aURL2)
+{
+  nsCOMPtr<nsIURI> u1;
+  nsCOMPtr<nsIURI> u2;
+
+  nsresult rv = aURL1->Clone(getter_AddRefs(u1));
+  if (NS_SUCCEEDED(rv)) {
+    rv = aURL2->Clone(getter_AddRefs(u2));
+  }
+  if (NS_FAILED(rv))
+    return PR_FALSE;
+
+  nsCOMPtr<nsIURL> url1 = do_QueryInterface(u1);
+  nsCOMPtr<nsIURL> url2 = do_QueryInterface(u2);
+  if (!url1 || !url2) {
+    NS_WARNING("Cloning a URL produced a non-URL");
+    return PR_FALSE;
+  }
+  url1->SetRef(EmptyCString());
+  url2->SetRef(EmptyCString());
+
+  PRBool equal;
+  rv = url1->Equals(url2, &equal);
+  return NS_SUCCEEDED(rv) && equal;
+}
+
+void
+nsReferencedElement::Reset(nsIContent* aFromContent, nsIURI* aURI, PRBool aWatch)
+{
+  Unlink();
+
+  nsCOMPtr<nsIURL> url = do_QueryInterface(aURI);
+  if (!url)
+    return;
+
+  nsCAutoString refPart;
+  url->GetRef(refPart);
+  // Unescape %-escapes in the reference. The result will be in the
+  // origin charset of the URL, hopefully...
+  NS_UnescapeURL(refPart);
+
+  nsCAutoString charset;
+  url->GetOriginCharset(charset);
+  nsAutoString ref;
+  nsresult rv = nsContentUtils::ConvertStringFromCharset(charset, refPart, ref);
+  if (NS_FAILED(rv)) {
+    CopyUTF8toUTF16(refPart, ref);
+  }
+  if (ref.IsEmpty())
+    return;
+
+  // Get the current document
+  nsIDocument *doc = aFromContent->GetCurrentDoc();
+  if (!doc)
+    return;
+
+  // This will be the URI of the document the content belongs to
+  // (the URI of the XBL document if the content is anonymous
+  // XBL content)
+  nsCOMPtr<nsIURL> documentURL = do_QueryInterface(doc->GetDocumentURI());
+  nsIContent* bindingParent = aFromContent->GetBindingParent();
+  PRBool isXBL = PR_FALSE;
+  if (bindingParent) {
+    nsXBLBinding* binding = doc->BindingManager()->GetBinding(bindingParent);
+    if (binding) {
+      // XXX sXBL/XBL2 issue
+      // If this is an anonymous XBL element then the URI is
+      // relative to the binding document. A full fix requires a
+      // proper XBL2 implementation but for now URIs that are
+      // relative to the binding document should be resolve to the
+      // copy of the target element that has been inserted into the
+      // bound document.
+      documentURL = do_QueryInterface(binding->PrototypeBinding()->DocURI());
+      isXBL = PR_TRUE;
+    }
+  }
+  if (!documentURL)
+    return;
+
+  if (!EqualExceptRef(url, documentURL)) {
+    // Oops -- we don't support off-document references
+    return;
+  }
+
+  // Get the element
+  if (isXBL) {
+    nsCOMPtr<nsIDOMNodeList> anonymousChildren;
+    doc->BindingManager()->
+      GetAnonymousNodesFor(bindingParent, getter_AddRefs(anonymousChildren));
+
+    if (anonymousChildren) {
+      PRUint32 length;
+      anonymousChildren->GetLength(&length);
+      for (PRUint32 i = 0; i < length && !mContent; ++i) {
+        nsCOMPtr<nsIDOMNode> node;
+        anonymousChildren->Item(i, getter_AddRefs(node));
+        nsCOMPtr<nsIContent> c = do_QueryInterface(node);
+        if (c) {
+          mContent = nsContentUtils::MatchElementId(c, ref);
+        }
+      }
+    }
+    return;
+  }
+
+  if (aWatch) {
+    nsCOMPtr<nsIAtom> atom = do_GetAtom(ref);
+    if (!atom)
+      return;
+    atom.swap(mWatchID);
+    mWatchDocument = doc;
+    mContent = mWatchDocument->AddIDTargetObserver(mWatchID, Observe, this);
+    return;
+  }
+  
+  nsCOMPtr<nsIDOMDocument> domDoc = do_QueryInterface(doc);
+  NS_ASSERTION(domDoc, "Content doesn't reference a dom Document");
+
+  nsCOMPtr<nsIDOMElement> element;
+  rv = domDoc->GetElementById(ref, getter_AddRefs(element));
+  if (element) {
+    mContent = do_QueryInterface(element);
+  }
+}
+
+void
+nsReferencedElement::Traverse(nsCycleCollectionTraversalCallback* aCB)
+{
+  aCB->NoteXPCOMChild(mWatchDocument);
+  aCB->NoteXPCOMChild(mContent);
+}
+
+void
+nsReferencedElement::Unlink()
+{
+  if (mWatchDocument && mWatchID) {
+    mWatchDocument->RemoveIDTargetObserver(mWatchID, Observe, this);
+  }
+  mWatchDocument = nsnull;
+  mWatchID = nsnull;
+  mContent = nsnull;
+}
+
+PRBool
+nsReferencedElement::Observe(nsIContent* aOldContent,
+                             nsIContent* aNewContent, void* aData)
+{
+  nsReferencedElement* p = static_cast<nsReferencedElement*>(aData);
+  if (p->mPendingNotification) {
+    p->mPendingNotification->SetTo(aNewContent);
+  } else {
+    NS_ASSERTION(aOldContent == p->mContent, "Failed to track content!");
+    p->mPendingNotification = new Notification(p, aOldContent, aNewContent);
+    nsContentUtils::AddScriptRunner(p->mPendingNotification);
+  }
+  PRBool keepTracking = p->IsPersistent();
+  if (!keepTracking) {
+    p->mWatchDocument = nsnull;
+    p->mWatchID = nsnull;
+  }
+  return keepTracking;
+}
diff --git a/content/html/document/src/nsHTMLDocument.cpp b/content/html/document/src/nsHTMLDocument.cpp
--- a/content/html/document/src/nsHTMLDocument.cpp
+++ b/content/html/document/src/nsHTMLDocument.cpp
@@ -153,26 +153,16 @@ static PRBool gPlugDetector = PR_FALSE;
 #include "prtime.h"
 
 // Find/Search Includes
 const PRInt32 kForward  = 0;
 const PRInt32 kBackward = 1;
 
 //#define DEBUG_charset
 
-// Entries in an nsSmallVoidArray must not have the low bit set, so
-// can't use "1" for ID_NOT_IN_DOCUMENT.  "2" should be a perfectly
-// reasonable value, though -- no real nsIContent* will be equal to 2.
-#define ID_NOT_IN_DOCUMENT ((nsIContent *)2)
-#define NAME_NOT_VALID ((nsBaseContentList*)1)
-
-// Returns the name atom of aContent, if the content is a named item
-// and has a name atom.
-static nsIAtom* IsNamedItem(nsIContent* aContent);
-
 static NS_DEFINE_CID(kCParserCID, NS_PARSER_CID);
 
 PRUint32       nsHTMLDocument::gWyciwygSessionCnt = 0;
 
 // this function will return false if the command is not recognized
 // inCommandID will be converted as necessary for internal operations
 // inParam will be converted as necessary for internal operations
 // outParam will be Empty if no parameter is needed or if returning a boolean
@@ -224,190 +214,33 @@ NS_NewHTMLDocument(nsIDocument** aInstan
     NS_RELEASE(doc);
   }
 
   *aInstancePtrResult = doc;
 
   return rv;
 }
 
-class IdAndNameMapEntry : public PLDHashEntryHdr
-{
-public:
-  IdAndNameMapEntry(nsIAtom* aKey) :
-    mKey(aKey), mNameContentList(nsnull), mIdContentList()
-  {
-  }
-
-  ~IdAndNameMapEntry()
-  {
-    if (mNameContentList && mNameContentList != NAME_NOT_VALID) {
-      NS_RELEASE(mNameContentList);
-    }
-  }
-
-  nsIContent* GetIdContent() {
-    return static_cast<nsIContent*>(mIdContentList.SafeElementAt(0));
-  }
-
-  PRBool AddIdContent(nsIContent* aContent);
-
-  PRBool RemoveIdContent(nsIContent* aContent) {
-    // XXXbz should this ever Compact() I guess when all the content is gone
-    // we'll just get cleaned up in the natural order of things...
-    return mIdContentList.RemoveElement(aContent) &&
-      mIdContentList.Count() == 0;
-  }
-
-  void FlagIDNotInDocument() {
-    NS_ASSERTION(mIdContentList.Count() == 0,
-                 "Flagging ID not in document when we have content?");
-    // Note that if this fails that's OK; this is just an optimization
-    mIdContentList.AppendElement(ID_NOT_IN_DOCUMENT);
-  }
-
-  nsCOMPtr<nsIAtom> mKey;
-  nsBaseContentList *mNameContentList;
-  nsRefPtr<nsContentList> mDocAllList;
-private:
-  nsSmallVoidArray mIdContentList;
-};
-
-PRBool
-IdAndNameMapEntry::AddIdContent(nsIContent* aContent)
-{
-  NS_PRECONDITION(aContent, "Must have content");
-  NS_PRECONDITION(mIdContentList.IndexOf(nsnull) == -1,
-                  "Why is null in our list?");
-  NS_PRECONDITION(aContent != ID_NOT_IN_DOCUMENT,
-                  "Bogus content pointer");
-
-  if (GetIdContent() == ID_NOT_IN_DOCUMENT) {
-    NS_ASSERTION(mIdContentList.Count() == 1, "Bogus count");
-    return mIdContentList.ReplaceElementAt(aContent, 0);
-  }
-
-  // Common case
-  if (mIdContentList.Count() == 0) {
-    return mIdContentList.AppendElement(aContent);
-  }
-
-  // We seem to have multiple content nodes for the same id, or we're doing our
-  // top-down registration when the id table is going live.  Search for the
-  // right place to insert the content.
-  PRInt32 start = 0;
-  PRInt32 end = mIdContentList.Count();
-  do {
-    NS_ASSERTION(start < end, "Bogus start/end");
-    
-    PRInt32 cur = (start + end) / 2;
-    NS_ASSERTION(cur >= start && cur < end, "What happened here?");
-
-    nsIContent* curContent = static_cast<nsIContent*>(mIdContentList[cur]);
-    if (curContent == aContent) {
-      // Already in the list, so already in the right spot.  Get out of here.
-      return PR_TRUE;
-    }
-
-    if (nsContentUtils::PositionIsBefore(aContent, curContent)) {
-      end = cur;
-    } else {
-      start = cur + 1;
-    }
-  } while (start != end);
-  
-  return mIdContentList.InsertElementAt(aContent, start);
-}
-
-
-PR_STATIC_CALLBACK(PLDHashNumber)
-IdAndNameHashHashKey(PLDHashTable *table, const void *key)
-{
-  // Our key is an nsIAtom*, so just shift it and use that as the hash.
-  return NS_PTR_TO_INT32(key) >> 2;
-}
-
-PR_STATIC_CALLBACK(PRBool)
-IdAndNameHashMatchEntry(PLDHashTable *table, const PLDHashEntryHdr *entry,
-                        const void *key)
-{
-  const IdAndNameMapEntry *e =
-    static_cast<const IdAndNameMapEntry *>(entry);
-  const nsIAtom *atom = static_cast<const nsIAtom *>(key);
-
-  return atom == e->mKey;
-}
-
-PR_STATIC_CALLBACK(void)
-IdAndNameHashClearEntry(PLDHashTable *table, PLDHashEntryHdr *entry)
-{
-  IdAndNameMapEntry *e = static_cast<IdAndNameMapEntry *>(entry);
-
-  // An entry is being cleared, let the entry do its own cleanup.
-  e->~IdAndNameMapEntry();
-}
-
-PR_STATIC_CALLBACK(PRBool)
-IdAndNameHashInitEntry(PLDHashTable *table, PLDHashEntryHdr *entry,
-                       const void *key)
-{
-  nsIAtom *atom = const_cast<nsIAtom *>
-                            (static_cast<const nsIAtom*>(key));
-
-  // Inititlize the entry with placement new
-  new (entry) IdAndNameMapEntry(atom);
-  return PR_TRUE;
-}
-
   // NOTE! nsDocument::operator new() zeroes out all members, so don't
   // bother initializing members to 0.
 
 nsHTMLDocument::nsHTMLDocument()
-  : nsDocument("text/html"),
-    mDefaultNamespaceID(kNameSpaceID_None)
-{
-
+  : nsDocument("text/html")
+{
   // NOTE! nsDocument::operator new() zeroes out all members, so don't
   // bother initializing members to 0.
 
+  mIsRegularHTML = PR_TRUE;
   mDefaultElementType = kNameSpaceID_XHTML;
   mCompatMode = eCompatibility_NavQuirks;
 }
 
-nsHTMLDocument::~nsHTMLDocument()
-{
-  if (mIdAndNameHashTable.ops) {
-    PL_DHashTableFinish(&mIdAndNameHashTable);
-  }
-}
-
 NS_IMPL_CYCLE_COLLECTION_CLASS(nsHTMLDocument)
 
-PR_STATIC_CALLBACK(PLDHashOperator)
-IdAndNameMapEntryTraverse(PLDHashTable *table, PLDHashEntryHdr *hdr,
-                          PRUint32 number, void *arg)
-{
-  nsCycleCollectionTraversalCallback *cb =
-    static_cast<nsCycleCollectionTraversalCallback*>(arg);
-  IdAndNameMapEntry *entry = static_cast<IdAndNameMapEntry*>(hdr);
-
-  if (entry->mNameContentList != NAME_NOT_VALID)
-    cb->NoteXPCOMChild(entry->mNameContentList);
-
-  cb->NoteXPCOMChild(static_cast<nsIDOMNodeList*>(entry->mDocAllList));
-
-  return PL_DHASH_NEXT;
-}
-
 NS_IMPL_CYCLE_COLLECTION_TRAVERSE_BEGIN_INHERITED(nsHTMLDocument, nsDocument)
-  if (tmp->mIdAndNameHashTable.ops) {
-    PL_DHashTableEnumerate(&tmp->mIdAndNameHashTable,
-                           IdAndNameMapEntryTraverse,
-                           &cb);
-  }
   NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMARRAY(mImageMaps)
   NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMPTR(mImages)
   NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMPTR(mApplets)
   NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMPTR(mEmbeds)
   NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMPTR(mLinks)
   NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMPTR(mAnchors)
   NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMPTR(mFragmentParser)
   NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMPTR_AMBIGUOUS(mForms, nsIDOMNodeList)
@@ -437,38 +270,17 @@ nsHTMLDocument::Init()
   NS_ENSURE_SUCCESS(rv, rv);
 
   // Now reset the case-sensitivity of the CSSLoader, since we default
   // to being HTML, not XHTML.  Also, reset the compatibility mode to
   // match our compat mode.
   CSSLoader()->SetCaseSensitive(IsXHTML());
   CSSLoader()->SetCompatibilityMode(mCompatMode);
 
-  static PLDHashTableOps hash_table_ops =
-  {
-    PL_DHashAllocTable,
-    PL_DHashFreeTable,
-    IdAndNameHashHashKey,
-    IdAndNameHashMatchEntry,
-    PL_DHashMoveEntryStub,
-    IdAndNameHashClearEntry,
-    PL_DHashFinalizeStub,
-    IdAndNameHashInitEntry
-  };
-
-  PRBool ok = PL_DHashTableInit(&mIdAndNameHashTable, &hash_table_ops, nsnull,
-                                sizeof(IdAndNameMapEntry), 16);
-  if (!ok) {
-    mIdAndNameHashTable.ops = nsnull;
-
-    return NS_ERROR_OUT_OF_MEMORY;
-  }
-
-  PrePopulateHashTables();
-
+  PrePopulateIdentifierMap();
   return NS_OK;
 }
 
 
 void
 nsHTMLDocument::Reset(nsIChannel* aChannel, nsILoadGroup* aLoadGroup)
 {
   nsDocument::Reset(aChannel, aLoadGroup);
@@ -481,18 +293,17 @@ void
 void
 nsHTMLDocument::ResetToURI(nsIURI *aURI, nsILoadGroup *aLoadGroup,
                            nsIPrincipal* aPrincipal)
 {
   mLoadFlags = nsIRequest::LOAD_NORMAL;
 
   nsDocument::ResetToURI(aURI, aLoadGroup, aPrincipal);
 
-  InvalidateHashTables();
-  PrePopulateHashTables();
+  PrePopulateIdentifierMap();
 
   mImages = nsnull;
   mApplets = nsnull;
   mEmbeds = nsnull;
   mLinks = nsnull;
   mAnchors = nsnull;
 
   mImageMaps.Clear();
@@ -841,23 +652,23 @@ nsHTMLDocument::StartDocumentLoad(const 
 {
   nsCAutoString contentType;
   aChannel->GetContentType(contentType);
 
   if (contentType.Equals("application/xhtml+xml") &&
       (!aCommand || nsCRT::strcmp(aCommand, "view-source") != 0)) {
     // We're parsing XHTML as XML, remember that.
 
-    mDefaultNamespaceID = kNameSpaceID_XHTML;
+    mIsRegularHTML = PR_FALSE;
     mCompatMode = eCompatibility_FullStandards;
   }
 #ifdef DEBUG
   else {
-    NS_ASSERTION(mDefaultNamespaceID == kNameSpaceID_None,
-                 "Hey, someone forgot to reset mDefaultNamespaceID!!!");
+    NS_ASSERTION(mIsRegularHTML,
+                 "Hey, someone forgot to reset mIsRegularHTML!!!");
   }
 #endif
 
   CSSLoader()->SetCaseSensitive(IsXHTML());
   CSSLoader()->SetCompatibilityMode(mCompatMode);
   
   PRBool needsParser = PR_TRUE;
   if (aCommand)
@@ -1346,111 +1157,16 @@ nsHTMLDocument::SetCompatibilityMode(nsC
   if (shell) {
     nsPresContext *pc = shell->GetPresContext();
     if (pc) {
       pc->CompatibilityModeChanged();
     }
   }
 }
 
-void
-nsHTMLDocument::ContentAppended(nsIDocument* aDocument,
-                                nsIContent* aContainer,
-                                PRInt32 aNewIndexInContainer)
-{
-  NS_ASSERTION(aDocument == this, "unexpected doc");
-
-  PRUint32 count = aContainer->GetChildCount();
-  for (PRUint32 i = aNewIndexInContainer; i < count; ++i) {
-    RegisterNamedItems(aContainer->GetChildAt(i));
-  }
-}
-
-void
-nsHTMLDocument::ContentInserted(nsIDocument* aDocument,
-                                nsIContent* aContainer,
-                                nsIContent* aContent,
-                                PRInt32 aIndexInContainer)
-{
-  NS_ASSERTION(aDocument == this, "unexpected doc");
-
-  NS_ABORT_IF_FALSE(aContent, "Null content!");
-
-  RegisterNamedItems(aContent);
-}
-
-void
-nsHTMLDocument::ContentRemoved(nsIDocument* aDocument,
-                               nsIContent* aContainer,
-                               nsIContent* aChild,
-                               PRInt32 aIndexInContainer)
-{
-  NS_ASSERTION(aDocument == this, "unexpected doc");
-
-  NS_ABORT_IF_FALSE(aChild, "Null content!");
-
-  UnregisterNamedItems(aChild);
-}
-
-void
-nsHTMLDocument::AttributeWillChange(nsIContent* aContent, PRInt32 aNameSpaceID,
-                                    nsIAtom* aAttribute)
-{
-  NS_ABORT_IF_FALSE(aContent, "Null content!");
-  NS_PRECONDITION(aAttribute, "Must have an attribute that's changing!");
-
-  if (!IsXHTML() && aAttribute == nsGkAtoms::name &&
-      aNameSpaceID == kNameSpaceID_None) {
-    nsIAtom* name = IsNamedItem(aContent);
-    if (name) {
-      nsresult rv = RemoveFromNameTable(name, aContent);
-
-      if (NS_FAILED(rv)) {
-        return;
-      }
-    }
-  } else if (aAttribute == aContent->GetIDAttributeName() &&
-             aNameSpaceID == kNameSpaceID_None) {
-    nsresult rv = RemoveFromIdTable(aContent);
-
-    if (NS_FAILED(rv)) {
-      return;
-    }
-  }
-
-  nsDocument::AttributeWillChange(aContent, aNameSpaceID, aAttribute);
-}
-
-void
-nsHTMLDocument::AttributeChanged(nsIDocument* aDocument,
-                                 nsIContent* aContent, PRInt32 aNameSpaceID,
-                                 nsIAtom* aAttribute, PRInt32 aModType,
-                                 PRUint32 aStateMask)
-{
-  NS_ASSERTION(aDocument == this, "unexpected doc");
-
-  NS_ABORT_IF_FALSE(aContent, "Null content!");
-  NS_PRECONDITION(aAttribute, "Must have an attribute that's changing!");
-
-  if (!IsXHTML() && aAttribute == nsGkAtoms::name &&
-      aNameSpaceID == kNameSpaceID_None) {
-
-    nsIAtom* name = IsNamedItem(aContent);
-    if (name) {
-      UpdateNameTableEntry(name, aContent);
-    }
-  } else if (aAttribute == aContent->GetIDAttributeName() &&
-             aNameSpaceID == kNameSpaceID_None) {
-    nsIAtom* id = aContent->GetID();
-    if (id) {
-      UpdateIdTableEntry(id, aContent);
-    }
-  }
-}
-
 PRBool
 nsHTMLDocument::IsCaseSensitive()
 {
   return IsXHTML();
 }
 
 //
 // nsIDOMDocument interface implementation
@@ -1858,34 +1574,34 @@ nsHTMLDocument::SetBody(nsIDOMHTMLElemen
 
   return rootElem->AppendChild(aBody, getter_AddRefs(tmp));
 }
 
 NS_IMETHODIMP
 nsHTMLDocument::GetImages(nsIDOMHTMLCollection** aImages)
 {
   if (!mImages) {
-    mImages = new nsContentList(this, nsGkAtoms::img, mDefaultNamespaceID);
+    mImages = new nsContentList(this, nsGkAtoms::img, GetDefaultNamespaceID());
     if (!mImages) {
       return NS_ERROR_OUT_OF_MEMORY;
     }
   }
 
   *aImages = mImages;
   NS_ADDREF(*aImages);
 
   return NS_OK;
 }
 
 NS_IMETHODIMP
 nsHTMLDocument::GetApplets(nsIDOMHTMLCollection** aApplets)
 {
   if (!mApplets) {
     mApplets = new nsContentList(this, nsGkAtoms::applet,
-                                 mDefaultNamespaceID);
+                                 GetDefaultNamespaceID());
     if (!mApplets) {
       return NS_ERROR_OUT_OF_MEMORY;
     }
   }
 
   *aApplets = mApplets;
   NS_ADDREF(*aApplets);
 
@@ -2561,121 +2277,16 @@ nsHTMLDocument::Write()
 
 NS_IMETHODIMP
 nsHTMLDocument::Writeln()
 {
   return ScriptWriteCommon(PR_TRUE);
 }
 
 NS_IMETHODIMP
-nsHTMLDocument::GetElementById(const nsAString& aElementId,
-                               nsIDOMElement** aReturn)
-{
-  NS_ENSURE_ARG_POINTER(aReturn);
-  *aReturn = nsnull;
-
-  nsCOMPtr<nsIAtom> idAtom(do_GetAtom(aElementId));
-  NS_ENSURE_TRUE(idAtom, NS_ERROR_OUT_OF_MEMORY);
-
-  // We don't have to flush before we do the initial hashtable lookup, since if
-  // the id is already in the hashtable it couldn't have been removed without
-  // us being notified (all removals notify immediately, as far as I can tell).
-  // So do the lookup first.
-  IdAndNameMapEntry *entry =
-    static_cast<IdAndNameMapEntry *>
-               (PL_DHashTableOperate(&mIdAndNameHashTable, idAtom,
-                                        PL_DHASH_ADD));
-  NS_ENSURE_TRUE(entry, NS_ERROR_OUT_OF_MEMORY);
-
-  nsIContent *e = entry->GetIdContent();
-
-  if (!e || e == ID_NOT_IN_DOCUMENT) {
-    // Now we have to flush.  It could be that we have a cached "not in
-    // document" or know nothing about this ID yet but more content has been
-    // added to the document since.  Note that we have to flush notifications,
-    // so that the entry will get updated properly.
-    
-    // Make sure to stash away the current generation so we can check whether
-    // the table changes when we flush.
-    PRUint32 generation = mIdAndNameHashTable.generation;
-  
-    FlushPendingNotifications(Flush_ContentAndNotify);
-
-    if (generation != mIdAndNameHashTable.generation) {
-      // Table changed, so the entry pointer is no longer valid; look up the
-      // entry again, adding if necessary (the adding may be necessary in case
-      // the flush actually deleted entries).
-      entry =
-        static_cast<IdAndNameMapEntry *>
-                   (PL_DHashTableOperate(&mIdAndNameHashTable, idAtom,
-                                            PL_DHASH_ADD));
-      NS_ENSURE_TRUE(entry, NS_ERROR_OUT_OF_MEMORY);
-    }
-
-    // We could now have a new entry, or the entry could have been
-    // updated, so update e to point to the current entry's
-    // mIdContent.
-    e = entry->GetIdContent();
-  }
-
-  if (e == ID_NOT_IN_DOCUMENT) {
-    // We've looked for this id before and we didn't find it, so it
-    // won't be in the document now either (since the
-    // mIdAndNameHashTable is live for entries in the table)
-
-    return NS_OK;
-  }
-
-  if (!e) {
-    // If IdTableIsLive(), no need to look for the element in the document,
-    // since we're fully maintaining our table's state as the DOM mutates.
-    nsIContent* root = GetRootContent();
-    if (!IdTableIsLive()) {
-      if (IdTableShouldBecomeLive()) {
-        // Just make sure our table is up to date and call this method again
-        // to look up in the hashtable.
-        if (root) {
-          RegisterNamedItems(root);
-        }
-        return GetElementById(aElementId, aReturn);
-      }
-
-      if (root && CheckGetElementByIdArg(aElementId)) {
-        e = nsContentUtils::MatchElementId(root, idAtom);
-      }
-    }
-
-    if (!e) {
-#ifdef DEBUG
-      // No reason to call MatchElementId if !IdTableIsLive, since
-      // we'd have done just that already
-      if (IdTableIsLive() && root && !aElementId.IsEmpty()) {
-        nsIContent* eDebug =
-          nsContentUtils::MatchElementId(root, idAtom);
-        NS_ASSERTION(!eDebug,
-                     "We got null for |e| but MatchElementId found something?");
-      }
-#endif
-      // There is no element with the given id in the document, cache
-      // the fact that it's not in the document
-      entry->FlagIDNotInDocument();
-
-      return NS_OK;
-    }
-
-    // We found an element with a matching id, store that in the hash
-    if (NS_UNLIKELY(!entry->AddIdContent(e))) {
-      return NS_ERROR_OUT_OF_MEMORY;
-    }
-  }
-
-  return CallQueryInterface(e, aReturn);
-}
-
-NS_IMETHODIMP
 nsHTMLDocument::ImportNode(nsIDOMNode* aImportedNode,
                            PRBool aDeep,
                            nsIDOMNode** aReturn)
 {
   return nsDocument::ImportNode(aImportedNode, aDeep, aReturn);
 }
 
 NS_IMETHODIMP
@@ -2693,16 +2304,23 @@ nsHTMLDocument::GetElementsByTagNameNS(c
 {
   nsAutoString tmp(aLocalName);
 
   if (!IsXHTML()) {
     ToLowerCase(tmp); // HTML elements are lower case internally.
   }
 
   return nsDocument::GetElementsByTagNameNS(aNamespaceURI, tmp, aReturn);
+}
+
+NS_IMETHODIMP
+nsHTMLDocument::GetElementById(const nsAString& aElementId,
+                               nsIDOMElement** aReturn)
+{
+  return nsDocument::GetElementById(aElementId, aReturn);
 }
 
 PRBool
 nsHTMLDocument::MatchNameAttribute(nsIContent* aContent, PRInt32 aNamespaceID,
                                    nsIAtom* aAtom, void* aData)
 {
   NS_PRECONDITION(aContent, "Must have content node to work with!");
   nsString* elementName = static_cast<nsString*>(aData);
@@ -2993,17 +2611,17 @@ nsHTMLDocument::SetFgColor(const nsAStri
   return NS_OK;
 }
 
 
 NS_IMETHODIMP
 nsHTMLDocument::GetEmbeds(nsIDOMHTMLCollection** aEmbeds)
 {
   if (!mEmbeds) {
-    mEmbeds = new nsContentList(this, nsGkAtoms::embed, mDefaultNamespaceID);
+    mEmbeds = new nsContentList(this, nsGkAtoms::embed, GetDefaultNamespaceID());
     if (!mEmbeds) {
       return NS_ERROR_OUT_OF_MEMORY;
     }
   }
 
   *aEmbeds = mEmbeds;
   NS_ADDREF(*aEmbeds);
 
@@ -3097,397 +2715,111 @@ NS_IMETHODIMP
 NS_IMETHODIMP
 nsHTMLDocument::GetPlugins(nsIDOMHTMLCollection** aPlugins)
 {
   *aPlugins = nsnull;
 
   return GetEmbeds(aPlugins);
 }
 
-PR_STATIC_CALLBACK(PLDHashOperator)
-IdAndNameMapEntryRemoveCallback(PLDHashTable *table, PLDHashEntryHdr *hdr,
-                                PRUint32 number, void *arg)
-{
-  return PL_DHASH_REMOVE;
-}
-
-
-void
-nsHTMLDocument::InvalidateHashTables()
-{
-  PL_DHashTableEnumerate(&mIdAndNameHashTable, IdAndNameMapEntryRemoveCallback,
-                         nsnull);
-}
-
-static nsresult
-ReserveNameInHash(const char* aName, PLDHashTable *aHash)
-{
-  nsCOMPtr<nsIAtom> atom(do_GetAtom(aName));
-  NS_ENSURE_TRUE(atom, NS_ERROR_OUT_OF_MEMORY);
-  
-  IdAndNameMapEntry *entry =
-    static_cast<IdAndNameMapEntry *>
-               (PL_DHashTableOperate(aHash, atom, PL_DHASH_ADD));
-
-  NS_ENSURE_TRUE(entry, NS_ERROR_OUT_OF_MEMORY);
-
-  entry->mNameContentList = NAME_NOT_VALID;
-
-  return NS_OK;
-}
-
-// Pre-fill the name hash with names that are likely to be resolved in
-// this document to avoid walking the tree looking for elements with
-// these names.
-
-nsresult
-nsHTMLDocument::PrePopulateHashTables()
-{
-  nsresult rv = NS_OK;
-
-  rv = ReserveNameInHash("write", &mIdAndNameHashTable);
-  NS_ENSURE_SUCCESS(rv, rv);
-
-  rv = ReserveNameInHash("writeln", &mIdAndNameHashTable);
-  NS_ENSURE_SUCCESS(rv, rv);
-
-  rv = ReserveNameInHash("open", &mIdAndNameHashTable);
-  NS_ENSURE_SUCCESS(rv, rv);
-
-  rv = ReserveNameInHash("close", &mIdAndNameHashTable);
-  NS_ENSURE_SUCCESS(rv, rv);
-
-  rv = ReserveNameInHash("forms", &mIdAndNameHashTable);
-  NS_ENSURE_SUCCESS(rv, rv);
-
-  rv = ReserveNameInHash("elements", &mIdAndNameHashTable);
-  NS_ENSURE_SUCCESS(rv, rv);
-
-  rv = ReserveNameInHash("characterSet", &mIdAndNameHashTable);
-  NS_ENSURE_SUCCESS(rv, rv);
-
-  rv = ReserveNameInHash("nodeType", &mIdAndNameHashTable);
-  NS_ENSURE_SUCCESS(rv, rv);
-
-  rv = ReserveNameInHash("parentNode", &mIdAndNameHashTable);
-  NS_ENSURE_SUCCESS(rv, rv);
-
-  rv = ReserveNameInHash("cookie", &mIdAndNameHashTable);
-  NS_ENSURE_SUCCESS(rv, rv);
-
-  return rv;
-}
-
-static nsIAtom*
-IsNamedItem(nsIContent* aContent)
-{
-  // Only the content types reflected in Level 0 with a NAME
-  // attribute are registered. Images, layers and forms always get
-  // reflected up to the document. Applets and embeds only go
-  // to the closest container (which could be a form).
-  nsGenericHTMLElement* elm = nsGenericHTMLElement::FromContent(aContent);
-  if (!elm) {
-    return nsnull;
-  }
-
-  nsIAtom* tag = elm->Tag();
-  if (tag != nsGkAtoms::img    &&
-      tag != nsGkAtoms::form   &&
-      tag != nsGkAtoms::applet &&
-      tag != nsGkAtoms::embed  &&
-      tag != nsGkAtoms::object) {
-    return nsnull;
-  }
-
-  const nsAttrValue* val = elm->GetParsedAttr(nsGkAtoms::name);
-  if (val && val->Type() == nsAttrValue::eAtom) {
-    return val->GetAtomValue();
-  }
-
-  return nsnull;
-}
-
-nsresult
-nsHTMLDocument::UpdateNameTableEntry(nsIAtom* aName,
-                                     nsIContent *aContent)
-{
-  NS_ASSERTION(!IsXHTML(), 
-  "nsHTMLDocument::UpdateNameTableEntry Don't call me on an XHTML document!!!");
-
-  IdAndNameMapEntry *entry =
-    static_cast<IdAndNameMapEntry *>
-               (PL_DHashTableOperate(&mIdAndNameHashTable, aName,
-                                        PL_DHASH_LOOKUP));
-
-  if (PL_DHASH_ENTRY_IS_FREE(entry)) {
-    return NS_OK;
-  }
-
-  nsBaseContentList *list = entry->mNameContentList;
-
-  if (!list || list == NAME_NOT_VALID) {
-    return NS_OK;
-  }
-
-  // NOTE: this indexof is absolutely needed, since we don't flush
-  // content notifications when we do document.foo resolution.  So
-  // aContent may be in our list already and just now getting notified
-  // for!
-  if (list->IndexOf(aContent, PR_FALSE) < 0) {
-    list->AppendElement(aContent);
-  }
-
-  return NS_OK;
-}
-
-nsresult
-nsHTMLDocument::UpdateIdTableEntry(nsIAtom* aId, nsIContent *aContent)
-{
-  PRBool liveTable = IdTableIsLive();
-  PLDHashOperator op = liveTable ? PL_DHASH_ADD : PL_DHASH_LOOKUP;
-  IdAndNameMapEntry *entry =
-    static_cast<IdAndNameMapEntry *>
-               (PL_DHashTableOperate(&mIdAndNameHashTable, aId,
-                                        op));
-
-  NS_ENSURE_TRUE(entry, NS_ERROR_OUT_OF_MEMORY);
-
-  if (PL_DHASH_ENTRY_IS_BUSY(entry) &&
-      NS_UNLIKELY(!entry->AddIdContent(aContent))) {
-    // failed to update...
-    return NS_ERROR_OUT_OF_MEMORY;
-  }
-
-  return NS_OK;
-}
-
-nsresult
-nsHTMLDocument::RemoveFromNameTable(nsIAtom* aName, nsIContent *aContent)
-{
-  NS_ASSERTION(!IsXHTML(), 
-  "nsHTMLDocument::RemoveFromNameTable Don't call me on an XHTML document!!!");
-
-  IdAndNameMapEntry *entry =
-    static_cast<IdAndNameMapEntry *>
-               (PL_DHashTableOperate(&mIdAndNameHashTable, aName,
-                                        PL_DHASH_LOOKUP));
-
-  if (PL_DHASH_ENTRY_IS_BUSY(entry) && entry->mNameContentList &&
-      entry->mNameContentList != NAME_NOT_VALID) {
-    entry->mNameContentList->RemoveElement(aContent);
-  }
-
-  return NS_OK;
-}
-
-nsresult
-nsHTMLDocument::RemoveFromIdTable(nsIContent *aContent)
-{
-  nsIAtom* id = aContent->GetID();
-
-  if (!id) {
-    return NS_OK;
-  }
-
-  IdAndNameMapEntry *entry =
-    static_cast<IdAndNameMapEntry *>
-               (PL_DHashTableOperate(&mIdAndNameHashTable, id,
-                                        PL_DHASH_LOOKUP));
-
-  if (PL_DHASH_ENTRY_IS_FREE(entry)) {
-    return NS_OK;
-  }
-
-  if (entry->RemoveIdContent(aContent)) {
-    PL_DHashTableRawRemove(&mIdAndNameHashTable, entry);
-  }
-
-  return NS_OK;
-}
-
-nsresult
-nsHTMLDocument::UnregisterNamedItems(nsIContent *aContent)
-{
-  if (aContent->IsNodeOfType(nsINode::eTEXT)) {
-    // Text nodes are not named items nor can they have children.
-    return NS_OK;
-  }
-
-  nsresult rv = NS_OK;
-
-  if (!IsXHTML()) {
-    nsIAtom* name = IsNamedItem(aContent);
-    if (name) {
-      rv = RemoveFromNameTable(name, aContent);
-
-      if (NS_FAILED(rv)) {
-        return rv;
-      }
-    }
-  }
-
-  rv = RemoveFromIdTable(aContent);
-
-  if (NS_FAILED(rv)) {
-    return rv;
-  }
-
-  PRUint32 i, count = aContent->GetChildCount();
-
-  for (i = 0; i < count; ++i) {
-    UnregisterNamedItems(aContent->GetChildAt(i));
-  }
-
-  return NS_OK;
-}
-
-nsresult
-nsHTMLDocument::RegisterNamedItems(nsIContent *aContent)
-{
-  if (aContent->IsNodeOfType(nsINode::eTEXT)) {
-    // Text nodes are not named items nor can they have children.
-    return NS_OK;
-  }
-
-  if (!IsXHTML()) {
-    nsIAtom* name = IsNamedItem(aContent);
-    if (name) {
-      UpdateNameTableEntry(name, aContent);
-    }
-  }
-
-  nsIAtom* id = aContent->GetID();
-  if (id) {
-    nsresult rv = UpdateIdTableEntry(id, aContent);
-      
-    if (NS_FAILED(rv)) {
-      return rv;
-    }
-  }
-
-  PRUint32 i, count = aContent->GetChildCount();
-
-  for (i = 0; i < count; ++i) {
-    RegisterNamedItems(aContent->GetChildAt(i));
-  }
-
-  return NS_OK;
-}
-
 static void
 FindNamedItems(nsIAtom* aName, nsIContent *aContent,
-               IdAndNameMapEntry& aEntry, PRBool aIsXHTML)
-{
-  NS_ASSERTION(aEntry.mNameContentList,
+               nsIdentifierMapEntry* aEntry)
+{
+  NS_ASSERTION(aEntry->HasNameContentList(),
                "Entry w/o content list passed to FindNamedItems()!");
-  NS_ASSERTION(aEntry.mNameContentList != NAME_NOT_VALID,
+  NS_ASSERTION(!aEntry->IsInvalidName(),
                "Entry that should never have a list passed to FindNamedItems()!");
 
   if (aContent->IsNodeOfType(nsINode::eTEXT)) {
     // Text nodes are not named items nor can they have children.
     return;
   }
 
-  nsAutoString value;
-
-  if (!aIsXHTML && aName == IsNamedItem(aContent)) {
-    aEntry.mNameContentList->AppendElement(aContent);
-  }
-
-  if (!aEntry.GetIdContent() &&
+  if (aName == nsContentUtils::IsNamedItem(aContent)) {
+    aEntry->AddNameContent(aContent);
+  }
+
+  if (!aEntry->GetIdContent() &&
       // Maybe this node has the right id?
       aName == aContent->GetID()) {
-    aEntry.AddIdContent(aContent);
+    aEntry->AddIdContent(aContent);
   }
 
   PRUint32 i, count = aContent->GetChildCount();
-
   for (i = 0; i < count; ++i) {
-    FindNamedItems(aName, aContent->GetChildAt(i), aEntry, aIsXHTML);
+    FindNamedItems(aName, aContent->GetChildAt(i), aEntry);
   }
 }
 
 nsresult
 nsHTMLDocument::ResolveName(const nsAString& aName,
                             nsIDOMHTMLFormElement *aForm,
                             nsISupports **aResult)
 {
   *aResult = nsnull;
 
-  if (IsXHTML()) {
-    // We don't dynamically resolve names on XHTML documents.
-
+  if (!mIsRegularHTML) {
+    // We don't dynamically resolve names on non-HTML documents.
     return NS_OK;
   }
 
   nsCOMPtr<nsIAtom> name(do_GetAtom(aName));
 
   // We have built a table and cache the named items. The table will
   // be updated as content is added and removed.
-
-  IdAndNameMapEntry *entry =
-    static_cast<IdAndNameMapEntry *>
-               (PL_DHashTableOperate(&mIdAndNameHashTable, name,
-                                     PL_DHASH_ADD));
+  nsIdentifierMapEntry *entry = mIdentifierMap.PutEntry(name);
   NS_ENSURE_TRUE(entry, NS_ERROR_OUT_OF_MEMORY);
 
-  if (entry->mNameContentList == NAME_NOT_VALID) {
+  if (entry->IsInvalidName()) {
     // There won't be any named items by this name -- it's reserved
     return NS_OK;
   }
 
   // Now we know we _might_ have items.  Before looking at
   // entry->mNameContentList, make sure to flush out content (see
   // bug 69826).
   // This is a perf killer while the document is loading!
 
   // Make sure to stash away the current generation so we can check whether the
   // table changes when we flush.
-  PRUint32 generation = mIdAndNameHashTable.generation;
+  PRUint32 generation = mIdentifierMap.GetGeneration();
   
   // If we already have an entry->mNameContentList, we need to flush out
   // notifications too, so that it will get updated properly.
-  FlushPendingNotifications(entry->mNameContentList ?
+  FlushPendingNotifications(entry->HasNameContentList() ?
                             Flush_ContentAndNotify : Flush_Content);
 
-  if (generation != mIdAndNameHashTable.generation) {
+  if (generation != mIdentifierMap.GetGeneration()) {
     // Table changed, so the entry pointer is no longer valid; look up the
     // entry again, adding if necessary (the adding may be necessary in case
     // the flush actually deleted entries).
-    entry =
-      static_cast<IdAndNameMapEntry *>
-                 (PL_DHashTableOperate(&mIdAndNameHashTable, name,
-                                       PL_DHASH_ADD));
+    entry = mIdentifierMap.PutEntry(name);
     NS_ENSURE_TRUE(entry, NS_ERROR_OUT_OF_MEMORY);
   }
-    
-
-  nsBaseContentList *list = entry->mNameContentList;
-
-  if (!list) {
+
+  if (!entry->HasNameContentList()) {
 #ifdef DEBUG_jst
     {
       printf ("nsHTMLDocument name cache miss for name '%s'\n",
               NS_ConvertUTF16toUTF8(aName).get());
     }
 #endif
 
-    list = new nsBaseContentList();
-    NS_ENSURE_TRUE(list, NS_ERROR_OUT_OF_MEMORY);
-
-    entry->mNameContentList = list;
-    NS_ADDREF(entry->mNameContentList);
+    nsresult rv = entry->CreateNameContentList();
+    if (NS_FAILED(rv))
+      return rv;
 
     nsIContent* root = GetRootContent();
     if (root && !aName.IsEmpty()) {
-      // We'll never get here if !IsXHTML(), so we can just pass
-      // PR_FALSE to FindNamedItems().
-      FindNamedItems(name, root, *entry, PR_FALSE);
-    }
-  }
+      FindNamedItems(name, root, entry);
+    }
+  }
+
+  nsBaseContentList *list = entry->GetNameContentList();
 
   PRUint32 length;
   list->GetLength(&length);
 
   if (length > 0) {
     if (length == 1) {
       // Only one element in the list, return the element instead of
       // returning the list
@@ -3547,63 +2879,89 @@ nsHTMLDocument::ResolveName(const nsAStr
 
   // No named items were found, see if there's one registerd by id for
   // aName. If we get this far, FindNamedItems() will have been called
   // for aName, so we're guaranteed that if there is an element with
   // the id aName, it'll be entry's IdContent.
 
   nsIContent *e = entry->GetIdContent();
 
-  if (e && e != ID_NOT_IN_DOCUMENT && e->IsNodeOfType(nsINode::eHTML)) {
+  if (e && e->IsNodeOfType(nsINode::eHTML)) {
     nsIAtom *tag = e->Tag();
 
     if ((tag == nsGkAtoms::embed  ||
          tag == nsGkAtoms::img    ||
          tag == nsGkAtoms::object ||
          tag == nsGkAtoms::applet) &&
         (!aForm || nsContentUtils::BelongsInForm(aForm, e))) {
       NS_ADDREF(*aResult = e);
     }
   }
 
   return NS_OK;
 }
 
+// Pre-fill the name hash with names that are likely to be resolved in
+// this document to avoid walking the tree looking for elements with
+// these names.
+
+nsresult
+nsHTMLDocument::PrePopulateIdentifierMap()
+{
+  static const char names[][13] = {
+    "write", "writeln", "open", "close", "forms", "elements",
+    "characterSet", "nodeType", "parentNode", "cookie"
+  };
+
+  for (PRUint32 i = 0; i < NS_ARRAY_LENGTH(names); ++i) {
+    nsCOMPtr<nsIAtom> atom(do_GetAtom(names[i]));
+    NS_ENSURE_TRUE(atom, NS_ERROR_OUT_OF_MEMORY);
+  
+    nsIdentifierMapEntry* entry = mIdentifierMap.PutEntry(atom);
+    NS_ENSURE_TRUE(entry, NS_ERROR_OUT_OF_MEMORY);
+
+    entry->SetInvalidName();
+  }
+
+  return NS_OK;
+}
+
 //----------------------------
 
 /* virtual */ nsIContent*
 nsHTMLDocument::GetBodyContentExternal()
 {
   return GetBodyContent();
 }
 
 nsIContent*
+nsHTMLDocument::GetHtmlContent()
+{
+  nsIContent* rootContent = GetRootContent();
+  if (rootContent && rootContent->Tag() == nsGkAtoms::html &&
+      rootContent->IsNodeOfType(nsINode::eHTML))
+    return rootContent;
+  return nsnull;
+}
+
+nsIContent*
 nsHTMLDocument::GetBodyContent()
 {
-  // Loop backwards because any non-elements, such as doctypes and PIs
-  // are likely to appear before the root element.
-  PRUint32 i;
-  for (i = mChildren.ChildCount(); i > 0; --i) {
-    nsIContent* html = mChildren.ChildAt(i - 1);
-    if (html->Tag() == nsGkAtoms::html &&
-        html->IsNodeOfType(nsINode::eHTML)) {
-
-      // Look for body inside html
-      for (i = html->GetChildCount(); i > 0; --i) {
-        nsIContent* body = html->GetChildAt(i - 1);
-        if (body->Tag() == nsGkAtoms::body &&
-            body->IsNodeOfType(nsINode::eHTML)) {
-          return body;
-        }
-      }
-
-      break;
-    }
-  }
-
+  nsIContent* html = GetHtmlContent();
+  if (!html)
+    return nsnull;
+
+  // Look for body inside html. This needs to run forwards to find
+  // the first body element.
+  for (PRUint32 i = 0; i < html->GetChildCount(); ++i) {
+    nsIContent* body = html->GetChildAt(i);
+    if (body->Tag() == nsGkAtoms::body &&
+        body->IsNodeOfType(nsINode::eHTML))
+      return body;
+  }
   return nsnull;
 }
 
 // forms related stuff
 
 NS_IMETHODIMP
 nsHTMLDocument::GetForms(nsIDOMHTMLCollection** aForms)
 {
@@ -3614,17 +2972,17 @@ nsHTMLDocument::GetForms(nsIDOMHTMLColle
   NS_ADDREF(*aForms = forms);
   return NS_OK;
 }
 
 nsContentList*
 nsHTMLDocument::GetForms()
 {
   if (!mForms)
-    mForms = new nsContentList(this, nsGkAtoms::form, mDefaultNamespaceID);
+    mForms = new nsContentList(this, nsGkAtoms::form, GetDefaultNamespaceID());
 
   return mForms;
 }
 
 static PRBool MatchFormControls(nsIContent* aContent, PRInt32 aNamespaceID,
                                 nsIAtom* aAtom, void* aData)
 {
   return aContent->IsNodeOfType(nsIContent::eHTML_FORM_CONTROL);
@@ -3846,52 +3204,48 @@ DocAllResultMatch(nsIContent* aContent, 
 }
 
 
 nsresult
 nsHTMLDocument::GetDocumentAllResult(const nsAString& aID, nsISupports** aResult)
 {
   *aResult = nsnull;
 
-  PLDHashOperator op = IdTableIsLive() ? PL_DHASH_LOOKUP : PL_DHASH_ADD;
-
   nsCOMPtr<nsIAtom> id = do_GetAtom(aID);
-  IdAndNameMapEntry *entry =
-    static_cast<IdAndNameMapEntry *>
-               (PL_DHashTableOperate(&mIdAndNameHashTable, id, op));
-  NS_ENSURE_TRUE(entry, NS_ERROR_OUT_OF_MEMORY);
-
-  // If we did a lookup and it failed, there are no items with this id
-  if (PL_DHASH_ENTRY_IS_FREE(entry)) {
-    NS_ASSERTION(IdTableIsLive(), "should have gotten a busy entry");
-
-    return NS_OK;
+  nsIdentifierMapEntry *entry;
+  if (IdTableIsLive()) {
+    entry = mIdentifierMap.GetEntry(id);
+    // If we did a lookup and it failed, there are no items with this id
+    if (!entry)
+      return NS_OK;
+  } else {
+    entry = mIdentifierMap.PutEntry(id);
+    NS_ENSURE_TRUE(entry, NS_ERROR_OUT_OF_MEMORY);
   }
 
   nsIContent* root = GetRootContent();
   if (!root) {
     return NS_OK;
   }
 
-  if (!entry->mDocAllList) {
-    entry->mDocAllList = new nsContentList(root, DocAllResultMatch,
-                                           nsnull, nsnull, PR_TRUE, id);
-    NS_ENSURE_TRUE(entry->mDocAllList, NS_ERROR_OUT_OF_MEMORY);
-  }
-
-  nsRefPtr<nsContentList> docAllList = entry->mDocAllList;
+  nsRefPtr<nsContentList> docAllList = entry->GetDocAllList();
+  if (!docAllList) {
+    docAllList = new nsContentList(root, DocAllResultMatch,
+                                   nsnull, nsnull, PR_TRUE, id);
+    NS_ENSURE_TRUE(docAllList, NS_ERROR_OUT_OF_MEMORY);
+    entry->SetDocAllList(docAllList);
+  }
 
   // Check if there are more than 1 entries. Do this by getting the second one
   // rather than the length since getting the length always requires walking
   // the entire document.
 
   nsIContent* cont = docAllList->Item(1, PR_TRUE);
   if (cont) {
     NS_ADDREF(*aResult = static_cast<nsIDOMNodeList*>(docAllList));
-
     return NS_OK;
   }
 
   // There's only 0 or 1 items. Return the first one or null.
   NS_IF_ADDREF(*aResult = docAllList->Item(0, PR_TRUE));
 
   return NS_OK;
 }
diff --git a/content/html/document/src/nsHTMLDocument.h b/content/html/document/src/nsHTMLDocument.h
--- a/content/html/document/src/nsHTMLDocument.h
+++ b/content/html/document/src/nsHTMLDocument.h
@@ -69,17 +69,16 @@ class nsICacheEntryDescriptor;
 
 class nsHTMLDocument : public nsDocument,
                        public nsIHTMLDocument,
                        public nsIDOMHTMLDocument,
                        public nsIDOMNSHTMLDocument
 {
 public:
   nsHTMLDocument();
-  virtual ~nsHTMLDocument();
   virtual nsresult Init();
 
   NS_IMETHOD QueryInterface(REFNSIID aIID, void** aInstancePtr);
 
   NS_IMETHOD_(nsrefcnt) AddRef(void);
   NS_IMETHOD_(nsrefcnt) Release(void);
 
   virtual void Reset(nsIChannel* aChannel, nsILoadGroup* aLoadGroup);
@@ -118,27 +117,17 @@ public:
 
   virtual PRBool GetIsFrameset() { return mIsFrameset; }
   virtual void SetIsFrameset(PRBool aFrameset) { mIsFrameset = aFrameset; }
 
   virtual NS_HIDDEN_(nsContentList*) GetForms();
  
   virtual NS_HIDDEN_(nsContentList*) GetFormControls();
  
-  virtual void AttributeWillChange(nsIContent* aChild,
-                                   PRInt32 aNameSpaceID,
-                                   nsIAtom* aAttribute);
-
   virtual PRBool IsCaseSensitive();
-
-  // nsIMutationObserver
-  NS_DECL_NSIMUTATIONOBSERVER_CONTENTAPPENDED
-  NS_DECL_NSIMUTATIONOBSERVER_CONTENTINSERTED
-  NS_DECL_NSIMUTATIONOBSERVER_CONTENTREMOVED
-  NS_DECL_NSIMUTATIONOBSERVER_ATTRIBUTECHANGED
 
   // nsIDOMDocument interface
   NS_DECL_NSIDOMDOCUMENT
 
   // nsIDOM3Document interface
   NS_IMETHOD GetXmlEncoding(nsAString& aXmlVersion);
   NS_IMETHOD GetXmlStandalone(PRBool *aXmlStandalone);
   NS_IMETHOD SetXmlStandalone(PRBool aXmlStandalone);
@@ -173,30 +162,30 @@ public:
                                nsIDOMNodeList **_retval);
   virtual nsresult GetDocumentAllResult(const nsAString& aID,
                                         nsISupports** aResult);
 
   // nsIDOMNSHTMLDocument interface
   NS_DECL_NSIDOMNSHTMLDOCUMENT
 
   virtual nsresult ResolveName(const nsAString& aName,
-                         nsIDOMHTMLFormElement *aForm,
-                         nsISupports **aResult);
+                               nsIDOMHTMLFormElement *aForm,
+                               nsISupports **aResult);
 
   virtual void ScriptLoading(nsIScriptElement *aScript);
   virtual void ScriptExecuted(nsIScriptElement *aScript);
 
   virtual void AddedForm();
   virtual void RemovedForm();
   virtual PRInt32 GetNumFormsSynchronous();
   virtual void TearingDownEditor(nsIEditor *aEditor);
 
   PRBool IsXHTML()
   {
-    return mDefaultNamespaceID == kNameSpaceID_XHTML;
+    return !mIsRegularHTML;
   }
 
 #ifdef DEBUG
   virtual nsresult CreateElem(nsIAtom *aName, nsIAtom *aPrefix,
                               PRInt32 aNamespaceID,
                               PRBool aDocumentDefaultType,
                               nsIContent** aResult);
 #endif
@@ -222,54 +211,51 @@ public:
   }
 
   virtual nsresult SetEditingState(EditingState aState);
 
 protected:
   nsresult GetBodySize(PRInt32* aWidth,
                        PRInt32* aHeight);
 
-  nsresult RegisterNamedItems(nsIContent *aContent);
-  nsresult UnregisterNamedItems(nsIContent *aContent);
-  nsresult UpdateNameTableEntry(nsIAtom* aName, nsIContent *aContent);
-  nsresult UpdateIdTableEntry(nsIAtom* aId, nsIContent *aContent);
-  nsresult RemoveFromNameTable(nsIAtom* aName, nsIContent *aContent);
-  nsresult RemoveFromIdTable(nsIContent *aContent);
-
-  void InvalidateHashTables();
-  nsresult PrePopulateHashTables();
+  nsresult PrePopulateIdentifierMap();
 
   nsIContent *MatchId(nsIContent *aContent, const nsAString& aId);
 
   static PRBool MatchLinks(nsIContent *aContent, PRInt32 aNamespaceID,
                            nsIAtom* aAtom, void* aData);
   static PRBool MatchAnchors(nsIContent *aContent, PRInt32 aNamespaceID,
                              nsIAtom* aAtom, void* aData);
   static PRBool MatchNameAttribute(nsIContent* aContent, PRInt32 aNamespaceID,
                                    nsIAtom* aAtom, void* aData);
 
   static void DocumentWriteTerminationFunc(nsISupports *aRef);
 
+  // Get the root <html> element, or return null if there isn't one (e.g.
+  // if the root isn't <html>)
+  nsIContent* GetHtmlContent();
+  // Get the canonical <body> element, or return null if there isn't one (e.g.
+  // if the root isn't <html> or if the <body> isn't there)
   nsIContent* GetBodyContent();
 
   void GetDomainURI(nsIURI **uri);
 
   nsresult WriteCommon(const nsAString& aText,
                        PRBool aNewlineTerminate);
   nsresult ScriptWriteCommon(PRBool aNewlineTerminate);
   nsresult OpenCommon(const nsACString& aContentType, PRBool aReplace);
 
   nsresult CreateAndAddWyciwygChannel(void);
   nsresult RemoveWyciwygChannel(void);
 
   void *GenerateParserKey(void);
 
-  PRInt32 GetDefaultNamespaceID() const
+  virtual PRInt32 GetDefaultNamespaceID() const
   {
-    return mDefaultNamespaceID;
+    return mIsRegularHTML ? kNameSpaceID_None : kNameSpaceID_XHTML;
   }
 
   nsCOMArray<nsIDOMHTMLMapElement> mImageMaps;
 
   nsCOMPtr<nsIDOMHTMLCollection> mImages;
   nsCOMPtr<nsIDOMHTMLCollection> mApplets;
   nsCOMPtr<nsIDOMHTMLCollection> mEmbeds;
   nsCOMPtr<nsIDOMHTMLCollection> mLinks;
@@ -337,39 +323,16 @@ protected:
 
   // Load flags of the document's channel
   PRUint32 mLoadFlags;
 
   PRPackedBool mIsFrameset;
 
   PRPackedBool mTooDeepWriteRecursion;
 
-  PRBool IdTableIsLive() const {
-    // live if we've had over 63 misses
-    return (mIdMissCount & 0x40) != 0;
-  }
-
-  PRBool IdTableShouldBecomeLive() {
-    NS_ASSERTION(!IdTableIsLive(),
-                 "Shouldn't be called if table is already live!");
-    ++mIdMissCount;
-    return IdTableIsLive();
-  }
-
-  PRUint8 mIdMissCount;
-
-  /* mIdAndNameHashTable works as follows for IDs:
-   * 1) Attribute changes affect the table immediately (removing and adding
-   *    entries as needed).
-   * 2) Removals from the DOM affect the table immediately
-   * 3) Additions to the DOM always update existing entries, but only add new
-   *    ones if IdTableIsLive() is true.
-   */
-  PLDHashTable mIdAndNameHashTable;
-
   nsCOMPtr<nsIWyciwygChannel> mWyciwygChannel;
 
   /* Midas implementation */
   nsresult   GetMidasCommandManager(nsICommandManager** aCommandManager);
 
   nsCOMPtr<nsICommandManager> mMidasCommandManager;
 
   nsresult TurnEditingOff();
@@ -377,19 +340,13 @@ protected:
 
   PRUint32 mContentEditableCount;
   EditingState mEditingState;
 
   nsresult   DoClipboardSecurityCheck(PRBool aPaste);
   static jsval       sCutCopyInternal_id;
   static jsval       sPasteInternal_id;
 
-  // kNameSpaceID_None for good ol' HTML documents, and
-  // kNameSpaceID_XHTML for spiffy new XHTML documents.
-  // XXXbz should this be reset if someone manually calls
-  // SetContentType() on this document?
-  PRInt32 mDefaultNamespaceID;
-
   // Parser used for constructing document fragments.
   nsCOMPtr<nsIParser> mFragmentParser;
 };
 
 #endif /* nsHTMLDocument_h___ */
diff --git a/content/svg/content/src/nsSVGElement.cpp b/content/svg/content/src/nsSVGElement.cpp
--- a/content/svg/content/src/nsSVGElement.cpp
+++ b/content/svg/content/src/nsSVGElement.cpp
@@ -311,32 +311,48 @@ nsSVGElement::ParseAttribute(PRInt32 aNa
       }
     }
 
     if (!foundMatch) {
       // Check for nsSVGNumber2 attribute
       NumberAttributesInfo numberInfo = GetNumberInfo();
       for (i = 0; i < numberInfo.mNumberCount; i++) {
         if (aAttribute == *numberInfo.mNumberInfo[i].mName) {
-          rv = numberInfo.mNumbers[i].SetBaseValueString(aValue, this, PR_FALSE);
+          if (i + 1 < numberInfo.mNumberCount &&
+              aAttribute == *numberInfo.mNumberInfo[i + 1].mName) {
+            rv = ParseNumberOptionalNumber(aValue, i, i + 1);
+            if (NS_FAILED(rv)) {
+              numberInfo.Reset(i + 1);
+            }
+          } else {
+            rv = numberInfo.mNumbers[i].SetBaseValueString(aValue, this, PR_FALSE);
+          }
           if (NS_FAILED(rv)) {
             numberInfo.Reset(i);
           }
           foundMatch = PR_TRUE;
           break;
         }
       }
     }
 
     if (!foundMatch) {
       // Check for nsSVGInteger attribute
       IntegerAttributesInfo integerInfo = GetIntegerInfo();
       for (i = 0; i < integerInfo.mIntegerCount; i++) {
         if (aAttribute == *integerInfo.mIntegerInfo[i].mName) {
-          rv = integerInfo.mIntegers[i].SetBaseValueString(aValue, this, PR_FALSE);
+          if (i + 1 < integerInfo.mIntegerCount &&
+              aAttribute == *integerInfo.mIntegerInfo[i + 1].mName) {
+            rv = ParseIntegerOptionalInteger(aValue, i, i + 1);
+            if (NS_FAILED(rv)) {
+              integerInfo.Reset(i + 1);
+            }
+          } else {
+            rv = integerInfo.mIntegers[i].SetBaseValueString(aValue, this, PR_FALSE);
+          }
           if (NS_FAILED(rv)) {
             integerInfo.Reset(i);
           }
           foundMatch = PR_TRUE;
           break;
         }
       }
     }
@@ -438,55 +454,71 @@ nsSVGElement::UnsetAttr(PRInt32 aNamespa
       // Check if this is a length attribute going away
       LengthAttributesInfo lenInfo = GetLengthInfo();
 
       for (PRUint32 i = 0; i < lenInfo.mLengthCount; i++) {
         if (aName == *lenInfo.mLengthInfo[i].mName) {
           lenInfo.Reset(i);
           DidChangeLength(i, PR_FALSE);
           foundMatch = PR_TRUE;
+          break;
         }
       }
     }
 
     if (!foundMatch) {
       // Check if this is a number attribute going away
       NumberAttributesInfo numInfo = GetNumberInfo();
 
       for (PRUint32 i = 0; i < numInfo.mNumberCount; i++) {
         if (aName == *numInfo.mNumberInfo[i].mName) {
+          if (i + 1 < numInfo.mNumberCount &&
+              aName == *numInfo.mNumberInfo[i + 1].mName) {
+            // found a number-optional-number
+            numInfo.Reset(i + 1);
+            DidChangeNumber(i + 1, PR_FALSE);
+          }
           numInfo.Reset(i);
           DidChangeNumber(i, PR_FALSE);
           foundMatch = PR_TRUE;
+          break;
         }
       }
     }
 
     if (!foundMatch) {
       // Check if this is an integer attribute going away
       IntegerAttributesInfo intInfo = GetIntegerInfo();
 
       for (PRUint32 i = 0; i < intInfo.mIntegerCount; i++) {
         if (aName == *intInfo.mIntegerInfo[i].mName) {
+          if (i + 1 < intInfo.mIntegerCount &&
+              aName == *intInfo.mIntegerInfo[i + 1].mName) {
+            // found a number-optional-number
+            intInfo.Reset(i + 1);
+            DidChangeNumber(i + 1, PR_FALSE);
+          }
           intInfo.Reset(i);
           DidChangeInteger(i, PR_FALSE);
           foundMatch = PR_TRUE;
+          break;
         }
       }
     }
 
     if (!foundMatch) {
       // Check if this is an angle attribute going away
       AngleAttributesInfo angleInfo = GetAngleInfo();
 
       for (PRUint32 i = 0; i < angleInfo.mAngleCount; i++) {
         if (aName == *angleInfo.mAngleInfo[i].mName) {
           angleInfo.Reset(i);
           DidChangeAngle(i, PR_FALSE);
           foundMatch = PR_TRUE;
+          break;
         }
       }
     }
 
     if (!foundMatch) {
       // Check if this is a boolean attribute going away
       BooleanAttributesInfo boolInfo = GetBooleanInfo();
 
@@ -503,31 +535,33 @@ nsSVGElement::UnsetAttr(PRInt32 aNamespa
       // Check if this is an enum attribute going away
       EnumAttributesInfo enumInfo = GetEnumInfo();
 
       for (PRUint32 i = 0; i < enumInfo.mEnumCount; i++) {
         if (aName == *enumInfo.mEnumInfo[i].mName) {
           enumInfo.Reset(i);
           DidChangeEnum(i, PR_FALSE);
           foundMatch = PR_TRUE;
+          break;
         }
       }
     }
   }
 
   if (!foundMatch) {
     // Check if this is a string attribute going away
     StringAttributesInfo stringInfo = GetStringInfo();
 
     for (PRUint32 i = 0; i < stringInfo.mStringCount; i++) {
       if (aNamespaceID == stringInfo.mStringInfo[i].mNamespaceID &&
           aName == *stringInfo.mStringInfo[i].mName) {
         stringInfo.Reset(i);
         DidChangeString(i, PR_FALSE);
         foundMatch = PR_TRUE;
+        break;
       }
     }
   }
 
   if (!foundMatch) {
     // Now check for one of the old style basetypes going away
     nsCOMPtr<nsISVGValue> svg_value = GetMappedAttribute(aNamespaceID, aName);
 
@@ -1370,114 +1404,97 @@ nsSVGElement::DidChangeString(PRUint8 aA
 
   NS_ASSERTION(aAttrEnum < info.mStringCount, "aAttrEnum out of range");
 
   SetAttr(info.mStringInfo[aAttrEnum].mNamespaceID,
           *info.mStringInfo[aAttrEnum].mName,
           info.mStrings[aAttrEnum].GetBaseValue(), PR_TRUE);
 }
 
-PRBool
-nsSVGElement::ParseNumberOptionalNumber(nsIAtom* aAttribute, const nsAString& aValue,
-                                        PRUint32 aIndex1, PRUint32 aIndex2,
-                                        nsAttrValue& aResult)
+nsresult
+nsSVGElement::ParseNumberOptionalNumber(const nsAString& aValue,
+                                        PRUint32 aIndex1, PRUint32 aIndex2)
 {
   NS_ConvertUTF16toUTF8 value(aValue);
   const char *str = value.get();
 
-  PRBool parseError = NS_IsAsciiWhitespace(*str);
-  float x, y;
+  if (NS_IsAsciiWhitespace(*str))
+    return NS_ERROR_FAILURE;
 
-  if (!parseError) {
-    char *rest;
-    x = y = float(PR_strtod(str, &rest));
+  char *rest;
+  float x = float(PR_strtod(str, &rest));
+  float y = x;
 
-    if (str == rest) {
-      //first value was illformed
-      parseError = PR_TRUE;
-    } else if (*rest != '\0') {
-      while (NS_IsAsciiWhitespace(*rest)) {
-        ++rest;
-      }
-      if (*rest == ',') {
-        ++rest;
-      }
+  if (str == rest) {
+    //first value was illformed
+    return NS_ERROR_FAILURE;
+  }
+  
+  if (*rest != '\0') {
+    while (NS_IsAsciiWhitespace(*rest)) {
+      ++rest;
+    }
+    if (*rest == ',') {
+      ++rest;
+    }
 
-      y = float(PR_strtod(rest, &rest));
-      if (*rest != '\0') {
-        //second value was illformed or there was trailing content
-        parseError = PR_TRUE;
-      }
+    y = float(PR_strtod(rest, &rest));
+    if (*rest != '\0') {
+      //second value was illformed or there was trailing content
+      return NS_ERROR_FAILURE;
     }
   }
 
   NumberAttributesInfo numberInfo = GetNumberInfo();
 
-  if (parseError) {
-    ReportAttributeParseFailure(GetOwnerDoc(), aAttribute, aValue);
-    x = numberInfo.mNumberInfo[aIndex1].mDefaultValue;
-    y = numberInfo.mNumberInfo[aIndex2].mDefaultValue;
-  } else {
-    aResult.SetTo(aValue);
-  }
-
   numberInfo.mNumbers[aIndex1].SetBaseValue(x, this, PR_FALSE);
   numberInfo.mNumbers[aIndex2].SetBaseValue(y, this, PR_FALSE);
-
-  return (!parseError);
+  return NS_OK;
 }
 
-PRBool
-nsSVGElement::ParseIntegerOptionalInteger(nsIAtom* aAttribute, const nsAString& aValue,
-                                          PRUint32 aIndex1, PRUint32 aIndex2,
-                                          nsAttrValue& aResult)
+nsresult
+nsSVGElement::ParseIntegerOptionalInteger(const nsAString& aValue,
+                                          PRUint32 aIndex1, PRUint32 aIndex2)
 {
   NS_ConvertUTF16toUTF8 value(aValue);
   const char *str = value.get();
 
-  PRBool parseError = NS_IsAsciiWhitespace(*str);
-  PRInt32 x, y;
+  if (NS_IsAsciiWhitespace(*str))
+    return NS_ERROR_FAILURE;
 
-  if (!parseError) {
-    char *rest;
-    x = y = strtol(str, &rest, 10);
+  char *rest;
+  PRInt32 x = strtol(str, &rest, 10);
+  PRInt32 y = x;
 
-    if (str == rest) {
-      //first value was illformed
-      parseError = PR_TRUE;
-    } else if (*rest != '\0') {
-      while (NS_IsAsciiWhitespace(*rest)) {
-        ++rest;
-      }
-      if (*rest == ',') {
-        ++rest;
-      }
+  if (str == rest) {
+    //first value was illformed
+    return NS_ERROR_FAILURE;
+  }
+  
+  if (*rest != '\0') {
+    while (NS_IsAsciiWhitespace(*rest)) {
+      ++rest;
+    }
+    if (*rest == ',') {
+      ++rest;
+    }
 
-      y = strtol(rest, &rest, 10);
-      if (*rest != '\0') {
-        //second value was illformed or there was trailing content
-        parseError = PR_TRUE;
-      }
+    y = strtol(rest, &rest, 10);
+    if (*rest != '\0') {
+      //second value was illformed or there was trailing content
+      return NS_ERROR_FAILURE;
     }
   }
 
   IntegerAttributesInfo integerInfo = GetIntegerInfo();
 
-  if (parseError) {
-    ReportAttributeParseFailure(GetOwnerDoc(), aAttribute, aValue);
-    x = integerInfo.mIntegerInfo[aIndex1].mDefaultValue;
-    y = integerInfo.mIntegerInfo[aIndex2].mDefaultValue;
-  } else {
-    aResult.SetTo(aValue);
-  }
-
   integerInfo.mIntegers[aIndex1].SetBaseValue(x, this, PR_FALSE);
   integerInfo.mIntegers[aIndex2].SetBaseValue(y, this, PR_FALSE);
 
-  return (!parseError);
+  return NS_OK;
 }
 
 nsresult
 nsSVGElement::ReportAttributeParseFailure(nsIDocument* aDocument,
                                           nsIAtom* aAttribute,
                                           const nsAString& aValue)
 {
   nsAutoString attributeName;
diff --git a/content/svg/content/src/nsSVGElement.h b/content/svg/content/src/nsSVGElement.h
--- a/content/svg/content/src/nsSVGElement.h
+++ b/content/svg/content/src/nsSVGElement.h
@@ -305,33 +305,31 @@ protected:
   virtual IntegerAttributesInfo GetIntegerInfo();
   virtual AngleAttributesInfo GetAngleInfo();
   virtual BooleanAttributesInfo GetBooleanInfo();
   virtual EnumAttributesInfo GetEnumInfo();
   virtual StringAttributesInfo GetStringInfo();
 
   static nsSVGEnumMapping sSVGUnitTypesMap[];
 
+private:
   /* read <number-optional-number> */
-  PRBool
-  ParseNumberOptionalNumber(nsIAtom* aAttribute, const nsAString& aValue,
-                            PRUint32 aIndex1, PRUint32 aIndex2,
-                            nsAttrValue& aResult);
+  nsresult
+  ParseNumberOptionalNumber(const nsAString& aValue,
+                            PRUint32 aIndex1, PRUint32 aIndex2);
 
   /* read <integer-optional-integer> */
-  PRBool
-  ParseIntegerOptionalInteger(nsIAtom* aAttribute, const nsAString& aValue,
-                              PRUint32 aIndex1, PRUint32 aIndex2,
-                              nsAttrValue& aResult);
+  nsresult
+  ParseIntegerOptionalInteger(const nsAString& aValue,
+                              PRUint32 aIndex1, PRUint32 aIndex2);
 
   static nsresult ReportAttributeParseFailure(nsIDocument* aDocument,
                                               nsIAtom* aAttribute,
                                               const nsAString& aValue);
 
-private:
   void ResetOldStyleBaseType(nsISVGValue *svg_value);
 
   nsCOMPtr<nsICSSStyleRule> mContentStyleRule;
   nsAttrAndChildArray mMappedAttributes;
 
   PRPackedBool mSuppressNotification;
 };
 
diff --git a/content/svg/content/src/nsSVGFilterElement.cpp b/content/svg/content/src/nsSVGFilterElement.cpp
--- a/content/svg/content/src/nsSVGFilterElement.cpp
+++ b/content/svg/content/src/nsSVGFilterElement.cpp
@@ -170,30 +170,16 @@ nsSVGFilterElement::GetHref(nsIDOMSVGAni
 nsSVGFilterElement::GetHref(nsIDOMSVGAnimatedString * *aHref)
 {
   return mStringAttributes[HREF].ToDOMAnimatedString(aHref, this);
 }
 
 //----------------------------------------------------------------------
 // nsIContent methods
 
-PRBool
-nsSVGFilterElement::ParseAttribute(PRInt32 aNameSpaceID, nsIAtom* aName,
-                                   const nsAString& aValue,
-                                   nsAttrValue& aResult)
-{
-  if (aName == nsGkAtoms::filterRes && aNameSpaceID == kNameSpaceID_None) {
-    return ParseIntegerOptionalInteger(aName, aValue,
-                                       FILTERRES_X, FILTERRES_Y,
-                                       aResult);
-  }
-  return nsSVGFilterElementBase::ParseAttribute(aNameSpaceID, aName,
-                                                aValue, aResult);
-}
-
 NS_IMETHODIMP_(PRBool)
 nsSVGFilterElement::IsAttributeMapped(const nsIAtom* name) const
 {
   static const MappedAttributeEntry* const map[] = {
     sFEFloodMap,
     sFiltersMap,
     sFontSpecificationMap,
     sGradientStopMap,
diff --git a/content/svg/content/src/nsSVGFilterElement.h b/content/svg/content/src/nsSVGFilterElement.h
--- a/content/svg/content/src/nsSVGFilterElement.h
+++ b/content/svg/content/src/nsSVGFilterElement.h
@@ -80,20 +80,16 @@ public:
   virtual nsresult Clone(nsINodeInfo *aNodeInfo, nsINode **aResult) const;
   NS_IMETHOD_(PRBool) IsAttributeMapped(const nsIAtom* aAttribute) const;
 
   // Invalidate users of this filter
   void Invalidate();
 
 protected:
 
-  virtual PRBool ParseAttribute(PRInt32 aNameSpaceID, nsIAtom* aName,
-                                const nsAString& aValue,
-                                nsAttrValue& aResult);
-
   virtual LengthAttributesInfo GetLengthInfo();
   virtual IntegerAttributesInfo GetIntegerInfo();
   virtual EnumAttributesInfo GetEnumInfo();
   virtual StringAttributesInfo GetStringInfo();
 
   enum { X, Y, WIDTH, HEIGHT };
   nsSVGLength2 mLengthAttributes[4];
   static LengthInfo sLengthInfo[4];
diff --git a/content/svg/content/src/nsSVGFilters.cpp b/content/svg/content/src/nsSVGFilters.cpp
--- a/content/svg/content/src/nsSVGFilters.cpp
+++ b/content/svg/content/src/nsSVGFilters.cpp
@@ -523,19 +523,16 @@ public:
   // Gaussian
   NS_DECL_NSIDOMSVGFEGAUSSIANBLURELEMENT
 
   NS_FORWARD_NSIDOMSVGELEMENT(nsSVGFEGaussianBlurElementBase::)
 
   NS_FORWARD_NSIDOMNODE(nsSVGFEGaussianBlurElementBase::)
   NS_FORWARD_NSIDOMELEMENT(nsSVGFEGaussianBlurElementBase::)
 
-  virtual PRBool ParseAttribute(PRInt32 aNameSpaceID, nsIAtom* aName,
-                                const nsAString& aValue,
-                                nsAttrValue& aResult);
   virtual nsresult Clone(nsINodeInfo *aNodeInfo, nsINode **aResult) const;
 
 protected:
   virtual NumberAttributesInfo GetNumberInfo();
   virtual StringAttributesInfo GetStringInfo();
 
   enum { STD_DEV_X, STD_DEV_Y };
   nsSVGNumber2 mNumberAttributes[2];
@@ -544,26 +541,16 @@ protected:
   enum { RESULT, IN1 };
   nsSVGString mStringAttributes[2];
   static StringInfo sStringInfo[2];
 
 private:
   nsresult GetDXY(PRUint32 *aDX, PRUint32 *aDY, const nsSVGFilterInstance& aInstance);
   void InflateRectForBlur(nsRect* aRect, const nsSVGFilterInstance& aInstance);
 
-  PRUint8 *SetupPredivide(PRUint32 size) const;
-
-  void BoxBlurH(PRUint8 *aInput, PRUint8 *aOutput,
-                PRInt32 aStride, const nsRect& aRegion,
-                PRUint32 leftLobe, PRUint32 rightLobe, const PRUint8 *prediv);
-
-  void BoxBlurV(PRUint8 *aInput, PRUint8 *aOutput,
-                PRInt32 aStride, const nsRect& aRegion,
-                PRUint32 topLobe, PRUint32 bottomLobe, const PRUint8 *prediv);
-
   void GaussianBlur(PRUint8 *aInput, PRUint8 *aOutput,
                     nsSVGFilterResource *aFilterResource,
                     PRUint32 aDX, PRUint32 aDY);
 
 };
 
 nsSVGElement::NumberInfo nsSVGFEGaussianBlurElement::sNumberInfo[2] =
 {
@@ -626,123 +613,118 @@ nsSVGFEGaussianBlurElement::SetStdDeviat
 nsSVGFEGaussianBlurElement::SetStdDeviation(float stdDeviationX, float stdDeviationY)
 {
   NS_ENSURE_FINITE2(stdDeviationX, stdDeviationY, NS_ERROR_ILLEGAL_VALUE);
   mNumberAttributes[STD_DEV_X].SetBaseValue(stdDeviationX, this, PR_TRUE);
   mNumberAttributes[STD_DEV_Y].SetBaseValue(stdDeviationY, this, PR_TRUE);
   return NS_OK;
 }
 
-PRBool
-nsSVGFEGaussianBlurElement::ParseAttribute(PRInt32 aNameSpaceID, nsIAtom* aName,
-                                           const nsAString& aValue,
-                                           nsAttrValue& aResult)
-{
-  if (aName == nsGkAtoms::stdDeviation && aNameSpaceID == kNameSpaceID_None) {
-    return ParseNumberOptionalNumber(aName, aValue,
-                                     STD_DEV_X, STD_DEV_Y,
-                                     aResult);
-  }
-  return nsSVGFEGaussianBlurElementBase::ParseAttribute(aNameSpaceID, aName,
-                                                        aValue, aResult);
-}
-
-void
-nsSVGFEGaussianBlurElement::BoxBlurH(PRUint8 *aInput, PRUint8 *aOutput,
-                                     PRInt32 aStride, const nsRect &aRegion,
-                                     PRUint32 leftLobe, PRUint32 rightLobe,
-                                     const PRUint8 *prediv)
-{
-  PRInt32 boxSize = leftLobe + rightLobe + 1;
-  PRInt32 posStart = aRegion.x - leftLobe;
-
-  for (PRInt32 y = aRegion.y; y < aRegion.YMost(); y++) {
-    PRUint32 sums[4] = {0, 0, 0, 0};
-    PRInt32 lineIndex = aStride * y;
-    for (PRInt32 i = 0; i < boxSize; i++) {
-      PRInt32 pos = posStart + i;
-      pos = PR_MAX(pos, aRegion.x);
-      pos = PR_MIN(pos, aRegion.XMost() - 1);
-      PRInt32 index = lineIndex + (pos << 2);
-      sums[0] += aInput[index    ];
-      sums[1] += aInput[index + 1];
-      sums[2] += aInput[index + 2];
-      sums[3] += aInput[index + 3];
-    }
-    for (PRInt32 x = aRegion.x; x < aRegion.XMost(); x++) {
-      PRInt32 index = lineIndex + (x << 2);
-      aOutput[index    ] = prediv[sums[0]];
-      aOutput[index + 1] = prediv[sums[1]];
-      aOutput[index + 2] = prediv[sums[2]];
-      aOutput[index + 3] = prediv[sums[3]];
-
-      PRInt32 tmp = x - leftLobe;
-      PRInt32 last = PR_MAX(tmp, aRegion.x);
-      PRInt32 next = PR_MIN(tmp + boxSize, aRegion.XMost() - 1);
-      PRInt32 index2 = lineIndex + (next << 2);
-      PRInt32 index3 = lineIndex + (last << 2);
-      sums[0] += aInput[index2    ] - aInput[index3    ];
-      sums[1] += aInput[index2 + 1] - aInput[index3 + 1];
-      sums[2] += aInput[index2 + 2] - aInput[index3 + 2];
-      sums[3] += aInput[index2 + 3] - aInput[index3 + 3];
-    }
-  }
-}
-
-void
-nsSVGFEGaussianBlurElement::BoxBlurV(PRUint8 *aInput, PRUint8 *aOutput,
-                                     PRInt32 aStride, const nsRect &aRegion,
-                                     PRUint32 topLobe, PRUint32 bottomLobe,
-                                     const PRUint8 *prediv)
-{
-  PRInt32 boxSize = topLobe + bottomLobe + 1;
-  PRInt32 posStart = aRegion.y - topLobe;
-
-  for (PRInt32 x = aRegion.x; x < aRegion.XMost(); x++) {
-    PRUint32 sums[4] = {0, 0, 0, 0};
-    PRInt32 fourX = x << 2;
-    for (PRInt32 i = 0; i < boxSize; i++) {
-      PRInt32 pos = posStart + i;
-      pos = PR_MAX(pos, aRegion.y);
-      pos = PR_MIN(pos, aRegion.YMost() - 1);
-      PRInt32 index = aStride * pos + fourX;
-      sums[0] += aInput[index    ];
-      sums[1] += aInput[index + 1];
-      sums[2] += aInput[index + 2];
-      sums[3] += aInput[index + 3];
-    }
-    for (PRInt32 y = aRegion.y; y < aRegion.YMost(); y++) {
-      PRInt32 index = aStride * y + fourX;
-      aOutput[index    ] = prediv[sums[0]];
-      aOutput[index + 1] = prediv[sums[1]];
-      aOutput[index + 2] = prediv[sums[2]];
-      aOutput[index + 3] = prediv[sums[3]];
-
-      PRInt32 tmp = y - topLobe;
-      PRInt32 last = PR_MAX(tmp, aRegion.y);
-      PRInt32 next = PR_MIN(tmp + boxSize, aRegion.YMost() - 1);
-      PRInt32 index2 = aStride * next + fourX;
-      PRInt32 index3 = aStride * last + fourX;
-      sums[0] += aInput[index2    ] - aInput[index3    ];
-      sums[1] += aInput[index2 + 1] - aInput[index3 + 1];
-      sums[2] += aInput[index2 + 2] - aInput[index3 + 2];
-      sums[3] += aInput[index2 + 3] - aInput[index3 + 3];
-    }
-  }
-}
-
-PRUint8 *
-nsSVGFEGaussianBlurElement::SetupPredivide(PRUint32 size) const
-{
-  PRUint8 *tmp = new PRUint8[size * 256];
-  if (tmp) {
-    for (PRUint32 i = 0; i < 256; i++)
-      memset(tmp + i * size, i, size);
-  }
-  return tmp;
+/**
+ * We want to speed up 1/N integer divisions --- integer division is
+ * often rather slow.
+ * We know that our input numerators V are constrained to be <= 255*N,
+ * so the result of dividing by N always fits in 8 bits.
+ * So we can try approximating the division V/N as V*K/(2^24) (integer
+ * division, 32-bit multiply). Dividing by 2^24 is a simple shift so it's
+ * fast. The main problem is choosing a value for K; this function returns
+ * K's value.
+ * 
+ * If the result is correct for the extrema, V=0 and V=255*N, then we'll
+ * be in good shape since both the original function and our approximation
+ * are linear. V=0 always gives 0 in both cases, no problem there.
+ * For V=255*N, let's choose the largest K that doesn't cause overflow
+ * and ensure that it gives the right answer. The constraints are
+ *     (1)   255*N*K < 2^32
+ * and (2)   255*N*K >= 255*(2^24)
+ * 
+ * From (1) we find the best value of K is floor((2^32 - 1)/(255*N)).
+ * (2) tells us when this will be valid:
+ *    N*floor((2^32 - 1)/(255*N)) >= 2^24
+ * Now, floor(X) > X - 1, so (2) holds if
+ *    N*((2^32 - 1)/(255*N) - 1) >= 2^24
+ *         (2^32 - 1)/255 - 2^24 >= N
+ *                             N <= 65793
+ * 
+ * If all that math confuses you, this should convince you:
+ * > perl -e 'for($N=1;(255*$N*int(0xFFFFFFFF/(255*$N)))>>24==255;++$N){}print"$N\n"'
+ * 66052
+ * 
+ * So this is fine for all reasonable values of N. For larger values of N
+ * we may as well just use the same approximation and accept the fact that
+ * the output channel values will be a little low.
+ */
+static PRUint32 ComputeScaledDivisor(PRUint32 aDivisor)
+{
+  return PR_UINT32_MAX/(255*aDivisor);
+}
+  
+static void
+BoxBlur(const PRUint8 *aInput, PRUint8 *aOutput,
+        PRInt32 aStrideMinor, PRInt32 aStartMinor, PRInt32 aEndMinor,
+        PRUint32 aLeftLobe, PRUint32 aRightLobe)
+{
+  PRUint32 boxSize = aLeftLobe + aRightLobe + 1;
+  PRUint32 scaledDivisor = ComputeScaledDivisor(boxSize);
+  PRUint32 sums[4] = {0, 0, 0, 0};
+
+  for (PRUint32 i=0; i < boxSize; i++) {
+    PRInt32 pos = aStartMinor - aLeftLobe + i;
+    pos = PR_MAX(pos, aStartMinor);
+    pos = PR_MIN(pos, aEndMinor - 1);
+#define SUM(j)     sums[j] += aInput[aStrideMinor*pos + j];
+    SUM(0); SUM(1); SUM(2); SUM(3);
+#undef SUM
+  }
+
+  aOutput += aStrideMinor*aStartMinor;
+  if (aStartMinor + boxSize <= aEndMinor) {
+    const PRUint8 *lastInput = aInput + aStartMinor*aStrideMinor;
+    const PRUint8 *nextInput = aInput + (aStartMinor + aRightLobe + 1)*aStrideMinor;
+#define OUTPUT(j)     aOutput[j] = (sums[j]*scaledDivisor) >> 24;
+#define SUM(j)        sums[j] += nextInput[j] - lastInput[j];
+    for (PRInt32 minor = aStartMinor; minor < aStartMinor + aLeftLobe; minor++) {
+      OUTPUT(0); OUTPUT(1); OUTPUT(2); OUTPUT(3);
+      SUM(0); SUM(1); SUM(2); SUM(3);
+      nextInput += aStrideMinor;
+      aOutput += aStrideMinor;
+      }
+    for (PRInt32 minor = aStartMinor + aLeftLobe; minor < aEndMinor - aRightLobe - 1; minor++) {
+      OUTPUT(0); OUTPUT(1); OUTPUT(2); OUTPUT(3);
+      SUM(0); SUM(1); SUM(2); SUM(3);
+      lastInput += aStrideMinor;
+      nextInput += aStrideMinor;
+      aOutput += aStrideMinor;
+    }
+    // nextInput is now aInput + aEndMinor*aStrideMinor. Set it back to
+    // aInput + (aEndMinor - 1)*aStrideMinor so we read the last pixel in every
+    // iteration of the next loop.
+    nextInput -= aStrideMinor;
+    for (PRInt32 minor = aEndMinor - aRightLobe - 1; minor < aEndMinor; minor++) {
+      OUTPUT(0); OUTPUT(1); OUTPUT(2); OUTPUT(3);
+      SUM(0); SUM(1); SUM(2); SUM(3);
+      lastInput += aStrideMinor;
+      aOutput += aStrideMinor;
+#undef SUM
+    }
+  } else {
+    for (PRInt32 minor = aStartMinor; minor < aEndMinor; minor++) {
+      PRInt32 tmp = minor - aLeftLobe;
+      PRInt32 last = PR_MAX(tmp, aStartMinor);
+      PRInt32 next = PR_MIN(tmp + boxSize, aEndMinor - 1);
+
+      OUTPUT(0); OUTPUT(1); OUTPUT(2); OUTPUT(3);
+#define SUM(j)     sums[j] += aInput[aStrideMinor*next + j] - \
+                              aInput[aStrideMinor*last + j];
+      SUM(0); SUM(1); SUM(2); SUM(3);
+      aOutput += aStrideMinor;
+#undef SUM
+#undef OUTPUT
+    }
+  }
 }
 
 nsresult
 nsSVGFEGaussianBlurElement::GetDXY(PRUint32 *aDX, PRUint32 *aDY,
         const nsSVGFilterInstance& aInstance)
 {
   float stdX, stdY;
   nsSVGLength2 val;
@@ -765,77 +747,52 @@ nsSVGFEGaussianBlurElement::GetDXY(PRUin
   return NS_OK;
 }
 
 void
 nsSVGFEGaussianBlurElement::GaussianBlur(PRUint8 *aInput, PRUint8 *aOutput,
                                          nsSVGFilterResource *aFilterResource,
                                          PRUint32 aDX, PRUint32 aDY)
 {
-  NS_ASSERTION(aDX > 0 && aDY > 0, "Invalid stdDeviation!");
-
   nsAutoArrayPtr<PRUint8> tmp(new PRUint8[aFilterResource->GetDataSize()]);
   if (!tmp)
     return;
   memset(tmp, 0, aFilterResource->GetDataSize());
+
   nsRect rect = aFilterResource->GetSurfaceRect();
 #ifdef DEBUG_tor
   fprintf(stderr, "FILTER GAUSS rect: %d,%d  %dx%d\n",
           rect.x, rect.y, rect.width, rect.height);
 #endif
 
   PRUint32 stride = aFilterResource->GetDataStride();
 
-  if (aDX & 1) {
-    // odd
-    nsAutoArrayPtr<PRUint8> prediv(SetupPredivide(2 * (aDX / 2) + 1));
-    if (!prediv)
-      return;
-
-    BoxBlurH(aInput, tmp,  stride, rect, aDX/2, aDX/2, prediv);
-    BoxBlurH(tmp, aOutput, stride, rect, aDX/2, aDX/2, prediv);
-    BoxBlurH(aOutput, tmp, stride, rect, aDX/2, aDX/2, prediv);
-  } else {
-    // even
-    if (aDX == 0) {
-      aFilterResource->CopyImageSubregion(tmp, aInput);
-    } else {
-      nsAutoArrayPtr<PRUint8> prediv(SetupPredivide(2 * (aDX / 2) + 1));
-      nsAutoArrayPtr<PRUint8> prediv2(SetupPredivide(2 * (aDX / 2)));
-      if (!prediv || !prediv2)
-        return;
-
-      BoxBlurH(aInput, tmp,  stride, rect, aDX/2,     aDX/2 - 1, prediv2);
-      BoxBlurH(tmp, aOutput, stride, rect, aDX/2 - 1, aDX/2, prediv2);
-      BoxBlurH(aOutput, tmp, stride, rect, aDX/2,     aDX/2, prediv);
-    }
-  }
-
-  if (aDY & 1) {
-    // odd
-    nsAutoArrayPtr<PRUint8> prediv(SetupPredivide(2 * (aDY / 2) + 1));
-    if (!prediv)
-      return;
-
-    BoxBlurV(tmp, aOutput, stride, rect, aDY/2, aDY/2, prediv);
-    BoxBlurV(aOutput, tmp, stride, rect, aDY/2, aDY/2, prediv);
-    BoxBlurV(tmp, aOutput, stride, rect, aDY/2, aDY/2, prediv);
-  } else {
-    // even
-    if (aDY == 0) {
-      aFilterResource->CopyImageSubregion(aOutput, tmp);
-    } else {
-      nsAutoArrayPtr<PRUint8> prediv(SetupPredivide(2 * (aDY / 2) + 1));
-      nsAutoArrayPtr<PRUint8> prediv2(SetupPredivide(2 * (aDY / 2)));
-      if (!prediv || !prediv2)
-        return;
-
-      BoxBlurV(tmp, aOutput, stride, rect, aDY/2,     aDY/2 - 1, prediv2);
-      BoxBlurV(aOutput, tmp, stride, rect, aDY/2 - 1, aDY/2, prediv2);
-      BoxBlurV(tmp, aOutput, stride, rect, aDY/2,     aDY/2, prediv);
+  if (aDX == 0) {
+    aFilterResource->CopyImageSubregion(tmp, aInput);
+  } else {
+    PRInt32 longLobe = aDX/2;
+    PRInt32 shortLobe = (aDX & 1) ? longLobe : longLobe - 1;
+    for (PRInt32 major = rect.y; major < rect.YMost(); ++major) {
+      PRInt32 ms = major*stride;
+      BoxBlur(aInput + ms, tmp + ms, 4, rect.x, rect.XMost(), longLobe, shortLobe);
+      BoxBlur(tmp + ms, aOutput + ms, 4, rect.x, rect.XMost(), shortLobe, longLobe);
+      BoxBlur(aOutput + ms, tmp + ms, 4, rect.x, rect.XMost(), longLobe, longLobe);
+    }
+  }
+
+  if (aDY == 0) {
+    aFilterResource->CopyImageSubregion(aOutput, tmp);
+  } else {
+    PRInt32 longLobe = aDY/2;
+    PRInt32 shortLobe = (aDY & 1) ? longLobe : longLobe - 1;
+    for (PRInt32 major = rect.x; major < rect.XMost(); ++major) {
+      PRInt32 ms = major*4;
+      BoxBlur(tmp + ms, aOutput + ms, stride, rect.y, rect.YMost(), longLobe, shortLobe);
+      BoxBlur(aOutput + ms, tmp + ms, stride, rect.y, rect.YMost(), shortLobe, longLobe);
+      BoxBlur(tmp + ms, aOutput + ms, stride, rect.y, rect.YMost(), longLobe, longLobe);
     }
   }
 }
 
 nsresult
 nsSVGFEGaussianBlurElement::Filter(nsSVGFilterInstance *instance)
 {
   nsresult rv;
@@ -3105,19 +3062,16 @@ public:
   // Turbulence
   NS_DECL_NSIDOMSVGFETURBULENCEELEMENT
 
   NS_FORWARD_NSIDOMSVGELEMENT(nsSVGFETurbulenceElementBase::)
 
   NS_FORWARD_NSIDOMNODE(nsSVGFETurbulenceElementBase::)
   NS_FORWARD_NSIDOMELEMENT(nsSVGFETurbulenceElementBase::)
 
-  virtual PRBool ParseAttribute(PRInt32 aNameSpaceID, nsIAtom* aName,
-                                const nsAString& aValue,
-                                nsAttrValue& aResult);
   virtual nsresult Clone(nsINodeInfo *aNodeInfo, nsINode **aResult) const;
 
 protected:
   virtual NumberAttributesInfo GetNumberInfo();
   virtual IntegerAttributesInfo GetIntegerInfo();
   virtual EnumAttributesInfo GetEnumInfo();
   virtual StringAttributesInfo GetStringInfo();
 
@@ -3300,30 +3254,16 @@ NS_IMETHODIMP nsSVGFETurbulenceElement::
 {
   return mEnumAttributes[STITCHTILES].ToDOMAnimatedEnum(aStitch, this);
 }
 
 /* readonly attribute nsIDOMSVGAnimatedEnumeration type; */
 NS_IMETHODIMP nsSVGFETurbulenceElement::GetType(nsIDOMSVGAnimatedEnumeration * *aType)
 {
   return mEnumAttributes[TYPE].ToDOMAnimatedEnum(aType, this);
-}
-
-PRBool
-nsSVGFETurbulenceElement::ParseAttribute(PRInt32 aNameSpaceID, nsIAtom* aName,
-                                         const nsAString& aValue,
-                                         nsAttrValue& aResult)
-{
-  if (aName == nsGkAtoms::baseFrequency && aNameSpaceID == kNameSpaceID_None) {
-    return ParseNumberOptionalNumber(aName, aValue,
-                                     BASE_FREQ_X, BASE_FREQ_Y,
-                                     aResult);
-  }
-  return nsSVGFETurbulenceElementBase::ParseAttribute(aNameSpaceID, aName,
-                                                      aValue, aResult);
 }
 
 nsresult
 nsSVGFETurbulenceElement::Filter(nsSVGFilterInstance *instance)
 {
   nsresult rv;
   PRUint8 *targetData;
   nsSVGFilterResource fr(this, instance);
@@ -3633,19 +3573,16 @@ public:
   // Morphology
   NS_DECL_NSIDOMSVGFEMORPHOLOGYELEMENT
 
   NS_FORWARD_NSIDOMSVGELEMENT(nsSVGFEMorphologyElementBase::)
 
   NS_FORWARD_NSIDOMNODE(nsSVGFEMorphologyElementBase::)
   NS_FORWARD_NSIDOMELEMENT(nsSVGFEMorphologyElementBase::)
 
-  virtual PRBool ParseAttribute(PRInt32 aNameSpaceID, nsIAtom* aName,
-                                const nsAString& aValue,
-                                nsAttrValue& aResult);
   virtual nsresult Clone(nsINodeInfo *aNodeInfo, nsINode **aResult) const;
 
 protected:
   void GetRXY(PRInt32 *aRX, PRInt32 *aRY, const nsSVGFilterInstance& aInstance);
   void InflateRect(nsRect* aRect, const nsSVGFilterInstance& aInstance);
 
   virtual NumberAttributesInfo GetNumberInfo();
   virtual EnumAttributesInfo GetEnumInfo();
@@ -3744,30 +3681,16 @@ NS_IMETHODIMP nsSVGFEMorphologyElement::
 
 NS_IMETHODIMP
 nsSVGFEMorphologyElement::SetRadius(float rx, float ry)
 {
   NS_ENSURE_FINITE2(rx, ry, NS_ERROR_ILLEGAL_VALUE);
   mNumberAttributes[RADIUS_X].SetBaseValue(rx, this, PR_TRUE);
   mNumberAttributes[RADIUS_Y].SetBaseValue(ry, this, PR_TRUE);
   return NS_OK;
-}
-
-PRBool
-nsSVGFEMorphologyElement::ParseAttribute(PRInt32 aNameSpaceID, nsIAtom* aName,
-                                         const nsAString& aValue,
-                                         nsAttrValue& aResult)
-{
-  if (aName == nsGkAtoms::radius && aNameSpaceID == kNameSpaceID_None) {
-    return ParseNumberOptionalNumber(aName, aValue,
-                                     RADIUS_X, RADIUS_Y,
-                                     aResult);
-  }
-  return nsSVGFEMorphologyElementBase::ParseAttribute(aNameSpaceID, aName,
-                                                      aValue, aResult);
 }
 
 void
 nsSVGFEMorphologyElement::GetSourceImageNames(nsTArray<nsSVGString*>* aSources)
 {
   aSources->AppendElement(&mStringAttributes[IN1]);
 }
 
@@ -3967,19 +3890,16 @@ public:
   // Color Matrix
   NS_DECL_NSIDOMSVGFECONVOLVEMATRIXELEMENT
 
   NS_FORWARD_NSIDOMSVGELEMENT(nsSVGFEConvolveMatrixElementBase::)
 
   NS_FORWARD_NSIDOMNODE(nsSVGFEConvolveMatrixElementBase::)
   NS_FORWARD_NSIDOMELEMENT(nsSVGFEConvolveMatrixElementBase::)
 
-  virtual PRBool ParseAttribute(PRInt32 aNameSpaceID, nsIAtom* aName,
-                                const nsAString& aValue,
-                                nsAttrValue& aResult);
   virtual nsresult Clone(nsINodeInfo *aNodeInfo, nsINode **aResult) const;
 
 protected:
   virtual PRBool OperatesOnPremultipledAlpha() {
     return !mBooleanAttributes[PRESERVEALPHA].GetAnimValue();
   }
 
   virtual NumberAttributesInfo GetNumberInfo();
@@ -4190,38 +4110,16 @@ nsSVGFEConvolveMatrixElement::ComputeTar
 
 void
 nsSVGFEConvolveMatrixElement::ComputeNeededSourceBBoxes(const nsRect& aTargetBBox,
           nsTArray<nsRect>& aSourceBBoxes, const nsSVGFilterInstance& aInstance)
 {
   // XXX Precise results are possible but we're going to skip that work
   // for now. Do nothing, which means the needed-box remains the
   // source's output bounding box.
-}
-
-PRBool
-nsSVGFEConvolveMatrixElement::ParseAttribute(PRInt32 aNameSpaceID, nsIAtom* aName,
-                                             const nsAString& aValue,
-                                             nsAttrValue& aResult)
-{
-  if (aNameSpaceID == kNameSpaceID_None) {
-    if (aName == nsGkAtoms::order) {
-      return ParseIntegerOptionalInteger(aName, aValue,
-                                         ORDER_X, ORDER_Y,
-                                         aResult);
-    }
-    if (aName == nsGkAtoms::kernelUnitLength) {
-      return ParseNumberOptionalNumber(aName, aValue,
-                                       KERNEL_UNIT_LENGTH_X, KERNEL_UNIT_LENGTH_Y,
-                                       aResult);
-    }
-  }
-
-  return nsSVGFEConvolveMatrixElementBase::ParseAttribute(aNameSpaceID, aName,
-                                                          aValue, aResult);
 }
 
 static PRInt32 BoundInterval(PRInt32 aVal, PRInt32 aMax)
 {
   aVal = PR_MAX(aVal, 0);
   return PR_MIN(aVal, aMax - 1);
 }
 
@@ -4765,19 +4663,16 @@ public:
           nsTArray<nsRect>& aSourceBBoxes, const nsSVGFilterInstance& aInstance);
 
   NS_FORWARD_NSIDOMSVGELEMENT(nsSVGFELightingElementBase::)
   NS_FORWARD_NSIDOMNODE(nsSVGFELightingElementBase::)
   NS_FORWARD_NSIDOMELEMENT(nsSVGFELightingElementBase::)
 
   NS_IMETHOD_(PRBool) IsAttributeMapped(const nsIAtom* aAttribute) const;
 
-  virtual PRBool ParseAttribute(PRInt32 aNameSpaceID, nsIAtom* aName,
-                                const nsAString& aValue,
-                                nsAttrValue& aResult);
 protected:
   virtual void
   LightPixel(const float *N, const float *L,
              nscolor color, PRUint8 *targetData) = 0;
 
   virtual NumberAttributesInfo GetNumberInfo();
   virtual StringAttributesInfo GetStringInfo();
 
@@ -4823,31 +4718,16 @@ nsSVGFELightingElement::IsAttributeMappe
 nsSVGFELightingElement::IsAttributeMapped(const nsIAtom* name) const
 {
   static const MappedAttributeEntry* const map[] = {
     sLightingEffectsMap
   };
 
   return FindAttributeDependence(name, map, NS_ARRAY_LENGTH(map)) ||
     nsSVGFELightingElementBase::IsAttributeMapped(name);
-}
-
-PRBool
-nsSVGFELightingElement::ParseAttribute(PRInt32 aNameSpaceID, nsIAtom* aName,
-                                       const nsAString& aValue,
-                                       nsAttrValue& aResult)
-{
-  if (aName == nsGkAtoms::kernelUnitLength && aNameSpaceID == kNameSpaceID_None) {
-    return ParseNumberOptionalNumber(aName, aValue,
-                                     KERNEL_UNIT_LENGTH_X, KERNEL_UNIT_LENGTH_Y,
-                                     aResult);
-
-  }
-  return nsSVGFELightingElementBase::ParseAttribute(aNameSpaceID, aName,
-                                                    aValue, aResult);
 }
 
 void
 nsSVGFELightingElement::GetSourceImageNames(nsTArray<nsSVGString*>* aSources)
 {
   aSources->AppendElement(&mStringAttributes[IN1]);
 }
 
diff --git a/content/svg/content/src/nsSVGUseElement.cpp b/content/svg/content/src/nsSVGUseElement.cpp
--- a/content/svg/content/src/nsSVGUseElement.cpp
+++ b/content/svg/content/src/nsSVGUseElement.cpp
@@ -65,23 +65,23 @@ NS_IMPL_NS_NEW_SVG_ELEMENT(Use)
 // nsISupports methods
 
 NS_IMPL_CYCLE_COLLECTION_CLASS(nsSVGUseElement)
 NS_IMPL_CYCLE_COLLECTION_UNLINK_BEGIN_INHERITED(nsSVGUseElement,
                                                 nsSVGUseElementBase)
   nsAutoScriptBlocker scriptBlocker;
   NS_IMPL_CYCLE_COLLECTION_UNLINK_NSCOMPTR(mOriginal)
   tmp->DestroyAnonymousContent();
-  tmp->RemoveListener();
+  tmp->UnlinkSource();
 NS_IMPL_CYCLE_COLLECTION_UNLINK_END
 NS_IMPL_CYCLE_COLLECTION_TRAVERSE_BEGIN_INHERITED(nsSVGUseElement,
                                                   nsSVGUseElementBase)
   NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMPTR(mOriginal)
   NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMPTR(mClone)
-  NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMPTR(mSourceContent)
+  tmp->mSource.Traverse(&cb);
 NS_IMPL_CYCLE_COLLECTION_TRAVERSE_END
 
 NS_IMPL_ADDREF_INHERITED(nsSVGUseElement,nsSVGUseElementBase)
 NS_IMPL_RELEASE_INHERITED(nsSVGUseElement,nsSVGUseElementBase)
 
 NS_INTERFACE_MAP_BEGIN_CYCLE_COLLECTION_INHERITED(nsSVGUseElement)
   NS_INTERFACE_MAP_ENTRY(nsIDOMNode)
   NS_INTERFACE_MAP_ENTRY(nsIDOMElement)
@@ -94,23 +94,23 @@ NS_INTERFACE_MAP_BEGIN_CYCLE_COLLECTION_
     foundInterface = reinterpret_cast<nsISupports*>(this);
   else
 NS_INTERFACE_MAP_END_INHERITING(nsSVGUseElementBase)
 
 //----------------------------------------------------------------------
 // Implementation
 
 nsSVGUseElement::nsSVGUseElement(nsINodeInfo *aNodeInfo)
-  : nsSVGUseElementBase(aNodeInfo)
+  : nsSVGUseElementBase(aNodeInfo), mSource(this)
 {
 }
 
 nsSVGUseElement::~nsSVGUseElement()
 {
-  RemoveListener();
+  UnlinkSource();
 }
 
 //----------------------------------------------------------------------
 // nsIDOMNode methods
 
 nsresult
 nsSVGUseElement::Clone(nsINodeInfo *aNodeInfo, nsINode **aResult) const
 {
@@ -227,41 +227,39 @@ nsSVGUseElement::ContentRemoved(nsIDocum
   if (nsContentUtils::IsInSameAnonymousTree(this, aChild)) {
     TriggerReclone();
   }
 }
 
 void
 nsSVGUseElement::NodeWillBeDestroyed(const nsINode *aNode)
 {
-  RemoveListener();
+  UnlinkSource();
 }
 
 //----------------------------------------------------------------------
 
 nsIContent*
 nsSVGUseElement::CreateAnonymousContent()
 {
 #ifdef DEBUG_tor
   const nsString &href = mStringAttributes[HREF].GetAnimValue();
   fprintf(stderr, "<svg:use> reclone of \"%s\"\n", ToNewCString(href));
 #endif
 
   mClone = nsnull;
 
-  nsCOMPtr<nsIContent> targetContent = LookupHref();
+  if (mSource.get()) {
+    mSource.get()->RemoveMutationObserver(this);
+  }
 
+  LookupHref();
+  nsIContent* targetContent = mSource.get();
   if (!targetContent)
     return nsnull;
-
-  PRBool needAddObserver = PR_FALSE;
-  if (mSourceContent != targetContent) {
-    RemoveListener();
-    needAddObserver = PR_TRUE;
-  }
 
   // make sure target is valid type for <use>
   // QIable nsSVGGraphicsElement would eliminate enumerating all elements
   nsIAtom *tag = targetContent->Tag();
   if (tag != nsGkAtoms::svg &&
       tag != nsGkAtoms::symbol &&
       tag != nsGkAtoms::g &&
       tag != nsGkAtoms::path &&
@@ -372,20 +370,17 @@ nsSVGUseElement::CreateAnonymousContent(
 
     if (HasAttr(kNameSpaceID_None, nsGkAtoms::height)) {
       nsAutoString height;
       GetAttr(kNameSpaceID_None, nsGkAtoms::height, height);
       newcontent->SetAttr(kNameSpaceID_None, nsGkAtoms::height, height, PR_FALSE);
     }
   }
 
-  if (needAddObserver) {
-    targetContent->AddMutationObserver(this);
-  }
-  mSourceContent = targetContent;
+  targetContent->AddMutationObserver(this);
   mClone = newcontent;
   return mClone;
 }
 
 void
 nsSVGUseElement::DestroyAnonymousContent()
 {
   nsContentUtils::DestroyAnonymousContent(&mClone);
@@ -410,47 +405,47 @@ nsSVGUseElement::SyncWidthHeight(PRUint8
         nsAutoString height;
         GetAttr(kNameSpaceID_None, nsGkAtoms::height, height);
         mClone->SetAttr(kNameSpaceID_None, nsGkAtoms::height, height, PR_FALSE);
       }
     }
   }
 }
 
-nsIContent *
+void
 nsSVGUseElement::LookupHref()
 {
   const nsString &href = mStringAttributes[HREF].GetAnimValue();
   if (href.IsEmpty())
-    return nsnull;
+    return;
 
   nsCOMPtr<nsIURI> targetURI, baseURI = GetBaseURI();
   nsContentUtils::NewURIWithDocumentCharset(getter_AddRefs(targetURI), href,
                                             GetCurrentDoc(), baseURI);
 
-  return nsContentUtils::GetReferencedElement(targetURI, this);
+  mSource.Reset(this, targetURI);
 }
 
 void
 nsSVGUseElement::TriggerReclone()
 {
   nsIDocument *doc = GetCurrentDoc();
   if (!doc) return;
   nsIPresShell *presShell = doc->GetPrimaryShell();
   if (!presShell) return;
-  presShell->RecreateFramesFor(this);
+  presShell->PostRecreateFramesFor(this);
 }
 
 void
-nsSVGUseElement::RemoveListener()
+nsSVGUseElement::UnlinkSource()
 {
-  if (mSourceContent) {
-    mSourceContent->RemoveMutationObserver(this);
-    mSourceContent = nsnull;
+  if (mSource.get()) {
+    mSource.get()->RemoveMutationObserver(this);
   }
+  mSource.Unlink();
 }
 
 //----------------------------------------------------------------------
 // nsSVGElement methods
 
 void
 nsSVGUseElement::DidChangeLength(PRUint8 aAttrEnum, PRBool aDoSetAttr)
 {
diff --git a/content/svg/content/src/nsSVGUseElement.h b/content/svg/content/src/nsSVGUseElement.h
--- a/content/svg/content/src/nsSVGUseElement.h
+++ b/content/svg/content/src/nsSVGUseElement.h
@@ -40,22 +40,24 @@
 #include "nsIDOMSVGAnimatedString.h"
 #include "nsIDOMSVGURIReference.h"
 #include "nsIDOMSVGUseElement.h"
 #include "nsStubMutationObserver.h"
 #include "nsSVGGraphicElement.h"
 #include "nsSVGLength2.h"
 #include "nsSVGString.h"
 #include "nsTArray.h"
+#include "nsReferencedElement.h"
 
 class nsIContent;
 class nsINodeInfo;
 
 #define NS_SVG_USE_ELEMENT_IMPL_CID \
-{ 0xa95c13d3, 0xc193, 0x465f, {0x81, 0xf0, 0x02, 0x6d, 0x67, 0x05, 0x54, 0x58 } }
+{ 0x55fb86fe, 0xd81f, 0x4ae4, \
+  { 0x80, 0x3f, 0xeb, 0x90, 0xfe, 0xe0, 0x7a, 0xe9 } }
 
 nsresult
 NS_NewSVGSVGElement(nsIContent **aResult, nsINodeInfo *aNodeInfo);
 
 typedef nsSVGGraphicElement nsSVGUseElementBase;
 
 class nsSVGUseElement : public nsSVGUseElementBase,
                         public nsIDOMSVGURIReference,
@@ -99,33 +101,44 @@ public:
   virtual void DidChangeLength(PRUint8 aAttrEnum, PRBool aDoSetAttr);
   virtual void DidChangeString(PRUint8 aAttrEnum, PRBool aDoSetAttr);
 
   // nsIContent interface
   virtual nsresult Clone(nsINodeInfo *aNodeInfo, nsINode **aResult) const;
   NS_IMETHOD_(PRBool) IsAttributeMapped(const nsIAtom* aAttribute) const;
 
 protected:
+  class SourceReference : public nsReferencedElement {
+  public:
+    SourceReference(nsSVGUseElement* aContainer) : mContainer(aContainer) {}
+  protected:
+    virtual void ContentChanged(nsIContent* aFrom, nsIContent* aTo) {
+      nsReferencedElement::ContentChanged(aFrom, aTo);
+      mContainer->TriggerReclone();
+    }
+  private:
+    nsSVGUseElement* mContainer;
+  };
 
   virtual LengthAttributesInfo GetLengthInfo();
   virtual StringAttributesInfo GetStringInfo();
 
   void SyncWidthHeight(PRUint8 aAttrEnum);
-  nsIContent *LookupHref();
+  void LookupHref();
   void TriggerReclone();
-  void RemoveListener();
+  void UnlinkSource();
 
   enum { X, Y, WIDTH, HEIGHT };
   nsSVGLength2 mLengthAttributes[4];
   static LengthInfo sLengthInfo[4];
 
   enum { HREF };
   nsSVGString mStringAttributes[1];
   static StringInfo sStringInfo[1];
 
   nsCOMPtr<nsIContent> mOriginal; // if we've been cloned, our "real" copy
   nsCOMPtr<nsIContent> mClone;    // cloned tree
-  nsCOMPtr<nsIContent> mSourceContent;  // observed element
+  SourceReference      mSource;   // observed element
 };
 
 NS_DEFINE_STATIC_IID_ACCESSOR(nsSVGUseElement, NS_SVG_USE_ELEMENT_IMPL_CID)
 
 #endif
diff --git a/content/xml/document/src/nsXMLDocument.cpp b/content/xml/document/src/nsXMLDocument.cpp
--- a/content/xml/document/src/nsXMLDocument.cpp
+++ b/content/xml/document/src/nsXMLDocument.cpp
@@ -558,46 +558,16 @@ NS_IMETHODIMP
 NS_IMETHODIMP    
 nsXMLDocument::CloneNode(PRBool aDeep, nsIDOMNode** aReturn)
 {
   return nsNodeUtils::CloneNodeImpl(this, aDeep, aReturn);
 }
  
 // nsIDOMDocument interface
 
-NS_IMETHODIMP
-nsXMLDocument::GetElementById(const nsAString& aElementId,
-                              nsIDOMElement** aReturn)
-{
-  NS_ENSURE_ARG_POINTER(aReturn);
-  *aReturn = nsnull;
-
-  if (!CheckGetElementByIdArg(aElementId))
-    return NS_OK;
-
-  // If we tried to load a document and something went wrong, we might not have
-  // root content. This can happen when you do document.load() and the document
-  // to load is not XML, for example.
-  nsIContent* root = GetRootContent();
-  if (!root)
-    return NS_OK;
-
-  // XXX For now, we do a brute force search of the content tree.
-  // We should come up with a more efficient solution.
-  // Note that content is *not* refcounted here, so do *not* release it!
-  nsIContent *content =
-    nsContentUtils::MatchElementId(root, aElementId);
-
-  if (!content) {
-    return NS_OK;
-  }
-
-  return CallQueryInterface(content, aReturn);
-}
-
 nsresult
 nsXMLDocument::Clone(nsINodeInfo *aNodeInfo, nsINode **aResult) const
 {
   NS_ASSERTION(aNodeInfo->NodeInfoManager() == mNodeInfoManager,
                "Can't import this document into another document!");
 
   PRBool hasHadScriptObject = PR_TRUE;
   nsIScriptGlobalObject* scriptObject =
diff --git a/content/xml/document/src/nsXMLDocument.h b/content/xml/document/src/nsXMLDocument.h
--- a/content/xml/document/src/nsXMLDocument.h
+++ b/content/xml/document/src/nsXMLDocument.h
@@ -73,20 +73,16 @@ public:
                                      PRBool aReset = PR_TRUE,
                                      nsIContentSink* aSink = nsnull);
 
   virtual void EndLoad();
 
   // nsIDOMNode interface
   NS_IMETHOD CloneNode(PRBool aDeep, nsIDOMNode** aReturn);
 
-  // nsIDOMDocument interface
-  NS_IMETHOD GetElementById(const nsAString& aElementId,
-                            nsIDOMElement** aReturn);
-
   // nsIInterfaceRequestor
   NS_DECL_NSIINTERFACEREQUESTOR
 
   // nsIHTTPEventSink
   NS_DECL_NSICHANNELEVENTSINK
 
   // nsIDOMXMLDocument
   NS_DECL_NSIDOMXMLDOCUMENT
diff --git a/content/xul/document/public/nsIXULDocument.h b/content/xul/document/public/nsIXULDocument.h
--- a/content/xul/document/public/nsIXULDocument.h
+++ b/content/xul/document/public/nsIXULDocument.h
@@ -42,20 +42,20 @@
 #include "nsString.h"
 #include "nsCOMArray.h"
 
 class nsIXULTemplateBuilder;
 class nsIContent;
 class nsIScriptGlobalObjectOwner;
 
 
-// {57314526-f749-4cf0-b6b6-3723eba21480}
+// {AF676EDD-1FB9-4C75-9B1F-CB4E02E1C779}
 #define NS_IXULDOCUMENT_IID \
-{ 0x57314526, 0xf749, 0x4cf0, \
-  { 0xb6, 0xb6, 0x37, 0x23, 0xeb, 0xa2, 0x14, 0x80 } }
+{ 0xaf676edd, 0x1fb9, 0x4c75, \
+  { 0x9b, 0x1f, 0xcb, 0x4e, 0x02, 0xe1, 0xc7, 0x79 } }
 
 
 /*
  * An XUL-specific extension to nsIDocument. Includes methods for
  * setting the root resource of the document content model, a factory
  * method for constructing the children of a node, etc.
  */
 class nsIXULDocument : public nsISupports
@@ -64,26 +64,21 @@ public:
   NS_DECLARE_STATIC_IID_ACCESSOR(NS_IXULDOCUMENT_IID)
 
   // The resource-to-element map is a one-to-many mapping of RDF
   // resources to content elements.
 
   /**
    * Add an entry to the ID-to-element map.
    */
-  NS_IMETHOD AddElementForID(const nsAString& aID, nsIContent* aElement) = 0;
+  NS_IMETHOD AddElementForID(nsIContent* aElement) = 0;
 
   /**
-   * Remove an entry from the ID-to-element map.
-   */
-  NS_IMETHOD RemoveElementForID(const nsAString& aID, nsIContent* aElement) = 0;
-
-  /**
-   * Get the elements for a particular resource in the resource-to-element
-   * map. The nsCOMArray will be truncated and filled in with
+   * Get the elements for a particular resource --- all elements whose 'id'
+   * or 'ref' is aID. The nsCOMArray will be truncated and filled in with
    * nsIContent pointers.
    */
   NS_IMETHOD GetElementsForID(const nsAString& aID, nsCOMArray<nsIContent>& aElements) = 0;
 
   /**
    * Get the nsIScriptGlobalObjectOwner for this document.
    */
   NS_IMETHOD GetScriptGlobalObjectOwner(nsIScriptGlobalObjectOwner** aGlobalOwner) = 0;
diff --git a/content/xul/document/src/Makefile.in b/content/xul/document/src/Makefile.in
--- a/content/xul/document/src/Makefile.in
+++ b/content/xul/document/src/Makefile.in
@@ -72,17 +72,16 @@ REQUIRES	= xpcom \
 		  appshell \
 		  util \
 		  $(NULL)
 
 CPPSRCS		= nsXULControllers.cpp
 
 ifdef MOZ_XUL
 CPPSRCS		+= \
-		nsElementMap.cpp \
 		nsXULCommandDispatcher.cpp \
 		nsXULContentSink.cpp \
 		nsXULDocument.cpp \
 		nsXULPrototypeCache.cpp \
 		nsXULPrototypeDocument.cpp \
 		$(NULL)
 endif
 
diff --git a/content/xul/document/src/nsElementMap.cpp b/content/xul/document/src/nsElementMap.cpp
deleted file mode 100644
--- a/content/xul/document/src/nsElementMap.cpp
+++ /dev/null
@@ -1,431 +0,0 @@
-/* -*- Mode: C++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
-/* ***** BEGIN LICENSE BLOCK *****
- * Version: MPL 1.1/GPL 2.0/LGPL 2.1
- *
- * The contents of this file are subject to the Mozilla Public License Version
- * 1.1 (the "License"); you may not use this file except in compliance with
- * the License. You may obtain a copy of the License at
- * http://www.mozilla.org/MPL/
- *
- * Software distributed under the License is distributed on an "AS IS" basis,
- * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
- * for the specific language governing rights and limitations under the
- * License.
- *
- * The Original Code is Mozilla Communicator client code.
- *
- * The Initial Developer of the Original Code is
- * Netscape Communications Corporation.
- * Portions created by the Initial Developer are Copyright (C) 1998
- * the Initial Developer. All Rights Reserved.
- *
- * Contributor(s):
- *   Chris Waterson <waterson@netscape.com>
- *
- * Alternatively, the contents of this file may be used under the terms of
- * either of the GNU General Public License Version 2 or later (the "GPL"),
- * or the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
- * in which case the provisions of the GPL or the LGPL are applicable instead
- * of those above. If you wish to allow use of your version of this file only
- * under the terms of either the GPL or the LGPL, and not to allow others to
- * use your version of this file under the terms of the MPL, indicate your
- * decision by deleting the provisions above and replace them with the notice
- * and other provisions required by the GPL or the LGPL. If you do not delete
- * the provisions above, a recipient may use your version of this file under
- * the terms of any one of the MPL, the GPL or the LGPL.
- *
- * ***** END LICENSE BLOCK ***** */
-
-/*
-
-   Maps IDs to elements.
-
-
-   To turn on logging for this module, set:
-
-     NS_PR_LOG_MODULES nsElementMap:5
-
- */
-
-#include "nsCOMPtr.h"
-#include "nsCRT.h"
-#include "nsElementMap.h"
-#include "nsString.h"
-#include "nsIAtom.h"
-#include "nsReadableUtils.h"
-#include "prlog.h"
-#include "prbit.h"
-
-#ifdef PR_LOGGING
-static PRLogModuleInfo* gMapLog;
-#endif
-
-static void* PR_CALLBACK AllocTable(void* aPool, PRSize aSize)
-{
-    return new char[aSize];
-}
-
-static void PR_CALLBACK FreeTable(void* aPool, void* aItem)
-{
-    delete[] static_cast<char*>(aItem);
-}
-
-static PLHashEntry* PR_CALLBACK AllocEntry(void* aPool, const void* aKey)
-{
-    nsFixedSizeAllocator* pool = static_cast<nsFixedSizeAllocator*>(aPool);
-    PLHashEntry* entry = static_cast<PLHashEntry*>(pool->Alloc(sizeof(PLHashEntry)));
-    return entry;
-}
-
-static void PR_CALLBACK FreeEntry(void* aPool, PLHashEntry* aEntry, PRUintn aFlag) 
-{
-    nsFixedSizeAllocator* pool = static_cast<nsFixedSizeAllocator*>(aPool);
-    if (aFlag == HT_FREE_ENTRY)
-        pool->Free(aEntry, sizeof(PLHashEntry));
-}
-
-PLHashAllocOps nsElementMap::gAllocOps = {
-    AllocTable, FreeTable, AllocEntry, FreeEntry };
-
-
-nsElementMap::nsElementMap()
-{
-    MOZ_COUNT_CTOR(nsElementMap);
-
-    // Create a table for mapping IDs to elements in the content tree.
-    static const size_t kBucketSizes[] = {
-        sizeof(PLHashEntry), sizeof(ContentListItem)
-    };
-
-    static const PRInt32 kNumBuckets = sizeof(kBucketSizes) / sizeof(size_t);
-
-    static const PRInt32 kInitialNumElements = 64;
-
-    // Per news://news.mozilla.org/39BEC105.5090206%40netscape.com
-    static const PRInt32 kInitialPoolSize = 512;
-
-    mPool.Init("nsElementMap", kBucketSizes, kNumBuckets, kInitialPoolSize);
-
-    mMap = PL_NewHashTable(kInitialNumElements,
-                           Hash,
-                           Compare,
-                           PL_CompareValues,
-                           &gAllocOps,
-                           &mPool);
-
-    NS_ASSERTION(mMap != nsnull, "could not create hash table for resources");
-
-#ifdef PR_LOGGING
-    if (! gMapLog)
-        gMapLog = PR_NewLogModule("nsElementMap");
-
-
-    PR_LOG(gMapLog, PR_LOG_NOTICE,
-           ("xulelemap(%p) created", this));
-#endif
-}
-
-nsElementMap::~nsElementMap()
-{
-    MOZ_COUNT_DTOR(nsElementMap);
-
-    if (mMap) {
-        PL_HashTableEnumerateEntries(mMap, ReleaseContentList, this);
-        PL_HashTableDestroy(mMap);
-    }
-
-    PR_LOG(gMapLog, PR_LOG_NOTICE,
-           ("xulelemap(%p) destroyed", this));
-}
-
-
-PRIntn
-nsElementMap::ReleaseContentList(PLHashEntry* aHashEntry, PRIntn aIndex, void* aClosure)
-{
-    nsElementMap* self = static_cast<nsElementMap*>(aClosure);
-
-    PRUnichar* id =
-        reinterpret_cast<PRUnichar*>(const_cast<void*>(aHashEntry->key));
-
-    nsMemory::Free(id);
-        
-    ContentListItem* head =
-        reinterpret_cast<ContentListItem*>(aHashEntry->value);
-
-    while (head) {
-        ContentListItem* doomed = head;
-        head = head->mNext;
-        ContentListItem::Destroy(self->mPool, doomed);
-    }
-
-    return HT_ENUMERATE_NEXT;
-}
-
-
-nsresult
-nsElementMap::Add(const nsAString& aID, nsIContent* aContent)
-{
-    NS_PRECONDITION(mMap != nsnull, "not initialized");
-    if (! mMap)
-        return NS_ERROR_NOT_INITIALIZED;
-
-    const nsPromiseFlatString& flatID = PromiseFlatString(aID);
-    const PRUnichar *id = flatID.get();
-
-    ContentListItem* head =
-        static_cast<ContentListItem*>(PL_HashTableLookup(mMap, id));
-
-    if (! head) {
-        head = ContentListItem::Create(mPool, aContent);
-        if (! head)
-            return NS_ERROR_OUT_OF_MEMORY;
-
-        PRUnichar* key = ToNewUnicode(aID);
-        if (! key)
-            return NS_ERROR_OUT_OF_MEMORY;
-
-        PL_HashTableAdd(mMap, key, head);
-    }
-    else {
-        while (1) {
-            if (head->mContent.get() == aContent) {
-                // This can happen if an element that was created via
-                // frame construction code is then "appended" to the
-                // content model with aNotify == PR_TRUE. If you see
-                // this warning, it's an indication that you're
-                // unnecessarily notifying the frame system, and
-                // potentially causing unnecessary reflow.
-                //NS_ERROR("element was already in the map");
-#ifdef PR_LOGGING
-                if (PR_LOG_TEST(gMapLog, PR_LOG_NOTICE)) {
-                    const char *tagname;
-                    aContent->Tag()->GetUTF8String(&tagname);
-
-                    nsCAutoString aidC; 
-                    aidC.AssignWithConversion(id, aID.Length());
-                    PR_LOG(gMapLog, PR_LOG_NOTICE,
-                           ("xulelemap(%p) dup    %s[%p] <-- %s\n",
-                            this,
-                            tagname,
-                            aContent,
-                            aidC.get()));
-                }
-#endif
-
-                return NS_OK;
-            }
-            if (! head->mNext)
-                break;
-
-            head = head->mNext;
-        }
-
-        head->mNext = nsElementMap::ContentListItem::Create(mPool, aContent);
-        if (! head->mNext)
-            return NS_ERROR_OUT_OF_MEMORY;
-    }
-
-#ifdef PR_LOGGING
-    if (PR_LOG_TEST(gMapLog, PR_LOG_NOTICE)) {
-        const char *tagname;
-        aContent->Tag()->GetUTF8String(&tagname);
-
-        nsCAutoString aidC; 
-        aidC.AssignWithConversion(id, aID.Length());
-        PR_LOG(gMapLog, PR_LOG_NOTICE,
-               ("xulelemap(%p) add    %s[%p] <-- %s\n",
-                this,
-                tagname,
-                aContent,
-                aidC.get()));
-    }
-#endif
-
-    return NS_OK;
-}
-
-
-nsresult
-nsElementMap::Remove(const nsAString& aID, nsIContent* aContent)
-{
-    NS_PRECONDITION(mMap != nsnull, "not initialized");
-    if (! mMap)
-        return NS_ERROR_NOT_INITIALIZED;
-
-    const nsPromiseFlatString& flatID = PromiseFlatString(aID);
-    const PRUnichar *id = flatID.get();
-
-#ifdef PR_LOGGING
-    if (PR_LOG_TEST(gMapLog, PR_LOG_NOTICE)) {
-        const char *tagname;
-        aContent->Tag()->GetUTF8String(&tagname);
-
-        nsCAutoString aidC; 
-        aidC.AssignWithConversion(id);
-        PR_LOG(gMapLog, PR_LOG_NOTICE,
-               ("xulelemap(%p) remove  %s[%p] <-- %s\n",
-                this,
-                tagname,
-                aContent,
-                aidC.get()));
-    }
-#endif
-
-    PLHashEntry** hep = PL_HashTableRawLookup(mMap,
-                                              Hash(id),
-                                              id);
-
-    // XXX Don't comment out this assert: if you get here, something
-    // has gone dreadfully, horribly wrong. Curse. Scream. File a bug
-    // against waterson@netscape.com.
-    NS_ASSERTION(hep != nsnull && *hep != nsnull, "attempt to remove an element that was never added");
-    if (!hep || !*hep)
-        return NS_OK;
-
-    ContentListItem* head = reinterpret_cast<ContentListItem*>((*hep)->value);
-
-    if (head->mContent.get() == aContent) {
-        ContentListItem* next = head->mNext;
-        if (next) {
-            (*hep)->value = next;
-        }
-        else {
-            // It was the last reference in the table
-            PRUnichar* key = reinterpret_cast<PRUnichar*>(const_cast<void*>((*hep)->key));
-            PL_HashTableRawRemove(mMap, hep, *hep);
-            nsMemory::Free(key);
-        }
-        ContentListItem::Destroy(mPool, head);
-    }
-    else {
-        ContentListItem* item = head->mNext;
-        while (item) {
-            if (item->mContent.get() == aContent) {
-                head->mNext = item->mNext;
-                ContentListItem::Destroy(mPool, item);
-                break;
-            }
-            head = item;
-            item = item->mNext;
-        }
-    }
-
-    return NS_OK;
-}
-
-
-
-nsresult
-nsElementMap::Find(const nsAString& aID, nsCOMArray<nsIContent>& aResults)
-{
-    NS_PRECONDITION(mMap != nsnull, "not initialized");
-    if (! mMap)
-        return NS_ERROR_NOT_INITIALIZED;
-
-    aResults.Clear();
-    ContentListItem* item =
-        reinterpret_cast<ContentListItem*>(PL_HashTableLookup(mMap, (const PRUnichar *)PromiseFlatString(aID).get()));
-
-    while (item) {
-        aResults.AppendObject(item->mContent);
-        item = item->mNext;
-    }
-    return NS_OK;
-}
-
-
-nsresult
-nsElementMap::FindFirst(const nsAString& aID, nsIContent** aResult)
-{
-    NS_PRECONDITION(mMap != nsnull, "not initialized");
-    if (! mMap)
-        return NS_ERROR_NOT_INITIALIZED;
-
-    ContentListItem* item =
-        reinterpret_cast<ContentListItem*>(PL_HashTableLookup(mMap, (const PRUnichar *)PromiseFlatString(aID).get()));
-
-    if (item) {
-        *aResult = item->mContent;
-        NS_ADDREF(*aResult);
-    }
-    else {
-        *aResult = nsnull;
-    }
-
-    return NS_OK;
-}
-
-nsresult
-nsElementMap::Enumerate(nsElementMapEnumerator aEnumerator, void* aClosure)
-{
-    EnumerateClosure closure = { this, aEnumerator, aClosure };
-    PL_HashTableEnumerateEntries(mMap, EnumerateImpl, &closure);
-    return NS_OK;
-}
-
-
-PRIntn
-nsElementMap::EnumerateImpl(PLHashEntry* aHashEntry, PRIntn aIndex, void* aClosure)
-{
-    // This routine will be called once for each key in the
-    // hashtable. It will in turn call the enumerator that the user
-    // has passed in via Enumerate() once for each element that's been
-    // mapped to this ID.
-    EnumerateClosure* closure = reinterpret_cast<EnumerateClosure*>(aClosure);
-
-    const PRUnichar* id =
-        reinterpret_cast<const PRUnichar*>(aHashEntry->key);
-
-    // 'link' holds a pointer to the previous element's link field.
-    ContentListItem** link = 
-        reinterpret_cast<ContentListItem**>(&aHashEntry->value);
-
-    ContentListItem* item = *link;
-
-    // Iterate through each content node that's been mapped to this ID
-    while (item) {
-        ContentListItem* current = item;
-        item = item->mNext;
-        PRIntn result = (*closure->mEnumerator)(id, current->mContent, closure->mClosure);
-
-        if (result == HT_ENUMERATE_REMOVE) {
-            // If the user wants to remove the current, then deal.
-            *link = item;
-            ContentListItem::Destroy(closure->mSelf->mPool, current);
-
-            if ((! *link) && (link == reinterpret_cast<ContentListItem**>(&aHashEntry->value))) {
-                // It's the last content node that was mapped to this
-                // ID. Unhash it.
-                PRUnichar* key = const_cast<PRUnichar*>(id);
-                nsMemory::Free(key);
-                return HT_ENUMERATE_REMOVE;
-            }
-        }
-        else {
-            link = &current->mNext;
-        }
-    }
-
-    return HT_ENUMERATE_NEXT;
-}
-
-
-PLHashNumber
-nsElementMap::Hash(const void* aKey)
-{
-    PLHashNumber result = 0;
-    const PRUnichar* s = reinterpret_cast<const PRUnichar*>(aKey);
-    while (*s != nsnull) {
-        result = PR_ROTATE_LEFT32(result, 4) ^ *s;
-        ++s;
-    }
-    return result;
-}
-
-
-PRIntn
-nsElementMap::Compare(const void* aLeft, const void* aRight)
-{
-    return 0 == nsCRT::strcmp(reinterpret_cast<const PRUnichar*>(aLeft),
-                              reinterpret_cast<const PRUnichar*>(aRight));
-}
diff --git a/content/xul/document/src/nsElementMap.h b/content/xul/document/src/nsElementMap.h
deleted file mode 100644
--- a/content/xul/document/src/nsElementMap.h
+++ /dev/null
@@ -1,153 +0,0 @@
-/* -*- Mode: C++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
- *
- * ***** BEGIN LICENSE BLOCK *****
- * Version: MPL 1.1/GPL 2.0/LGPL 2.1
- *
- * The contents of this file are subject to the Mozilla Public License Version
- * 1.1 (the "License"); you may not use this file except in compliance with
- * the License. You may obtain a copy of the License at
- * http://www.mozilla.org/MPL/
- *
- * Software distributed under the License is distributed on an "AS IS" basis,
- * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
- * for the specific language governing rights and limitations under the
- * License.
- *
- * The Original Code is Mozilla Communicator client code.
- *
- * The Initial Developer of the Original Code is
- * Netscape Communications Corporation.
- * Portions created by the Initial Developer are Copyright (C) 1998
- * the Initial Developer. All Rights Reserved.
- *
- * Contributor(s):
- *
- * Alternatively, the contents of this file may be used under the terms of
- * either of the GNU General Public License Version 2 or later (the "GPL"),
- * or the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
- * in which case the provisions of the GPL or the LGPL are applicable instead
- * of those above. If you wish to allow use of your version of this file only
- * under the terms of either the GPL or the LGPL, and not to allow others to
- * use your version of this file under the terms of the MPL, indicate your
- * decision by deleting the provisions above and replace them with the notice
- * and other provisions required by the GPL or the LGPL. If you do not delete
- * the provisions above, a recipient may use your version of this file under
- * the terms of any one of the MPL, the GPL or the LGPL.
- *
- * ***** END LICENSE BLOCK *****
- *
- *
- * This Original Code has been modified by IBM Corporation.
- * Modifications made by IBM described herein are
- * Copyright (c) International Business Machines
- * Corporation, 2000
- *
- * Modifications to Mozilla code or documentation
- * identified per MPL Section 3.3
- *
- * Date         Modified by     Description of modification
- * 03/27/2000   IBM Corp.       Added PR_CALLBACK for Optlink
- *                               use in OS2
- */
-
-/*
-
-   Maintains one-to-many mapping between element IDs and content
-   nodes.
-
- */
-
-#ifndef nsElementMap_h__
-#define nsElementMap_h__
-
-#include "nscore.h"
-#include "nsError.h"
-#include "plhash.h"
-#include "nsIContent.h"
-#include "nsFixedSizeAllocator.h"
-#include "nsCOMArray.h"
-
-class nsString;
-
-class nsElementMap
-{
-protected:
-    PLHashTable* mMap;
-    nsFixedSizeAllocator mPool;
-
-    static PLHashAllocOps gAllocOps;
-
-    class ContentListItem {
-    public:
-        ContentListItem* mNext;
-        nsCOMPtr<nsIContent> mContent;
-
-        static ContentListItem*
-        Create(nsFixedSizeAllocator& aPool, nsIContent* aContent) {
-            void* bytes = aPool.Alloc(sizeof(ContentListItem));
-            return bytes ? new (bytes) ContentListItem(aContent) : nsnull; }
-
-        static void
-        Destroy(nsFixedSizeAllocator& aPool, ContentListItem* aItem) {
-            delete aItem;
-            aPool.Free(aItem, sizeof(*aItem)); }
-
-    protected:
-        static void* operator new(size_t aSize, void* aPtr) CPP_THROW_NEW {
-            return aPtr; }
-
-        static void operator delete(void* aPtr, size_t aSize) {
-            /* do nothing; memory free()'d in Destroy() */ }
-
-        ContentListItem(nsIContent* aContent) : mNext(nsnull), mContent(aContent) {
-            MOZ_COUNT_CTOR(nsElementMap::ContentListItem); }
-
-        ~ContentListItem() {
-            MOZ_COUNT_DTOR(nsElementMap::ContentListItem); }
-    };
-
-    static PLHashNumber PR_CALLBACK
-    Hash(const void* akey);
-
-    static PRIntn PR_CALLBACK
-    Compare(const void* aLeft, const void* aRight);
-
-    static PRIntn PR_CALLBACK
-    ReleaseContentList(PLHashEntry* aHashEntry, PRIntn aIndex, void* aClosure);
-
-public:
-    nsElementMap(void);
-    virtual ~nsElementMap();
-
-    nsresult
-    Add(const nsAString& aID, nsIContent* aContent);
-
-    nsresult
-    Remove(const nsAString& aID, nsIContent* aContent);
-
-    nsresult
-    Find(const nsAString& aID, nsCOMArray<nsIContent>& aResults);
-
-    nsresult
-    FindFirst(const nsAString& aID, nsIContent** aContent);
-
-    typedef PRIntn (*nsElementMapEnumerator)(const PRUnichar* aID,
-                                             nsIContent* aElement,
-                                             void* aClosure);
-
-    nsresult
-    Enumerate(nsElementMapEnumerator aEnumerator, void* aClosure);
-
-private:
-    struct EnumerateClosure {
-        nsElementMap*          mSelf;
-        nsElementMapEnumerator mEnumerator;
-        void*                  mClosure;
-    };
-        
-    static PRIntn PR_CALLBACK
-    EnumerateImpl(PLHashEntry* aHashEntry, PRIntn aIndex, void* aClosure);
-};
-
-
-#endif // nsElementMap_h__
diff --git a/content/xul/document/src/nsXULDocument.cpp b/content/xul/document/src/nsXULDocument.cpp
--- a/content/xul/document/src/nsXULDocument.cpp
+++ b/content/xul/document/src/nsXULDocument.cpp
@@ -50,20 +50,16 @@
   -----
 
   1. We do some monkey business in the document observer methods to`
      keep the element map in sync for HTML elements. Why don't we just
      do it for _all_ elements? Well, in the case of XUL elements,
      which may be lazily created during frame construction, the
      document observer methods will never be called because we'll be
      adding the XUL nodes into the content model "quietly".
-
-  2. The "element map" maps an RDF resource to the elements whose 'id'
-     or 'ref' attributes refer to that resource. We re-use the element
-     map to support the HTML-like 'getElementById()' method.
 
 */
 
 // Note the ALPHABETICAL ORDERING
 #include "nsXULDocument.h"
 
 #include "nsDOMError.h"
 #include "nsIBoxObject.h"
@@ -180,16 +176,45 @@ struct BroadcasterMapEntry : public PLDH
     nsSmallVoidArray mListeners;   // [OWNING] of BroadcastListener objects
 };
 
 struct BroadcastListener {
     nsWeakPtr mListener;
     nsCOMPtr<nsIAtom> mAttribute;
 };
 
+nsIContent*
+nsRefMapEntry::GetFirstContent()
+{
+    return static_cast<nsIContent*>(mRefContentList.SafeElementAt(0));
+}
+
+void
+nsRefMapEntry::AppendAll(nsCOMArray<nsIContent>* aElements)
+{
+    for (PRInt32 i = 0; i < mRefContentList.Count(); ++i) {
+        aElements->AppendObject(static_cast<nsIContent*>(mRefContentList[i]));
+    }
+}
+
+PRBool
+nsRefMapEntry::AddContent(nsIContent* aContent)
+{
+    if (mRefContentList.IndexOf(aContent) >= 0)
+        return PR_TRUE;
+    return mRefContentList.AppendElement(aContent);
+}
+
+PRBool
+nsRefMapEntry::RemoveContent(nsIContent* aContent)
+{
+    mRefContentList.RemoveElement(aContent);
+    return mRefContentList.Count() == 0;
+}
+
 //----------------------------------------------------------------------
 //
 // ctors & dtors
 //
 
     // NOTE! nsDocument::operator new() zeroes out all members, so
     // don't bother initializing members to 0.
 
@@ -285,27 +310,16 @@ NS_NewXULDocument(nsIXULDocument** resul
 
 //----------------------------------------------------------------------
 //
 // nsISupports interface
 //
 
 NS_IMPL_CYCLE_COLLECTION_CLASS(nsXULDocument)
 
-static PRIntn
-TraverseElement(const PRUnichar* aID, nsIContent* aElement, void* aContext)
-{
-    nsCycleCollectionTraversalCallback *cb =
-        static_cast<nsCycleCollectionTraversalCallback*>(aContext);
-
-    cb->NoteXPCOMChild(aElement);
-
-    return HT_ENUMERATE_NEXT;
-}
-
 static PLDHashOperator PR_CALLBACK
 TraverseTemplateBuilders(nsISupports* aKey, nsIXULTemplateBuilder* aData,
                          void* aContext)
 {
     nsCycleCollectionTraversalCallback *cb =
         static_cast<nsCycleCollectionTraversalCallback*>(aContext);
 
     cb->NoteXPCOMChild(aKey);
@@ -323,18 +337,16 @@ TraverseObservers(nsIURI* aKey, nsIObser
     cb->NoteXPCOMChild(aData);
 
     return PL_DHASH_NEXT;
 }
 
 NS_IMPL_CYCLE_COLLECTION_TRAVERSE_BEGIN_INHERITED(nsXULDocument, nsXMLDocument)
     // XXX tmp->mForwardReferences?
     // XXX tmp->mContextStack?
-
-    tmp->mElementMap.Enumerate(TraverseElement, &cb);
 
     // An element will only have a template builder as long as it's in the
     // document, so we'll traverse the table here instead of from the element.
     if (tmp->mTemplateBuilderTable)
         tmp->mTemplateBuilderTable->EnumerateRead(TraverseTemplateBuilders, &cb);
         
     NS_IMPL_CYCLE_COLLECTION_TRAVERSE_NSCOMPTR_AMBIGUOUS(mCurrentPrototype,
                                                      nsIScriptGlobalObjectOwner)
@@ -913,37 +925,52 @@ nsXULDocument::ExecuteOnBroadcastHandler
                                         &status);
         }
     }
 
     return NS_OK;
 }
 
 void
+nsXULDocument::AttributeWillChange(nsIContent* aContent, PRInt32 aNameSpaceID,
+                                   nsIAtom* aAttribute)
+{
+    NS_ABORT_IF_FALSE(aContent, "Null content!");
+    NS_PRECONDITION(aAttribute, "Must have an attribute that's changing!");
+
+    // XXXbz check aNameSpaceID, dammit!
+    // See if we need to update our ref map.
+    if (aAttribute == nsGkAtoms::ref ||
+        (aAttribute == nsGkAtoms::id && !aContent->GetIDAttributeName())) {
+        RemoveElementFromRefMap(aContent);
+    }
+    
+    nsXMLDocument::AttributeWillChange(aContent, aNameSpaceID, aAttribute);
+}
+
+void
 nsXULDocument::AttributeChanged(nsIDocument* aDocument,
                                 nsIContent* aElement, PRInt32 aNameSpaceID,
                                 nsIAtom* aAttribute, PRInt32 aModType,
                                 PRUint32 aStateMask)
 {
     NS_ASSERTION(aDocument == this, "unexpected doc");
 
-    nsresult rv;
+    // Do this here so that all the exit paths below don't leave this undone
+    nsXMLDocument::AttributeChanged(aDocument, aElement, aNameSpaceID,
+            aAttribute, aModType, aStateMask);
 
     // XXXbz check aNameSpaceID, dammit!
-    // First see if we need to update our element map.
-    if ((aAttribute == nsGkAtoms::id) || (aAttribute == nsGkAtoms::ref)) {
-
-        rv = mElementMap.Enumerate(RemoveElementsFromMapByContent, aElement);
-        if (NS_FAILED(rv)) return;
-
-        // That'll have removed _both_ the 'ref' and 'id' entries from
-        // the map. So add 'em back now.
-        rv = AddElementToMap(aElement);
-        if (NS_FAILED(rv)) return;
-    }
+    // See if we need to update our ref map.
+    if (aAttribute == nsGkAtoms::ref ||
+        (aAttribute == nsGkAtoms::id && !aElement->GetIDAttributeName())) {
+        AddElementToRefMap(aElement);
+    }
+    
+    nsresult rv;
 
     // Synchronize broadcast listeners
     if (mBroadcasterMap && CanBroadcast(aNameSpaceID, aAttribute)) {
         nsCOMPtr<nsIDOMElement> domele = do_QueryInterface(aElement);
         BroadcasterMapEntry* entry =
             static_cast<BroadcasterMapEntry*>
                        (PL_DHashTableOperate(mBroadcasterMap, domele.get(),
                                                 PL_DHASH_LOOKUP));
@@ -1008,82 +1035,88 @@ nsXULDocument::AttributeChanged(nsIDocum
 }
 
 void
 nsXULDocument::ContentAppended(nsIDocument* aDocument,
                                nsIContent* aContainer,
                                PRInt32 aNewIndexInContainer)
 {
     NS_ASSERTION(aDocument == this, "unexpected doc");
-
+    
     // Update our element map
     PRUint32 count = aContainer->GetChildCount();
 
     nsresult rv = NS_OK;
     for (PRUint32 i = aNewIndexInContainer; i < count && NS_SUCCEEDED(rv);
          ++i) {
         rv = AddSubtreeToDocument(aContainer->GetChildAt(i));
     }
+
+    nsXMLDocument::ContentAppended(aDocument, aContainer, aNewIndexInContainer);
 }
 
 void
 nsXULDocument::ContentInserted(nsIDocument* aDocument,
                                nsIContent* aContainer,
                                nsIContent* aChild,
                                PRInt32 aIndexInContainer)
 {
     NS_ASSERTION(aDocument == this, "unexpected doc");
 
     AddSubtreeToDocument(aChild);
+
+    nsXMLDocument::ContentInserted(aDocument, aContainer, aChild, aIndexInContainer);
 }
 
 void
 nsXULDocument::ContentRemoved(nsIDocument* aDocument,
                               nsIContent* aContainer,
                               nsIContent* aChild,
                               PRInt32 aIndexInContainer)
 {
     NS_ASSERTION(aDocument == this, "unexpected doc");
 
     RemoveSubtreeFromDocument(aChild);
+
+    nsXMLDocument::ContentRemoved(aDocument, aContainer, aChild, aIndexInContainer);
 }
 
 //----------------------------------------------------------------------
 //
 // nsIXULDocument interface
 //
 
 NS_IMETHODIMP
-nsXULDocument::AddElementForID(const nsAString& aID, nsIContent* aElement)
+nsXULDocument::AddElementForID(nsIContent* aElement)
 {
     NS_PRECONDITION(aElement != nsnull, "null ptr");
     if (! aElement)
         return NS_ERROR_NULL_POINTER;
 
-    mElementMap.Add(aID, aElement);
-    return NS_OK;
-}
-
-
-NS_IMETHODIMP
-nsXULDocument::RemoveElementForID(const nsAString& aID, nsIContent* aElement)
-{
-    NS_PRECONDITION(aElement != nsnull, "null ptr");
-    if (! aElement)
-        return NS_ERROR_NULL_POINTER;
-
-    mElementMap.Remove(aID, aElement);
+    UpdateIdTableEntry(aElement);
     return NS_OK;
 }
 
 NS_IMETHODIMP
 nsXULDocument::GetElementsForID(const nsAString& aID,
                                 nsCOMArray<nsIContent>& aElements)
 {
-    mElementMap.Find(aID, aElements);
+    aElements.Clear();
+
+    nsCOMPtr<nsIAtom> atom = do_GetAtom(aID);
+    if (!atom)
+        return NS_ERROR_OUT_OF_MEMORY;
+    nsIdentifierMapEntry *entry = mIdentifierMap.GetEntry(atom);
+    if (entry) {
+        entry->AppendAllIdContent(&aElements);
+    }
+    nsRefMapEntry *refEntry = mRefMap.GetEntry(atom);
+    if (refEntry) {
+        refEntry->AppendAll(&aElements);
+    }
     return NS_OK;
 }
 
 nsresult
 nsXULDocument::AddForwardReference(nsForwardReference* aRef)
 {
     if (mResolutionPhase < aRef->GetPhase()) {
         if (!mForwardReferences.AppendElement(aRef)) {
@@ -1549,41 +1582,50 @@ nsXULDocument::GetCommandDispatcher(nsID
 
 NS_IMETHODIMP
 nsXULDocument::GetElementById(const nsAString& aId,
                               nsIDOMElement** aReturn)
 {
     NS_ENSURE_ARG_POINTER(aReturn);
     *aReturn = nsnull;
 
-    if (!CheckGetElementByIdArg(aId))
-        return NS_OK;
-
-    nsresult rv;
-
-    nsCOMPtr<nsIContent> element;
-    rv = mElementMap.FindFirst(aId, getter_AddRefs(element));
-    if (NS_FAILED(rv)) return rv;
-
-    if (element) {
-        rv = CallQueryInterface(element, aReturn);
-    }
-
-    return rv;
+    nsCOMPtr<nsIAtom> atom = do_GetAtom(aId);
+    if (!atom)
+        return NS_ERROR_OUT_OF_MEMORY;
+
+    if (!CheckGetElementByIdArg(atom))
+        return NS_OK;
+
+    nsIdentifierMapEntry *entry = mIdentifierMap.GetEntry(atom);
+    if (entry) {
+        nsIContent* content = entry->GetIdContent();
+        if (content)
+            return CallQueryInterface(content, aReturn);
+    }
+    nsRefMapEntry* refEntry = mRefMap.GetEntry(atom);
+    if (refEntry) {
+        NS_ASSERTION(refEntry->GetFirstContent(),
+                     "nsRefMapEntries should have nonempty content lists");
+        return CallQueryInterface(refEntry->GetFirstContent(), aReturn);
+    }
+    return NS_OK;
 }
 
 nsresult
 nsXULDocument::AddElementToDocumentPre(nsIContent* aElement)
 {
     // Do a bunch of work that's necessary when an element gets added
     // to the XUL Document.
     nsresult rv;
 
-    // 1. Add the element to the resource-to-element map
-    rv = AddElementToMap(aElement);
+    // 1. Add the element to the resource-to-element map. Also add it to
+    // the id map, since it seems this can be called when creating
+    // elements from prototypes.
+    UpdateIdTableEntry(aElement);
+    rv = AddElementToRefMap(aElement);
     if (NS_FAILED(rv)) return rv;
 
     // 2. If the element is a 'command updater' (i.e., has a
     // "commandupdater='true'" attribute), then add the element to the
     // document's command dispatcher
     if (aElement->AttrValueIs(kNameSpaceID_None, nsGkAtoms::commandupdater,
                               nsGkAtoms::_true, eCaseMatters)) {
         rv = nsXULContentUtils::SetCommandUpdater(this, aElement);
@@ -1694,18 +1736,17 @@ nsXULDocument::RemoveSubtreeFromDocument
 
     while (count-- > 0) {
         rv = RemoveSubtreeFromDocument(aElement->GetChildAt(count));
         if (NS_FAILED(rv))
             return rv;
     }
 
     // 2. Remove the element from the resource-to-element map
-    rv = RemoveElementFromMap(aElement);
-    if (NS_FAILED(rv)) return rv;
+    RemoveElementFromRefMap(aElement);
 
     // 3. If the element is a 'command updater', then remove the
     // element from the document's command dispatcher.
     if (aElement->AttrValueIs(kNameSpaceID_None, nsGkAtoms::commandupdater,
                               nsGkAtoms::_true, eCaseMatters)) {
         nsCOMPtr<nsIDOMElement> domelement = do_QueryInterface(aElement);
         NS_ASSERTION(domelement != nsnull, "not a DOM element");
         if (! domelement)
@@ -1758,74 +1799,64 @@ nsXULDocument::GetTemplateBuilderFor(nsI
         mTemplateBuilderTable->Get(aContent, aResult);
     }
     else
         *aResult = nsnull;
 
     return NS_OK;
 }
 
-// Attributes that are used with getElementById() and the
-// resource-to-element map.
-nsIAtom** nsXULDocument::kIdentityAttrs[] =
-{
-    &nsGkAtoms::id,
-    &nsGkAtoms::ref,
-    nsnull
-};
-
-nsresult
-nsXULDocument::AddElementToMap(nsIContent* aElement)
-{
-    // Look at the element's 'id' and 'ref' attributes, and if set,
-    // add pointers in the resource-to-element map to the element.
-    nsresult rv;
-
-    for (PRInt32 i = 0; kIdentityAttrs[i] != nsnull; ++i) {
-        nsAutoString value;
-        aElement->GetAttr(kNameSpaceID_None, *kIdentityAttrs[i], value);
-        if (!value.IsEmpty()) {
-            rv = mElementMap.Add(value, aElement);
-            if (NS_FAILED(rv)) return rv;
-        }
-    }
-
-    return NS_OK;
-}
-
-
-nsresult
-nsXULDocument::RemoveElementFromMap(nsIContent* aElement)
+static void
+GetRefMapAttribute(nsIContent* aElement, nsAutoString* aValue)
+{
+    aElement->GetAttr(kNameSpaceID_None, nsGkAtoms::ref, *aValue);
+    if (aValue->IsEmpty() && !aElement->GetIDAttributeName()) {
+        aElement->GetAttr(kNameSpaceID_None, nsGkAtoms::id, *aValue);
+    }
+}
+
+nsresult
+nsXULDocument::AddElementToRefMap(nsIContent* aElement)
+{
+    // Look at the element's 'ref' attribute, and if set,
+    // add an entry in the resource-to-element map to the element.
+    nsAutoString value;
+    GetRefMapAttribute(aElement, &value);
+    if (!value.IsEmpty()) {
+        nsCOMPtr<nsIAtom> atom = do_GetAtom(value);
+        if (!atom)
+            return NS_ERROR_OUT_OF_MEMORY;
+        nsRefMapEntry *entry = mRefMap.PutEntry(atom);
+        if (!entry)
+            return NS_ERROR_OUT_OF_MEMORY;
+        if (!entry->AddContent(aElement))
+            return NS_ERROR_OUT_OF_MEMORY;
+    }
+
+    return NS_OK;
+}
+
+void
+nsXULDocument::RemoveElementFromRefMap(nsIContent* aElement)
 {
     // Remove the element from the resource-to-element map.
-    nsresult rv;
-
-    for (PRInt32 i = 0; kIdentityAttrs[i] != nsnull; ++i) {
-        nsAutoString value;
-        aElement->GetAttr(kNameSpaceID_None, *kIdentityAttrs[i], value);
-        if (!value.IsEmpty()) {
-            rv = mElementMap.Remove(value, aElement);
-            if (NS_FAILED(rv)) return rv;
-        }
-    }
-
-    return NS_OK;
-}
-
-
-PRIntn
-nsXULDocument::RemoveElementsFromMapByContent(const PRUnichar* aID,
-                                              nsIContent* aElement,
-                                              void* aClosure)
-{
-    nsIContent* content = reinterpret_cast<nsIContent*>(aClosure);
-    return (aElement == content) ? HT_ENUMERATE_REMOVE : HT_ENUMERATE_NEXT;
-}
-
-
+    nsAutoString value;
+    GetRefMapAttribute(aElement, &value);
+    if (!value.IsEmpty()) {
+        nsCOMPtr<nsIAtom> atom = do_GetAtom(value);
+        if (!atom)
+            return;
+        nsRefMapEntry *entry = mRefMap.GetEntry(atom);
+        if (!entry)
+            return;
+        if (entry->RemoveContent(aElement)) {
+            mRefMap.RemoveEntry(atom);
+        }
+    }
+}
 
 //----------------------------------------------------------------------
 //
 // nsIDOMNode interface
 //
 
 NS_IMETHODIMP
 nsXULDocument::CloneNode(PRBool aDeep, nsIDOMNode** aReturn)
@@ -1839,16 +1870,19 @@ nsXULDocument::CloneNode(PRBool aDeep, n
 //----------------------------------------------------------------------
 //
 // Implementation methods
 //
 
 nsresult
 nsXULDocument::Init()
 {
+    SetIdTableLive();
+    mRefMap.Init();
+
     nsresult rv = nsXMLDocument::Init();
     NS_ENSURE_SUCCESS(rv, rv);
 
     // Create our command dispatcher and hook it up.
     mCommandDispatcher = new nsXULCommandDispatcher(this);
     NS_ENSURE_TRUE(mCommandDispatcher, NS_ERROR_OUT_OF_MEMORY);
 
     // this _could_ fail; e.g., if we've tried to grab the local store
@@ -2364,17 +2398,18 @@ nsXULDocument::PrepareToWalk()
         // Add the root element
         rv = CreateElementFromPrototype(proto, getter_AddRefs(root));
         if (NS_FAILED(rv)) return rv;
 
         rv = AppendChildTo(root, PR_FALSE);
         if (NS_FAILED(rv)) return rv;
         
         // Add the root element to the XUL document's ID-to-element map.
-        rv = AddElementToMap(root);
+        UpdateIdTableEntry(root);
+        rv = AddElementToRefMap(root);
         if (NS_FAILED(rv)) return rv;
 
         // Block onload until we've finished building the complete
         // document content model.
         BlockOnload();
     }
 
     // There'd better not be anything on the context stack at this
diff --git a/content/xul/document/src/nsXULDocument.h b/content/xul/document/src/nsXULDocument.h
--- a/content/xul/document/src/nsXULDocument.h
+++ b/content/xul/document/src/nsXULDocument.h
@@ -41,17 +41,16 @@
 #define nsXULDocument_h__
 
 #include "nsCOMPtr.h"
 #include "nsXULPrototypeDocument.h"
 #include "nsXULPrototypeCache.h"
 #include "nsTArray.h"
 
 #include "nsXMLDocument.h"
-#include "nsElementMap.h"
 #include "nsForwardReference.h"
 #include "nsIContent.h"
 #include "nsIDOMEventTarget.h"
 #include "nsIDOMXULCommandDispatcher.h"
 #include "nsIDOMXULDocument.h"
 #include "nsCOMArray.h"
 #include "nsIURI.h"
 #include "nsIXULDocument.h"
@@ -72,16 +71,45 @@ class nsIXULPrototypeScript;
 #include "nsIObjectOutputStream.h"
 #include "nsXULElement.h"
 #endif
 #include "nsURIHashKey.h"
 #include "nsInterfaceHashtable.h"
  
 struct JSObject;
 struct PRLogModuleInfo;
+
+class nsRefMapEntry : public nsISupportsHashKey
+{
+public:
+  nsRefMapEntry(const nsISupports* aKey) :
+    nsISupportsHashKey(aKey)
+  {
+  }
+  nsRefMapEntry(const nsRefMapEntry& aOther) :
+    nsISupportsHashKey(GetKey())
+  {
+    NS_ERROR("Should never be called");
+  }
+
+  nsIContent* GetFirstContent();
+  void AppendAll(nsCOMArray<nsIContent>* aElements);
+  /**
+   * @return true if aContent was added, false if we failed due to OOM
+   */
+  PRBool AddContent(nsIContent* aContent);
+  /**
+   * @return true if aContent was removed and it was the last content for
+   * this ref, so this entry should be removed from the map
+   */
+  PRBool RemoveContent(nsIContent* aContent);
+
+private:
+  nsSmallVoidArray mRefContentList;
+};
 
 /**
  * The XUL document class
  */
 class nsXULDocument : public nsXMLDocument,
                       public nsIXULDocument,
                       public nsIDOMXULDocument,
                       public nsIStreamLoaderObserver,
@@ -113,19 +141,22 @@ public:
     virtual void EndLoad();
 
     // nsIMutationObserver interface
     NS_DECL_NSIMUTATIONOBSERVER_CONTENTAPPENDED
     NS_DECL_NSIMUTATIONOBSERVER_CONTENTINSERTED
     NS_DECL_NSIMUTATIONOBSERVER_CONTENTREMOVED
     NS_DECL_NSIMUTATIONOBSERVER_ATTRIBUTECHANGED
 
+    virtual void AttributeWillChange(nsIContent* aChild,
+                                     PRInt32 aNameSpaceID,
+                                     nsIAtom* aAttribute);
+
     // nsIXULDocument interface
-    NS_IMETHOD AddElementForID(const nsAString& aID, nsIContent* aElement);
-    NS_IMETHOD RemoveElementForID(const nsAString& aID, nsIContent* aElement);
+    NS_IMETHOD AddElementForID(nsIContent* aElement);
     NS_IMETHOD GetElementsForID(const nsAString& aID,
                                 nsCOMArray<nsIContent>& aElements);
 
     NS_IMETHOD GetScriptGlobalObjectOwner(nsIScriptGlobalObjectOwner** aGlobalOwner);
     NS_IMETHOD AddSubtreeToDocument(nsIContent* aElement);
     NS_IMETHOD RemoveSubtreeFromDocument(nsIContent* aElement);
     NS_IMETHOD SetTemplateBuilderFor(nsIContent* aContent,
                                      nsIXULTemplateBuilder* aBuilder);
@@ -165,27 +196,21 @@ protected:
     // Implementation methods
     friend nsresult
     NS_NewXULDocument(nsIXULDocument** aResult);
 
     nsresult Init(void);
     nsresult StartLayout(void);
 
     nsresult
-    AddElementToMap(nsIContent* aElement);
-
-    nsresult
-    RemoveElementFromMap(nsIContent* aElement);
+    AddElementToRefMap(nsIContent* aElement);
+    void
+    RemoveElementFromRefMap(nsIContent* aElement);
 
     nsresult GetViewportSize(PRInt32* aWidth, PRInt32* aHeight);
-
-    static PRIntn
-    RemoveElementsFromMapByContent(const PRUnichar* aID,
-                                   nsIContent* aElement,
-                                   void* aClosure);
 
     void SetIsPopup(PRBool isPopup) { mIsPopup = isPopup; }
 
     nsresult PrepareToLoad(nsISupports* aContainer,
                            const char* aCommand,
                            nsIChannel* aChannel,
                            nsILoadGroup* aLoadGroup,
                            nsIParser** aResult);
@@ -245,17 +270,19 @@ protected:
     // for owning pointers and raw COM interface pointers for weak
     // (ie, non owning) references. If you add any members to this
     // class, please make the ownership explicit (pinkerton, scc).
     // NOTE, THIS IS STILL IN PROGRESS, TALK TO PINK OR SCC BEFORE
     // CHANGING
 
     nsXULDocument*             mNextSrcLoadWaiter;  // [OWNER] but not COMPtr
 
-    nsElementMap               mElementMap;
+    // Tracks elements with a 'ref' attribute, or an 'id' attribute where
+    // the element's namespace has no registered ID attribute name.
+    nsTHashtable<nsRefMapEntry> mRefMap;
     nsCOMPtr<nsIRDFDataSource> mLocalStore;
     PRPackedBool               mIsPopup;
     PRPackedBool               mApplyingPersistedAttrs;
     PRPackedBool               mIsWritingFastLoad;
     PRPackedBool               mDocumentLoaded;
     /**
      * Since ResumeWalk is interruptible, it's possible that last
      * stylesheet finishes loading while the PD walk is still in
diff --git a/content/xul/document/test/test_bug311681.xul b/content/xul/document/test/test_bug311681.xul
--- a/content/xul/document/test/test_bug311681.xul
+++ b/content/xul/document/test/test_bug311681.xul
@@ -42,25 +42,23 @@ https://bugzilla.mozilla.org/show_bug.cg
     // removed.
     var newParent = $("display");
     var node = testNode.cloneNode(true);
     isnot(node, testNode, "Clone should be a different node");
 
     newParent.appendChild(node);
 
     // Check what getElementById returns, no flushing
-    todo(getCont() == node, "Should be getting new node pre-flush 1")
-    is(getCont(), testNode, "XUL does it differently for now");
+    is(getCont(), node, "Should be getting new node pre-flush 1")
     
     // Trigger a layout flush, just in case.
     var itemHeight = newParent.offsetHeight/10;
 
     // Check what getElementById returns now.
-    todo(getCont() == node, "Should be getting new node post-flush 1")
-    is(getCont(), testNode, "XUL does it differently for now");
+    is(getCont(), node, "Should be getting new node post-flush 1")
     
     clear(newParent);
     
     // Check what getElementById returns, no flushing
     is(getCont(), testNode, "Should be getting orig node pre-flush 2");
     
     // Trigger a layout flush, just in case.
     var itemHeight = newParent.offsetHeight/10;
diff --git a/content/xul/document/test/test_bug403868.xul b/content/xul/document/test/test_bug403868.xul
--- a/content/xul/document/test/test_bug403868.xul
+++ b/content/xul/document/test/test_bug403868.xul
@@ -35,29 +35,26 @@ is(document.getElementById("test1"), s1a
 is(document.getElementById("test1"), s1a,
    "Appending span with id=test1 doesn't change which one comes first");
 
 var s3a = createSpan("test1", s2a);
 is(document.getElementById("test1"), s1a,
    "Inserting span with id=test1 not at the beginning; doesn't matter");
 
 var s4a = createSpan("test1", s1a);
-todo(document.getElementById("test1") == s4a,
+is(document.getElementById("test1"), s4a,
    "Inserting span with id=test1 at the beginning changes which one is first");
-is(document.getElementById("test1"), s1a, "XUL is confused")
 
 s4a.parentNode.removeChild(s4a);
 is(document.getElementById("test1"), s1a,
    "First-created span with id=test1 is first again");
 
 s1a.parentNode.removeChild(s1a);
-todo(document.getElementById("test1") == s3a,
+is(document.getElementById("test1"), s3a,
    "Third-created span with id=test1 is first now");
-is(document.getElementById("test1"), s2a,
-   "XUL is confused");
 
 // Start the id hashtable
 for (var i = 0; i < 256; ++i) {
   document.getElementById("no-such-id-in-the-document" + i);
 }
 
 var s1b = createSpan("test2", null);
 is(document.getElementById("test2"), s1b,
@@ -67,24 +64,21 @@ is(document.getElementById("test2"), s1b
 is(document.getElementById("test2"), s1b,
    "Appending span with id=test2 doesn't change which one comes first");
 
 var s3b = createSpan("test2", s2b);
 is(document.getElementById("test2"), s1b,
    "Inserting span with id=test2 not at the beginning; doesn't matter");
 
 var s4b = createSpan("test2", s1b);
-todo(document.getElementById("test2") == s4b,
+is(document.getElementById("test2"), s4b,
    "Inserting span with id=test2 at the beginning changes which one is first");
-is(document.getElementById("test2"), s1b, "XUL is confused")
 
 s4b.parentNode.removeChild(s4b);
 is(document.getElementById("test2"), s1b,
    "First-created span with id=test2 is first again");
 
 s1b.parentNode.removeChild(s1b);
-todo(document.getElementById("test2") == s3b,
+is(document.getElementById("test2"), s3b,
    "Third-created span with id=test2 is first now");
-is(document.getElementById("test2"), s2b,
-   "XUL is confused");
 
   ]]></script>
 </window>
diff --git a/content/xul/templates/src/nsXULContentBuilder.cpp b/content/xul/templates/src/nsXULContentBuilder.cpp
--- a/content/xul/templates/src/nsXULContentBuilder.cpp
+++ b/content/xul/templates/src/nsXULContentBuilder.cpp
@@ -732,17 +732,17 @@ nsXULContentBuilder::BuildContentFromTem
             if (! aNotify) {
                 // XUL document will watch us, and take care of making
                 // sure that we get added to or removed from the
                 // element map if aNotify is true. If not, we gotta do
                 // it ourselves. Yay.
                 nsCOMPtr<nsIXULDocument> xuldoc =
                     do_QueryInterface(mRoot->GetDocument());
                 if (xuldoc)
-                    xuldoc->AddElementForID(id, realKid);
+                    xuldoc->AddElementForID(realKid);
             }
 
             // Set up the element's 'container' and 'empty' attributes.
             SetContainerAttrs(realKid, aChild, PR_TRUE, PR_FALSE);
         }
         else if (tag == nsGkAtoms::textnode &&
                  nameSpaceID == kNameSpaceID_XUL) {
             // <xul:text value="..."> is replaced by text of the
diff --git a/dom/src/base/nsDOMClassInfo.cpp b/dom/src/base/nsDOMClassInfo.cpp
--- a/dom/src/base/nsDOMClassInfo.cpp
+++ b/dom/src/base/nsDOMClassInfo.cpp
@@ -4505,20 +4505,24 @@ nsWindowSH::GetProperty(nsIXPConnectWrap
     //
     // Calling GetWrappedNativeOfJSObject() is not all that cheap, so
     // only do that if the JSClass name is one that is likely to be a
     // window object.
 
     const char *name = JS_GET_CLASS(cx, JSVAL_TO_OBJECT(*vp))->name;
 
     // The list of Window class names here need to be kept in sync
-    // with the actual class names!
+    // with the actual class names! The class name
+    // XPCCrossOriginWrapper needs to be handled here too as XOWs
+    // define child frame names with a XOW as the value, and thus
+    // we'll need to get through here with XOWs class name too.
     if ((*name == 'W' && strcmp(name, "Window") == 0) ||
         (*name == 'C' && strcmp(name, "ChromeWindow") == 0) ||
-        (*name == 'M' && strcmp(name, "ModalContentWindow") == 0)) {
+        (*name == 'M' && strcmp(name, "ModalContentWindow") == 0) ||
+        (*name == 'X' && strcmp(name, "XPCCrossOriginWrapper") == 0)) {
       nsCOMPtr<nsIXPConnectWrappedNative> vpwrapper;
       sXPConnect->GetWrappedNativeOfJSObject(cx, JSVAL_TO_OBJECT(*vp),
                                              getter_AddRefs(vpwrapper));
 
       if (vpwrapper) {
         nsCOMPtr<nsIDOMWindow> window(do_QueryWrappedNative(vpwrapper));
 
         if (window) {
diff --git a/dom/tests/mochitest/bugs/Makefile.in b/dom/tests/mochitest/bugs/Makefile.in
--- a/dom/tests/mochitest/bugs/Makefile.in
+++ b/dom/tests/mochitest/bugs/Makefile.in
@@ -72,12 +72,14 @@ _TEST_FILES	= \
 		iframe_bug424093.html \
 		test_bug409349.html \
 		iframe_bug409349.html \
 		test_bug411103.html \
 		test_bug414291.html \
 		test_bug430276.html \
 		iframe_bug430276.html \
 		iframe_bug430276-2.html \
+		test_bug440572.html \
+		iframe_bug440572.html \
 		$(NULL)
 
 libs:: 	$(_TEST_FILES)
 	$(INSTALL) $(foreach f,$^,"$f") $(DEPTH)/_tests/testing/mochitest/tests/$(relativesrcdir)
diff --git a/dom/tests/mochitest/bugs/iframe_bug440572.html b/dom/tests/mochitest/bugs/iframe_bug440572.html
new file mode 100644
--- /dev/null
+++ b/dom/tests/mochitest/bugs/iframe_bug440572.html
@@ -0,0 +1,17 @@
+<html>
+<body>
+<script>
+
+var success = 0;
+
+try {
+  parent[name].success = 1;
+} catch (e) {
+  parent.postMessage(e, "http://localhost:8888");
+}
+
+parent.postMessage(success ? "success" : "failure", "http://localhost:8888");
+</script>
+<p>Move on, nothing to see here...</p>
+</body>
+</html>
diff --git a/dom/tests/mochitest/bugs/test_bug440572.html b/dom/tests/mochitest/bugs/test_bug440572.html
new file mode 100644
--- /dev/null
+++ b/dom/tests/mochitest/bugs/test_bug440572.html
@@ -0,0 +1,48 @@
+<!DOCTYPE HTML>
+<html>
+<!--
+https://bugzilla.mozilla.org/show_bug.cgi?id=440572
+-->
+<head>
+  <title>Test for Bug 440572</title>
+  <script type="text/javascript" src="/MochiKit/MochiKit.js"></script>
+  <script type="text/javascript" src="/tests/SimpleTest/SimpleTest.js"></script>        
+  <link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css" />
+</head>
+<body onload="runtests()">
+<a target="_blank" href="https://bugzilla.mozilla.org/show_bug.cgi?id=440572">Mozilla Bug 440572</a>
+
+<script class="testbody" type="text/javascript">
+
+/** Test for Bug 440572 **/
+
+var messages = [];
+
+function receiveMessage(e)
+{
+  is(e.origin, "http://example.org", "wrong sender!");
+  messages.push(e.data);
+}
+
+window.addEventListener("message", receiveMessage, false);
+
+function runtests()
+{
+  for (i in messages) {
+    is(messages[i], "success", "test in frame failed.");
+  }
+
+  SimpleTest.finish();
+}
+
+SimpleTest.waitForExplicitFinish();
+</script>
+<br>
+<iframe name="test" src="http://example.org:80/tests/dom/tests/mochitest/bugs/iframe_bug440572.html"></iframe>
+<br>
+<iframe name="content" src="http://example.org:80/tests/dom/tests/mochitest/bugs/iframe_bug440572.html"></iframe>
+<br>
+<iframe name="dump" src="http://example.org:80/tests/dom/tests/mochitest/bugs/iframe_bug440572.html"></iframe>
+</body>
+</html>
+
diff --git a/embedding/browser/gtk/src/EmbedWindow.cpp b/embedding/browser/gtk/src/EmbedWindow.cpp
--- a/embedding/browser/gtk/src/EmbedWindow.cpp
+++ b/embedding/browser/gtk/src/EmbedWindow.cpp
@@ -404,16 +404,17 @@ EmbedWindow::OnShowTooltip(PRInt32 aXCoo
   // cursor.
   root_y += 10;
   
   sTipWindow = gtk_window_new(GTK_WINDOW_POPUP);
   gtk_widget_set_app_paintable(sTipWindow, TRUE);
   gtk_window_set_resizable(GTK_WINDOW(sTipWindow), TRUE);
   // needed to get colors + fonts etc correctly
   gtk_widget_set_name(sTipWindow, "gtk-tooltips");
+  gtk_window_set_type_hint(GTK_WINDOW(sTipWindow), GDK_WINDOW_TYPE_HINT_TOOLTIP);
   
   // set up the popup window as a transient of the widget.
   GtkWidget *toplevel_window;
   toplevel_window = gtk_widget_get_toplevel(GTK_WIDGET(mOwner->mOwningWidget));
   if (!GTK_WINDOW(toplevel_window)) {
     NS_ERROR("no gtk window in hierarchy!\n");
     return NS_ERROR_FAILURE;
   }
diff --git a/extensions/universalchardet/tests/Makefile.in b/extensions/universalchardet/tests/Makefile.in
--- a/extensions/universalchardet/tests/Makefile.in
+++ b/extensions/universalchardet/tests/Makefile.in
@@ -67,16 +67,18 @@ LIBS		+= \
 
 include $(topsrcdir)/config/rules.mk
 
 ifdef MOZ_MOCHITEST
 relativesrcdir = extensions/universalchardet/tests
 
 _TEST_FILES =	\
 		CharsetDetectionTests.js \
+		bug9357_text.html \
+		test_bug9357.html \
 		bug171813_text.html \
 		test_bug171813.html \
 		bug306272_text.html \
 		test_bug306272.html \
 		bug421271_text.html \
 		test_bug421271.html \
 		bug426271_text-euc-jp.html \
 		test_bug426271-euc-jp.html \
diff --git a/extensions/universalchardet/tests/bug9357_text.html b/extensions/universalchardet/tests/bug9357_text.html
new file mode 100644
--- /dev/null
+++ b/extensions/universalchardet/tests/bug9357_text.html
@@ -0,0 +1,15 @@
+<!DOCTYPE html>
+<html>
+<head>
+ <title>EUC-KR test</title>
+</head>
+<body>
+ <p>¿äÃ»ÇÏ½Å À¥ ÆäÀÌÁö¸¦ Ã£À» ¼ö ¾ø½À´Ï´Ù.<br>Ã£À¸½Ã´Â À¥ ÆäÀÌÁö°¡ ÇöÀç »ç¿ëÇÒ ¼ö ¾ø°Å³ª<br>À¥ ÆäÀÌÁöÀÇ ÀÌ¸§ÀÌ º¯°æ ¶Ç´Â »èÁ¦ µÇ¾ú½À´Ï´Ù.<br>ÀÌº¥Æ® °ü·Ã ¹®ÀÇ´Â °í°´¹®ÀÇ¸¦ ÀÌ¿ëÇÏ½Ã±â ¹Ù¶ø´Ï´Ù </p>
+</body>
+</html>
+
+
+
+
+
+
diff --git a/extensions/universalchardet/tests/test_bug9357.html b/extensions/universalchardet/tests/test_bug9357.html
new file mode 100644
--- /dev/null
+++ b/extensions/universalchardet/tests/test_bug9357.html
@@ -0,0 +1,31 @@
+<!DOCTYPE HTML>
+<html>
+<!--
+https://bugzilla.mozilla.org/show_bug.cgi?id=9357
+-->
+<head>
+  <title>Test for Bug 9357</title>
+  <script type="text/javascript" src="/MochiKit/MochiKit.js"></script>
+  <script type="text/javascript" src="/tests/SimpleTest/SimpleTest.js"></script>
+  <script type="text/javascript" src="CharsetDetectionTests.js"></script>
+  <link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css" />
+</head>
+<body>
+<a target="_blank" href="https://bugzilla.mozilla.org/show_bug.cgi?id=9357">Mozilla Bug 9357</a>
+<p id="display"></p>
+<div id="content" style="display: none">  
+</div>
+<iframe id="testframe"></iframe>
+<pre id="test">
+<script class="testbody" type="text/javascript">
+/** Test for Bug 9357 **/
+CharsetDetectionTests("bug9357_text.html",
+		      "EUC-KR",
+		      new Array("ko_parallel_state_machine",
+				"cjk_parallel_state_machine",
+				"universal_charset_detector"));
+</script>
+</pre>
+</body>
+</html>
+
diff --git a/js/src/js.cpp b/js/src/js.cpp
--- a/js/src/js.cpp
+++ b/js/src/js.cpp
@@ -303,17 +303,17 @@ Process(JSContext *cx, JSObject *obj, ch
 
         /* Clear any pending exception from previous failed compiles.  */
         JS_ClearPendingException(cx);
         script = JS_CompileScript(cx, obj, buffer, strlen(buffer), "typein",
                                   startline);
         if (script) {
             if (!compileOnly) {
                 ok = JS_ExecuteScript(cx, obj, script, &result);
-                if (ok && result != JSVAL_VOID) {
+                if (ok && !JSVAL_IS_VOID(result)) {
                     str = JS_ValueToString(cx, result);
                     if (str)
                         fprintf(gOutFile, "%s\n", JS_GetStringBytes(str));
                     else
                         ok = JS_FALSE;
                 }
             }
             JS_DestroyScript(cx, script);
@@ -536,16 +536,18 @@ ProcessArgs(JSContext *cx, JSObject *obj
                 return usage();
 
             /* Set maximum stack size. */
             gMaxStackSize = atoi(argv[i]);
             break;
 
         case 'z':
             obj = split_setup(cx);
+            if (!obj)
+                return gExitCode;
             break;
 #ifdef MOZ_SHARK
         case 'k':
             JS_ConnectShark();
             break;
 #endif
         default:
             return usage();
@@ -1073,17 +1075,17 @@ TrapHandler(JSContext *cx, JSScript *scr
     str = (JSString *) closure;
     caller = JS_GetScriptedCaller(cx, NULL);
     if (!JS_EvaluateScript(cx, caller->scopeChain,
                            JS_GetStringBytes(str), JS_GetStringLength(str),
                            caller->script->filename, caller->script->lineno,
                            rval)) {
         return JSTRAP_ERROR;
     }
-    if (*rval != JSVAL_VOID)
+    if (!JSVAL_IS_VOID(*rval))
         return JSTRAP_RETURN;
     return JSTRAP_CONTINUE;
 }
 
 static JSBool
 Trap(JSContext *cx, JSObject *obj, uintN argc, jsval *argv, jsval *rval)
 {
     JSString *str;
@@ -2078,16 +2080,17 @@ ThrowError(JSContext *cx, JSObject *obj,
     return JS_FALSE;
 }
 
 #define LAZY_STANDARD_CLASSES
 
 /* A class for easily testing the inner/outer object callbacks. */
 typedef struct ComplexObject {
     JSBool isInner;
+    JSBool frozen;
     JSObject *inner;
     JSObject *outer;
 } ComplexObject;
 
 static JSObject *
 split_create_outer(JSContext *cx);
 
 static JSObject *
@@ -2204,17 +2207,17 @@ split_enumerate(JSContext *cx, JSObject 
             *idp = JSVAL_ZERO;
         break;
 
       case JSENUMERATE_NEXT:
         iterator = (JSObject*)JSVAL_TO_OBJECT(*statep);
         if (!JS_NextProperty(cx, iterator, idp))
             return JS_FALSE;
 
-        if (*idp != JSVAL_VOID)
+        if (!JSVAL_IS_VOID(*idp))
             break;
         /* Fall through. */
 
       case JSENUMERATE_DESTROY:
         /* Let GC at our iterator object. */
         *statep = JSVAL_NULL;
         break;
     }
@@ -2295,22 +2298,27 @@ split_outerObject(JSContext *cx, JSObjec
 }
 
 JS_STATIC_DLL_CALLBACK(JSObject *)
 split_innerObject(JSContext *cx, JSObject *obj)
 {
     ComplexObject *cpx;
 
     cpx = (ComplexObject *) JS_GetPrivate(cx, obj);
+    if (cpx->frozen) {
+        JS_ASSERT(!cpx->isInner);
+        return obj;
+    }
     return !cpx->isInner ? cpx->inner : obj;
 }
 
 static JSExtendedClass split_global_class = {
     {"split_global",
-    JSCLASS_NEW_RESOLVE | JSCLASS_HAS_PRIVATE | JSCLASS_IS_EXTENDED,
+    JSCLASS_NEW_RESOLVE | JSCLASS_NEW_ENUMERATE | JSCLASS_HAS_PRIVATE |
+    JSCLASS_IS_EXTENDED,
     split_addProperty, split_delProperty,
     split_getProperty, split_setProperty,
     (JSEnumerateOp)split_enumerate,
     (JSResolveOp)split_resolve,
     JS_ConvertStub, split_finalize,
     NULL, NULL, NULL, NULL, NULL, NULL,
     split_mark, NULL},
     NULL, split_outerObject, split_innerObject,
@@ -2321,27 +2329,27 @@ split_create_outer(JSContext *cx)
 split_create_outer(JSContext *cx)
 {
     ComplexObject *cpx;
     JSObject *obj;
 
     cpx = (ComplexObject *) JS_malloc(cx, sizeof *obj);
     if (!cpx)
         return NULL;
+    cpx->isInner = JS_FALSE;
+    cpx->frozen = JS_TRUE;
+    cpx->inner = NULL;
     cpx->outer = NULL;
-    cpx->inner = NULL;
-    cpx->isInner = JS_FALSE;
 
     obj = JS_NewObject(cx, &split_global_class.base, NULL, NULL);
-    if (!obj) {
+    if (!obj || !JS_SetParent(cx, obj, NULL)) {
         JS_free(cx, cpx);
         return NULL;
     }
 
-    JS_ASSERT(!JS_GetParent(cx, obj));
     if (!JS_SetPrivate(cx, obj, cpx)) {
         JS_free(cx, cpx);
         return NULL;
     }
 
     return obj;
 }
 
@@ -2351,28 +2359,30 @@ split_create_inner(JSContext *cx, JSObje
     ComplexObject *cpx, *outercpx;
     JSObject *obj;
 
     JS_ASSERT(JS_GET_CLASS(cx, outer) == &split_global_class.base);
 
     cpx = (ComplexObject *) JS_malloc(cx, sizeof *cpx);
     if (!cpx)
         return NULL;
+    cpx->isInner = JS_TRUE;
+    cpx->frozen = JS_FALSE;
+    cpx->inner = NULL;
     cpx->outer = outer;
-    cpx->inner = NULL;
-    cpx->isInner = JS_TRUE;
 
     obj = JS_NewObject(cx, &split_global_class.base, NULL, NULL);
     if (!obj || !JS_SetParent(cx, obj, NULL) || !JS_SetPrivate(cx, obj, cpx)) {
         JS_free(cx, cpx);
         return NULL;
     }
 
     outercpx = (ComplexObject *) JS_GetPrivate(cx, outer);
     outercpx->inner = obj;
+    outercpx->frozen = JS_FALSE;
 
     return obj;
 }
 
 static ComplexObject *
 split_get_private(JSContext *cx, JSObject *obj)
 {
     do {
@@ -3198,17 +3208,17 @@ its_enumerate(JSContext *cx, JSObject *o
             JS_ReportError(cx, "its enumeration failed");
             return JS_FALSE;
         }
 
         iterator = (JSObject *) JSVAL_TO_OBJECT(*statep);
         if (!JS_NextProperty(cx, iterator, idp))
             return JS_FALSE;
 
-        if (*idp != JSVAL_VOID)
+        if (!JSVAL_IS_VOID(*idp))
             break;
         /* Fall through. */
 
       case JSENUMERATE_DESTROY:
         /* Allow our iterator object to be GC'd. */
         *statep = JSVAL_NULL;
         break;
     }
diff --git a/js/src/jsapi.h b/js/src/jsapi.h
--- a/js/src/jsapi.h
+++ b/js/src/jsapi.h
@@ -65,26 +65,28 @@ JS_BEGIN_EXTERN_C
 #define JSVAL_TAG(v)            ((v) & JSVAL_TAGMASK)
 #define JSVAL_SETTAG(v,t)       ((v) | (t))
 #define JSVAL_CLRTAG(v)         ((v) & ~(jsval)JSVAL_TAGMASK)
 #define JSVAL_ALIGN             JS_BIT(JSVAL_TAGBITS)
 
 /* Predicates for type testing. */
 #define JSVAL_IS_OBJECT(v)      (JSVAL_TAG(v) == JSVAL_OBJECT)
 #define JSVAL_IS_NUMBER(v)      (JSVAL_IS_INT(v) || JSVAL_IS_DOUBLE(v))
-#define JSVAL_IS_INT(v)         (((v) & JSVAL_INT) && (v) != JSVAL_VOID)
+#define JSVAL_IS_INT(v)         ((v) & JSVAL_INT)
 #define JSVAL_IS_DOUBLE(v)      (JSVAL_TAG(v) == JSVAL_DOUBLE)
 #define JSVAL_IS_STRING(v)      (JSVAL_TAG(v) == JSVAL_STRING)
-#define JSVAL_IS_BOOLEAN(v)     (JSVAL_TAG(v) == JSVAL_BOOLEAN)
+#define JSVAL_IS_BOOLEAN(v)     (((v) & ~((jsval)1 << JSVAL_TAGBITS)) ==      \
+                                 JSVAL_BOOLEAN)
 #define JSVAL_IS_NULL(v)        ((v) == JSVAL_NULL)
 #define JSVAL_IS_VOID(v)        ((v) == JSVAL_VOID)
 #define JSVAL_IS_PRIMITIVE(v)   (!JSVAL_IS_OBJECT(v) || JSVAL_IS_NULL(v))
 
 /* Objects, strings, and doubles are GC'ed. */
-#define JSVAL_IS_GCTHING(v)     (!((v) & JSVAL_INT) && !JSVAL_IS_BOOLEAN(v))
+#define JSVAL_IS_GCTHING(v)     (!((v) & JSVAL_INT) &&                        \
+                                 JSVAL_TAG(v) != JSVAL_BOOLEAN)
 #define JSVAL_TO_GCTHING(v)     ((void *)JSVAL_CLRTAG(v))
 #define JSVAL_TO_OBJECT(v)      ((JSObject *)JSVAL_TO_GCTHING(v))
 #define JSVAL_TO_DOUBLE(v)      ((jsdouble *)JSVAL_TO_GCTHING(v))
 #define JSVAL_TO_STRING(v)      ((JSString *)JSVAL_TO_GCTHING(v))
 #define OBJECT_TO_JSVAL(obj)    ((jsval)(obj))
 #define DOUBLE_TO_JSVAL(dp)     JSVAL_SETTAG((jsval)(dp), JSVAL_DOUBLE)
 #define STRING_TO_JSVAL(str)    JSVAL_SETTAG((jsval)(str), JSVAL_STRING)
 
@@ -94,19 +96,20 @@ JS_BEGIN_EXTERN_C
                                  : JS_TRUE)
 #define JSVAL_UNLOCK(cx,v)      (JSVAL_IS_GCTHING(v)                          \
                                  ? JS_UnlockGCThing(cx, JSVAL_TO_GCTHING(v))  \
                                  : JS_TRUE)
 
 /* Domain limits for the jsval int type. */
 #define JSVAL_INT_BITS          31
 #define JSVAL_INT_POW2(n)       ((jsval)1 << (n))
-#define JSVAL_INT_MIN           ((jsval)1 - JSVAL_INT_POW2(30))
+#define JSVAL_INT_MIN           (-JSVAL_INT_POW2(30))
 #define JSVAL_INT_MAX           (JSVAL_INT_POW2(30) - 1)
-#define INT_FITS_IN_JSVAL(i)    ((jsuint)((i)+JSVAL_INT_MAX) <= 2*JSVAL_INT_MAX)
+#define INT_FITS_IN_JSVAL(i)    ((jsuint)(i) + JSVAL_INT_MAX + 1 <=           \
+                                 2 * JSVAL_INT_MAX + 1)
 #define JSVAL_TO_INT(v)         ((jsint)(v) >> 1)
 #define INT_TO_JSVAL(i)         (((jsval)(i) << 1) | JSVAL_INT)
 
 /* Convert between boolean and jsval. */
 #define JSVAL_TO_BOOLEAN(v)     ((JSBool)((v) >> JSVAL_TAGBITS))
 #define BOOLEAN_TO_JSVAL(b)     JSVAL_SETTAG((jsval)(b) << JSVAL_TAGBITS,     \
                                              JSVAL_BOOLEAN)
 
@@ -205,17 +208,17 @@ JS_BEGIN_EXTERN_C
  * JSFunctionSpec structs are allocated in static arrays.
  */
 #define JSFUN_GENERIC_NATIVE    JSFUN_LAMBDA
 
 /*
  * Well-known JS values.  The extern'd variables are initialized when the
  * first JSContext is created by JS_NewContext (see below).
  */
-#define JSVAL_VOID              INT_TO_JSVAL(0 - JSVAL_INT_POW2(30))
+#define JSVAL_VOID              BOOLEAN_TO_JSVAL(2)
 #define JSVAL_NULL              OBJECT_TO_JSVAL(0)
 #define JSVAL_ZERO              INT_TO_JSVAL(0)
 #define JSVAL_ONE               INT_TO_JSVAL(1)
 #define JSVAL_FALSE             BOOLEAN_TO_JSVAL(JS_FALSE)
 #define JSVAL_TRUE              BOOLEAN_TO_JSVAL(JS_TRUE)
 
 /*
  * Microseconds since the epoch, midnight, January 1, 1970 UTC.  See the
diff --git a/js/src/jsarray.cpp b/js/src/jsarray.cpp
--- a/js/src/jsarray.cpp
+++ b/js/src/jsarray.cpp
@@ -381,17 +381,17 @@ GetArrayElement(JSContext *cx, JSObject 
         return JS_TRUE;
     }
 
     if (index <= JSVAL_INT_MAX) {
         id = INT_TO_JSID(index);
     } else {
         if (!BigIndexToId(cx, obj, index, JS_FALSE, &id))
             return JS_FALSE;
-        if (id == JSVAL_VOID) {
+        if (JSVAL_IS_VOID(id)) {
             *hole = JS_TRUE;
             *vp = JSVAL_VOID;
             return JS_TRUE;
         }
     }
 
     if (!OBJ_LOOKUP_PROPERTY(cx, obj, id, &obj2, &prop))
         return JS_FALSE;
@@ -432,17 +432,17 @@ SetArrayElement(JSContext *cx, JSObject 
         }
     }
 
     if (index <= JSVAL_INT_MAX) {
         id = INT_TO_JSID(index);
     } else {
         if (!BigIndexToId(cx, obj, index, JS_TRUE, &id))
             return JS_FALSE;
-        JS_ASSERT(id != JSVAL_VOID);
+        JS_ASSERT(!JSVAL_IS_VOID(id));
     }
     return OBJ_SET_PROPERTY(cx, obj, id, &v);
 }
 
 static JSBool
 DeleteArrayElement(JSContext *cx, JSObject *obj, jsuint index)
 {
     jsid id;
@@ -457,32 +457,32 @@ DeleteArrayElement(JSContext *cx, JSObje
         return JS_TRUE;
     }
 
     if (index <= JSVAL_INT_MAX) {
         id = INT_TO_JSID(index);
     } else {
         if (!BigIndexToId(cx, obj, index, JS_FALSE, &id))
             return JS_FALSE;
-        if (id == JSVAL_VOID)
+        if (JSVAL_IS_VOID(id))
             return JS_TRUE;
     }
     return OBJ_DELETE_PROPERTY(cx, obj, id, &junk);
 }
 
 /*
  * When hole is true, delete the property at the given index. Otherwise set
  * its value to v assuming v is rooted.
  */
 static JSBool
 SetOrDeleteArrayElement(JSContext *cx, JSObject *obj, jsuint index,
                         JSBool hole, jsval v)
 {
     if (hole) {
-        JS_ASSERT(v == JSVAL_VOID);
+        JS_ASSERT(JSVAL_IS_VOID(v));
         return DeleteArrayElement(cx, obj, index);
     }
     return SetArrayElement(cx, obj, index, v);
 }
 
 JSBool
 js_SetLengthProperty(JSContext *cx, JSObject *obj, jsuint length)
 {
@@ -611,17 +611,17 @@ array_length_setter(JSContext *cx, JSObj
         /* Protect iter against GC in OBJ_DELETE_PROPERTY. */
         JS_PUSH_TEMP_ROOT_OBJECT(cx, iter, &tvr);
         gap = oldlen - newlen;
         for (;;) {
             ok = (JS_CHECK_OPERATION_LIMIT(cx, JSOW_JUMP) &&
                   JS_NextProperty(cx, iter, &id));
             if (!ok)
                 break;
-            if (id == JSVAL_VOID)
+            if (JSVAL_IS_VOID(id))
                 break;
             if (js_IdIsIndex(id, &index) && index - newlen < gap) {
                 ok = OBJ_DELETE_PROPERTY(cx, obj, id, &junk);
                 if (!ok)
                     break;
             }
         }
         JS_POP_TEMP_ROOT(cx, &tvr);
@@ -661,30 +661,30 @@ array_lookupProperty(JSContext *cx, JSOb
         }
 
         return OBJ_LOOKUP_PROPERTY(cx, proto, id, objp, propp);
     }
 
     /* FIXME 417501: threadsafety: could race with a lookup on another thread.
      * If we can only have a single lookup active per context, we could
      * pigeonhole this on the context instead. */
-    JS_ASSERT(STOBJ_GET_SLOT(obj, JSSLOT_ARRAY_LOOKUP_HOLDER) == JSVAL_VOID);
-    STOBJ_SET_SLOT(obj, JSSLOT_ARRAY_LOOKUP_HOLDER, (jsval)id);
+    JS_ASSERT(JSVAL_IS_VOID(obj->fslots[JSSLOT_ARRAY_LOOKUP_HOLDER]));
+    obj->fslots[JSSLOT_ARRAY_LOOKUP_HOLDER] = (jsval) id;
     *propp = (JSProperty *)&(obj->fslots[JSSLOT_ARRAY_LOOKUP_HOLDER]);
     *objp = obj;
     return JS_TRUE;
 }
 
 static void
 array_dropProperty(JSContext *cx, JSObject *obj, JSProperty *prop)
 {
-    JS_ASSERT(!OBJ_IS_DENSE_ARRAY(cx, obj) ||
-              STOBJ_GET_SLOT(obj, JSSLOT_ARRAY_LOOKUP_HOLDER) != JSVAL_VOID);
+    JS_ASSERT_IF(OBJ_IS_DENSE_ARRAY(cx, obj),
+                 !JSVAL_IS_VOID(obj->fslots[JSSLOT_ARRAY_LOOKUP_HOLDER]));
 #ifdef DEBUG
-    STOBJ_SET_SLOT(obj, JSSLOT_ARRAY_LOOKUP_HOLDER, JSVAL_VOID);
+    obj->fslots[JSSLOT_ARRAY_LOOKUP_HOLDER] = JSVAL_VOID;
 #endif
 }
 
 static JSBool
 array_getProperty(JSContext *cx, JSObject *obj, jsid id, jsval *vp)
 {
     uint32 i;
 
@@ -907,18 +907,18 @@ array_enumerate(JSContext *cx, JSObject 
 {
     uint32 length, i;
     JSIndexIterState *ii;
 
     switch (enum_op) {
       case JSENUMERATE_INIT:
         JS_ASSERT(OBJ_IS_DENSE_ARRAY(cx, obj));
         length = ARRAY_DENSE_LENGTH(obj);
-        if (idp && !IndexToId(cx, length, idp))
-            return JS_FALSE;
+        if (idp)
+            *idp = INT_TO_JSVAL(obj->fslots[JSSLOT_ARRAY_COUNT]);
         ii = NULL;
         for (i = 0; i != length; ++i) {
             if (obj->dslots[i] == JSVAL_HOLE) {
                 if (!ii) {
                     ii = (JSIndexIterState *)
                          JS_malloc(cx, offsetof(JSIndexIterState, holes) +
                                    JS_BITMAP_SIZE(length));
                     if (!ii)
@@ -1703,18 +1703,18 @@ sort_compare(void *arg, const void *a, c
     JSContext *cx = ca->context;
     jsval *invokevp, *sp;
     jsdouble cmp;
 
     /**
      * array_sort deals with holes and undefs on its own and they should not
      * come here.
      */
-    JS_ASSERT(av != JSVAL_VOID);
-    JS_ASSERT(bv != JSVAL_VOID);
+    JS_ASSERT(!JSVAL_IS_VOID(av));
+    JS_ASSERT(!JSVAL_IS_VOID(bv));
 
     if (!JS_CHECK_OPERATION_LIMIT(cx, JSOW_JUMP))
         return JS_FALSE;
 
     invokevp = ca->elemroot;
     sp = invokevp;
     *sp++ = ca->fval;
     *sp++ = JSVAL_NULL;
@@ -1851,17 +1851,17 @@ array_sort(JSContext *cx, uintN argc, js
         tvr.count = newlen + 1;
         ok = GetArrayElement(cx, obj, i, &hole, &vec[newlen]);
         if (!ok)
             goto out;
 
         if (hole)
             continue;
 
-        if (vec[newlen] == JSVAL_VOID) {
+        if (JSVAL_IS_VOID(vec[newlen])) {
             ++undefs;
             continue;
         }
 
         /* We know JSVAL_IS_STRING yields 0 or 1, so avoid a branch via &=. */
         all_strings &= JSVAL_IS_STRING(vec[newlen]);
 
         ++newlen;
diff --git a/js/src/jsatom.cpp b/js/src/jsatom.cpp
--- a/js/src/jsatom.cpp
+++ b/js/src/jsatom.cpp
@@ -785,18 +785,18 @@ js_AtomizePrimitiveValue(JSContext *cx, 
         atom = js_AtomizeString(cx, JSVAL_TO_STRING(v), 0);
         if (!atom)
             return JS_FALSE;
     } else if (JSVAL_IS_DOUBLE(v)) {
         atom = js_AtomizeDouble(cx, *JSVAL_TO_DOUBLE(v));
         if (!atom)
             return JS_FALSE;
     } else {
-        JS_ASSERT(JSVAL_IS_INT(v) || v == JSVAL_TRUE || v == JSVAL_FALSE ||
-                  v == JSVAL_NULL || v == JSVAL_VOID);
+        JS_ASSERT(JSVAL_IS_INT(v) || JSVAL_IS_BOOLEAN(v) ||
+                  JSVAL_IS_NULL(v) || JSVAL_IS_VOID(v));
         atom = (JSAtom *)v;
     }
     *atomp = atom;
     return JS_TRUE;
 }
 
 JSBool
 js_ValueToStringId(JSContext *cx, jsval v, jsid *idp)
diff --git a/js/src/jsbool.cpp b/js/src/jsbool.cpp
--- a/js/src/jsbool.cpp
+++ b/js/src/jsbool.cpp
@@ -48,16 +48,21 @@
 #include "jsbool.h"
 #include "jscntxt.h"
 #include "jsconfig.h"
 #include "jsinterp.h"
 #include "jslock.h"
 #include "jsnum.h"
 #include "jsobj.h"
 #include "jsstr.h"
+
+/* Check pseudo-booleans values. */
+JS_STATIC_ASSERT(JSVAL_VOID == JSVAL_TRUE + JSVAL_ALIGN);
+JS_STATIC_ASSERT(JSVAL_HOLE == JSVAL_VOID + JSVAL_ALIGN);
+JS_STATIC_ASSERT(JSVAL_ARETURN == JSVAL_HOLE + JSVAL_ALIGN);
 
 JSClass js_BooleanClass = {
     "Boolean",
     JSCLASS_HAS_PRIVATE | JSCLASS_HAS_CACHED_PROTO(JSProto_Boolean),
     JS_PropertyStub,  JS_PropertyStub,  JS_PropertyStub,  JS_PropertyStub,
     JS_EnumerateStub, JS_ResolveStub,   JS_ConvertStub,   JS_FinalizeStub,
     JSCLASS_NO_OPTIONAL_MEMBERS
 };
diff --git a/js/src/jsbool.h b/js/src/jsbool.h
--- a/js/src/jsbool.h
+++ b/js/src/jsbool.h
@@ -41,26 +41,28 @@
 #define jsbool_h___
 /*
  * JS boolean interface.
  */
 
 JS_BEGIN_EXTERN_C
 
 /*
- * Crypto-booleans, not visible to script but used internally by the engine.
+ * Pseudo-booleans, not visible to script but used internally by the engine.
  *
  * JSVAL_HOLE is a useful value for identifying a hole in an array.  It's also
  * used in the interpreter to represent "no exception pending".  In general it
  * can be used to represent "no value".
  *
  * JSVAL_ARETURN is used to throw asynchronous return for generator.close().
+ *
+ * NB: BOOLEAN_TO_JSVAL(2) is JSVAL_VOID (see jsapi.h).
  */
-#define JSVAL_HOLE      BOOLEAN_TO_JSVAL(2)
-#define JSVAL_ARETURN   BOOLEAN_TO_JSVAL(3)
+#define JSVAL_HOLE      BOOLEAN_TO_JSVAL(3)
+#define JSVAL_ARETURN   BOOLEAN_TO_JSVAL(4)
 
 extern JSClass js_BooleanClass;
 
 extern JSObject *
 js_InitBooleanClass(JSContext *cx, JSObject *obj);
 
 extern JSString *
 js_BooleanToString(JSContext *cx, JSBool b);
diff --git a/js/src/jscntxt.h b/js/src/jscntxt.h
--- a/js/src/jscntxt.h
+++ b/js/src/jscntxt.h
@@ -56,35 +56,37 @@
 #include "jspubtd.h"
 #include "jsregexp.h"
 #include "jsutil.h"
 
 JS_BEGIN_EXTERN_C
 
 /*
  * js_GetSrcNote cache to avoid O(n^2) growth in finding a source note for a
- * given pc in a script.
+ * given pc in a script. We use the script->code pointer to tag the cache,
+ * instead of the script address itself, so that source notes are always found
+ * by offset from the bytecode with which they were generated.
  */
 typedef struct JSGSNCache {
-    JSScript        *script;
+    jsbytecode      *code;
     JSDHashTable    table;
 #ifdef JS_GSNMETER
     uint32          hits;
     uint32          misses;
     uint32          fills;
     uint32          clears;
 # define GSN_CACHE_METER(cache,cnt) (++(cache)->cnt)
 #else
 # define GSN_CACHE_METER(cache,cnt) /* nothing */
 #endif
 } JSGSNCache;
 
 #define GSN_CACHE_CLEAR(cache)                                                \
     JS_BEGIN_MACRO                                                            \
-        (cache)->script = NULL;                                               \
+        (cache)->code = NULL;                                                 \
         if ((cache)->table.ops) {                                             \
             JS_DHashTableFinish(&(cache)->table);                             \
             (cache)->table.ops = NULL;                                        \
         }                                                                     \
         GSN_CACHE_METER(cache, clears);                                       \
     JS_END_MACRO
 
 /* These helper macros take a cx as parameter and operate on its GSN cache. */
diff --git a/js/src/jsfun.cpp b/js/src/jsfun.cpp
--- a/js/src/jsfun.cpp
+++ b/js/src/jsfun.cpp
@@ -2026,17 +2026,17 @@ js_NewFunction(JSContext *cx, JSObject *
     if (funobj) {
         JS_ASSERT(HAS_FUNCTION_CLASS(funobj));
         OBJ_SET_PARENT(cx, funobj, parent);
     } else {
         funobj = js_NewObject(cx, &js_FunctionClass, NULL, parent, 0);
         if (!funobj)
             return NULL;
     }
-    JS_ASSERT(funobj->fslots[JSSLOT_PRIVATE] == JSVAL_VOID);
+    JS_ASSERT(JSVAL_IS_VOID(funobj->fslots[JSSLOT_PRIVATE]));
     fun = (JSFunction *) funobj;
 
     /* Initialize all function members. */
     fun->nargs = nargs;
     fun->flags = flags & (JSFUN_FLAGS_MASK | JSFUN_INTERPRETED);
     if (flags & JSFUN_INTERPRETED) {
         JS_ASSERT(!native);
         JS_ASSERT(nargs == 0);
diff --git a/js/src/jsgc.cpp b/js/src/jsgc.cpp
--- a/js/src/jsgc.cpp
+++ b/js/src/jsgc.cpp
@@ -3013,18 +3013,26 @@ js_GC(JSContext *cx, JSGCInvocationKind 
     if (gckind != GC_SET_SLOT_REQUEST && (callback = rt->gcCallback)) {
         JSBool ok;
 
         if (gckind & GC_LOCK_HELD)
             JS_UNLOCK_GC(rt);
         ok = callback(cx, JSGC_BEGIN);
         if (gckind & GC_LOCK_HELD)
             JS_LOCK_GC(rt);
-        if (!ok && gckind != GC_LAST_CONTEXT)
+        if (!ok && gckind != GC_LAST_CONTEXT) {
+            /*
+             * It's possible that we've looped back to this code from the 'goto
+             * restart_at_beginning' below in the GC_SET_SLOT_REQUEST code and
+             * that rt->gcLevel is now 0. Don't return without notifying!
+             */
+            if (rt->gcLevel == 0 && (gckind & GC_LOCK_HELD))
+                JS_NOTIFY_GC_DONE(rt);
             return;
+        }
     }
 
     /* Lock out other GC allocator and collector invocations. */
     if (!(gckind & GC_LOCK_HELD))
         JS_LOCK_GC(rt);
 
     METER(rt->gcStats.poke++);
     rt->gcPoke = JS_FALSE;
@@ -3164,22 +3172,17 @@ js_GC(JSContext *cx, JSGCInvocationKind 
     rt->gcMallocBytes = 0;
 
 #ifdef JS_DUMP_SCOPE_METERS
   { extern void js_DumpScopeMeters(JSRuntime *rt);
     js_DumpScopeMeters(rt);
   }
 #endif
 
-    /*
-     * Clear property cache weak references and disable the cache so nothing
-     * can fill it during GC (this is paranoia, since scripts should not run
-     * during GC).
-     */
-    js_DisablePropertyCache(cx);
+    /* Clear property cache weak references. */
     js_FlushPropertyCache(cx);
 
 #ifdef JS_THREADSAFE
     /*
      * Set all thread local freelists to NULL. We may visit a thread's
      * freelist more than once. To avoid redundant clearing we unroll the
      * current thread's step.
      *
@@ -3191,17 +3194,16 @@ js_GC(JSContext *cx, JSGCInvocationKind 
      */
     memset(cx->thread->gcFreeLists, 0, sizeof cx->thread->gcFreeLists);
     iter = NULL;
     while ((acx = js_ContextIterator(rt, JS_FALSE, &iter)) != NULL) {
         if (!acx->thread || acx->thread == cx->thread)
             continue;
         memset(acx->thread->gcFreeLists, 0, sizeof acx->thread->gcFreeLists);
         GSN_CACHE_CLEAR(&acx->thread->gsnCache);
-        js_DisablePropertyCache(acx);
         js_FlushPropertyCache(acx);
     }
 #else
     /* The thread-unsafe case just has to clear the runtime's GSN cache. */
     GSN_CACHE_CLEAR(&rt->gsnCache);
 #endif
 
   restart:
@@ -3464,24 +3466,29 @@ js_GC(JSContext *cx, JSGCInvocationKind 
      */
     if (rt->gcLevel > 1 || rt->gcPoke) {
         rt->gcLevel = 1;
         rt->gcPoke = JS_FALSE;
         JS_UNLOCK_GC(rt);
         goto restart;
     }
 
-    if (!(rt->shapeGen & SHAPE_OVERFLOW_BIT)) {
-        js_EnablePropertyCache(cx);
+    if (rt->shapeGen & SHAPE_OVERFLOW_BIT) {
+        /*
+         * FIXME bug 440834: The shape id space has overflowed. Currently we
+         * cope badly with this. Every call to js_GenerateShape does GC, and
+         * we never re-enable the property cache.
+         */
+        js_DisablePropertyCache(cx);
 #ifdef JS_THREADSAFE
         iter = NULL;
         while ((acx = js_ContextIterator(rt, JS_FALSE, &iter)) != NULL) {
             if (!acx->thread || acx->thread == cx->thread)
                 continue;
-            js_EnablePropertyCache(acx);
+            js_DisablePropertyCache(acx);
         }
 #endif
     }
 
     rt->gcLastBytes = rt->gcBytes;
   done_running:
     rt->gcLevel = 0;
     rt->gcRunning = JS_FALSE;
diff --git a/js/src/jsinterp.cpp b/js/src/jsinterp.cpp
--- a/js/src/jsinterp.cpp
+++ b/js/src/jsinterp.cpp
@@ -113,16 +113,17 @@ js_FillPropertyCache(JSContext *cx, JSOb
     JSOp op;
     const JSCodeSpec *cs;
     jsuword vword;
     ptrdiff_t pcoff;
     jsuword khash;
     JSAtom *atom;
     JSPropCacheEntry *entry;
 
+    JS_ASSERT(!cx->runtime->gcRunning);
     cache = &JS_PROPERTY_CACHE(cx);
     pc = cx->fp->regs->pc;
     if (cache->disabled) {
         PCMETER(cache->disfills++);
         *entryp = NULL;
         return;
     }
 
@@ -2427,18 +2428,16 @@ js_DumpOpMeters()
  * Quickly test if v is an int from the [-2**29, 2**29) range, that is, when
  * the lowest bit of v is 1 and the bits 30 and 31 are both either 0 or 1. For
  * such v we can do increment or decrement via adding or subtracting two
  * without checking that the result overflows JSVAL_INT_MIN or JSVAL_INT_MAX.
  */
 #define CAN_DO_FAST_INC_DEC(v)     (((((v) << 1) ^ v) & 0x80000001) == 1)
 
 JS_STATIC_ASSERT(JSVAL_INT == 1);
-JS_STATIC_ASSERT(JSVAL_INT & JSVAL_VOID);
-JS_STATIC_ASSERT(!CAN_DO_FAST_INC_DEC(JSVAL_VOID));
 JS_STATIC_ASSERT(!CAN_DO_FAST_INC_DEC(INT_TO_JSVAL(JSVAL_INT_MIN)));
 JS_STATIC_ASSERT(!CAN_DO_FAST_INC_DEC(INT_TO_JSVAL(JSVAL_INT_MAX)));
 
 /*
  * Conditional assert to detect failure to clear a pending exception that is
  * suppressed (or unintentional suppression of a wanted exception).
  */
 #if defined DEBUG_brendan || defined DEBUG_mrbkap || defined DEBUG_shaver
@@ -2519,20 +2518,16 @@ JS_STATIC_ASSERT(JSOP_XMLNAME_LENGTH == 
 /*
  * Same for JSOP_SETNAME and JSOP_SETPROP, which differ only slightly but
  * remain distinct for the decompiler.
  */
 JS_STATIC_ASSERT(JSOP_SETNAME_LENGTH == JSOP_SETPROP_LENGTH);
 
 /* Ensure we can share deffun and closure code. */
 JS_STATIC_ASSERT(JSOP_DEFFUN_LENGTH == JSOP_CLOSURE_LENGTH);
-
-
-/* See comments in FETCH_SHIFT macro. */
-JS_STATIC_ASSERT((JSVAL_TO_INT(JSVAL_VOID) & 31) == 0);
 
 /* See TRY_BRANCH_AFTER_COND. */
 JS_STATIC_ASSERT(JSOP_IFNE_LENGTH == JSOP_IFEQ_LENGTH);
 JS_STATIC_ASSERT(JSOP_IFNE == JSOP_IFEQ + 1);
 
 JSBool
 js_Interpret(JSContext *cx)
 {
@@ -2560,17 +2555,17 @@ js_Interpret(JSContext *cx)
     JSScopeProperty *sprop;
     JSString *str, *str2;
     jsint i, j;
     jsdouble d, d2;
     JSClass *clasp;
     JSFunction *fun;
     JSType type;
 #if JS_THREADED_INTERP
-    register const void * const *jumpTable;
+    register void * const *jumpTable;
 #else
     register uint32 switchMask;
     uintN switchOp;
 #endif
 #if JS_HAS_EXPORT_IMPORT
     JSIdArray *ida;
 #endif
     jsint low, high, off, npairs;
@@ -2583,24 +2578,24 @@ js_Interpret(JSContext *cx)
 # define JS_EXTENSION __extension__
 # define JS_EXTENSION_(s) __extension__ ({ s; })
 #else
 # define JS_EXTENSION
 # define JS_EXTENSION_(s) s
 #endif
 
 #if JS_THREADED_INTERP
-    static const void *const normalJumpTable[] = {
+    static void *const normalJumpTable[] = {
 # define OPDEF(op,val,name,token,length,nuses,ndefs,prec,format) \
         JS_EXTENSION &&L_##op,
 # include "jsopcode.tbl"
 # undef OPDEF
     };
 
-    static const void *const interruptJumpTable[] = {
+    static void *const interruptJumpTable[] = {
 # define OPDEF(op,val,name,token,length,nuses,ndefs,prec,format)              \
         JS_EXTENSION &&L_JSOP_INTERRUPT,
 # include "jsopcode.tbl"
 # undef OPDEF
     };
 
     METER_OP_INIT(op);      /* to nullify first METER_OP_PAIR */
 
@@ -3536,25 +3531,17 @@ js_Interpret(JSContext *cx)
     JS_END_MACRO
 
 #define RELATIONAL_OP(OP)                                                     \
     JS_BEGIN_MACRO                                                            \
         rval = FETCH_OPND(-1);                                                \
         lval = FETCH_OPND(-2);                                                \
         /* Optimize for two int-tagged operands (typical loop control). */    \
         if ((lval & rval) & JSVAL_INT) {                                      \
-            ltmp = lval ^ JSVAL_VOID;                                         \
-            rtmp = rval ^ JSVAL_VOID;                                         \
-            if (ltmp && rtmp) {                                               \
-                cond = JSVAL_TO_INT(lval) OP JSVAL_TO_INT(rval);              \
-            } else {                                                          \
-                d  = ltmp ? JSVAL_TO_INT(lval) : *rt->jsNaN;                  \
-                d2 = rtmp ? JSVAL_TO_INT(rval) : *rt->jsNaN;                  \
-                cond = JSDOUBLE_COMPARE(d, OP, d2, JS_FALSE);                 \
-            }                                                                 \
+            cond = JSVAL_TO_INT(lval) OP JSVAL_TO_INT(rval);                  \
         } else {                                                              \
             if (!JSVAL_IS_PRIMITIVE(lval))                                    \
                 DEFAULT_VALUE(cx, -2, JSTYPE_NUMBER, lval);                   \
             if (!JSVAL_IS_PRIMITIVE(rval))                                    \
                 DEFAULT_VALUE(cx, -1, JSTYPE_NUMBER, rval);                   \
             if (JSVAL_IS_STRING(lval) && JSVAL_IS_STRING(rval)) {             \
                 str  = JSVAL_TO_STRING(lval);                                 \
                 str2 = JSVAL_TO_STRING(rval);                                 \
@@ -3720,41 +3707,21 @@ js_Interpret(JSContext *cx)
 
           BEGIN_CASE(JSOP_GE)
             RELATIONAL_OP(>=);
           END_CASE(JSOP_GE)
 
 #undef EQUALITY_OP
 #undef RELATIONAL_OP
 
-/*
- * We do not check for JSVAL_VOID here since ToInt32(undefined) == 0
- * and (JSVAL_TO_INT(JSVAL_VOID) & 31) == 0. The static assert before
- * js_Interpret ensures this.
- */
-#define FETCH_SHIFT(shift)                                                    \
-    JS_BEGIN_MACRO                                                            \
-        jsval v_;                                                             \
-                                                                              \
-        v_ = FETCH_OPND(-1);                                                  \
-        if (v_ & JSVAL_INT) {                                                 \
-            shift = JSVAL_TO_INT(v_);                                         \
-        } else {                                                              \
-            shift = js_ValueToECMAInt32(cx, &regs.sp[-1]);                    \
-            if (JSVAL_IS_NULL(regs.sp[-1]))                                   \
-                goto error;                                                   \
-        }                                                                     \
-        shift &= 31;                                                          \
-    JS_END_MACRO
-
 #define SIGNED_SHIFT_OP(OP)                                                   \
     JS_BEGIN_MACRO                                                            \
         FETCH_INT(cx, -2, i);                                                 \
-        FETCH_SHIFT(j);                                                       \
-        i = i OP j;                                                           \
+        FETCH_INT(cx, -1, j);                                                 \
+        i = i OP (j & 31);                                                    \
         regs.sp--;                                                            \
         STORE_INT(cx, -1, i);                                                 \
     JS_END_MACRO
 
           BEGIN_CASE(JSOP_LSH)
             SIGNED_SHIFT_OP(<<);
           END_CASE(JSOP_LSH)
 
@@ -3762,18 +3729,18 @@ js_Interpret(JSContext *cx)
             SIGNED_SHIFT_OP(>>);
           END_CASE(JSOP_RSH)
 
           BEGIN_CASE(JSOP_URSH)
           {
             uint32 u;
 
             FETCH_UINT(cx, -2, u);
-            FETCH_SHIFT(j);
-            u >>= j;
+            FETCH_INT(cx, -1, j);
+            u >>= (j & 31);
             regs.sp--;
             STORE_UINT(cx, -1, u);
           }
           END_CASE(JSOP_URSH)
 
 #undef BITWISE_OP
 #undef SIGNED_SHIFT_OP
 
@@ -3824,20 +3791,20 @@ js_Interpret(JSContext *cx)
                     regs.sp--;
                     STORE_NUMBER(cx, -1, d);
                 }
             }
           END_CASE(JSOP_ADD)
 
 #define BINARY_OP(OP)                                                         \
     JS_BEGIN_MACRO                                                            \
+        FETCH_NUMBER(cx, -2, d);                                              \
         FETCH_NUMBER(cx, -1, d2);                                             \
-        FETCH_NUMBER(cx, -2, d);                                              \
         d = d OP d2;                                                          \
-        regs.sp--;                                                                 \
+        regs.sp--;                                                            \
         STORE_NUMBER(cx, -1, d);                                              \
     JS_END_MACRO
 
           BEGIN_CASE(JSOP_SUB)
             BINARY_OP(-);
           END_CASE(JSOP_SUB)
 
           BEGIN_CASE(JSOP_MUL)
@@ -3892,22 +3859,25 @@ js_Interpret(JSContext *cx)
           BEGIN_CASE(JSOP_BITNOT)
             FETCH_INT(cx, -1, i);
             i = ~i;
             STORE_INT(cx, -1, i);
           END_CASE(JSOP_BITNOT)
 
           BEGIN_CASE(JSOP_NEG)
             /*
-             * Optimize the case of an int-tagged operand by noting that
-             * INT_FITS_IN_JSVAL(i) => INT_FITS_IN_JSVAL(-i) unless i is 0
-             * when -i is the negative zero which is jsdouble.
-             */
-            rval = FETCH_OPND(-1);
-            if (JSVAL_IS_INT(rval) && (i = JSVAL_TO_INT(rval)) != 0) {
+             * When the operand is int jsval, INT_FITS_IN_JSVAL(i) implies
+             * INT_FITS_IN_JSVAL(-i) unless i is 0 or JSVAL_INT_MIN when the
+             * results, -0.0 or JSVAL_INT_MAX + 1, are jsdouble values.
+             */
+            rval = FETCH_OPND(-1);
+            if (JSVAL_IS_INT(rval) &&
+                rval != INT_TO_JSVAL(JSVAL_INT_MIN) &&
+                (i = JSVAL_TO_INT(rval)) != 0) {
+                JS_STATIC_ASSERT(!INT_FITS_IN_JSVAL(-JSVAL_INT_MIN));
                 i = -i;
                 JS_ASSERT(INT_FITS_IN_JSVAL(i));
                 regs.sp[-1] = INT_TO_JSVAL(i);
             } else {
                 if (JSVAL_IS_DOUBLE(rval)) {
                     d = *JSVAL_TO_DOUBLE(rval);
                 } else {
                     d = js_ValueToNumber(cx, &regs.sp[-1]);
@@ -4440,17 +4410,17 @@ js_Interpret(JSContext *cx)
                     (obj = JSVAL_TO_OBJECT(rval),
                      fun = GET_FUNCTION_PRIVATE(cx, obj),
                      !PRIMITIVE_THIS_TEST(fun, lval))) {
                     if (!js_PrimitiveToObject(cx, &regs.sp[-1]))
                         goto error;
                 }
             }
 #if JS_HAS_NO_SUCH_METHOD
-            if (JS_UNLIKELY(rval == JSVAL_VOID)) {
+            if (JS_UNLIKELY(JSVAL_IS_VOID(rval))) {
                 LOAD_ATOM(0);
                 regs.sp[-2] = ATOM_KEY(atom);
                 if (!js_OnUnknownMethod(cx, regs.sp - 2))
                     goto error;
             }
 #endif
           }
           END_CASE(JSOP_CALLPROP)
@@ -4703,17 +4673,17 @@ js_Interpret(JSContext *cx)
 
           BEGIN_CASE(JSOP_CALLELEM)
             /*
              * FIXME: JSOP_CALLELEM should call getMethod on XML objects as
              * CALLPROP does. See bug 362910.
              */
             ELEMENT_OP(-1, OBJ_GET_PROPERTY(cx, obj, id, &rval));
 #if JS_HAS_NO_SUCH_METHOD
-            if (JS_UNLIKELY(rval == JSVAL_VOID)) {
+            if (JS_UNLIKELY(JSVAL_IS_VOID(rval))) {
                 regs.sp[-2] = regs.sp[-1];
                 regs.sp[-1] = OBJECT_TO_JSVAL(obj);
                 if (!js_OnUnknownMethod(cx, regs.sp - 2))
                     goto error;
             } else
 #endif
             {
                 STORE_OPND(-2, rval);
diff --git a/js/src/jsinterp.h b/js/src/jsinterp.h
--- a/js/src/jsinterp.h
+++ b/js/src/jsinterp.h
@@ -390,17 +390,17 @@ js_ComputeThis(JSContext *cx, JSBool laz
  * The alert should display "true".
  */
 JSObject *
 js_ComputeGlobalThis(JSContext *cx, JSBool lazy, jsval *argv);
 
 extern const uint16 js_PrimitiveTestFlags[];
 
 #define PRIMITIVE_THIS_TEST(fun,thisv)                                        \
-    (JS_ASSERT(thisv != JSVAL_VOID),                                          \
+    (JS_ASSERT(!JSVAL_IS_VOID(thisv)),                                        \
      JSFUN_THISP_TEST(JSFUN_THISP_FLAGS((fun)->flags),                        \
                       js_PrimitiveTestFlags[JSVAL_TAG(thisv) - 1]))
 
 /*
  * NB: js_Invoke requires that cx is currently running JS (i.e., that cx->fp
  * is non-null), and that vp points to the callee, |this| parameter, and
  * actual arguments of the call. [vp .. vp + 2 + argc) must belong to the last
  * JS stack segment that js_AllocStack allocated. The function may use the
diff --git a/js/src/jsobj.cpp b/js/src/jsobj.cpp
--- a/js/src/jsobj.cpp
+++ b/js/src/jsobj.cpp
@@ -2889,17 +2889,17 @@ js_AllocSlot(JSContext *cx, JSObject *ob
     }
 
     if (map->freeslot >= STOBJ_NSLOTS(obj) &&
         !js_ReallocSlots(cx, obj, map->freeslot + 1, JS_FALSE)) {
         return JS_FALSE;
     }
 
     /* js_ReallocSlots or js_FreeSlot should set the free slots to void. */
-    JS_ASSERT(STOBJ_GET_SLOT(obj, map->freeslot) == JSVAL_VOID);
+    JS_ASSERT(JSVAL_IS_VOID(STOBJ_GET_SLOT(obj, map->freeslot)));
     *slotp = map->freeslot++;
     return JS_TRUE;
 }
 
 void
 js_FreeSlot(JSContext *cx, JSObject *obj, uint32 slot)
 {
     JSObjectMap *map;
@@ -3338,28 +3338,28 @@ js_LookupPropertyWithFlags(JSContext *cx
                     if (!ok)
                         goto cleanup;
 
                     JS_LOCK_OBJ(cx, obj);
                     if (obj2) {
                         /* Resolved: juggle locks and lookup id again. */
                         if (obj2 != obj) {
                             JS_UNLOCK_OBJ(cx, obj);
-                            JS_LOCK_OBJ(cx, obj2);
+                            if (OBJ_IS_NATIVE(obj2))
+                                JS_LOCK_OBJ(cx, obj2);
                         }
                         protoIndex = 0;
                         for (proto = start; proto && proto != obj2;
                              proto = OBJ_GET_PROTO(cx, proto)) {
                             protoIndex++;
                         }
                         scope = OBJ_SCOPE(obj2);
                         if (!MAP_IS_NATIVE(&scope->map)) {
                             /* Whoops, newresolve handed back a foreign obj2. */
                             JS_ASSERT(obj2 != obj);
-                            JS_UNLOCK_OBJ(cx, obj2);
                             ok = OBJ_LOOKUP_PROPERTY(cx, obj2, id, objp, propp);
                             if (!ok || *propp)
                                 goto cleanup;
                             JS_LOCK_OBJ(cx, obj2);
                         } else {
                             /*
                              * Require that obj2 have its own scope now, as we
                              * do for old-style resolve.  If it doesn't, then
@@ -3370,17 +3370,18 @@ js_LookupPropertyWithFlags(JSContext *cx
                              */
                             if (scope->object == obj2)
                                 sprop = SCOPE_GET_PROPERTY(scope, id);
                         }
                         if (sprop) {
                             JS_ASSERT(obj2 == scope->object);
                             obj = obj2;
                         } else if (obj2 != obj) {
-                            JS_UNLOCK_OBJ(cx, obj2);
+                            if (OBJ_IS_NATIVE(obj2))
+                                JS_UNLOCK_OBJ(cx, obj2);
                             JS_LOCK_OBJ(cx, obj);
                         }
                     }
                 } else {
                     /*
                      * Old resolve always requires id re-lookup if obj owns
                      * its scope after resolve returns.
                      */
@@ -4686,17 +4687,17 @@ js_PrimitiveToObject(JSContext *cx, jsva
         &js_NumberClass,    /* INT     */
         &js_StringClass,    /* STRING  */
         &js_NumberClass,    /* INT     */
         &js_BooleanClass,   /* BOOLEAN */
         &js_NumberClass     /* INT     */
     };
 
     JS_ASSERT(!JSVAL_IS_OBJECT(*vp));
-    JS_ASSERT(*vp != JSVAL_VOID);
+    JS_ASSERT(!JSVAL_IS_VOID(*vp));
     clasp = PrimitiveClasses[JSVAL_TAG(*vp) - 1];
     obj = js_NewObject(cx, clasp, NULL, NULL, 0);
     if (!obj)
         return JS_FALSE;
     STOBJ_SET_SLOT(obj, JSSLOT_PRIVATE, *vp);
     *vp = OBJECT_TO_JSVAL(obj);
     return JS_TRUE;
 }
diff --git a/js/src/jsscript.cpp b/js/src/jsscript.cpp
--- a/js/src/jsscript.cpp
+++ b/js/src/jsscript.cpp
@@ -1527,17 +1527,17 @@ js_DestroyScript(JSContext *cx, JSScript
 js_DestroyScript(JSContext *cx, JSScript *script)
 {
     js_CallDestroyScriptHook(cx, script);
     JS_ClearScriptTraps(cx, script);
 
     if (script->principals)
         JSPRINCIPALS_DROP(cx, script->principals);
 
-    if (JS_GSN_CACHE(cx).script == script)
+    if (JS_GSN_CACHE(cx).code == script->code)
         JS_CLEAR_GSN_CACHE(cx);
 
     /*
      * The GC flushes all property caches, so no need to purge just the
      * entries for this script.
      *
      * JS_THREADSAFE note: js_FlushPropertyCacheForScript flushes only the
      * current thread's property cache, so a script not owned by a function
@@ -1633,17 +1633,17 @@ js_GetSrcNoteCached(JSContext *cx, JSScr
     jssrcnote *sn, *result;
     uintN nsrcnotes;
 
 
     target = PTRDIFF(pc, script->code, jsbytecode);
     if ((uint32)target >= script->length)
         return NULL;
 
-    if (JS_GSN_CACHE(cx).script == script) {
+    if (JS_GSN_CACHE(cx).code == script->code) {
         JS_METER_GSN_CACHE(cx, hits);
         entry = (GSNCacheEntry *)
                 JS_DHashTableOperate(&JS_GSN_CACHE(cx).table, pc,
                                      JS_DHASH_LOOKUP);
         return entry->sn;
     }
 
     JS_METER_GSN_CACHE(cx, misses);
@@ -1655,17 +1655,17 @@ js_GetSrcNoteCached(JSContext *cx, JSScr
         }
         offset += SN_DELTA(sn);
         if (offset == target && SN_IS_GETTABLE(sn)) {
             result = sn;
             break;
         }
     }
 
-    if (JS_GSN_CACHE(cx).script != script &&
+    if (JS_GSN_CACHE(cx).code != script->code &&
         script->length >= GSN_CACHE_THRESHOLD) {
         JS_CLEAR_GSN_CACHE(cx);
         nsrcnotes = 0;
         for (sn = SCRIPT_NOTES(script); !SN_IS_TERMINATOR(sn);
              sn = SN_NEXT(sn)) {
             if (SN_IS_GETTABLE(sn))
                 ++nsrcnotes;
         }
@@ -1681,17 +1681,17 @@ js_GetSrcNoteCached(JSContext *cx, JSScr
                 if (SN_IS_GETTABLE(sn)) {
                     entry = (GSNCacheEntry *)
                             JS_DHashTableOperate(&JS_GSN_CACHE(cx).table, pc,
                                                  JS_DHASH_ADD);
                     entry->pc = pc;
                     entry->sn = sn;
                 }
             }
-            JS_GSN_CACHE(cx).script = script;
+            JS_GSN_CACHE(cx).code = script->code;
             JS_METER_GSN_CACHE(cx, fills);
         }
     }
 
     return result;
 }
 
 uintN
diff --git a/js/src/jsutil.cpp b/js/src/jsutil.cpp
--- a/js/src/jsutil.cpp
+++ b/js/src/jsutil.cpp
@@ -84,17 +84,17 @@ BinToVal(uintN logscale, uintN bin)
 {
     JS_ASSERT(bin <= 10);
     if (bin <= 1 || logscale == 0)
         return bin;
     --bin;
     if (logscale == 2)
         return JS_BIT(bin);
     JS_ASSERT(logscale == 10);
-    return (uint32) pow(10, (double) bin);
+    return (uint32) pow(10.0, (double) bin);
 }
 
 static uintN
 ValToBin(uintN logscale, uint32 val)
 {
     uintN bin;
 
     if (val <= 1)
@@ -245,31 +245,31 @@ CallTree(void **bp)
     parent = &js_calltree_root;
     do {
         bpup = (void**) bp[0];
         bp[0] = (void*) bpdown;
         pc = bp[1];
 
         csp = &parent->kids;
         while ((site = *csp) != NULL) {
-            if (site->pc == pc) {
+            if (site->pc == (uint32)pc) {
                 /* Put the most recently used site at the front of siblings. */
                 *csp = site->siblings;
                 site->siblings = parent->kids;
                 parent->kids = site;
 
                 /* Site already built -- go up the stack. */
                 goto upward;
             }
             csp = &site->siblings;
         }
 
         /* Check for recursion: see if pc is on our ancestor line. */
         for (site = parent; site; site = site->parent) {
-            if (site->pc == pc)
+            if (site->pc == (uint32)pc)
                 goto upward;
         }
 
         /*
          * Not in tree at all: let's find our symbolic callsite info.
          * XXX static syms are masked by nearest lower global
          */
         info.dli_fname = info.dli_sname = NULL;
@@ -291,17 +291,17 @@ CallTree(void **bp)
             return NULL;
 
         /* Create a new callsite record. */
         site = (JSCallsite *) malloc(sizeof(JSCallsite));
         if (!site)
             return NULL;
 
         /* Insert the new site into the tree. */
-        site->pc = pc;
+        site->pc = (uint32)pc;
         site->name = method;
         site->library = info.dli_fname;
         site->offset = offset;
         site->parent = parent;
         site->siblings = parent->kids;
         parent->kids = site;
         site->kids = NULL;
 
diff --git a/js/src/xpconnect/src/XPCCrossOriginWrapper.cpp b/js/src/xpconnect/src/XPCCrossOriginWrapper.cpp
--- a/js/src/xpconnect/src/XPCCrossOriginWrapper.cpp
+++ b/js/src/xpconnect/src/XPCCrossOriginWrapper.cpp
@@ -486,34 +486,34 @@ XPC_XOW_WrapObject(JSContext *cx, JSObje
         return JS_FALSE;
       }
     }
   }
 
   XPCWrappedNativeScope *parentScope =
     XPCWrappedNativeScope::FindInJSObjectScope(ccx, parent);
 
-#ifdef DEBUG_mrbkap
+#ifdef DEBUG_mrbkap_off
   printf("Wrapping object at %p (%s) [%p]\n",
          (void *)wrappedObj, STOBJ_GET_CLASS(wrappedObj)->name,
          (void *)parentScope);
 #endif
 
   JSObject *outerObj = nsnull;
   WrappedNative2WrapperMap *map = parentScope->GetWrapperMap();
 
   { // Scoped lock
     XPCAutoLock al(rt->GetMapLock());
     outerObj = map->Find(wrappedObj);
   }
 
   if (outerObj) {
     NS_ASSERTION(STOBJ_GET_CLASS(outerObj) == &sXPC_XOW_JSClass.base,
                               "What crazy object are we getting here?");
-#ifdef DEBUG_mrbkap
+#ifdef DEBUG_mrbkap_off
     printf("But found a wrapper in the map %p!\n", (void *)outerObj);
 #endif
     *vp = OBJECT_TO_JSVAL(outerObj);
     return JS_TRUE;
   }
 
   // FIXME: bug 408871, Note that we create outerObj with a null parent
   // here. We set it later so that we find our nominal prototype in the
diff --git a/js/src/xpconnect/src/XPCNativeWrapper.cpp b/js/src/xpconnect/src/XPCNativeWrapper.cpp
--- a/js/src/xpconnect/src/XPCNativeWrapper.cpp
+++ b/js/src/xpconnect/src/XPCNativeWrapper.cpp
@@ -213,20 +213,22 @@ EnsureLegalActivity(JSContext *cx, JSObj
   uint32 fileFlags = JS_GetTopScriptFilenameFlags(cx, NULL);
   if (!JS_FrameIterator(cx, &frame) ||
       fileFlags == JSFILENAME_NULL ||
       (fileFlags & JSFILENAME_SYSTEM)) {
     // We expect implicit native wrappers in system files.
     return JS_TRUE;
   }
 
-  XPCCallContext ccx(JS_CALLER, cx);
-  nsIXPCSecurityManager *sm = ccx.GetXPCContext()->
-    GetAppropriateSecurityManager(nsIXPCSecurityManager::HOOK_CALL_METHOD);
-  nsCOMPtr<nsIScriptSecurityManager> ssm(do_QueryInterface(sm));
+  nsIScriptSecurityManager *ssm = XPCWrapper::GetSecurityManager();
+  if (!ssm) {
+    // If there's no security manager, then we're not running in a browser
+    // context: allow access.
+    return JS_TRUE;
+  }
 
   // A last ditch effort to allow access: if the currently-running code
   // has UniversalXPConnect privileges, then allow access.
   PRBool isPrivileged;
   nsresult rv = ssm->IsCapabilityEnabled("UniversalXPConnect", &isPrivileged);
   if (NS_SUCCEEDED(rv) && isPrivileged) {
     return JS_TRUE;
   }
diff --git a/js/src/xpconnect/src/xpccomponents.cpp b/js/src/xpconnect/src/xpccomponents.cpp
--- a/js/src/xpconnect/src/xpccomponents.cpp
+++ b/js/src/xpconnect/src/xpccomponents.cpp
@@ -2956,17 +2956,17 @@ nsXPCComponents_Utils::ReportError()
 }
 
 #ifndef XPCONNECT_STANDALONE
 #include "nsIScriptSecurityManager.h"
 #include "nsIURI.h"
 #include "nsNetUtil.h"
 const char kScriptSecurityManagerContractID[] = NS_SCRIPTSECURITYMANAGER_CONTRACTID;
 
-NS_IMPL_ISUPPORTS1(PrincipalHolder, nsIScriptObjectPrincipal)
+NS_IMPL_THREADSAFE_ISUPPORTS1(PrincipalHolder, nsIScriptObjectPrincipal)
 
 nsIPrincipal *
 PrincipalHolder::GetPrincipal()
 {
     return mHoldee;
 }
 
 JS_STATIC_DLL_CALLBACK(JSBool)
diff --git a/js/src/xpconnect/src/xpcthreadcontext.cpp b/js/src/xpconnect/src/xpcthreadcontext.cpp
--- a/js/src/xpconnect/src/xpcthreadcontext.cpp
+++ b/js/src/xpconnect/src/xpcthreadcontext.cpp
@@ -267,17 +267,17 @@ XPCJSContextStack::GetSafeJSContext(JSCo
 
 NS_IMETHODIMP
 XPCJSContextStack::SetSafeJSContext(JSContext * aSafeJSContext)
 {
     if(mOwnSafeJSContext &&
        mOwnSafeJSContext == mSafeJSContext &&
        mOwnSafeJSContext != aSafeJSContext)
     {
-        JS_DestroyContext(mOwnSafeJSContext);
+        JS_DestroyContextNoGC(mOwnSafeJSContext);
         mOwnSafeJSContext = nsnull;
         SyncJSContexts();
     }
 
     mSafeJSContext = aSafeJSContext;
     return NS_OK;
 }
 
diff --git a/js/tests/Makefile b/js/tests/Makefile
--- a/js/tests/Makefile
+++ b/js/tests/Makefile
@@ -17,21 +17,19 @@ spidermonkey-extensions-n.tests: $(TEST_
 	find . -name '*.js' | grep -v shell.js | grep -v browser.js | grep '/extensions/' | sed 's|\.\/||' | sort > $@
 
 menu-list.txt:
 	echo "http://$(TEST_HTTP)/tests/mozilla.org/$(JSDIR)/menu.html" > menu-list.txt
 
 confidential-failures.txt:
 	touch confidential-failures.txt
 
-failures.txt: public-failures.txt confidential-failures.txt
-	cp public-failures.txt public-failures.txt.save
-	cp confidential-failures.txt confidential-failures.txt.save
-	sort < public-failures.txt | uniq | ./create-patterns.pl > public-failures.$$
-	mv public-failures.$$ public-failures.txt
-	sort < confidential-failures.txt | uniq | ./create-patterns.pl > confidential-failures.$$
-	mv confidential-failures.$$ confidential-failures.txt
-	cat public-failures.txt confidential-failures.txt | sort | uniq > failures.txt
+public-failures.txt.expanded: public-failures.txt universe.data
+	pattern-expander.pl public-failures.txt > public-failures.txt.expanded
+
+confidential-failures.txt.expanded: confidential-failures.txt universe.data
+	pattern-expander.pl confidential-failures.txt > confidential-failures.txt.expanded
+
+failures.txt: public-failures.txt.expanded confidential-failures.txt.expanded
+	sort -u public-failures.txt.expanded confidential-failures.txt.expanded > failures.txt
 
 clean:
-	rm -f menubody.html menu.html menu-list.txt failures.txt excluded-*.tests included-*.tests urllist*.html urllist*.tests
-
-
+	rm -f menubody.html menu.html menu-list.txt failures.txt *failures.txt.expanded excluded-*.tests included-*.tests urllist*.html urllist*.tests
diff --git a/js/tests/Patterns.pm b/js/tests/Patterns.pm
new file mode 100644
--- /dev/null
+++ b/js/tests/Patterns.pm
@@ -0,0 +1,223 @@
+# -*- Mode: Perl; tab-width: 4; indent-tabs-mode: nil; -*-
+# ***** BEGIN LICENSE BLOCK *****
+# Version: MPL 1.1/GPL 2.0/LGPL 2.1
+#
+# The contents of this file are subject to the Mozilla Public License Version
+# 1.1 (the "License"); you may not use this file except in compliance with
+# the License. You may obtain a copy of the License at
+# http://www.mozilla.org/MPL/
+#
+# Software distributed under the License is distributed on an "AS IS" basis,
+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+# for the specific language governing rights and limitations under the
+# License.
+#
+# The Original Code is Mozilla JavaScript Testing Utilities
+#
+# The Initial Developer of the Original Code is
+# Mozilla Corporation.
+# Portions created by the Initial Developer are Copyright (C) 2008
+# the Initial Developer. All Rights Reserved.
+#
+# Contributor(s): Bob Clary <bclary@bclary.com>
+#
+# Alternatively, the contents of this file may be used under the terms of
+# either the GNU General Public License Version 2 or later (the "GPL"), or
+# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+# in which case the provisions of the GPL or the LGPL are applicable instead
+# of those above. If you wish to allow use of your version of this file only
+# under the terms of either the GPL or the LGPL, and not to allow others to
+# use your version of this file under the terms of the MPL, indicate your
+# decision by deleting the provisions above and replace them with the notice
+# and other provisions required by the GPL or the LGPL. If you do not delete
+# the provisions above, a recipient may use your version of this file under
+# the terms of any one of the MPL, the GPL or the LGPL.
+#
+# ***** END LICENSE BLOCK *****
+
+package Patterns;
+
+sub getuniversekey
+{
+    my ($machinerecord, $excludeduniversefield) = @_;
+    my $i;
+    my $key = '';
+
+#    dbg("getuniversekey: \$machinerecord=" . recordtostring($machinerecord) . ", \$excludeduniversefield=$excludeduniversefield");
+
+    for ($i = 0; $i < @universefields; $i++)
+    {
+#	dbg("getuniversekey: \$universefields[$i]=$universefields[$i]");
+
+        if ($universefields[$i] ne $excludeduniversefield)
+        {
+            $key .= $machinerecord->{$universefields[$i]}
+        }
+    }
+
+#    dbg("getuniversekey=$key");
+
+    return $key;
+}
+
+sub getuniverse
+{
+    my ($universekey, $excludeduniversefield) = @_;
+    my $i;
+    my $value;
+    my $testrun;
+    my @universe = ();
+    my %universehash = ();
+
+    dbg("getuniverse: \$universekey=$universekey, \$excludeduniversefield=$excludeduniversefield");
+
+    for ($i = 0; $i < @testruns; $i++)
+    {
+        $testrun = $testruns[$i];
+#	dbg("getuniverse: \$testruns[$i]=" . recordtostring($testrun));
+        $testrununiversekey = getuniversekey($testrun, $excludeduniversefield);
+#	dbg("getuniverse: \$testrununiversekey=$testrununiversekey");
+        if ($testrununiversekey =~ /$universekey/)
+        {
+#	    dbg("getuniverse: matched \$testrununiversekey=$testrununiversekey to \$universekey=$universekey");
+            $value = $testrun->{$excludeduniversefield};
+            
+#	    dbg("getuniverse: \$testrun->{$excludeduniversefield}=$value");
+
+            if (! $universehash{$value} )
+            {
+#		dbg("getuniverse: pushing $value");
+                push @universe, ($value);
+                $universehash{$value} = 1;
+            }
+        }
+    }
+    @universe = sort @universe;
+    dbg("getuniverse=" . join(',', @universe));
+    return @universe;
+}
+
+sub recordtostring
+{
+    my ($record) = @_;
+    my $j;
+    my $line   = '';
+    my $field;
+
+    for ($j = 0; $j < @recordfields - 1; $j++)
+    {
+        $field = $recordfields[$j];
+#	dbg("recordtostring: \$field=$field, \$record->{$field}=$record->{$field}");
+        $line .= "$field=$record->{$field}, ";
+    }
+    $field = $recordfields[$#recordfields];
+#    dbg("recordtodtring: \$field=$field, \$record->{$field}= $record->{$field}");
+    $line .= "$field=$record->{$field}";
+
+    return $line;
+}
+
+sub dumprecords
+{
+    my $record;
+    my $line;
+    my $prevline = '';
+    my $i;
+
+    dbg("dumping records");
+
+#    @records = sort sortrecords @records;
+
+    for ($i = 0; $i < @records; $i++)
+    {
+        $record = $records[$i];
+        $line   = recordtostring($record);
+        if ($line eq $prevline)
+        {
+#            dbg("DUPLICATE $line") if ($DEBUG);
+        }
+        else
+        {
+            print "$line\n";
+            $prevline = $line;
+        }
+    }
+}
+
+sub sortrecords
+{
+    return recordtostring($a) cmp recordtostring($b);
+}
+
+sub dbg 
+{
+    if ($DEBUG)
+    {
+	print STDERR "DEBUG: " . join(" ", @_) . "\n";
+    }
+}
+
+sub copyreference
+{
+    my ($fromreference) = @_;
+    my $toreference = {};
+    my $key;
+
+    foreach $key (keys %{$fromreference})
+    {
+	$toreference->{$key} = $fromreference->{$key};
+    }
+    return $toreference;
+}
+
+#my @recordfields;
+#my @universefields;
+#my %machines;
+#my @testruns;
+
+
+BEGIN 
+{
+    dbg("begin");
+
+    my $test_dir = $ENV{TEST_DIR} || "/work/mozilla/mozilla.com/test.mozilla.com/www";
+
+    $DEBUG = $ENV{DEBUG};
+
+    @recordfields   = ('TEST_ID', 'TEST_BRANCH', 'TEST_BUILDTYPE', 'TEST_TYPE', 'TEST_OS', 'TEST_KERNEL', 'TEST_PROCESSORTYPE', 'TEST_MEMORY', 'TEST_CPUSPEED', 'TEST_TIMEZONE', 'TEST_RESULT', 'TEST_EXITSTATUS', 'TEST_DESCRIPTION');
+    @sortkeyfields  = ('TEST_ID', 'TEST_RESULT', 'TEST_EXITSTATUS', 'TEST_DESCRIPTION', 'TEST_BRANCH', 'TEST_BUILDTYPE', 'TEST_TYPE', 'TEST_OS', 'TEST_KERNEL', 'TEST_PROCESSORTYPE', 'TEST_MEMORY', 'TEST_CPUSPEED', 'TEST_TIMEZONE', );
+    @universefields = ('TEST_BRANCH', 'TEST_BUILDTYPE', 'TEST_TYPE', 'TEST_OS', 'TEST_KERNEL', 'TEST_PROCESSORTYPE', 'TEST_MEMORY', 'TEST_CPUSPEED', 'TEST_TIMEZONE');
+
+    @records = ();
+
+    @testruns = ();
+
+    open TESTRUNS, "<$test_dir/tests/mozilla.org/js/universe.data" or die "$?";
+
+    while (<TESTRUNS>) {
+
+        chomp;
+
+        my $record = {};
+
+        my ($test_os, $test_kernel, $test_processortype, $test_memory, $test_cpuspeed, $test_timezone, $test_branch, $test_buildtype, $test_type) = $_ =~ 
+            /^TEST_OS=([^,]*), TEST_KERNEL=([^,]*), TEST_PROCESSORTYPE=([^,]*), TEST_MEMORY=([^,]*), TEST_CPUSPEED=([^,]*), TEST_TIMEZONE=([^,]*), TEST_BRANCH=([^,]*), TEST_BUILDTYPE=([^,]*), TEST_TYPE=([^,]*)/;
+
+        $record->{TEST_BRANCH}        = $test_branch;
+        $record->{TEST_BUILDTYPE}     = $test_buildtype;
+        $record->{TEST_TYPE}          = $test_type;
+        $record->{TEST_OS}            = $test_os;
+        $record->{TEST_KERNEL}        = $test_kernel;
+        $record->{TEST_PROCESSORTYPE} = $test_processortype;
+        $record->{TEST_MEMORY}        = $test_memory;
+        $record->{TEST_CPUSPEED}      = $test_cpuspeed;
+        $record->{TEST_TIMEZONE}      = $test_timezone;
+
+	push @testruns, ($record);
+    }
+
+    close TESTRUNS;
+
+}
+
+1;
diff --git a/js/tests/changes.sh b/js/tests/changes.sh
new file mode 100644
--- /dev/null
+++ b/js/tests/changes.sh
@@ -0,0 +1,120 @@
+#!/bin/bash
+# -*- Mode: Shell-script; tab-width: 4; indent-tabs-mode: nil; -*-
+
+# ***** BEGIN LICENSE BLOCK *****
+# Version: MPL 1.1/GPL 2.0/LGPL 2.1
+#
+# The contents of this file are subject to the Mozilla Public License Version
+# 1.1 (the "License"); you may not use this file except in compliance with
+# the License. You may obtain a copy of the License at
+# http://www.mozilla.org/MPL/
+#
+# Software distributed under the License is distributed on an "AS IS" basis,
+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+# for the specific language governing rights and limitations under the
+# License.
+#
+# The Original Code is Mozilla JavaScript Testing Utilities
+#
+# The Initial Developer of the Original Code is
+# Mozilla Corporation.
+# Portions created by the Initial Developer are Copyright (C) 2008
+# the Initial Developer. All Rights Reserved.
+#
+# Contributor(s): Bob Clary <bclary@bclary.com>
+#
+# Alternatively, the contents of this file may be used under the terms of
+# either the GNU General Public License Version 2 or later (the "GPL"), or
+# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+# in which case the provisions of the GPL or the LGPL are applicable instead
+# of those above. If you wish to allow use of your version of this file only
+# under the terms of either the GPL or the LGPL, and not to allow others to
+# use your version of this file under the terms of the MPL, indicate your
+# decision by deleting the provisions above and replace them with the notice
+# and other provisions required by the GPL or the LGPL. If you do not delete
+# the provisions above, a recipient may use your version of this file under
+# the terms of any one of the MPL, the GPL or the LGPL.
+#
+# ***** END LICENSE BLOCK *****
+
+# usage: changes.sh [prefix]
+# 
+# combines the {prefix}*possible-fixes.log files into {prefix}possible-fixes.log
+# and {prefix}*possible-regressions.log files into 
+# possible-regressions.log.
+#
+# This script is useful in cases where log files from different machines, branches
+# and builds are being investigated.
+
+if cat /dev/null | sed -r 'q' > /dev/null 2>&1; then
+   SED="sed -r"
+elif cat /dev/null | sed -E 'q' > /dev/null 2>&1; then
+   SED="sed -E"
+else
+   echo "Neither sed -r or sed -E is supported"
+   exit 2
+fi
+
+workfile=`mktemp work.XXXXXXXX`
+if [ $? -ne 0 ]; then
+    echo "Unable to create working temp file"
+    exit 2
+fi
+
+for f in ${1}*results-possible-fixes.log*; do
+    case $f in
+	*.log)
+	    CAT=cat
+	    ;;
+	*.log.bz2)
+	    CAT=bzcat
+	    ;;
+	*.log.gz)
+	    CAT=zcat
+	    ;;
+	*.log.zip)
+	    CAT="unzip -c"
+	    ;;
+	*)
+	    echo "unknown log type: $f"
+	    exit 2
+	    ;;
+    esac
+
+    $CAT $f | $SED "s|$|:$f|" >> $workfile
+
+done
+
+sort -u $workfile > ${1}possible-fixes.log
+
+rm $workfile
+
+
+for f in ${1}*results-possible-regressions.log*; do
+    case $f in
+	*.log)
+	    CAT=cat
+	    ;;
+	*.log.bz2)
+	    CAT=bzcat
+	    ;;
+	*.log.gz)
+	    CAT=zcat
+	    ;;
+	*.log.zip)
+	    CAT="unzip -c"
+	    ;;
+	*)
+	    echo "unknown log type: $f"
+	    exit 2
+	    ;;
+    esac
+    $CAT $f >> $workfile
+done
+
+sort -u $workfile > ${1}possible-regressions.log
+
+rm $workfile
+
+
+
diff --git a/js/tests/create-patterns.pl b/js/tests/create-patterns.pl
deleted file mode 100755
--- a/js/tests/create-patterns.pl
+++ /dev/null
@@ -1,264 +0,0 @@
-#!/usr/bin/perl
-# -*- Mode: Perl; tab-width: 4; indent-tabs-mode: nil; -*-
-
-# ***** BEGIN LICENSE BLOCK *****
-# Version: MPL 1.1/GPL 2.0/LGPL 2.1
-#
-# The contents of this file are subject to the Mozilla Public License Version
-# 1.1 (the "License"); you may not use this file except in compliance with
-# the License. You may obtain a copy of the License at
-# http://www.mozilla.org/MPL/
-#
-# Software distributed under the License is distributed on an "AS IS" basis,
-# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
-# for the specific language governing rights and limitations under the
-# License.
-#
-# The Original Code is Mozilla JavaScript Testing Utilities
-#
-# The Initial Developer of the Original Code is
-# Mozilla Corporation.
-# Portions created by the Initial Developer are Copyright (C) 2007
-# the Initial Developer. All Rights Reserved.
-#
-# Contributor(s): Bob Clary <bclary@bclary.com>
-#
-# Alternatively, the contents of this file may be used under the terms of
-# either the GNU General Public License Version 2 or later (the "GPL"), or
-# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
-# in which case the provisions of the GPL or the LGPL are applicable instead
-# of those above. If you wish to allow use of your version of this file only
-# under the terms of either the GPL or the LGPL, and not to allow others to
-# use your version of this file under the terms of the MPL, indicate your
-# decision by deleting the provisions above and replace them with the notice
-# and other provisions required by the GPL or the LGPL. If you do not delete
-# the provisions above, a recipient may use your version of this file under
-# the terms of any one of the MPL, the GPL or the LGPL.
-#
-# ***** END LICENSE BLOCK *****
-
-# make stderr, stdout unbuffered
-
-select STDERR; $| = 1;
-select STDOUT; $| = 1;
-
-my $regchars = '\[\^\-\]\|\{\}\?\*\+\.\<\>\$\(\)';
-
-sub escape_patterns;
-sub unescape_patterns;
-sub debug;
-
-my $debug = $ENV{DEBUG};
-my @outputlines = ();
-my @inputlines = ();
-
-while (<ARGV>) {
-    chomp;
-
-    # remove irrelevant data the caller is required to remove any
-    # other data which should not be considered during the
-    # consolidation such as TEST_MACHINE, etc.
-
-    s/TEST_DATE=[^,]*,/TEST_DATE=.*,/;
-
-    push @inputlines, ($_);
-
-}
-
-my @fieldnames = ('TEST_BRANCH', 'TEST_BUILDTYPE', 'TEST_TYPE', 'TEST_OS', 'TEST_PROCESSORTYPE', 'TEST_KERNEL', 'TEST_TIMEZONE');
-
-my $pass = 0;
-my $changed = 1;
-
-while ($changed) {
-
-    # repeated loop until no changes are made.
-
-    ++$pass;
-    $changed = 0;
-
-    debug "pass $pass, " . ($#inputlines + 1) . " inputlines, " . ($#outputlines + 1) . " outputlines\n";
-
-    foreach $field (@fieldnames) {
-
-        debug "pass $pass, processing $field, " . ($#inputlines + 1) . " inputlines, " . ($#outputlines + 1) . " outputlines\n";
-
-        # process each field across all lines so that later consolidations
-        # will match consolidated field values
-
-        while ($inputline = shift(@inputlines)) {
-
-            debug "inputline $inputline\n";
-
-            # get the current field value from the current input line
-
-            ($inputvalue) = $inputline =~ /$field=\(?([^,\)]*)\)?,/;
-
-            if ($inputvalue eq '.*') {
-
-                # if the current input value is the any wildcard,
-                # then there is no need to perform a consolidation
-                # on the field.
-
-                push @outputlines, ($inputline);
-
-                next;
-            }
-
-            # turn "off" any regular expression characters in the input line
-
-            $pattern = escape_pattern($inputline);
-
-            # Make the current field in the current pattern an any
-            # wildcard so that it will match any value. We are looking
-            # for all other lines that only differ from the current line by
-            # the current field value 
-
-            $pattern =~ s/$field=[^,]*,/$field=.*,/;
-
-            # find the matches to the current pattern
-
-            debug "pattern: $pattern\n";
-
-            @matched   = grep /$pattern/, (@inputlines, @outputlines);
-            @unmatched = grep !/$pattern/, @inputlines;
-
-            debug "" . ($#matched + 1) . " matched, " . ($#unmatched + 1) . " unmatched, " . ($#inputlines + 1) . " inputlines, " . ($#outputlines + 1) . " outputlines\n";
-
-            if (@matched) {
-
-                # the input line matched others
-
-                $outputvalue = $inputvalue;
-
-                foreach $matchline (@matched) {
-
-                    ($matchvalue) = $matchline =~ /$field=\(?([^,\)]*)\)?,/;
-
-                    if ( $inputvalue !~ /$matchvalue/ && $matchvalue !~ /$inputvalue/) {
-
-                        # the current match value and input value
-                        # do not overlap so add the match
-                        # field value as regular expression
-                        # alternation | to the current field value 
-
-                        debug "adding regexp alternation to $field: inputvalue: $inputvalue, matchvalue: $matchvalue";
-
-                        $outputvalue .= "|$matchvalue";
-                    }
-                } # foreach matchline
-
-                # replace the current inputs field value with the
-                # consolidated value
-
-                if ($outputvalue =~ /\|/) {
-                    $outputvalue = "(" . join('|', sort(split(/\|/, $outputvalue))) . ")";
-                }
-                $inputline =~ s/$field=[^,]*,/$field=$outputvalue,/;
-                debug "$inputline\n";
-
-                $changes = 1;
-            }
-            push @outputlines, ($inputline);
-
-            @inputlines = @unmatched;
-
-        } # while inputline
-        
-        @inputlines = @outputlines;
-        @outputlines = ();
-
-    } # foreach field
-}
-
-@inputlines = sort @inputlines;
-
-my $output = join"\n", @inputlines;
-
-debug "output: " . ($#inputlines + 1) . " lines\n";
-
-print "$output\n";
-
-### # look for over specified failures
-### 
-### $field = 'TEST_DESCRIPTION';
-### 
-### while ($inputline = shift(@inputlines)) {
-### 
-###     debug "inputline $inputline\n";
-### 
-###     # turn "off" any regular expression characters in the input line
-### 
-###     $pattern = escape_pattern($inputline);
-### 
-###     # Make the TEST_DESCRIPTION field in the current pattern an any
-###     # wildcard so that it will match any value. We are looking
-###     # for all other lines that only differ from the current line by
-###     # the TEST_DESCRIPTION. These will be the potentially overspecified 
-###     # failures.
-### 
-###     $pattern =~ s/$field=[^,]*,/$field=.*,/;
-### 
-###     # find the matches to the current pattern
-### 
-###     debug "pattern: $pattern\n";
-### 
-###     @matched   = grep /$pattern/, @inputlines;
-###     @unmatched = grep !/$pattern/, @inputlines;
-### 
-###     debug "" . ($#matched + 1) . " matched, " . ($#unmatched + 1) . " unmatched, " . ($#inputlines + 1) . " inputlines, " . ($#outputlines + 1) . " outputlines\n";
-### 
-###     if (@matched) {
-### 
-###         # the inputline overspecifies an error
-### 
-###         push @matched, ($inputline);
-### 
-###         foreach $matchline (@matched) {
-### 
-###             print STDERR "OVERSPECIFIED? : $matchline\n";
-### 
-###         } # foreach matchline
-### 
-###     }
-### 
-###     @inputlines = @unmatched;
-### 
-### } # while inputline
-### 
-
-
-
-sub escape_pattern {
-
-    # unlike the known-failures.pl, this escape escapes the entire 
-    # line to make it not contain any active regular expression patterns
-    # so that any matched will be literal and not regular
-    my $line = shift;
-
-    chomp;
-
-    # replace unescaped regular expression characters in the 
-    # description so they are not interpreted as regexp chars
-    # when matching descriptions. leave the escaped regexp chars
-    # `regexp alone so they can be unescaped later and used in 
-    # pattern matching.
-
-    # see perldoc perlre
-
-    $line =~ s/\\/\\\\/g;
-
-    # escape regexpchars
-    $line =~ s/([$regchars])/\\$1/g;
-
-    return "$line";
-
-}
-
-sub debug {
-    my $msg;
-    if ($debug) {
-        $msg = shift;
-        print "DEBUG: $msg\n";
-    }
-}
diff --git a/js/tests/e4x/QName/regress-373595-03.js b/js/tests/e4x/QName/regress-373595-03.js
--- a/js/tests/e4x/QName/regress-373595-03.js
+++ b/js/tests/e4x/QName/regress-373595-03.js
@@ -31,17 +31,17 @@
  * use your version of this file under the terms of the MPL, indicate your
  * decision by deleting the provisions above and replace them with the notice
  * and other provisions required by the GPL or the LGPL. If you do not delete
  * the provisions above, a recipient may use your version of this file under
  * the terms of any one of the MPL, the GPL or the LGPL.
  *
  * ***** END LICENSE BLOCK ***** */
 
-gTestfile = 'regress-373595-02.js';
+gTestfile = 'regress-373595-03.js';
 
 var summary = '13.3 QName Objects - Do not assert: op == JSOP_ADD';
 var BUGNUMBER = 373595;
 var actual = 'No Crash';
 var expect = 'No Crash';
 
 printBugNumber(BUGNUMBER);
 START(summary);
diff --git a/js/tests/ecma_3/RegExp/regress-311414.js b/js/tests/ecma_3/RegExp/regress-311414.js
--- a/js/tests/ecma_3/RegExp/regress-311414.js
+++ b/js/tests/ecma_3/RegExp/regress-311414.js
@@ -42,38 +42,38 @@ var actual = '';
 var actual = '';
 var expect = '';
 
 printBugNumber(BUGNUMBER);
 printStatus (summary);
  
 function q1(n) {
   var c = [];
-  c[Math.pow(10, n)] = 1;
+  c[n] = 1;
   c = c.join(" ");
   var d = Date.now();
   var e = c.match(/(.*)foo$/);
   var f = Date.now();
   return (f - d);
 }
 
 function q2(n) {
   var c = [];
-  c[Math.pow(10, n)] = 1;
+  c[n] = 1;
   c = c.join(" ");
   var d = Date.now();
   var e = /foo$/.test(c) && c.match(/(.*)foo$/);
   var f = Date.now();
   return (f - d);
 }
 
 var data1 = {X:[], Y:[]};
 var data2 = {X:[], Y:[]};
 
-for (var x = 0; x < 5; x++)
+for (var x = 500; x < 5000; x += 500)
 {
   var y1 = q1(x);
   var y2 = q2(x);
   data1.X.push(x);
   data1.Y.push(y1);
   data2.X.push(x);
   data2.Y.push(y2);
   gc();
diff --git a/js/tests/ecma_3/RegExp/regress-375715-01-n.js b/js/tests/ecma_3/RegExp/regress-375715-01-n.js
--- a/js/tests/ecma_3/RegExp/regress-375715-01-n.js
+++ b/js/tests/ecma_3/RegExp/regress-375715-01-n.js
@@ -30,17 +30,17 @@
  * use your version of this file under the terms of the MPL, indicate your
  * decision by deleting the provisions above and replace them with the notice
  * and other provisions required by the GPL or the LGPL. If you do not delete
  * the provisions above, a recipient may use your version of this file under
  * the terms of any one of the MPL, the GPL or the LGPL.
  *
  * ***** END LICENSE BLOCK ***** */
 
-var gTestfile = 'regress-375715-01.js';
+var gTestfile = 'regress-375715-01-n.js';
 //-----------------------------------------------------------------------------
 var BUGNUMBER = 375715;
 var summary = 'Do not assert: (c2 <= cs->length) && (c1 <= c2)';
 var actual = '';
 var expect = '';
 
 //-----------------------------------------------------------------------------
 test();
diff --git a/js/tests/get-universe.sh b/js/tests/get-universe.sh
new file mode 100644
--- /dev/null
+++ b/js/tests/get-universe.sh
@@ -0,0 +1,48 @@
+#!/bin/bash -e
+# -*- Mode: Shell-script; tab-width: 4; indent-tabs-mode: nil; -*-
+
+# ***** BEGIN LICENSE BLOCK *****
+# Version: MPL 1.1/GPL 2.0/LGPL 2.1
+#
+# The contents of this file are subject to the Mozilla Public License Version
+# 1.1 (the "License"); you may not use this file except in compliance with
+# the License. You may obtain a copy of the License at
+# http://www.mozilla.org/MPL/
+#
+# Software distributed under the License is distributed on an "AS IS" basis,
+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+# for the specific language governing rights and limitations under the
+# License.
+#
+# The Original Code is Mozilla JavaScript Testing Utilities
+#
+# The Initial Developer of the Original Code is
+# Mozilla Corporation.
+# Portions created by the Initial Developer are Copyright (C) 2007
+# the Initial Developer. All Rights Reserved.
+#
+# Contributor(s): Bob Clary <bclary@bclary.com>
+#
+# Alternatively, the contents of this file may be used under the terms of
+# either the GNU General Public License Version 2 or later (the "GPL"), or
+# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+# in which case the provisions of the GPL or the LGPL are applicable instead
+# of those above. If you wish to allow use of your version of this file only
+# under the terms of either the GPL or the LGPL, and not to allow others to
+# use your version of this file under the terms of the MPL, indicate your
+# decision by deleting the provisions above and replace them with the notice
+# and other provisions required by the GPL or the LGPL. If you do not delete
+# the provisions above, a recipient may use your version of this file under
+# the terms of any one of the MPL, the GPL or the LGPL.
+#
+# ***** END LICENSE BLOCK *****
+
+# usage: get-universe.sh logfile(s) > universe.data
+#
+# get-universe.sh reads the processed javascript logs and writes to
+# stdout the unique set of fields to be used as the "universe" of test
+# run data. These values are used by pattern-expander.pl and
+# pattern-extracter.pl to encode the known failure files into regular
+# expressions.
+
+sed 's|.*\(TEST_BRANCH.*\), \(TEST_OS.*\), TEST_RESULT.*|\2, \1|' $@ | sort -u
diff --git a/js/tests/js1_5/GC/regress-338653.js b/js/tests/js1_5/GC/regress-338653.js
--- a/js/tests/js1_5/GC/regress-338653.js
+++ b/js/tests/js1_5/GC/regress-338653.js
@@ -33,17 +33,17 @@
  * and other provisions required by the GPL or the LGPL. If you do not delete
  * the provisions above, a recipient may use your version of this file under
  * the terms of any one of the MPL, the GPL or the LGPL.
  *
  * ***** END LICENSE BLOCK ***** */
 
 var gTestfile = 'regress-338653.js';
 //-----------------------------------------------------------------------------
-var BUGNUMBER = 338652;
+var BUGNUMBER = 338653;
 var summary = 'Force GC when JSRuntime.gcMallocBytes hits ' +
   'JSRuntime.gcMaxMallocBytes';
 var actual = 'No Crash';
 var expect = 'No Crash';
 
 printBugNumber(BUGNUMBER);
 printStatus (summary);
 print('This test should never fail explicitly. ' +
diff --git a/js/tests/js1_5/Object/regress-382503.js b/js/tests/js1_5/Object/regress-382503.js
--- a/js/tests/js1_5/Object/regress-382503.js
+++ b/js/tests/js1_5/Object/regress-382503.js
@@ -30,17 +30,17 @@
  * use your version of this file under the terms of the MPL, indicate your
  * decision by deleting the provisions above and replace them with the notice
  * and other provisions required by the GPL or the LGPL. If you do not delete
  * the provisions above, a recipient may use your version of this file under
  * the terms of any one of the MPL, the GPL or the LGPL.
  *
  * ***** END LICENSE BLOCK ***** */
 
-var gTestfile = 'regress-383503.js';
+var gTestfile = 'regress-382503.js';
 //-----------------------------------------------------------------------------
 var BUGNUMBER = 382503;
 var summary = 'Do not assert: with prototype=regexp';
 var actual = '';
 var expect = '';
 
 printBugNumber(BUGNUMBER);
 printStatus (summary);
diff --git a/js/tests/js1_5/Regress/regress-246964.js b/js/tests/js1_5/Regress/regress-246964.js
--- a/js/tests/js1_5/Regress/regress-246964.js
+++ b/js/tests/js1_5/Regress/regress-246964.js
@@ -44,17 +44,22 @@ var BUGNUMBER = 246964;
 // see also bug 248549, bug 253150, bug 259935
 var summary = 'undetectable document.all';
 var actual = '';
 var expect = '';
 
 printBugNumber(BUGNUMBER);
 printStatus (summary);
 
-if (typeof document != 'undefined')
+if (typeof document == 'undefined')
+{
+  expect = actual = 'Test requires browser: skipped';
+  reportCompare(expect, actual, summary);
+}
+else
 {
   status = summary + ' ' + inSection(1) + ' if (document.all) ';
   expect = false;
   actual = false;
   if (document.all)
   {
     actual = true;
   }
diff --git a/js/tests/js1_5/Regress/regress-398085-01.js b/js/tests/js1_5/Regress/regress-398085-01.js
--- a/js/tests/js1_5/Regress/regress-398085-01.js
+++ b/js/tests/js1_5/Regress/regress-398085-01.js
@@ -30,17 +30,17 @@
  * use your version of this file under the terms of the MPL, indicate your
  * decision by deleting the provisions above and replace them with the notice
  * and other provisions required by the GPL or the LGPL. If you do not delete
  * the provisions above, a recipient may use your version of this file under
  * the terms of any one of the MPL, the GPL or the LGPL.
  *
  * ***** END LICENSE BLOCK ***** */
 
-var gTestfile = 'regress-398095-01.js';
+var gTestfile = 'regress-398085-01.js';
 //-----------------------------------------------------------------------------
 var BUGNUMBER = 398095;
 var summary = 'Do not crash with large switch statement';
 var actual = '';
 var expect = 'PASSED';
 
 
 //-----------------------------------------------------------------------------
diff --git a/js/tests/js1_5/extensions/regress-365869.js b/js/tests/js1_5/extensions/regress-365869.js
--- a/js/tests/js1_5/extensions/regress-365869.js
+++ b/js/tests/js1_5/extensions/regress-365869.js
@@ -72,27 +72,44 @@ function test()
   catch(ex)
   {
     actual = ex + '';
     print(ex);
   }
  
   reportCompare(expect, actual, summary);
 
-  print('test crash from bug 371292');
+  print('test crash from bug 371292 Comment 3');
 
   try
   {
     expect = 'TypeError: redeclaration of property 1';
     var o1 = {1:1, 1:2};
     // syntax warning, need to eval to catch
     actual = 'No warning';
   }
   catch(ex)
   {
     actual = ex + '';
     print(ex);
   }
  
   reportCompare(expect, actual, summary);
 
+
+  print('test crash from bug 371292 Comment 9');
+
+  try
+  {
+    expect = 'TypeError: redeclaration of const 5';
+    "012345".__defineSetter__(5, function(){});
+  }
+  catch(ex)
+  {
+    actual = ex + '';
+    print(ex);
+  }
+
+  reportCompare(expect, actual, summary);
+
+
   exitFunc ('test');
 }
diff --git a/js/tests/js1_7/extensions/regress-387955-02.js b/js/tests/js1_7/extensions/regress-387955-02.js
--- a/js/tests/js1_7/extensions/regress-387955-02.js
+++ b/js/tests/js1_7/extensions/regress-387955-02.js
@@ -31,17 +31,17 @@
  * use your version of this file under the terms of the MPL, indicate your
  * decision by deleting the provisions above and replace them with the notice
  * and other provisions required by the GPL or the LGPL. If you do not delete
  * the provisions above, a recipient may use your version of this file under
  * the terms of any one of the MPL, the GPL or the LGPL.
  *
  * ***** END LICENSE BLOCK ***** */
 
-var gTestfile = 'regress-387955.js';
+var gTestfile = 'regress-387955-02.js';
 
 //-----------------------------------------------------------------------------
 var BUGNUMBER = 387955;
 var summary = 'Do not Crash [@ JS_CallTracer]';
 var actual = 'No Crash';
 var expect = 'No Crash';
 
 //-----------------------------------------------------------------------------
diff --git a/js/tests/js1_7/extensions/regress-392308.js b/js/tests/js1_7/extensions/regress-392308.js
--- a/js/tests/js1_7/extensions/regress-392308.js
+++ b/js/tests/js1_7/extensions/regress-392308.js
@@ -30,17 +30,17 @@
  * use your version of this file under the terms of the MPL, indicate your
  * decision by deleting the provisions above and replace them with the notice
  * and other provisions required by the GPL or the LGPL. If you do not delete
  * the provisions above, a recipient may use your version of this file under
  * the terms of any one of the MPL, the GPL or the LGPL.
  *
  * ***** END LICENSE BLOCK ***** */
 
-var gTestfile = 'regress--392308.js';
+var gTestfile = 'regress-392308.js';
 //-----------------------------------------------------------------------------
 var BUGNUMBER = 392308;
 var summary = 'StopIteration should be catchable';
 var actual = '';
 var expect = '';
 
 
 //-----------------------------------------------------------------------------
diff --git a/js/tests/js1_7/geniter/regress-392310.js b/js/tests/js1_7/geniter/regress-392310.js
--- a/js/tests/js1_7/geniter/regress-392310.js
+++ b/js/tests/js1_7/geniter/regress-392310.js
@@ -30,17 +30,17 @@
  * use your version of this file under the terms of the MPL, indicate your
  * decision by deleting the provisions above and replace them with the notice
  * and other provisions required by the GPL or the LGPL. If you do not delete
  * the provisions above, a recipient may use your version of this file under
  * the terms of any one of the MPL, the GPL or the LGPL.
  *
  * ***** END LICENSE BLOCK ***** */
 
-var gTestfile = 'regress--392310.js';
+var gTestfile = 'regress-392310.js';
 //-----------------------------------------------------------------------------
 var BUGNUMBER = 392310;
 var summary = 'send on newborn generator';
 var actual = '';
 var expect = '';
 
 
 //-----------------------------------------------------------------------------
diff --git a/js/tests/js1_7/regress/regress-385133-02.js b/js/tests/js1_7/regress/regress-385133-02.js
--- a/js/tests/js1_7/regress/regress-385133-02.js
+++ b/js/tests/js1_7/regress/regress-385133-02.js
@@ -30,17 +30,17 @@
  * use your version of this file under the terms of the MPL, indicate your
  * decision by deleting the provisions above and replace them with the notice
  * and other provisions required by the GPL or the LGPL. If you do not delete
  * the provisions above, a recipient may use your version of this file under
  * the terms of any one of the MPL, the GPL or the LGPL.
  *
  * ***** END LICENSE BLOCK ***** */
 
-var gTestfile = 'regress-385133-01.js';
+var gTestfile = 'regress-385133-02.js';
 //-----------------------------------------------------------------------------
 var BUGNUMBER = 385133;
 var summary = 'Do not crash due to recursion with watch, setter, delete, generator';
 var actual = 'No Crash';
 var expect = 'No Crash';
 
 
 //-----------------------------------------------------------------------------
diff --git a/js/tests/js1_8/extensions/regress-385393-11.js b/js/tests/js1_8/extensions/regress-385393-11.js
--- a/js/tests/js1_8/extensions/regress-385393-11.js
+++ b/js/tests/js1_8/extensions/regress-385393-11.js
@@ -30,17 +30,17 @@
  * use your version of this file under the terms of the MPL, indicate your
  * decision by deleting the provisions above and replace them with the notice
  * and other provisions required by the GPL or the LGPL. If you do not delete
  * the provisions above, a recipient may use your version of this file under
  * the terms of any one of the MPL, the GPL or the LGPL.
  *
  * ***** END LICENSE BLOCK ***** */
 
-var gTestfile = 'regress-385393-10.js';
+var gTestfile = 'regress-385393-11.js';
 
 //-----------------------------------------------------------------------------
 var BUGNUMBER = 385393;
 var summary = 'Regression test for bug 385393';
 var actual = 'No Crash';
 var expect = 'No Crash';
 
 //-----------------------------------------------------------------------------
diff --git a/js/tests/known-failures.pl b/js/tests/known-failures.pl
--- a/js/tests/known-failures.pl
+++ b/js/tests/known-failures.pl
@@ -44,30 +44,32 @@ sub debug;
 sub debug;
 sub usage;
 sub parse_options;
 sub escape_pattern;
 sub unescape_pattern;
 
 # option arguments
 
-my $option_desc = "b=s branch>b T=s buildtype>T t=s testtype>t l=s rawlogfile>l f=s failurelogfile>f o=s os>o r=s patterns>r z=s timezone>z O=s outputprefix>O A=s arch>A K=s kernel>K D debug>D";
+my $option_desc = "b=s branch>b T=s buildtype>T t=s testtype>t o=s os>o K=s kernel>K A=s arch>A M=s memory>M S=s speed>S z=s timezone>z l=s rawlogfile>l f=s failurelogfile>f r=s patterns>r O=s outputprefix>O D debug>D";
 
 my $testid;
 my $branch;
 my $buildtype;
 my $testtype;
 my $rawlogfile;
 my $failurelogfile;
 my $os;
 my $patterns;
 my $timezone;
 my $outputprefix;
 my $arch;
 my $kernel;
+my $memory;
+my $cpuspeed;
 my $debug = $ENV{DEBUG};
 
 # pattern variables
 
 my $knownfailurebranchpattern;
 my $failurebranchpattern;
 my $knownfailureospattern;
 my $failureospattern;
@@ -76,16 +78,20 @@ my $knownfailuretesttypepattern;
 my $knownfailuretesttypepattern;
 my $failuretesttypepattern;
 my $knownfailuretimezonepattern;
 my $failuretimezonepattern;
 my $knownfailurearchpattern;
 my $failurearchpattern;
 my $knownfailurekernelpattern;
 my $failurekernelpattern;
+my $knownfailurememorypattern;
+my $failurememorypattern;
+my $knownfailurecpuspeedpattern;
+my $failurecpuspeedpattern;
 
 my @patterns;
 my $pattern;
 my @failures;
 my @fixes;
 my @excludedtests;
 my $excludedtest;
 my $excludedfile;
@@ -139,44 +145,44 @@ foreach $includedfile ( @includedfiles )
         s/\s+$//;
 
         $includedtests{$_} = 1;
     }
     close INCLUDED;
 }
 
 debug "loading patterns $patterns";
-debug "pattern filter: /^TEST_ID=[^,]*, TEST_BRANCH=$knownfailurebranchpattern, TEST_RESULT=[^,]*, TEST_BUILDTYPE=$knownfailurebuildtypepattern, TEST_TYPE=$knownfailuretesttypepattern, TEST_OS=$knownfailureospattern, TEST_MACHINE=[^,]*, TEST_PROCESSORTYPE=$knownfailurearchpattern, TEST_KERNEL=$knownfailurekernelpattern, TEST_DATE=[^,]*, TEST_TIMEZONE=$knownfailuretimezonepattern,/\n";
+debug "pattern filter: ^TEST_ID=[^,]*, TEST_BRANCH=$knownfailurebranchpattern, TEST_BUILDTYPE=$knownfailurebuildtypepattern, TEST_TYPE=$knownfailuretesttypepattern, TEST_OS=$knownfailureospattern, TEST_KERNEL=$knownfailurekernelpattern, TEST_PROCESSORTYPE=$knownfailurearchpattern, TEST_MEMORY=$knownfailurememorypattern, TEST_CPUSPEED=$knownfailurecpuspeedpattern, TEST_TIMEZONE=$knownfailuretimezonepattern,";
 
 open PATTERNS, "<$patterns" or die "Unable to open known failure patterns file $patterns: $!\n";
 while (<PATTERNS>) {
     chomp;
 
     s/\s+$//;
 
     ($testid) = $_ =~ /^TEST_ID=([^,]*),/;
 
     if (!$includedtests{$testid})
     {
         debug "test $testid was not included during this run";
     }
-    elsif ($_ =~ /^TEST_ID=[^,]*, TEST_BRANCH=$knownfailurebranchpattern, TEST_RESULT=[^,]*, TEST_BUILDTYPE=$knownfailurebuildtypepattern, TEST_TYPE=$knownfailuretesttypepattern, TEST_OS=$knownfailureospattern, TEST_MACHINE=[^,]*, TEST_PROCESSORTYPE=$knownfailurearchpattern, TEST_KERNEL=$knownfailurekernelpattern, TEST_DATE=[^,]*, TEST_TIMEZONE=$knownfailuretimezonepattern,/) {
+    elsif ($_ =~ /^TEST_ID=[^,]*, TEST_BRANCH=$knownfailurebranchpattern, TEST_BUILDTYPE=$knownfailurebuildtypepattern, TEST_TYPE=$knownfailuretesttypepattern, TEST_OS=$knownfailureospattern, TEST_KERNEL=$knownfailurekernelpattern, TEST_PROCESSORTYPE=$knownfailurearchpattern, TEST_MEMORY=$knownfailurememorypattern, TEST_CPUSPEED=$knownfailurecpuspeedpattern, TEST_TIMEZONE=$knownfailuretimezonepattern,/) {
         debug "adding pattern  : $_";
         push @patterns, (escape_pattern($_));   
     }
     else {
         debug "skipping pattern: $_";
     }
 
 }
 close PATTERNS;
 
  # create a working copy of the current failures which match the users selection
 
-debug "failure filter: ^TEST_ID=[^,]*, TEST_BRANCH=$failurebranchpattern, TEST_RESULT=FAIL[^,]*, TEST_BUILDTYPE=$failurebuildtypepattern, TEST_TYPE=$failuretesttypepattern, TEST_OS=$failureospattern, TEST_MACHINE=[^,]*, TEST_PROCESSORTYPE=$failurearchpattern, TEST_KERNEL=$failurekernelpattern, TEST_DATE=[^,]*, TEST_TIMEZONE=$failuretimezonepattern,";
+debug "failure filter: ^TEST_ID=[^,]*, TEST_BRANCH=$failurebranchpattern, TEST_BUILDTYPE=$failurebuildtypepattern, TEST_TYPE=$failuretesttypepattern, TEST_OS=$failureospattern, TEST_KERNEL=$failurekernelpattern, TEST_PROCESSORTYPE=$failurearchpattern, TEST_MEMORY=$failurememorypattern, TEST_CPUSPEED=$failurecpuspeedpattern, TEST_TIMEZONE=$failuretimezonepattern, TEST_RESULT=FAIL[^,]*,/";
 
 if (defined($rawlogfile)) {
 
     $failurelogfile = "$outputprefix-results-failures.log";
     my $alllog      = "$outputprefix-results-all.log";
 
     debug "writing failures $failurelogfile";
 
@@ -184,39 +190,53 @@ if (defined($rawlogfile)) {
     open ALLLOG, ">$alllog" or die "Unable to open $alllog $!\n";
     open FAILURELOG, ">$failurelogfile" or die "Unable to open $failurelogfile $!\n";
 
     while (<INPUTLOG>) {
         chomp;
 
         print ALLLOG "$_\n";
 
-        if ($_ =~ /^TEST_ID=[^,]*, TEST_BRANCH=$failurebranchpattern, TEST_RESULT=FAIL[^,]*, TEST_BUILDTYPE=$failurebuildtypepattern, TEST_TYPE=$failuretesttypepattern, TEST_OS=$failureospattern, TEST_MACHINE=[^,]*, TEST_PROCESSORTYPE=$failurearchpattern, TEST_KERNEL=$failurekernelpattern, TEST_DATE=[^,]*, TEST_TIMEZONE=$failuretimezonepattern,/) {
+        if ($_ =~ /^TEST_ID=[^,]*, TEST_BRANCH=$failurebranchpattern, TEST_BUILDTYPE=$failurebuildtypepattern, TEST_TYPE=$failuretesttypepattern, TEST_OS=$failureospattern, TEST_KERNEL=$failurekernelpattern, TEST_PROCESSORTYPE=$failurearchpattern, TEST_MEMORY=$failurememorypattern, TEST_CPUSPEED=$failurecpuspeedpattern, TEST_TIMEZONE=$failuretimezonepattern, TEST_RESULT=FAIL[^,]*,/) {
             debug "failure: $_";
             push @failures, ($_);
             print FAILURELOG "$_\n";
         }
     }
     close INPUTLOG;
     my $inputrc = $?;
     close ALLLOG;
     close FAILURELOG;
 
     die "FATAL ERROR in post-process-logs.pl" if $inputrc != 0;
-
 }
-else {
-
+else 
+{
     debug "loading failures $failurelogfile";
 
-    open FAILURES, "<$failurelogfile" or die "Unable to open current failure log $failurelogfile: $!\n";
+    my $failurelogfilemode;
+
+    if ($failurelogfile =~ /\.bz2$/)
+    {
+        $failurelogfilemode = "bzcat $failurelogfile|";
+    }
+    elsif ($failurelogfile =~ /\.gz$/)
+    {
+        $failurelogfilemode = "zcat $failurelogfile|";
+    }
+    else
+    {
+        $failurelogfilemode = "<$failurelogfile";
+    }
+
+    open FAILURES, "$failurelogfilemode" or die "Unable to open current failure log $failurelogfile: $!\n";
     while (<FAILURES>) {
         chomp;
 
-        if ($_ =~ /^TEST_ID=[^,]*, TEST_BRANCH=$failurebranchpattern, TEST_RESULT=FAIL[^,]*, TEST_BUILDTYPE=$failurebuildtypepattern, TEST_TYPE=$failuretesttypepattern, TEST_OS=$failureospattern, TEST_MACHINE=[^,]*, TEST_PROCESSORTYPE=$failurearchpattern, TEST_KERNEL=$failurekernelpattern, TEST_DATE=[^,]*, TEST_TIMEZONE=$failuretimezonepattern,/) {
+        if ($_ =~ /^TEST_ID=[^,]*, TEST_BRANCH=$failurebranchpattern, TEST_BUILDTYPE=$failurebuildtypepattern, TEST_TYPE=$failuretesttypepattern, TEST_OS=$failureospattern, TEST_KERNEL=$failurekernelpattern, TEST_PROCESSORTYPE=$failurearchpattern, TEST_MEMORY=$failurememorypattern, TEST_CPUSPEED=$failurecpuspeedpattern, TEST_TIMEZONE=$failuretimezonepattern, TEST_RESULT=FAIL[^,]*,/) {
             debug "failure: $_";
             push @failures, ($_);
         }
     }
     close FAILURES;
 }
 
 debug "finding fixed bugs";
@@ -338,35 +358,45 @@ sub usage {
 sub usage {
 
     my $msg = shift;
 
     print STDERR <<EOF;
 
 usage: $msg
 
-known-failures.pl [-b|--branch] branch [-T|--buildtype] buildtype 
-                  [-t|--testtype] testtype [-o os|--os] 
+known-failures.pl [-b|--branch] branch 
+                  [-T|--buildtype] buildtype 
+                  [-t|--testtype] testtype 
+                  [-o|--os] os
+                  [-K|--kernel] kernel
+                  [-A|--arch] arch
+                  [-M|--memory] memory
+                  [-S|--speed] speed
+                  [-z|--timezone] timezone 
+                  [-r|--patterns] patterns 
                   ([-f|--failurelogfile] failurelogfile|[-l|--logfile] rawlogfile])
-                  [-r|--patterns] patterns [-z|--timezone] timezone 
                   [-O|--outputprefix] outputprefix
+                  [-D]
 
     variable            description
     ===============     ============================================================
     -b branch           branch 1.8.0, 1.8.1, 1.9.0, all
     -T buildtype        build type opt, debug, all
     -t testtype         test type browser, shell, all
+    -o os               operating system nt, darwin, linux, all
+    -K kernel           kernel, all or a specific pattern
+    -A arch             architecture, all or a specific pattern
+    -M memory           memory in Gigabytes, all or a specific pattern
+    -S speed            speed, all or specific pattern
+    -z timezone         -0400, -0700, etc. default to user\'s zone
     -l rawlogfile       raw logfile
     -f failurelogfile   failure logfile
-    -o os               operating system win32, mac, linux, all
     -r patterns         known failure patterns
-    -z timezone         -0400, -0700, etc. default to user\'s zone
     -O outputprefix     output files will be generated with this prefix
-    -A arch             architecture, all or a specific pattern
-    -K kernel           kernel, all or a specific pattern
     -D                  turn on debugging output
 EOF
 
     exit(2);
 }
 
 sub parse_options {
     my ($option, $value);
@@ -380,171 +410,216 @@ sub parse_options {
             $branch = $value;
         }
         elsif ($option eq "T") {
             $buildtype = $value;
         }
         elsif ($option eq "t") {
             $testtype = $value;
         }
+        elsif ($option eq "o") {
+            $os = $value;
+        }
+        elsif ($option eq "K") {
+            $kernel = $value;
+        }
+        elsif ($option eq "A") {
+            $arch = $value;
+        }
+        elsif ($option eq "M") {
+            $memory = $value;
+        }
+        elsif ($option eq "S") {
+            $cpuspeed = $value;
+            if ($cpuspeed < 4)
+            {
+                $cpuspeed = 'slow';
+            }
+            elsif ($cpuspeed < 9)
+            {
+                $cpuspeed = 'medium';
+            }
+            else
+            {
+                $cpuspeed = 'fast';
+            }
+        }
+        elsif ($option eq "z") {
+            $timezone = $value;
+        }
+        elsif ($option eq "r") {
+            $patterns = $value;
+        }
         elsif ($option eq "l") {
             $rawlogfile = $value;
         }
         elsif ($option eq "f") {
             $failurelogfile = $value;
         }
-        elsif ($option eq "o") {
-            $os = $value;
-        }
-        elsif ($option eq "r") {
-            $patterns = $value;
-        }
-        elsif ($option eq "z") {
-            $timezone = $value;
-        }
         elsif ($option eq "O") {
             $outputprefix = $value;
-        }
-        elsif ($option eq "A") {
-            $arch = $value;
-        }
-        elsif ($option eq "K") {
-            $kernel = $value;
         }
         elsif ($option eq "D") {
             $debug = 1;
         }
 
     }
 
     if ($debug) {
-        print "branch=$branch, rawlogfile=$rawlogfile failurelogfile=$failurelogfile, os=$os, buildtype=$buildtype, testtype=$testtype, patterns=$patterns, timezone=$timezone, outputprefix=$outputprefix\n";
+        print "branch=$branch, buildtype=$buildtype, testtype=$testtype, os=$os, kernel=$kernel, arch=$arch, memory=$memory, cpuspeed=$cpuspeed, timezone=$timezone, patterns=$patterns, rawlogfile=$rawlogfile failurelogfile=$failurelogfile, outputprefix=$outputprefix\n";
     }
     Getopt::Mixed::cleanup();
 
     if ( !defined($branch) ) {
         usage "missing branch";
-    }
-
-    if (!defined($rawlogfile) && !defined($failurelogfile)) {
-        usage "missing logfile";
-    }
-
-
-    if (!defined($os)) { 
-        usage "missing os";
     }
 
     if (!defined($buildtype)) {
         usage "missing buildtype";
     }
 
     if (!defined($testtype)) {
         usage "missing testtype";
     }
 
-    if (!defined($patterns)) {
-        usage "missing patterns";
+    if (!defined($os)) { 
+        usage "missing os";
     }
 
+    if (!defined($memory)) {
+        $memory = 'all';
+    }
+
+    if (!defined($cpuspeed)) {
+        $cpuspeed = 'all';
+    }
 
     if (!defined($timezone)) {
         usage "missing timezone";
     }
 
+    if (!defined($patterns)) {
+        usage "missing patterns";
+    }
+
+    if (!defined($rawlogfile) && !defined($failurelogfile)) {
+        usage "missing logfile";
+    }
 
     if (!defined($outputprefix)) {
         usage "missing outputprefix";
     }
 
     if ($branch eq "1.8.0") {
-        $knownfailurebranchpattern = "([^,]*1\\.8\\.0[^,]*|\\.\\*)";
+        $knownfailurebranchpattern = "(1\\.8\\.0|\\.\\*)";
         $failurebranchpattern      = "1\\.8\\.0";
     }
-    if ($branch eq "1.8.1") {
-        $knownfailurebranchpattern = "([^,]*1\\.8\\.1[^,]*|\\.\\*)";
+    elsif ($branch eq "1.8.1") {
+        $knownfailurebranchpattern = "(1\\.8\\.1|\\.\\*)";
         $failurebranchpattern      = "1\\.8\\.1";
     }
     elsif ($branch eq "1.9.0") {
-        $knownfailurebranchpattern = "([^,]*1\\.9\\.0[^,]*|\\.\\*)";
+        $knownfailurebranchpattern = "(1\\.9\\.0|\\.\\*)";
         $failurebranchpattern      = "1\\.9\\.0";
+    }
+    elsif ($branch eq "1.9.1") {
+        $knownfailurebranchpattern = "(1\\.9\\.1|\\.\\*)";
+        $failurebranchpattern      = "1\\.9\\.1";
     }
     elsif ($branch eq "all") {
         $knownfailurebranchpattern = "[^,]*";
         $failurebranchpattern      = "[^,]*";
     }
 
-    if ($os eq "win32") {
-        $knownfailureospattern     = "([^,]*win32[^,]*|\\.\\*)";
-        $failureospattern          = "win32";
-    }
-    elsif ($os eq "mac") {
-        $knownfailureospattern     = "([^,]*mac[^,]*|\\.\\*)";
-        $failureospattern          = "mac";
-    }
-    elsif ($os eq "linux") {
-        $knownfailureospattern     = "([^,]*linux[^,]*|\\.\\*)";
-        $failureospattern          = "linux";
-    }
-    elsif ($os eq "all") {
-        $knownfailureospattern     = "[^,]*";
-        $failureospattern          = "[^,]*";
-    }
-
     if ($buildtype eq "opt") {
-        $knownfailurebuildtypepattern = "([^,]*opt[^,]*|\\.\\*)";
+        $knownfailurebuildtypepattern = "(opt|\\.\\*)";
         $failurebuildtypepattern      = "opt";
     }
     elsif ($buildtype eq "debug") {
-        $knownfailurebuildtypepattern = "([^,]*debug[^,]*|\\.\\*)";
+        $knownfailurebuildtypepattern = "(debug|\\.\\*)";
         $failurebuildtypepattern      = "debug";
     }
     elsif ($buildtype eq "all") {
         $knownfailurebuildtypepattern = "[^,]*";
         $failurebuildtypepattern      = "[^,]*";
     }
 
     if ($testtype eq "shell") {
-        $knownfailuretesttypepattern = "([^,]*shell[^,]*|\\.\\*)";
+        $knownfailuretesttypepattern = "(shell|\\.\\*)";
         $failuretesttypepattern      = "shell";
     }
     elsif ($testtype eq "browser") {
-        $knownfailuretesttypepattern = "([^,]*browser[^,]*|\\.\\*)";
+        $knownfailuretesttypepattern = "(browser|\\.\\*)";
         $failuretesttypepattern      = "browser";
     }
     elsif ($testtype eq "all") {
         $knownfailuretesttypepattern = "[^,]*";
         $failuretesttypepattern      = "[^,]*";
     }
 
-    if ($timezone eq "all") {
-        $knownfailuretimezonepattern = "[^,]*";
-        $failuretimezonepattern      = "[^,]*";
+    if ($os eq "nt") {
+        $knownfailureospattern     = "(nt|\\.\\*)";
+        $failureospattern          = "nt";
+    }
+    elsif ($os eq "darwin") {
+        $knownfailureospattern     = "(darwin|\\.\\*)";
+        $failureospattern          = "darwin";
+    }
+    elsif ($os eq "linux") {
+        $knownfailureospattern     = "(linux|\\.\\*)";
+        $failureospattern          = "linux";
+    }
+    elsif ($os eq "all") {
+        $knownfailureospattern     = "[^,]*";
+        $failureospattern          = "[^,]*";
+    }
+
+    if ($kernel ne  "all") {
+        $knownfailurekernelpattern = "(" . $kernel . "|\\.\\*)";
+        $failurekernelpattern      = "$kernel";
     }
     else {
-        $knownfailuretimezonepattern = "([^,]*" . $timezone . "[^,]*|\\.\\*)";
-        $failuretimezonepattern      = "$timezone";
+        $knownfailurekernelpattern = "[^,]*";
+        $failurekernelpattern      = "[^,]*";
     }
 
     if ($arch ne "all") {
-        $knownfailurearchpattern = "([^,]*" . $arch . "[^,]*|\\.\\*)";
+        $knownfailurearchpattern = "(" . $arch . "|\\.\\*)";
         $failurearchpattern      = "$arch";
     }
     else {
         $knownfailurearchpattern = "[^,]*";
         $failurearchpattern      = "[^,]*";
     }
 
-    if ($kernel ne  "all") {
-        $knownfailurekernelpattern = "([^,]*" . $kernel . "[^,]*|\\.\\*)";
-        $failurekernelpattern      = "$kernel";
+    if ($memory ne  "all") {
+        $knownfailurememorypattern = "(" . $memory . "|\\.\\*)";
+        $failurememorypattern      = "$memory";
     }
     else {
-        $knownfailurekernelpattern = "[^,]*";
-        $failurekernelpattern      = "[^,]*";
+        $knownfailurememorypattern = "[^,]*";
+        $failurememorypattern      = "[^,]*";
+    }
+
+    if ($cpuspeed ne  "all") {
+        $knownfailurecpuspeedpattern = "(" . $cpuspeed . "|\\.\\*)";
+        $failurecpuspeedpattern      = "$cpuspeed";
+    }
+    else {
+        $knownfailurecpuspeedpattern = "[^,]*";
+        $failurecpuspeedpattern      = "[^,]*";
+    }
+
+    if ($timezone eq "all") {
+        $knownfailuretimezonepattern = "[^,]*";
+        $failuretimezonepattern      = "[^,]*";
+    }
+    else {
+        $knownfailuretimezonepattern = "(" . $timezone . "|\\.\\*)";
+        $failuretimezonepattern      = "$timezone";
     }
 
 
 }
 
 sub escape_pattern {
 
     my $line = shift;
diff --git a/js/tests/pattern-expander.pl b/js/tests/pattern-expander.pl
new file mode 100644
--- /dev/null
+++ b/js/tests/pattern-expander.pl
@@ -0,0 +1,159 @@
+#!/usr/bin/perl -w
+# -*- Mode: Perl; tab-width: 4; indent-tabs-mode: nil; -*-
+# ***** BEGIN LICENSE BLOCK *****
+# Version: MPL 1.1/GPL 2.0/LGPL 2.1
+#
+# The contents of this file are subject to the Mozilla Public License Version
+# 1.1 (the "License"); you may not use this file except in compliance with
+# the License. You may obtain a copy of the License at
+# http://www.mozilla.org/MPL/
+#
+# Software distributed under the License is distributed on an "AS IS" basis,
+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+# for the specific language governing rights and limitations under the
+# License.
+#
+# The Original Code is Mozilla JavaScript Testing Utilities
+#
+# The Initial Developer of the Original Code is
+# Mozilla Corporation.
+# Portions created by the Initial Developer are Copyright (C) 2008
+# the Initial Developer. All Rights Reserved.
+#
+# Contributor(s): Bob Clary <bclary@bclary.com>
+#
+# Alternatively, the contents of this file may be used under the terms of
+# either the GNU General Public License Version 2 or later (the "GPL"), or
+# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+# in which case the provisions of the GPL or the LGPL are applicable instead
+# of those above. If you wish to allow use of your version of this file only
+# under the terms of either the GPL or the LGPL, and not to allow others to
+# use your version of this file under the terms of the MPL, indicate your
+# decision by deleting the provisions above and replace them with the notice
+# and other provisions required by the GPL or the LGPL. If you do not delete
+# the provisions above, a recipient may use your version of this file under
+# the terms of any one of the MPL, the GPL or the LGPL.
+#
+# ***** END LICENSE BLOCK *****
+
+# usage: pattern-expander.pl knownfailures > knownfailures.expanded
+#
+# pattern-expander.pl reads the specified knownfailures file and
+# writes to stdout an expanded set of failures where the wildcards
+# ".*" are replaced with the set of possible values specified in the
+# universe.data file.
+
+use lib "/work/mozilla/mozilla.com/test.mozilla.com/www/tests/mozilla.org/js";
+
+use Patterns;
+
+package Patterns;
+
+processfile();
+
+sub processfile
+{
+    my ($i, $j);
+
+    while (<ARGV>) {
+
+        chomp;
+
+        $record = {};
+
+        my ($test_id, $test_branch, $test_buildtype, $test_type, $test_os, $test_kernel, $test_processortype, $test_memory, $test_cpuspeed, $test_timezone, $test_result, $test_exitstatus, $test_description) = $_ =~ 
+            /TEST_ID=([^,]*), TEST_BRANCH=([^,]*), TEST_BUILDTYPE=([^,]*), TEST_TYPE=([^,]*), TEST_OS=([^,]*), TEST_KERNEL=([^,]*), TEST_PROCESSORTYPE=([^,]*), TEST_MEMORY=([^,]*), TEST_CPUSPEED=([^,]*), TEST_TIMEZONE=([^,]*), TEST_RESULT=([^,]*), TEST_EXITSTATUS=([^,]*), TEST_DESCRIPTION=(.*)/;
+
+        $record->{TEST_ID}            = $test_id;
+        $record->{TEST_BRANCH}        = $test_branch;
+        $record->{TEST_BUILDTYPE}     = $test_buildtype;
+        $record->{TEST_TYPE}          = $test_type;
+        $record->{TEST_OS}            = $test_os;
+        $record->{TEST_KERNEL}        = $test_kernel;
+        $record->{TEST_PROCESSORTYPE} = $test_processortype;
+        $record->{TEST_MEMORY}        = $test_memory;
+        $record->{TEST_CPUSPEED}      = $test_cpuspeed;
+        $record->{TEST_TIMEZONE}      = $test_timezone;
+        $record->{TEST_RESULT}        = $test_result;
+        $record->{TEST_EXITSTATUS}    = $test_exitstatus;
+        $record->{TEST_DESCRIPTION}   = $test_description;
+
+        dbg("processfile: \$_=$_");
+
+        my @list1 = ();
+        my @list2 = ();
+
+        my $iuniversefield;
+        my $universefield;
+
+        $item1 = copyreference($record);
+        dbg("processfile: check copyreference");
+        dbg("processfile: \$record=" . recordtostring($record));
+        dbg("processfile: \$item1=" . recordtostring($item1));
+
+        push @list1, ($item1);
+
+        for ($iuniversefield = 0; $iuniversefield < @universefields; $iuniversefield++)
+        {
+            $universefield = $universefields[$iuniversefield];
+
+            dbg("processfile: \$universefields[$iuniversefield]=$universefield, \$record->{$universefield}=$record->{$universefield}");
+
+            for ($j = 0; $j < @list1; $j++)
+            {
+                $item1 = $list1[$j];
+                dbg("processfile: item1 \$list1[$j]=" . recordtostring($item1));
+                # create a reference to a copy of the hash referenced by $item1
+                if ($item1->{$universefield} ne '.*')
+                {
+                    dbg("processfile: literal value");
+                    $item2 = copyreference($item1);
+                    dbg("processfile: check copyreference");
+                    dbg("processfile: \$item1=" . recordtostring($item1));
+                    dbg("processfile: \$item2=" . recordtostring($item2));
+                    dbg("processfile: pushing existing record to list 2: " . recordtostring($item2));
+                    push @list2, ($item2);
+                }
+                else
+                {
+                    dbg("processfile: wildcard value");
+                    $keyfielduniversekey = getuniversekey($item1, $universefield);
+                    @keyfielduniverse = getuniverse($keyfielduniversekey, $universefield);
+
+                    dbg("processfile: \$keyfielduniversekey=$keyfielduniversekey, \@keyfielduniverse=" . join(',', @keyfielduniverse));
+
+                    for ($i = 0; $i < @keyfielduniverse; $i++)
+                    {
+                        $item2 = copyreference($item1);
+                        dbg("processfile: check copyreference");
+                        dbg("processfile: \$item1=" . recordtostring($item1));
+                        dbg("processfile: \$item2=" . recordtostring($item2));
+                        $item2->{$universefield} = $keyfielduniverse[$i];
+                        dbg("processfile: pushing new record to list 2 " . recordtostring($item2));
+                        push @list2, ($item2);
+                    }
+                }
+                for ($i = 0; $i < @list1; $i++)
+                {
+                    dbg("processfile: \$list1[$i]=" . recordtostring($list1[$i]));
+                }
+                for ($i = 0; $i < @list2; $i++)
+                {
+                    dbg("processfile: \$list2[$i]=" . recordtostring($list2[$i]));
+                }
+            }
+
+            @list1 = @list2;
+            @list2 = ();
+        }
+        for ($j = 0; $j < @list1; $j++)
+        {
+            $item1 = $list1[$j];
+            push @records, ($item1);
+        }
+    }
+    @records = sort sortrecords @records;
+
+    dumprecords();
+}
+
diff --git a/js/tests/pattern-extracter.pl b/js/tests/pattern-extracter.pl
new file mode 100644
--- /dev/null
+++ b/js/tests/pattern-extracter.pl
@@ -0,0 +1,217 @@
+#!/usr/bin/perl -w
+# -*- Mode: Perl; tab-width: 4; indent-tabs-mode: nil; -*-
+# ***** BEGIN LICENSE BLOCK *****
+# Version: MPL 1.1/GPL 2.0/LGPL 2.1
+#
+# The contents of this file are subject to the Mozilla Public License Version
+# 1.1 (the "License"); you may not use this file except in compliance with
+# the License. You may obtain a copy of the License at
+# http://www.mozilla.org/MPL/
+#
+# Software distributed under the License is distributed on an "AS IS" basis,
+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+# for the specific language governing rights and limitations under the
+# License.
+#
+# The Original Code is Mozilla JavaScript Testing Utilities
+#
+# The Initial Developer of the Original Code is
+# Mozilla Corporation.
+# Portions created by the Initial Developer are Copyright (C) 2008
+# the Initial Developer. All Rights Reserved.
+#
+# Contributor(s): Bob Clary <bclary@bclary.com>
+#
+# Alternatively, the contents of this file may be used under the terms of
+# either the GNU General Public License Version 2 or later (the "GPL"), or
+# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+# in which case the provisions of the GPL or the LGPL are applicable instead
+# of those above. If you wish to allow use of your version of this file only
+# under the terms of either the GPL or the LGPL, and not to allow others to
+# use your version of this file under the terms of the MPL, indicate your
+# decision by deleting the provisions above and replace them with the notice
+# and other provisions required by the GPL or the LGPL. If you do not delete
+# the provisions above, a recipient may use your version of this file under
+# the terms of any one of the MPL, the GPL or the LGPL.
+#
+# ***** END LICENSE BLOCK *****
+
+# usage: pattern-extracter.pl knownfailures.expanded > knownfailures
+#
+# pattern-extracter.pl reads the specified expanded knownfailures file
+# (see pattern-expander.pl) and writes to stdout a set of knownfailures
+# where repetitions of values found in the universe.data file are
+# replaced with wildcards ".*".
+
+use lib "/work/mozilla/mozilla.com/test.mozilla.com/www/tests/mozilla.org/js";
+
+use Patterns;
+
+package Patterns;
+
+
+my $universefield;
+
+processfile();
+
+sub processfile
+{
+    my $recordcurr = {};
+    my $recordprev;
+
+    my @output;
+    my $keycurr = '';
+    my $keyprev = '';
+    my @values = ();
+    my $universefielduniversekey; # universekey for universefield
+    my @universefielduniverse;
+    my $i;
+    my $j;
+    my $v;
+
+    while (<ARGV>) {
+
+        chomp;
+
+        $recordcurr = {};
+
+        my ($test_id, $test_branch, $test_buildtype, $test_type, $test_os, $test_kernel, $test_processortype, $test_memory, $test_cpuspeed, $test_timezone, $test_result, $test_exitstatus, $test_description) = $_ =~ 
+            /TEST_ID=([^,]*), TEST_BRANCH=([^,]*), TEST_BUILDTYPE=([^,]*), TEST_TYPE=([^,]*), TEST_OS=([^,]*), TEST_KERNEL=([^,]*), TEST_PROCESSORTYPE=([^,]*), TEST_MEMORY=([^,]*), TEST_CPUSPEED=([^,]*), TEST_TIMEZONE=([^,]*), TEST_RESULT=([^,]*), TEST_EXITSTATUS=([^,]*), TEST_DESCRIPTION=(.*)/;
+
+        $recordcurr->{TEST_ID}            = $test_id;
+        $recordcurr->{TEST_BRANCH}        = $test_branch;
+        $recordcurr->{TEST_BUILDTYPE}     = $test_buildtype;
+        $recordcurr->{TEST_TYPE}          = $test_type;
+        $recordcurr->{TEST_OS}            = $test_os;
+        $recordcurr->{TEST_KERNEL}        = $test_kernel;
+        $recordcurr->{TEST_PROCESSORTYPE} = $test_processortype;
+        $recordcurr->{TEST_MEMORY}        = $test_memory;
+        $recordcurr->{TEST_CPUSPEED}      = $test_cpuspeed;
+        $recordcurr->{TEST_TIMEZONE}      = $test_timezone;
+        $recordcurr->{TEST_RESULT}        = $test_result;
+        $recordcurr->{TEST_EXITSTATUS}    = $test_exitstatus;
+        $recordcurr->{TEST_DESCRIPTION}   = $test_description;
+
+        push @records, ($recordcurr);
+    }
+
+    for ($j = $#universefields; $j >= 0; $j--)
+    {
+        $universefield   = $universefields[$j];
+
+        @records = sort {getkey($a, $universefield) cmp getkey($b, $universefield);} @records;
+
+        $recordprev = $records[0];
+        $keyprev    = getkey($recordprev, $universefield);
+        @values     = ();
+
+        my $recordtemp;
+        my $keytemp;
+
+        dbg("processfile: begin processing records for \$universefields[$j]=$universefield");
+
+        for ($i = 0; $i < @records; $i++)
+        {
+            $recordcurr = $records[$i];
+            $keycurr = getkey($recordcurr, $universefield);
+
+            dbg("processfile: processing record[$i]");
+            dbg("processfile: recordprev: " . recordtostring($recordprev));
+            dbg("processfile: recordcurr: " . recordtostring($recordcurr));
+            dbg("processfile: \$keyprev=$keyprev");
+            dbg("processfile: \$keycurr=$keycurr");
+
+            if ($keycurr ne $keyprev)
+            {
+                # key changed, must output previous record
+                dbg("processfile: new key");
+                $universefielduniversekey = getuniversekey($recordprev, $universefield);
+                @universefielduniverse = getuniverse($universefielduniversekey, $universefield);
+                dbg("processfile: \@values: ". join(',', @values));
+                dbg("processfile: \$universefielduniversekey=$universefielduniversekey, \@universefielduniverse=" . join(',', @universefielduniverse));
+                @values = ('.*') if (arraysequal(\@values, \@universefielduniverse));
+                dbg("processfile: \@values=" . join(',', @values));
+
+                for ($v = 0; $v < @values; $v++)
+                {
+                    dbg("processfile: stuffing $values[$v]");
+                    $recordtemp = copyreference($recordprev);
+                    $recordtemp->{$universefield} = $values[$v];
+                    dbg("processfile: stuffed $recordtemp->{$universefield}");
+                    dbg("processfile: recordprev: " . recordtostring($recordprev));
+                    dbg("processfile: output: " . recordtostring($recordtemp));
+                    push @output, ($recordtemp);
+                }
+                @values = ();
+            }
+            dbg("processfile: collecting \$recordcurr->{$universefield}=$recordcurr->{$universefield}");
+            push @values, ($recordcurr->{$universefield});
+            $keyprev = $keycurr;
+            $recordprev = $recordcurr;
+        }
+        dbg("processfile: finish processing records for \$universefields[$j]=$universefield");
+        if (@values)
+        {
+            dbg("processfile: last record for \$universefields[$j]=$universefield has pending values");
+            $universefielduniversekey = getuniversekey($recordprev, $universefield);
+            @universefielduniverse = getuniverse($universefielduniversekey, $universefield);
+            dbg("processfile: \@values: ". join(',', @values));
+            dbg("processfile: \$universefielduniversekey=$universefielduniversekey, \@universefielduniverse=" . join(',', @universefielduniverse));
+            @values = ('.*') if (arraysequal(\@values, \@universefielduniverse));
+            dbg("processfile: \@values=" . join(',', @values));
+
+            for ($v = 0; $v < @values; $v++)
+            {
+                dbg("processfile: stuffing $values[$v]");
+                $recordtemp = copyreference($recordprev);
+                $recordtemp->{$universefield} = $values[$v];
+                dbg("processfile: stuffed $recordprev->{$universefield}");
+                dbg("processfile: recordprev: " . recordtostring($recordprev));
+                dbg("processfile: output: " . recordtostring($recordtemp));
+                push @output, ($recordtemp);
+            }
+            @values = ();
+        }
+        @records = @output;
+        @output = ();
+    }
+
+    @records = sort sortrecords @records;
+    dumprecords();
+}
+
+
+sub getkey 
+{
+    my ($record, $universefield) = @_;
+
+    my $i;
+
+    my $key = '';
+
+    for ($i = 0; $i < @sortkeyfields; $i++)
+    {
+        if ($sortkeyfields[$i] ne $universefield)
+        {
+            $key .= $record->{$sortkeyfields[$i]}
+        }
+    }
+    return $key;
+}
+
+sub arraysequal 
+{
+    my ($larrayref, $rarrayref) = @_;
+    my $i;
+
+    dbg("arraysequal: checking if " . (join ',', @{$larrayref}) . " is equal to " . (join ',', @{$rarrayref}));
+    return 0 if (@{$larrayref} != @{$rarrayref});
+
+    for ($i = 0; $i < @{$larrayref}; $i++)
+    {
+        return 0 if ($rarrayref->[$i] ne $larrayref->[$i]);
+    }
+    dbg("arraysequal: equal");
+    return 1;
+}
+
diff --git a/js/tests/post-process-logs.pl b/js/tests/post-process-logs.pl
--- a/js/tests/post-process-logs.pl
+++ b/js/tests/post-process-logs.pl
@@ -57,33 +57,36 @@ die "FATAL ERROR: environment variable T
 
 (undef, $temp) = tempfile();
 
 open TEMP, ">$temp" or
     die "FATAL ERROR: Unable to open temporary file $temp for writing: $!\n";
 
 local ($test_id,
        $tmp_test_id,
+       $tmp_test_exit_status,
        %test_id,
        %test_reported,
        $test_result, 
        $test_type, 
        $tmp_test_type,
        $test_description, 
        @messages,
        $test_processortype, 
        $test_kernel, 
        $test_suite,
-       $exit_status,
-       $page_status,
+       $test_exit_status,
+       @expected_exit_code_list,
+       $expected_exit_code,
+       $exit_code,
        $state);
 
-local ($actual_exit, $actual_signal);
-
-local %test_reported       = ();
+local $test_memory = 0;
+local $test_cpuspeed = 0;
+local %test_reported = ();
 
 while ($file = shift @ARGV)
 {
     @messages = ();
 
     dbg "file: $file";
 
     my $filename = basename $file;
@@ -95,776 +98,491 @@ while ($file = shift @ARGV)
            $test_machine,$test_global_target) = split /,/, $filename;
 
     $test_branchid =~ s/[^0-9.]//g;
     $test_global_target =~ s/.log$//;
 
     local ($test_timezone) = $test_date;
     $test_timezone =~ s/.*([-+]\d{4,4})/$1/;
 
-    open FILE, "$file" or die "FATAL ERROR: unable to open $file for reading: $!\n";
+    my $filemode;
+
+    if ($file =~ /\.bz2$/)
+    {
+        $filemode = "bzcat $file|";
+    }
+    elsif ($file =~ /\.gz$/)
+    {
+        $filemode = "zcat $file|";
+    }
+    else
+    {
+        $filemode = "<$file";
+    }
+
+    open FILE, "$filemode" or die "FATAL ERROR: unable to open $file for reading: $!\n";
 
     dbg "process header with environment variables used in test";
 
     while (<FILE>)
     {
         $state = 'failure';
 
         chomp;
 
         # remove carriage returns, bels and other annoyances.
         $_ =~ s/[\r]$//;
         $_ =~ s/[\r]/CR/g;
         $_ =~ s/[\x01-\x08]//g;
         $_ =~ s/\s+$//;
 
-        dbg  "INPUT: $_";
+        if ($debug)
+        {
+            dbg "\nINPUT: $_";
+        }
 
-        last if ( $_ =~ /^environment: EOF/);
+        last if ( $_ =~ /^arguments:/);
 
         if (($envvar, $envval) = $_ =~ /^environment: (TEST_[A-Z0-9_]*)=(.*)/ )
         {
             dbg "envvar=$envvar, envval=$envval";
+            if ($envvar =~ /TEST_KERNEL/)
+            {
+                $envval =~ s/([0-9]+)\.([0-9]+)\.([0-9]+).*/$1.$2.$3/;
+                dbg "found TEST_KERNEL";
+            }
             $envvar =~ tr/A-Z/a-z/;
             $$envvar = $envval;
             dbg $envvar . "=" . $$envvar;
         }
         elsif (($envval) = $_ =~ /^environment: OSID=(.*)/ )
         {
             $test_os = $envval;
         }
     }
 
+    if ($test_cpuspeed < 4)
+    {
+        $test_cpuspeed = 'slow';
+    }
+    elsif ($test_cpuspeed < 9)
+    {
+        $test_cpuspeed = 'medium';
+    }
+    else
+    {
+        $test_cpuspeed = 'fast';
+    }
+
     if ($test_product eq "js")
     {
-        while (<FILE>)
+        $test_type       = "shell";
+    }
+    elsif ($test_product eq "firefox" || $test_product eq "thunderbird")
+    {
+        $test_buildtype  = "nightly" unless $test_buildtype;
+        $test_type       = "browser";
+    }
+
+#  Expected sequence if all output written to the log.
+#
+#    Input                     
+# -----------------------------
+# JavaScriptTest: Begin Run    
+# JavaScriptTest: Begin Test t;
+# jstest: t                    
+# t:.*EXIT STATUS:             
+# JavaScriptTest: End Test t   
+# JavaScriptTest: End Run      
+# EOF                          
+# 
+    %test_id         = ();
+    @messages        = ();
+    $test_exit_status = '';
+    $state           = 'idle';
+
+    while (<FILE>)
+    {
+        chomp;
+
+        if ($debug)
         {
-            chomp;
+            dbg "\nINPUT: '$_'";
+        }
 
-            dbg  "INPUT: $_";
+        $_ =~ s/[\r]$//;
+        $_ =~ s/[\r]/CR/g;
+        $_ =~ s/[\x01-\x08]//g;
+        $_ =~ s/\s+$//;
 
-            if (/Wrote results to/)
+        if ( /^JavaScriptTest: Begin Run/)
+        {
+            dbg "Begin Run";
+
+            if ($state eq 'idle')
             {
-                $state = 'success';
-                last;
+                $state = 'beginrun';
+            }
+            else
+            {
+                warn "WARNING: state: $state, expected: idle, log: $file";
+                $state = 'beginrun';
+            }
+        }
+        elsif ( ($tmp_test_id) = $_ =~ /^JavaScriptTest: Begin Test ([^ ]*)/)
+        {
+            dbg "Begin Test: $tmp_test_id";
+
+            if ($state eq 'beginrun' || $state eq 'endtest')
+            {
+                $state = 'runningtest';
+            }
+            else
+            {
+                warn "WARNING: state: $state, expected: beginrun, endtest, log: $file";
+                $state = 'runningtest';
             }
 
-            $_ =~ s/[\r]$//;
-            $_ =~ s/[\r]/CR/g;
-            $_ =~ s/[\x01-\x08]//g;
-            $_ =~ s/\s+$//;
+            $test_id{$state}         = $tmp_test_id;
+            @messages                = ();
+            @expected_exit_code_list = ();
+            $expected_exit_code      = ();
 
-            next if ( $_ !~ /^jstest: /);
+            $test_id          = '';
+            $test_result      = '';
+            $test_exit_status = 'NORMAL'; # default to normal, so subtests will have a NORMAL status
+            $test_description = '';
 
-            ($test_id)          = $_ =~ /^jstest: (.*?) *bug:/;
+            push @expected_exit_code_list, (3) if ($tmp_test_id =~ /-n.js$/);
+            
+        }
+        elsif ( ($expected_exit_code) = $_ =~ /WE EXPECT EXIT CODE ([0-9]*)/ ) 
+        {
+            dbg "Expected Exit Code: $expected_exit_code";
+
+            push @expected_exit_code_list, ($expected_exit_code);
+        }
+        elsif ( ($tmp_test_id) = $_ =~ /^jstest: (.*?) *bug:/)
+        {
+            dbg "jstest: $tmp_test_id";
+
+#            if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+#            {
+#                warn "WARNING: state: $state, expected runningtest, reportingtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+#            }
+
+            if ($state eq 'runningtest')
+            {
+                $state = 'reportingtest';
+            }
+            elsif ($state eq 'reportingtest')
+            {
+                $state = 'reportingtest';
+            }
+            else
+            {
+                warn "WARNING: test_id: $test_id{$state}, state: $state, expected: runningtest, reportingtest, log: $file";
+                $state = 'reportingtest';
+            }
+
             ($test_result)      = $_ =~ /result: (.*?) *type:/;
-            ($test_type)        = $_ =~ /type: (.*?) *description:/;
+            ($tmp_test_type)    = $_ =~ /type: (.*?) *description:/;
+
+            die "FATAL ERROR: test_id: $test_id{$state}, jstest test type mismatch: start test_type: $test_type, current test_type: $tmp_test_type, test state: $state, log: $file" 
+                if ($test_type ne $tmp_test_type);
+
             ($test_description) = $_ =~ /description: (.*)/;
 
             if (!$test_description)
             {
                 $test_description = "";
             }
+            $test_description .= '; messages: ' . (join '; ', @messages) . ';';
+
+            outputrecord $tmp_test_id, $test_description, $test_result;
+
+            $test_id{$state} = $tmp_test_id;
+        }
+        elsif ( $state ne 'idle' && (($tmp_test_id) = $_ =~ /^([^:]*):.* EXIT STATUS: NORMAL/))
+        {
+            $test_exit_status = 'NORMAL';
+            dbg "Exit Status Normal: $tmp_test_id, $test_exit_status";
+
+            if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+            {
+                warn "WARNING: state: $state, mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+            }
+
+            if ($state eq 'reportingtest' || $state eq 'runningtest')
+            {
+                $state = 'exitedtest';
+            }
             else
             {
-                ($actual_exit, $actual_signal) = $test_description =~ /expected: Expected exit [03] actual: Actual exit ([0-9]*), signal ([0-9]*)/;
-                if (defined($actual_exit) or defined($actual_signal))
-                {
-                    if ($actual_exit > 3 || $actual_signal > 0)
-                    {
-                        $test_description =~ s/ *expected: Expected exit [03] actual: Actual exit ([0-9]*), signal ([0-9]*) /EXIT STATUS: CRASHED $actual_exit signal $actual_signal, /;
-                    }
-                }
-                elsif ($test_result eq "FAILED TIMED OUT")
-                {
-                    $test_description = "EXIT STATUS: TIMED OUT, $test_description";
-                    $test_result = "FAILED";
-                }
+                warn "WARNING: state: $state, expected: reportingtest, runningtest, log: $file";
+                $state = 'exitedtest';
             }
 
-            if ($test_description =~ /error: can.t allocate region/ || /set a breakpoint in malloc_error_break/ || 
-                /set a breakpoint in szone_error to debug/ || /malloc:.*mmap/ || /vm_allocate/ )
+            if (! $test_reported{$tmp_test_id})
             {
-                dbg "Adding message: /$test_id:0: out of memory";
-                $test_description .= "; /$test_id:0: out of memory";
+                dbg "No test results reported: $tmp_test_id";
+
+                $test_result = 'FAILED';
+                $test_description = 'No test results reported; messages: ' . (join '; ', @messages) . ';';
+                
+                outputrecord $tmp_test_id, $test_description, $test_result;
             }
 
-            dbg "test_id:          $test_id";
-            dbg "test_result:      $test_result";
-            dbg "test_type:        $test_type";
-            dbg "test_description: $test_description";
+            $test_id{$state} = $tmp_test_id;
+        }
+        elsif ( $state ne 'idle' && (($tmp_test_id) = $_ =~ /^([^:]*):.* EXIT STATUS: TIMED OUT/))
+        {
+            $test_exit_status = 'TIMED OUT';
+            dbg "Exit Status Timed Out: $tmp_test_id, $test_exit_status";
 
-            outputrecord $test_id, $test_description, $test_result;
-
-            dbg "-";
-        }
-    }
-    elsif ($test_product eq "firefox")
-    {
-        %test_id         = ();
-        @messages        = ();
-
-        $page_status     = '';
-        $exit_status     = '';
-        $test_buildtype  = "nightly" unless $test_buildtype;
-        $test_type       = "browser";
-
-
-# non-restart mode. start spider; for each test { load test;} exit spider;
-# restart mode.     for each test; { start spider; load test; exit spider; }
-# 
-#                    Expected sequence if all output written to the log.
-#
-#    Input                                            Initial State       Next State       userhook event                         outputrecord
-# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
-# Spider: Start.*start-spider.html                    idle                startrun
-# Spider: Begin loading.*start-spider.html            startrun            startrun
-# Start Spider: try.*EXIT STATUS: NORMAL              startrun            initialized
-# Start Spider: try.*EXIT STATUS: (TIMED OUT|CRASHED) startrun            startrun
-# Spider: Start.*urllist                              initialized         initialized      (non restart mode)
-# Spider: Begin loading.*urllist                      initialized         initialized      (non restart mode)
-# Spider: Finish loading.*urllist                     initialized         initialized      (non restart mode)
-# Spider: Current Url:.*urllist                       initialized         initialized      (non restart mode)
-# Spider: Start.*test=t;                              initialized         starttest        (has test id)
-# JavaScriptTest: Begin Run                           starttest           starttest        onStart
-# Spider: Begin loading.*test=t;                      starttest           loadingtest      (has test id)
-# JavaScriptTest: Begin Test t;                       loadingtest         runningtest      onBeforePage (has test id)                         
-# jstest: t                                           runningtest         reportingtest    (has test id)                          yes.        
-# Spider: Finish loading.*t=t;                        reportingtest       loadedtest       (has test id)                                      
-# Spider: Finish loading.*t=t;                        runningtest         pendingtest      (has test id)                                      
-# Spider: Current Url:.*test=t;                       loadedtest          loadedtest       (has test id)                                      
-# http://.*test=t;.*PAGE STATUS: NORMAL               loadedtest          loadedtest       onAfterPage (has test id)                          
-# http://.*test=t;.*PAGE STATUS: TIMED OUT            loadedtest          endrun           onPageTimeout (has test id)            yes.        
-# JavaScriptTest: t Elapsed time                      loadedtest          completedtest    checkTestCompleted (has test id)                   
-# JavaScriptTest: End Test t                          completedtest       completedtest    checkTestCompleted (has test id)                   
-# JavaScriptTest: End Test t                          endrun              endrun           onPageTimeout (has test id)                        
-# Spider: Start.*test=t;                              completedtest       starttest        (non restart mode) (has test id)
-# JavaScriptTest: End Run                             completedtest       endrun           onStop
-# JavaScriptTest: End Run                             loadedtest          endrun           onStop
-# Spider: Start.*test=t;                              endrun              starttest        (restart mode) (has test id)
-# http://.*test=t;.*EXIT STATUS: NORMAL               endrun              endrun           (has test id)                          maybe.
-# http://.*test=t;.*EXIT STATUS: TIMED OUT            endrun              endrun           (has test id)                          yes.
-# http://.*test=t;.*EXIT STATUS: CRASHED              endrun              endrun           (has test id)                          yes.
-# /work/mozilla/mozilla.com/test.mozilla.com/www$     endrun              success
-# EOF                                                 success             success
-# EOF                                                 endrun              failure
-# 
-# States        has test id
-# -------------------------
-# idle
-# startrun
-# initialized
-# starttest     has test id
-# loadingtest   has test id
-# runningtest   has test id
-# pendingtest   has test id
-# reportingtest has test id
-# loadedtest    has test id
-# endrun        has test id
-# completedtest has test id
-# success
-# failure
-
-        dbg "Assuming starting in restart mode";
-
-        $mode  = 'restart';
-        $state = 'idle';
-
-        while (<FILE>)
-        {
-            chomp;
-
-            # remove carriage returns, bels and other annoyances.
-            $_ =~ s/[\r]$//;
-            $_ =~ s/[\r]/CR/g;
-            $_ =~ s/[\x01-\x08]//g;
-            $_ =~ s/\s+$//;
-
-            if ($debug)
+            if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
             {
-                dbg "\nINPUT: $_";
+                warn "WARNING: state: $state, mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
             }
 
-            # massage the input to make more uniform across test types and platforms
-            s/\.js, line ([0-9]*): out of memory/.js:$1: out of memory/g;
+            if ($state eq 'reportingtest' || $state eq 'runningtest')
+            {
+                $state = 'exitedtest';
+            }
+            else
+            {
+                dbg "state: $state, expected: reportingtest, runningtest";
+                $state = 'exitedtest';
+            }
 
+            $test_result     = 'FAILED';
+            $test_description .= '; messages: ' . (join '; ', @messages) . ';';
+            
+            outputrecord $tmp_test_id, $test_description, $test_result;
 
-            if (/^Spider: Start.*start-spider.html/)
+            $test_id{$state} = $tmp_test_id;
+        }
+        elsif ( $state ne 'idle' && (($tmp_test_id, $tmp_test_exit_status) = $_ =~ /^([^:]*):.* EXIT STATUS: (CRASHED signal [0-9]+ [A-Z]+) \([0-9.]+ seconds\)/))
+        {
+            $test_exit_status = $tmp_test_exit_status;
+            dbg "Exit Status Crashed: $tmp_test_id, $test_exit_status";
+
+            if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
             {
-                if ($state eq 'idle')
+                warn "WARNING: state: $state, mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+            }
+
+            if ($state eq 'reportingtest' || $state eq 'runningtest')
+            {
+                $state = 'exitedtest';
+            }
+            else
+            {
+                dbg "state: $state, expected: reportingtest, runningtest";
+                $state = 'exitedtest';
+            }
+
+            $test_result     = 'FAILED';
+            $test_description .= '; messages: ' . (join '; ', @messages) . ';';
+            
+            outputrecord $tmp_test_id, $test_description, $test_result;
+
+            $test_id{$state} = $tmp_test_id;
+        }
+        elsif ( $state ne 'idle' && (($tmp_test_id, $tmp_test_exit_status) = $_ =~ /^([^:]*):.* EXIT STATUS: (ABNORMAL [0-9]+) \([0-9.]+ seconds\)/))
+        {
+            $test_exit_status = $tmp_test_exit_status;
+            dbg "Exit Status Abnormal: $tmp_test_id, $test_exit_status";
+
+            if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+            {
+                warn "WARNING: state: $state, mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+            }
+
+            if ($state eq 'reportingtest'  || $state eq 'runningtest')
+            {
+                $state = 'exitedtest';
+            }
+            else
+            {
+                dbg "state: $state, expected: reportingtest, runningtest";
+                $state = 'exitedtest';
+            }
+
+            ($exit_code) = $test_exit_status =~ /ABNORMAL ([0-9]+)/;
+
+            if (grep /$exit_code/, @expected_exit_code_list)
+            {
+                $test_result = 'PASSED';
+            }
+            else
+            {
+                $test_result = 'FAILED';
+            }
+
+            $test_description .= '; messages: ' . (join '; ', @messages) . ';';
+
+            dbg "Exit Code: $exit_code, Test Result: $test_result, Expected Exit Codes: " . (join '; ', @expected_exit_code_list);
+
+            outputrecord $tmp_test_id, $test_description, $test_result;
+
+            $test_id{$state} = $tmp_test_id;
+        }
+        elsif ( ($tmp_test_id) = $_ =~ /^JavaScriptTest: End Test ([^ ]*)/)
+        {
+            dbg "End Test: $tmp_test_id";
+
+            if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+            {
+                warn "WARNING: state: $state, mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+            }
+
+            if ($state eq 'exitedtest' || $state eq 'runningtest' || $state eq 'reportingtest')
+            {
+                $state = 'endtest';
+            }
+            else
+            {
+                warn "WARNING: state: $state, expected: runningtest, reportingtest, exitedtest, log: $file";
+                $state = 'endtest';
+            }
+
+            $test_id{$state} = $tmp_test_id;
+        }
+        elsif ( /^JavaScriptTest: End Run/)
+        {
+            dbg "End Run";
+
+            if ($state eq 'endtest')
+            {
+                $state = 'endrun';
+            }
+            else
+            {
+                warn "WARNING: state: $state, expected: endtest, log: $file";
+                $state = 'endrun';
+            }
+        }
+        elsif ($_ && 
+               !/^\s+$/ && 
+               !/^(STATUS:| *PASSED!| *FAILED!)/ && 
+               !/^JavaScriptTest:/ && 
+               !/^[*][*][*]/ && 
+               !/^[-+]{2,2}(WEBSHELL|DOMWINDOW)/ && 
+               !/^Spider:/ && 
+               !/real.*user.*sys.*$/ && 
+               !/user.*system.*elapsed/)
+        {
+            if ('runningtest, reportingtest' =~ /$state/)
+            {
+
+                if (/error: can.t allocate region/ || /set a breakpoint in malloc_error_break/ || 
+                    /set a breakpoint in szone_error to debug/ || /malloc:.*mmap/ || /vm_allocate/ ||
+                    /terminate called after throwing an instance of 'std::bad_alloc'/)
                 {
-                    $state = 'startrun';
+                    dbg "Adding message: $_ converted to /$test_id{$state}:0: out of memory";
+                    push @messages, ('/' . $test_id{$state} . ':0: out of memory');
+                }
+                elsif (/\.js, line [0-9]+: out of memory/ )
+                {
+                    s/\.js, line ([0-9]+): out of memory/\.js:$1:/;
+                    dbg "Adding message: $_ converted to /$test_id{$state}:0: out of memory";
+                    push @messages, ('/' . $test_id{$state} . ':0: out of memory');
                 }
                 else
                 {
-                    warn "WARNING: state: $state, expected: idle, log: $file";
-                    $state = 'startrun';
-                }
-            }
-            elsif (/^Spider: Begin loading.*start-spider.html/)
-            {
-                if ($state eq 'startrun')
-                {
-                    $state = 'startrun';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: startrun, log: $file";
-                    $state = 'startrun';
-                }
-            }
-            elsif (/^Start Spider: try.*EXIT STATUS: NORMAL/)
-            {
-                if ($state eq 'startrun')
-                {
-                    $state = 'initialized';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: startrun, log: $file";
-                    $state = 'initialized';
-                }
-            }
-            elsif (/^Start Spider: try.*EXIT STATUS: (TIMED OUT|CRASHED)/)
-            {
-                if ($state eq 'startrun')
-                {
-                    $state = 'startrun';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: startrun, log: $file";
-                    $state = 'startrun';
-                }
-            }
-            elsif ( /^Spider: Start: -url .*test.mozilla.com.tests.mozilla.org.js.urllist-/)
-            {
-                dbg "Setting mode to nonrestart";
-
-                $mode = 'nonrestart';
-
-                if ($state eq 'initialized')
-                {
-                    $state = 'initialized';
-                }
-                elsif ($state eq 'starttest')
-                {
-                    $state = 'initialized';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: initialized, starttest, log: $file";
-                    $state = 'initialized';
-                }
-            }
-            elsif ( ($tmp_test_id) = $_ =~ /^Spider: Start.*http.*test=([^;]*);/)
-            {
-                if ($state eq 'initialized')
-                {
-                    $state = 'starttest';
-                }
-                elsif ($state eq 'completedtest')
-                {
-                    $state = 'starttest';
-                }
-                elsif ($state eq 'endrun')
-                {
-                    $state = 'starttest';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: initialized, completedtest, endrun, log: $file";
-                    $state = 'starttest';
-                }
-
-                $test_id{$state} = $tmp_test_id;
-                $test_id{'loadingtest'} = $test_id{'runningtest'} = $test_id{'reportingtest'} = $test_id{'loadedtest'} = $test_id{'endrun'} = $test_id {'completedtest'} = $test_id{'loadedtest'} = '';
-                @messages = ();
-            }
-            elsif ( /^JavaScriptTest: Begin Run/)
-            {
-                if ($state eq 'starttest')
-                {
-                    $state = 'starttest';
-                }
-                elsif ($state eq 'initialized' && $mode eq 'nonrestart')
-                {
-                    $state = 'starttest';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: starttest or initialized in non restart mode, mode $mode, log: $file";
-                    $state = 'starttest';
-                }
-            }
-            elsif ( ($tmp_test_id) = $_ =~ /^Spider: Begin loading http.*test=([^;]*);/)
-            {
-                if ($mode eq 'restart' && $test_id{$state} && $tmp_test_id ne $test_id{$state})
-                {
-                    warn "WARNING: state: $state, expected starttest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
-                }
-
-                if ($state eq 'starttest')
-                {
-                    $state = 'loadingtest';
-                }
-                elsif ($state eq 'initialized' && $mode eq 'nonrestart')
-                {
-                    $state = 'loadingtest';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: starttest or initialized in non restart mode, log: $file";
-                    $state = 'loadingtest';
-                }
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif ( ($tmp_test_id) = $_ =~ /^JavaScriptTest: Begin Test ([^ ]*)/)
-            {
-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
-                {
-                    warn "WARNING: state: $state, expected loadingtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
-                }
-
-                if ($state eq 'loadingtest')
-                {
-                    $state = 'runningtest';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: loadingtest, log: $file";
-                    $state = 'runningtest';
-                }
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif ( ($tmp_test_id) = $_ =~ /^jstest: (.*?) *bug:/)
-            {
-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
-                {
-                    warn "WARNING: state: $state, expected runningtest, reportingtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
-                }
-
-                if ($state eq 'runningtest')
-                {
-                    $state = 'reportingtest';
-                }
-                elsif ($state eq 'reportingtest')
-                {
-                    $state = 'reportingtest';
-                }
-                elsif ($state eq 'pendingtest')
-                {
-                    $state = 'reportingtest';
-                }
-                else
-                {
-                    warn "WARNING: test_id: $test_id{$state}, state: $state, expected: runningtest, reportingtest, pendingtest, log: $file";
-                    $state = 'reportingtest';
-                }
-
-                ($test_result)      = $_ =~ /result: (.*?) *type:/;
-                ($tmp_test_type)    = $_ =~ /type: (.*?) *description:/;
-
-                die "FATAL ERROR: test_id: $test_id{$state}, jstest test type mismatch: start test_type: $test_type, current test_type: $tmp_test_type, test state: $state, log: $file" 
-                    if ($test_type ne $tmp_test_type);
-
-                ($test_description) = $_ =~ /description: (.*)/;
-
-                if (!$test_description)
-                {
-                    $test_description = "";
-                }
-                $test_description .= ' ' . join '; ', @messages;
-
-                outputrecord $tmp_test_id, $test_description, $test_result;
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif ( ($tmp_test_id) = $_ =~ /^Spider: Finish loading http.*test=([^;]*);/)
-            {
-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
-                {
-                    warn "WARNING: state: $state, expected reportingtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
-                }
-
-                if ($state eq 'reportingtest')
-                {
-                    $state = 'loadedtest';
-                }
-                else
-                {
-                    # probably an out of memory error or a browser only delayed execution test.
-                    dbg "state: $state, expected: reportingtest. assuming test result is pending";
-                    $state = 'pendingtest';
-                }
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif ( ($tmp_test_id) = $_ =~ /^Spider: Current Url:.*test=([^;]*);/)
-            {
-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
-                {
-                    warn "WARNING: state: $state, expected loadedtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
-                }
-
-                if ($state eq 'loadedtest')
-                {
-                    $state = 'loadedtest';
-                }
-                elsif ($state eq 'reportingtest')
-                {
-                    $state = 'loadedtest';
-                }
-                elsif ($state eq 'pendingtest')
-                {
-                    $state = 'pendingtest';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: loadedtest, reportingtest, pendingtest, log: $file";
-                    $state = 'loadedtest';
-                }
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif ( ($tmp_test_id, $page_status) = $_ =~ /^http:.*test=([^;]*);.* (PAGE STATUS: NORMAL.*)/)
-            {
-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
-                {
-                    warn "WARNING: state: $state, expected loadedtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
-                }
-
-                if ($state eq 'loadedtest')
-                {
-                    $state = 'loadedtest';
-                }
-                elsif ($state eq 'pendingtest')
-                {
-                    $state = 'pendingtest';
-                }
-                elsif ($state eq 'reportingtest')
-                {
-                    # test was pending, but output a result.
-                    $state = 'loadedtest';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: loadedtest, pendingtest, reportingtest, log: $file";
-                    $state = 'loadedtest';
-                }
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif ( ($tmp_test_id, $page_status) = $_ =~ /^http:.*test=([^;]*);.* (PAGE STATUS: TIMED OUT.*)/)
-            {
-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
-                {
-                    warn "WARNING: state: $state, expected loadedtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
-                }
-
-                if ($state eq 'loadedtest')
-                {
-                    $state = 'endrun';
-                }
-                elsif ($state eq 'runningtest')
-                {
-                    $state = 'completedtest';
-                }
-                elsif ($state eq 'reportingtest')
-                {
-                    $state = 'completedtest';
-                }
-                elsif ($state eq 'pendingtest')
-                {
-                    $state = 'completedtest';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: loadedtest, runningtest, reportingtest, pendingtest, log: $file";
-                    $state = 'endrun';
-                }
-
-                $test_result     = 'FAILED';
-                $test_description = $page_status . ' ' . join '; ', @messages;;
-                
-                outputrecord $tmp_test_id, $test_description, $test_result;
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif ( ($tmp_test_id) = $_ =~ /^JavaScriptTest: ([^ ]*) Elapsed time/)
-            {
-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
-                {
-                    warn "WARNING: state: $state, expected loadedtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
-                }
-
-                if ($state eq 'loadedtest')
-                {
-                    $state = 'completedtest';
-                }
-                elsif ($state eq 'pendingtest')
-                {
-                    $state = 'pendingtest';
-                }
-                elsif ($state eq 'reportingtest')
-                {
-                    # test was pending, but has been reported.
-                    $state = 'completedtest';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: loadedtest, loadedtest, pendingtest, reportingtest, log: $file";
-                    $state = 'completedtest';
-                }
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif ( ($tmp_test_id) = $_ =~ /^JavaScriptTest: End Test ([^ ]*)/)
-            {
-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
-                {
-                    warn "WARNING: state: $state, expected completedtest, endrun. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
-                }
-
-                if ($state eq 'completedtest')
-                {
-                    if ($mode eq 'restart')
-                    {
-                        $state = 'completedtest';
-                    }
-                    else
-                    {
-                        $state = 'starttest';
-                    }
-                }
-                elsif ($state eq 'pendingtest')
-                {
-                    $state = 'completedtest';
-
-                    $test_result = 'UNKNOWN';
-                    $test_description = 'No test results reported. ' . join '; ', @messages;
-                    
-                    outputrecord $tmp_test_id, $test_description, $test_result;
-                }
-                elsif ($state eq 'endrun')
-                {
-                    $state = 'endrun';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: completedtest, pendingtest, endrun, log: $file";
-                    $state = 'completedtest';
-                }
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif ( /^JavaScriptTest: End Run/)
-            {
-                if ($state eq 'completedtest')
-                {
-                    $state = 'endrun';
-                }
-                elsif ($state eq 'loadedtest')
-                {
-                    $state = 'endrun';
-                }
-                elsif ($state eq 'pendingtest')
-                {
-                    $state = 'pendingtest';
-                }
-                elsif ($state eq 'starttest' && $mode eq 'nonrestart')
-                {
-                    # non restart mode, at last test.
-                    $state = 'endrun';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: completedtest, loadedtest, pendingtest or starttest in non restart mode, log: $file";
-                    $state = 'endrun';
-                }
-            }
-            elsif ( ($tmp_test_id, $exit_status) = $_ =~ /^http:.*test=([^;]*);.* (EXIT STATUS: NORMAL.*)/)
-            {
-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
-                {
-                    warn "WARNING: state: $state, expected endrun. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
-                }
-
-                if ($state eq 'endrun')
-                {
-                    $state = 'endrun';
-                }
-                elsif ($state eq 'completedtest')
-                {
-                    dbg "previously pending test $test_id{$state} completed and is now endrun";
-                    $state = 'endrun';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: endrun, log: $file";
-                    $state = 'endrun';
-                }
-
-                if (! $test_reported{$tmp_test_id})
-                {
-                    $test_result = 'UNKNOWN';
-                    $test_description = $exit_status . ' No test results reported. ' . join '; ', @messages;
-                    
-                    outputrecord $tmp_test_id, $test_description, $test_result;
-                }
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif ( ($tmp_test_id, $exit_status) = $_ =~ /^http:.*test=([^;]*);.* (EXIT STATUS: TIMED OUT.*)/)
-            {
-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
-                {
-                    warn "WARNING: state: $state, expected endrun. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
-                }
-
-                if ($state eq 'endrun')
-                {
-                    $state = 'endrun';
-                }
-                else
-                {
-                    dbg "state: $state, expected: endrun";
-                    $state = 'endrun';
-                }
-
-                $test_result     = 'FAILED';
-                $test_description = $exit_status . ' ' . join '; ', @messages;
-                
-                outputrecord $tmp_test_id, $test_description, $test_result;
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif ( ($tmp_test_id, $exit_status) = $_ =~ /^http:.*test=([^;]*);.* (EXIT STATUS: CRASHED.*)/)
-            {
-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
-                {
-                    warn "WARNING: state: $state, expected endrun. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
-                }
-
-                if ($state eq 'endrun')
-                {
-                    $state = 'endrun';
-                }
-                else
-                {
-                    dbg "state: $state, expected: endrun";
-                    $state = 'endrun';
-                }
-
-                $test_result     = 'FAILED';
-                $test_description = $exit_status . ' ' . join '; ', @messages;;
-                
-                outputrecord $tmp_test_id, $test_description, $test_result;
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif ( m@^(\/cygdrive\/.|\/.)?$test_dir$@)
-            {
-                if ($state eq 'endrun')
-                {
-                    $state = 'success';
-                }
-                else
-                {
-                    warn "WARNING: state: $state, expected: endrun, log: $file";
-                    $state = 'success';
-                }
-
-                $test_id{$state} = $tmp_test_id;
-            }
-            elsif (!/^ \=\>/ && !/^\s+$/ && !/^[*][*][*]/ && !/^[-+]{2,2}(WEBSHELL|DOMWINDOW)/ && !/^Spider:/ && 
-                   !/^JavaScriptTest:/ && !/real.*user.*sys.*$/ && !/user.*system.*elapsed/)
-            {
-                if ('starttest, loadingtest, runningtest, reportingtest, pendingtest, loadedtest, endrun, completedtest' =~ /$state/)
-                {
-
-                    if (/error: can.t allocate region/ || /set a breakpoint in malloc_error_break/ || 
-                        /set a breakpoint in szone_error to debug/ || /malloc:.*mmap/ || /vm_allocate/ )
-                    {
-                        dbg "Adding message: $_ converted to /$test_id{$state}:0: out of memory";
-                        push @messages, ('/' . $test_id{$state} . ':0: out of memory');
-                    }
-                    else
-                    {
-                        dbg "Adding message: $_";
-                        push @messages, ($_);
-                    }
-                }
-            }
-
-            if ($debug)
-            {
-                if ($test_id{$state})
-                {
-                    dbg "test_id{$state}=$test_id{$state}, " . join '; ', @messages;
-                }
-                else
-                {
-                    dbg "state=$state, " . join '; ', @messages;
+                    dbg "Adding message: $_";
+                    push @messages, ($_);
                 }
             }
         }
+        elsif ($debug)
+        {
+            dbg "Skipping: $_";
+        } 
+
+        if ($debug)
+        {
+            if ($test_id{$state})
+            {
+                dbg "test_id{$state}=$test_id{$state}, " . (join '; ', @messages);
+            }
+            else
+            {
+                dbg "state=$state, " . (join '; ', @messages);
+            }
+        }
     }
-    close FILE;
+    if ($state eq 'endrun')
+    {
+        $state = 'success';
+    }
+    die "FATAL ERROR: Test run terminated prematurely. state: $state, log: $file" if ($state ne 'success');
 
-    undef $test_branchid;
-    undef $test_date;
-    undef $test_buildtype;
-    undef $test_machine;
-    undef $test_product;
-    undef $test_suite;
+}
+close FILE;
+close TEMP;
 
-    die "FATAL ERROR: Test run terminated prematurely. state: $state, log: $file" if ($state ne 'success');
-}
-
-close TEMP;
+undef $test_branchid;
+undef $test_date;
+undef $test_buildtype;
+undef $test_machine;
+undef $test_product;
+undef $test_suite;
 
 outresults;
 
 unlink $temp;
 
 sub dbg {
     if ($debug)
     {
         my $msg = shift;
         print STDERR "DEBUG: $msg\n";
     }
 }
 
 sub outresults
 {
+    dbg "sorting temp file $temp";
     system("sort < $temp | uniq");
+    dbg "finished sorting";
 }
 
 sub outputrecord
 {
     my ($test_id, $test_description, $test_result) = @_;
 
     # cut off the extra jstest: summaries as they duplicate the other
     # output and follow it.
     $test_description =~ s/jstest:.*//;
 
-    if (length($test_description) > 6000)
-    {
-        $test_description = substr($test_description, 0, 6000);
-    }
+#    if (length($test_description) > 6000)
+#    {
+#        $test_description = substr($test_description, 0, 6000);
+#    }
+#
 
     my $output = 
-        "TEST_ID=$test_id, TEST_BRANCH=$test_branchid, TEST_RESULT=$test_result, " .
-        "TEST_BUILDTYPE=$test_buildtype, TEST_TYPE=$test_type, TEST_OS=$test_os, " . 
-        "TEST_MACHINE=$test_machine, TEST_PROCESSORTYPE=$test_processortype, " . 
-        "TEST_KERNEL=$test_kernel, TEST_DATE=$test_date, TEST_TIMEZONE=$test_timezone, " . 
-        "TEST_DESCRIPTION=$test_description\n";
+        "TEST_ID=$test_id, " .
+        "TEST_BRANCH=$test_branchid, " .
+        "TEST_BUILDTYPE=$test_buildtype, " .
+        "TEST_TYPE=$test_type, " .
+        "TEST_OS=$test_os, " .
+        "TEST_KERNEL=$test_kernel, " .
+        "TEST_PROCESSORTYPE=$test_processortype, " .
+        "TEST_MEMORY=$test_memory, " .
+        "TEST_CPUSPEED=$test_cpuspeed, " . 
+        "TEST_TIMEZONE=$test_timezone, " . 
+        "TEST_RESULT=$test_result, " .
+        "TEST_EXITSTATUS=$test_exit_status, " .
+        "TEST_DESCRIPTION=$test_description, " .
+        "TEST_MACHINE=$test_machine, " .
+        "TEST_DATE=$test_date" .
+        "\n";
 
     if ($debug)
     {
         dbg "RECORD: $output";
     }
     print TEMP $output;
 
     $test_reported{$test_id} = 1;
diff --git a/js/tests/process-logs.sh b/js/tests/process-logs.sh
--- a/js/tests/process-logs.sh
+++ b/js/tests/process-logs.sh
@@ -33,23 +33,23 @@
 # decision by deleting the provisions above and replace them with the notice
 # and other provisions required by the GPL or the LGPL. If you do not delete
 # the provisions above, a recipient may use your version of this file under
 # the terms of any one of the MPL, the GPL or the LGPL.
 #
 # ***** END LICENSE BLOCK *****
 
 if [[ -z "$TEST_DIR" ]]; then
-  cat <<EOF
+    cat <<EOF
 `basename $0`: error
 
 TEST_DIR, the location of the Sisyphus framework, 
 is required to be set prior to calling this script.
 EOF
-  exit 2
+    exit 2
 fi
 
 if [[ ! -e $TEST_DIR/bin/library.sh ]]; then
     echo "TEST_DIR=$TEST_DIR"
     echo ""
     echo "This script requires the Sisyphus testing framework. Please "
     echo "cvs check out the Sisyphys framework from mozilla/testing/sisyphus"
     echo "and set the environment variable TEST_DIR to the directory where it"
@@ -69,53 +69,71 @@ usage: process-logs.sh.sh -l testlogfile
 usage: process-logs.sh.sh -l testlogfiles -A arch -K kernel
 
 variable            description
 ===============     ============================================================
 testlogfiles        The test log to be processed. If testlogfiles is a file 
                     pattern it must be single quoted to prevent the shell from
                     expanding it before it is passed to the script.
 
+kernel              optional. The machine kernel as specified by uname -r
+                    If not specified, the script will attempt to determine the 
+                    value from the TEST_KERNEL line in the log. 
+                    'all'     - do not filter on machine kernel. Use this for
+                                Windows.
+                    For Linux distros, use the value of uname -r 
+                    and replace the minor version numbers with .* as in 
+                    2.6.23.1-21.fc7 -> 2.6.23.*fc7
 arch                optional. The machine architecture as specified by uname -p
                     If not specified, the script will attempt to determine the 
                     value from the TEST_PROCESSORTYPE line in each log.
                     'all'     - do not filter on machine architecture. Use this 
                                 for Windows.
                     'i686'    - Linux distros such as Fedora Core or RHEL or CentOS.
                     'i386'    - Mac Intel
                     'powerpc' - Mac PowerPC
 
-kernel              optional. The machine kernel as specified by uname -r
-                    If not specified, the script will attempt to determine the 
-                    value from the TEST_KERNEL line in the log. 
-                    'all'     - do not filter on machine kernel. Use this for
-                                Windows.
-                    For Linux distros, use the value of uname -r 
-                    and replace the minor version numbers with .* as in 
-                    2.6.23.1-21.fc7 -> 2.6.23.*fc7
 EOF
     exit 2
 }
 
 while getopts "l:A:K:" optname; 
-  do
-  case $optname in
-      l) testlogfiles=$OPTARG;;
-      A) optarch=$OPTARG;;
-      K) optkernel=$OPTARG;;
-  esac
+do
+    case $optname in
+        l) testlogfiles=$OPTARG;;
+        A) optarch=$OPTARG;;
+        K) optkernel=$OPTARG;;
+    esac
 done
 
 if [[ -z "$testlogfiles" ]]; then
     usage
 fi
 
 for testlogfile in `ls $testlogfiles`; do
 
     debug "testlogfile=$testlogfile"
+
+    case $testlogfile in
+	    *.log)
+            worktestlogfile=$testlogfile
+	        ;;
+	    *.log.bz2)
+            worktestlogfile=`mktemp $testlogfile.XXXXXX`
+            bunzip2 -c $testlogfile > $worktestlogfile
+	        ;;
+	    *.log.gz)
+            worktestlogfile=`mktemp $testlogfile.XXXXXX`
+	        gunzip -c $testlogfile > $worktestlogfile
+	        ;;
+	    *)
+	        echo "unknown log type: $f"
+	        exit 2
+	        ;;
+    esac
 
     case "$testlogfile" in
         *,js,*) testtype=shell;;
         *,firefox,*) testtype=browser;;
         *) error "unknown testtype in logfile $testlogfile" $LINENO;;
     esac
 
     debug "testtype=$testtype"
@@ -128,72 +146,86 @@ for testlogfile in `ls $testlogfiles`; d
     esac
 
     debug "buildtype=$buildtype"
 
     case "$testlogfile" in
         *,1.8.0*) branch=1.8.0;;
         *,1.8.1*) branch=1.8.1;;
         *,1.9.0*) branch=1.9.0;;
+        *,1.9.1*) branch=1.9.1;;
         *) 
-            branch=`grep '^environment: TEST_BRANCH=' $testlogfile | sed 's|.*TEST_BRANCH=\(.*\)|\1|'`
+            branch=`grep -m 1 '^environment: TEST_BRANCH=' $worktestlogfile | sed 's|.*TEST_BRANCH=\(.*\)|\1|'`
             if [[ -z "$branch" ]]; then
                 error "unknown branch in logfile $testlogfile" $LINENO
             fi
             ;;
     esac
 
     debug "branch=$branch"
 
     case "$testlogfile" in 
-        *,win32,*) OSID=win32;;
+        *,nt,*) OSID=nt;;
         *,linux,*) OSID=linux;;
-        *,mac,*) OSID=mac;;
+        *,darwin,*) OSID=darwin;;
         *) 
-            OSID=`grep '^environment: OSID=' $testlogfile | sed 's|.*OSID=\(.*\)|\1|'`
+            OSID=`grep -m 1 '^environment: OSID=' $worktestlogfile | sed 's|.*OSID=\(.*\)|\1|'`
             if [[ -z "$OSID" ]]; then
                 error "unknown OS in logfile $testlogfile" $LINENO
             fi
             ;;
     esac
 
     debug "OSID=$OSID"
 
     if [[ -n "$optkernel" ]]; then
         kernel="$optkernel"
     else
-        if [[ "$OSID" == "win32" ]]; then
-            kernel=all
-        else
-            kernel=`grep '^environment: TEST_KERNEL=' $testlogfile | sed 's|.*TEST_KERNEL=\(.*\)|\1|'`
-            kernel=`echo $kernel | sed 's|\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\)[-.0-9]*\.\([a-zA-Z0-9]*\)|\1.\2.\3.*\4|'`
+        kernel=`grep -m 1 '^environment: TEST_KERNEL=' $worktestlogfile | sed 's|.*TEST_KERNEL=\(.*\)|\1|'`
+        if [[ "$OSID" == "linux" ]]; then
+            kernel=`echo $kernel | sed 's|\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\).*|\1.\2.\3|'`
         fi
     fi
 
     debug "kernel=$kernel"
 
     if [[ -n "$optarch" ]]; then
         arch="$optarch"
     else
-        if [[ "$OSID" == "win32" ]]; then
-            arch=all
-        else
-            arch=`grep '^environment: TEST_PROCESSORTYPE=' $testlogfile | sed 's|.*TEST_PROCESSORTYPE=\(.*\)|\1|'`
-        fi
+        arch=`grep -m 1 '^environment: TEST_PROCESSORTYPE=' $worktestlogfile | sed 's|.*TEST_PROCESSORTYPE=\(.*\)|\1|'`
     fi
 
     debug "arch=$arch"
+
+    memory=`grep -m 1 '^environment: TEST_MEMORY=' $worktestlogfile | sed 's|.*TEST_MEMORY=\(.*\)|\1|'`
+    speed=`grep -m 1 '^environment: TEST_CPUSPEED=' $worktestlogfile | sed 's|.*TEST_CPUSPEED=\(.*\)|\1|'`
 
     timezone=`basename $testlogfile | sed 's|^[-0-9]*\([-+]\)\([0-9]\{4,4\}\),.*|\1\2|'`
 
     debug "timezone=$timezone"
 
     outputprefix=$testlogfile
 
     includetests="included-$branch-$testtype-$buildtype.tests"
     excludetests="excluded-$branch-$testtype-$buildtype.tests"
 
-    grep '^include: ' $testlogfile | sed 's|include: ||' > $TEST_DIR/tests/mozilla.org/js/$includetests
-    grep '^exclude: ' $testlogfile | sed 's|exclude: ||' > $TEST_DIR/tests/mozilla.org/js/$excludetests
+    grep '^include: ' $worktestlogfile | sed 's|include: ||' > $TEST_DIR/tests/mozilla.org/js/$includetests
+    grep '^exclude: ' $worktestlogfile | sed 's|exclude: ||' > $TEST_DIR/tests/mozilla.org/js/$excludetests
 
-    $TEST_DIR/tests/mozilla.org/js/known-failures.pl -b "$branch" -T "$buildtype" -t "$testtype" -o "$OSID" -z "$timezone" -l "$testlogfile" -A "$arch" -K "$kernel" -r "$TEST_JSDIR/failures.txt" -O "$outputprefix"
+    $TEST_DIR/tests/mozilla.org/js/known-failures.pl \
+        -b "$branch" \
+        -T "$buildtype" \
+        -t "$testtype" \
+        -o "$OSID" \
+        -K "$kernel" \
+        -A "$arch" \
+        -M "$memory" \
+        -S "$speed" \
+        -z "$timezone" \
+        -r "$TEST_JSDIR/failures.txt" \
+        -l "$worktestlogfile" \
+        -O "$outputprefix"
 
+    if [[ "$testlogfile" != "$worktestlogfile" ]]; then
+        rm $worktestlogfile
+        unset worktestlogfile
+    fi
 done
diff --git a/js/tests/public-failures.txt b/js/tests/public-failures.txt
--- a/js/tests/public-failures.txt
+++ b/js/tests/public-failures.txt
@@ -1,500 +1,649 @@ TEST_ID=e4x/Expressions/11.1.4-08.js, TE
-TEST_ID=e4x/Expressions/11.1.4-08.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 50 of test - 11.1.4 - XML Initializer - {} Expressions - 08 expected: true actual: false reason: Expected value 'true', Actual value 'false'
-TEST_ID=e4x/Expressions/11.1.4-08.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 51 of test - 11.1.4 - XML Initializer - {} Expressions - 08 expected: true actual: false reason: Expected value 'true', Actual value 'false'
-TEST_ID=e4x/Expressions/11.1.4-08.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 53 of test - 11.1.4 - XML Initializer - {} Expressions - 08 expected: true actual: false reason: Expected value 'true', Actual value 'false'
-TEST_ID=e4x/Expressions/11.1.4-08.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 54 of test - 11.1.4 - XML Initializer - {} Expressions - 08 expected: true actual: false reason: Expected value 'true', Actual value 'false'
-TEST_ID=e4x/Expressions/11.1.4-08.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 56 of test - 11.1.4 - XML Initializer - {} Expressions - 08 expected: true actual: false reason: Expected value 'true', Actual value 'false'
-TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=powerpc, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=PAGE STATUS: TIMED OUT
-TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=unknown, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=unknown, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=PAGE STATUS: TIMED OUT
-TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/e4x/GC/regress-324278.js:`.``*`: out of memory
-TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/e4x/GC/regress-324278.js:`.``*`: out of memory
-TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/e4x/GC/regress-324278.js:`.``*`: out of memory
-TEST_ID=e4x/Global/13.1.2.1.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 4 of test - 13.1.2.1 - isXMLName() expected: exception actual: no exception reason: Expected value 'exception', Actual value 'no exception'
-TEST_ID=e4x/Global/13.1.2.1.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 6 of test - 13.1.2.1 - isXMLName() expected:  actual: 0xAA-0xAA : Invalid char accepted as start : Invalid Char accepted as other NL0xB5-0xB5 : Invalid char accepted as start : Invalid Char accepted as other NL0xB7-0xB7 : Other char not acceptedNL0xBA-0xBA : Invalid char accepted as start : Invalid Char accepted as other NL0x132-0x133 : Invalid char accepted as start : Invalid Char accepted as other NL0x13F-0x140 : Invalid char accepted as start : Invalid Char accepted as other NL0x149-0x149 : Invalid char accepted as start : Invalid Char accepted as other NL0x17F-0x17F : Invalid char accepted as start : Invalid Char accepted as other NL0x1C4-0x1CC : Invalid char accepted as start : Invalid Char accepted as other NL0x1F1-0x1F3 : Invalid char accepted as start : Invalid Char accepted as other NL0x2B0-0x2B8 : Invalid Char accepted as other NL0x2BB-0x2C1 : Start char not acceptedNL0x2E0-0x2E4 : Invalid Char accepted as other NL0x37A-0x37A : Invalid Char accepted as other NL0x387-0x387 : Other char not acceptedNL0x559-0x559 : Start char not acceptedNL0x587-0x587 : Invalid char accepted as start : Invalid Char accepted as other NL0x6E5-0x6E6 : Start char not acceptedNL0xEDC-0xEDD : Invalid char accepted as start : Invalid Char accepted as other NL0x1101-0x1101 : Invalid char accepted as start : Invalid Char accepted as other NL0x1104-0x1104 : Invalid char accepted as start : Invalid Char accepted as other NL0x1108-0x1108 : Invalid char accepted as start : Invalid Char accepted as other NL0x110A-0x110A : Invalid char accepted as start : Invalid Char accepted as other NL0x110D-0x110D : Invalid char accepted as start : Invalid Char accepted as other NL0x1113-0x113B : Invalid char accepted as start : Invalid Char accepted as other NL0x113D-0x113D : Invalid char accepted as start : Invalid Char accepted as other NL0x113F-0x113F : Invalid char accepted as start : Invalid Char accepted as other NL0x1141-0x114B : Invalid char accepted as start : Invalid Char accepted as other NL0x114D-0x114D : Invalid char accepted as start : Invalid Char accepted as other NL0x114F-0x114F : Invalid char accepted as start : Invalid Char accepted as other NL0x1151-0x1153 : Invalid char accepted as start : Invalid Char accepted as other NL0x1156-0x1158 : Invalid char accepted as start : Invalid Char accepted as other NL0x1162-0x1162 : Invalid char accepted as start : Invalid Char accepted as other NL0x1164-0x1164 : Invalid char accepted as start : Invalid Char accepted as other NL0x1166-0x1166 : Invalid char accepted as start : Invalid Char accepted as other NL0x1168-0x1168 : Invalid char accepted as start : Invalid Char accepted as other NL0x116A-0x116C : Invalid char accepted as start : Invalid Char accepted as other NL0x116F-0x1171 : Invalid char accepted as start : Invalid Char accepted as other NL0x1174-0x1174 : Invalid char accepted as start : Invalid Char accepted as other NL0x1176-0x119D : Invalid char accepted as start : Invalid Char accepted as other NL0x119F-0x11A2 : Invalid char accepted as start : Invalid Char accepted as other NL0x11A9-0x11AA : Invalid char accepted as start : Invalid Char accepted as other NL0x11AC-0x11AD : Invalid char accepted as start : Invalid Char accepted as other NL0x11B0-0x11B6 : Invalid char accepted as start : Invalid Char accepted as other NL0x11B9-0x11B9 : Invalid char accepted as start : Invalid Char accepted as other NL0x11BB-0x11BB : Invalid char accepted as start : Invalid Char accepted as other NL0x11C3-0x11EA : Invalid char accepted as start : Invalid Char accepted as other NL0x11EC-0x11EF : Invalid char accepted as start : Invalid Char accepted as other NL0x11F1-0x11F8 : Invalid char accepted as start : Invalid Char accepted as other NL0x207F-0x207F : Invalid char accepted as start : Invalid Char accepted as other NL0x20DD-0x20E0 : Invalid Char accepted as other NL0x2102-0x2102 : Invalid char accepted as start : Invalid Char accepted as other NL0x2107-0x2107 : Invalid char accepted as start : Invalid Char accepted as other NL0x210A-0x2113 : Invalid char accepted as start : Invalid Char accepted as other NL0x2115-0x2115 : Invalid char accepted as start : Invalid Char accepted as other NL0x2118-0x211D : Invalid char accepted as start : Invalid Char accepted as other NL0x2124-0x2124 : Invalid char accepted as start : Invalid Char accepted as other NL0x2128-0x2128 : Invalid char accepted as start : Invalid Char accepted as other NL0x212C-0x212D : Invalid char accepted as start : Invalid Char accepted as other NL0x212F-0x2131 : Invalid char accepted as start : Invalid Char accepted as other NL0x2133-0x2138 : Invalid char accepted as start : Invalid Char accepted as other NL0x2160-0x217F : Invalid char accepted as start : Invalid Char accepted as other NL0x309B-0x309C : Invalid Char accepted as other NL0x3131-0x318E : Invalid char accepted as start : Invalid Char accepted as other NL0xF900-0xFA2D : Invalid char accepted as start : Invalid Char accepted as other NL0xFB00-0xFB06 : Invalid char accepted as start : Invalid Char accepted as other NL0xFB13-0xFB17 : Invalid char accepted as start : Invalid Char accepted as other NL0xFB1E-0xFB1E : Invalid Char accepted as other NL0xFB1F-0xFB28 : Invalid char accepted as start : Invalid Char accepted as other NL0xFB2A-0xFB36 : Invalid char accepted as start : Invalid Char accepted as other NL0xFB38-0xFB3C : Invalid char accepted as start : Invalid Char accepted as other NL0xFB3E-0xFB3E : Invalid char accepted as start : Invalid Char accepted as other NL0xFB40-0xFB41 : Invalid char accepted as start : Invalid Char accepted as other NL0xFB43-0xFB44 : Invalid char accepted as start : Invalid Char accepted as other NL0xFB46-0xFBB1 : Invalid char accepted as start : Invalid Char accepted as other NL0xFBD3-0xFD3D : Invalid char accepted as start : Invalid Char accepted as other NL0xFD50-0xFD8F : Invalid char accepted as start : Invalid Char accepted as other NL0xFD92-0xFDC7 : Invalid char accepted as start : Invalid Char accepted as
-TEST_ID=e4x/Namespace/regress-292863.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 1 of test - Undeclaring namespace prefix should cause parse error expected: error actual: no error reason: Expected value 'error', Actual value 'no error'
-TEST_ID=e4x/Regress/regress-319872.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=e4x/Regress/regress-319872.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=e4x/Regress/regress-352223.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 1 of test - Reject invalid spaces in tags expected: SyntaxError: invalid XML name actual:  reason: Expected value 'SyntaxError: invalid XML name', Actual value ''
-TEST_ID=e4x/Regress/regress-352223.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 2 of test - Reject invalid spaces in tags expected: SyntaxError: invalid XML tag syntax actual:  reason: Expected value 'SyntaxError: invalid XML tag syntax', Actual value ''
-TEST_ID=e4x/Regress/regress-369032.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: CRASHED `)``?``.``*`Assertion failure: kid2->parent == xml || !kid2->parent, at `.``*`jsxml.c:
-TEST_ID=e4x/Regress/regress-369032.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=e4x/Regress/regress-369032.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: Testcase produced no output!
-TEST_ID=e4x/Regress/regress-369032.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 2 of test - Do not assert: kid2->parent == xml || !kid2->parent expected: <x>NL  <b>NL    <a>3</a>NL  </b>NL</x> actual: <x>NL  <b>5</b>NL</x> reason: Expected value '<x>NL  <b>NL    <a>3</a>NL  </b>NL</x>', Actual value '<x>NL  <b>5</b>NL</x>'
-TEST_ID=e4x/Regress/regress-369740.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 3 of test - generic code for function:: expected: test actual: TypeError: can't set property @mozilla.org/js/function::toString in XMLList reason: Expected value 'test', Actual value 'TypeError: can't set property @mozilla.org/js/function::toString in XMLList'
-TEST_ID=e4x/Regress/regress-370016.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/e4x/Regress/regress-370016.js:`.``*`: `(`ReferenceError: `)``?`reference to undefined XML name @mozilla.org/js/function::sin
-TEST_ID=e4x/Regress/regress-370048-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/e4x/Regress/regress-370048-01.js:`.``*`: `(`ReferenceError: `)``?`reference to undefined XML name @mozilla.org/js/function::length
-TEST_ID=e4x/Regress/regress-370372.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/e4x/Regress/regress-370372.js:`.``*`: `(`ReferenceError: `)``?`reference to undefined XML name @mozilla.org/js/function::toString
-TEST_ID=e4x/Regress/regress-394941.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=powerpc, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=e4x/TypeConversion/10.2.1.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 5 of test - 10.2.1 - XML.toXMLString expected:
-TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 12 of test - 13.4.4.26 - XML normalize() expected: 1 actual: 0 reason: Expected value '1', Actual value '0'
-TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 13 of test - 13.4.4.26 - XML normalize() expected: 1 actual: 0 reason: Expected value '1', Actual value '0'
-TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 22 of test - 13.4.4.26 - XML normalize() expected: <alpha><beta/> </alpha> actual: <alpha><beta/></alpha> reason: Expected value '<alpha><beta/> </alpha>', Actual value '<alpha><beta/></alpha>'
-TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 23 of test - 13.4.4.26 - XML normalize() expected: 2 actual: 1 reason: Expected value '2', Actual value '1'
-TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 3 of test - 13.4.4.26 - XML normalize() expected: <alpha> <bravo> one </bravo> </alpha> actual: <alpha><bravo> one </bravo></alpha> reason: Expected value '<alpha> <bravo> one </bravo> </alpha>', Actual value '<alpha><bravo> one </bravo></alpha>'
-TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 4 of test - 13.4.4.26 - XML normalize() expected: <alpha>  </alpha> actual: <alpha/> reason: Expected value '<alpha>  </alpha>', Actual value '<alpha/>'
-TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 5 of test - 13.4.4.26 - XML normalize() expected: 2 actual: 0 reason: Expected value '2', Actual value '0'
-TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 6 of test - 13.4.4.26 - XML normalize() expected: <alpha>  </alpha> actual: <alpha/> reason: Expected value '<alpha>  </alpha>', Actual value '<alpha/>'
-TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 7 of test - 13.4.4.26 - XML normalize() expected: 1 actual: 0 reason: Expected value '1', Actual value '0'
-TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 8 of test - 13.4.4.26 - XML normalize() expected: <alpha>  <bravo> fun </bravo></alpha> actual: <alpha><bravo> fun </bravo></alpha> reason: Expected value '<alpha>  <bravo> fun </bravo></alpha>', Actual value '<alpha><bravo> fun </bravo></alpha>'
-TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 9 of test - 13.4.4.26 - XML normalize() expected: 2 actual: 1 reason: Expected value '2', Actual value '1'
-TEST_ID=e4x/XML/regress-324422-2.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/e4x/XML/regress-324422-2.js:`.``*`: out of memory
-TEST_ID=e4x/XML/regress-324422-2.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/e4x/XML/regress-324422-2.js:`.``*`: out of memory
-TEST_ID=e4x/XML/regress-376773.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=xmlsimple.stringmethod === xmlsimple.function::stringmethod Section 61 expected: t actual: error reason: `.``*`/e4x/XML/regress-376773.js:`.``*`: reference to undefined XML name @mozilla.org/js/function::charAt
-TEST_ID=e4x/XML/regress-376773.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: BUGNUMBER: 376773 STATUS: xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 1 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 2 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 3 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 4 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 5 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 6 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 7 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 8 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 9 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 10 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 11 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 12 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 13 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 14 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 15 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 16 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 17 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 18 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 19 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 20 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 21 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 22 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 23 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 24 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 25 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 26 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 27 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 28 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 29 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 30 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 31 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 32 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 33 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 34 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 35 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 36 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 37 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 38 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 39 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 40 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 41 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 42 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 43 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 44 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 45 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Sectio./e4x/XML/regress-376773.js:`.``*`: `(`ReferenceError: `)``?`reference to undefined XML name @mozilla.org/js/function::charAt n 46 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 47 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 48 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 49 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 50 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 51 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 52 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 53 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 54 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 55 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 56 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 57 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 58 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 59 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 60 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 61 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod
-TEST_ID=e4x/XML/regress-376773.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: BUGNUMBER: 376773 STATUS: xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 1 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 2 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 3 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 4 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 5 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 6 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 7 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 8 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 9 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 10 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 11 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 12 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 13 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 14 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 15 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 16 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 17 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 18 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 19 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 20 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 21 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 22 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 23 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 24 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 25 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 26 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 27 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 28 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 29 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 30 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 31 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 32 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 33 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 34 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 35 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 36 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 37 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 38 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 39 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 40 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 41 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 42 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 43 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 44 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 45 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 46 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 47 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 48 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 49 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 50 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 51 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 52 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 53 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 54 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 55 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 56 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 57 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 58 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 59 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 60 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod PASSED! Section 61 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod
-TEST_ID=e4x/decompilation/decompile-xml-escapes.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 1 of test - Decompiler escapes line breaks/backslashes in E4X literals expected: false actual: 'function anonymous() {NL    return <![CDATA[\\\\]]>;NL}' does not contain '<![CDATA[\\]]>'! reason: Type mismatch, expected type boolean, actual type string Expected value 'false', Actual value ''function anonymous() {NL    return <![CDATA[\\\\]]>;NL}' does not contain '<![CDATA[\\]]>'!'
-TEST_ID=e4x/decompilation/decompile-xml-escapes.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 1 of test - Decompiler escapes line breaks/backslashes in E4X literals expected: false actual: 'function anonymous() {NL    return <?f bNLNLcNLc?>;NL}' does not contain '<?f bNLNLcNLc?>'! reason: Type mismatch, expected type boolean, actual type string Expected value 'false', Actual value ''function anonymous() {NL    return <?f bNLNLcNLc?>;NL}' does not contain '<?f bNLNLcNLc?>'!'
-TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 11 of test - Decompilation with new operator redeaux expected:  function ( ) { new ( x ( y ) . n : : z ) ; }  actual:  function ( ) { new x ( y ) . n : : z ; }  reason: Expected value ' function ( ) { new ( x ( y ) . n : : z ) ; } ', Actual value ' function ( ) { new x ( y ) . n : : z ; } '
-TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 12 of test - Decompilation with new operator redeaux expected:  function ( ) { new ( x ( y ) . n : : z ) ; }  actual:  function ( ) { new x ( y ) . n : : z ; }  reason: Expected value ' function ( ) { new ( x ( y ) . n : : z ) ; } ', Actual value ' function ( ) { new x ( y ) . n : : z ; } '
-TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 14 of test - Decompilation with new operator redeaux expected:  function ( ) { new ( x ( y ) . n : : [ z ] ) ; }  actual:  function ( ) { new x ( y ) . n : : [ z ] ; }  reason: Expected value ' function ( ) { new ( x ( y ) . n : : [ z ] ) ; } ', Actual value ' function ( ) { new x ( y ) . n : : [ z ] ; } '
-TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 15 of test - Decompilation with new operator redeaux expected:  function ( ) { new ( x ( y ) . n : : [ z ] ) ; }  actual:  function ( ) { new x ( y ) . n : : [ z ] ; }  reason: Expected value ' function ( ) { new ( x ( y ) . n : : [ z ] ) ; } ', Actual value ' function ( ) { new x ( y ) . n : : [ z ] ; } '
-TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 2 of test - Decompilation with new operator redeaux expected:  function ( ) { new ( x ( y ) [ z ] ) ; }  actual:  function ( ) { new x ( y ) [ z ] ; }  reason: Expected value ' function ( ) { new ( x ( y ) [ z ] ) ; } ', Actual value ' function ( ) { new x ( y ) [ z ] ; } '
-TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 3 of test - Decompilation with new operator redeaux expected:  function ( ) { new ( x ( y ) [ z ] ) ; }  actual:  function ( ) { new x ( y ) [ z ] ; }  reason: Expected value ' function ( ) { new ( x ( y ) [ z ] ) ; } ', Actual value ' function ( ) { new x ( y ) [ z ] ; } '
-TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 5 of test - Decompilation with new operator redeaux expected:  function ( ) { new ( x ( y ) . @ a ) ; }  actual:  function ( ) { new x ( y ) . @ a ; }  reason: Expected value ' function ( ) { new ( x ( y ) . @ a ) ; } ', Actual value ' function ( ) { new x ( y ) . @ a ; } '
-TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 6 of test - Decompilation with new operator redeaux expected:  function ( ) { new ( x ( y ) . @ a ) ; }  actual:  function ( ) { new x ( y ) . @ a ; }  reason: Expected value ' function ( ) { new ( x ( y ) . @ a ) ; } ', Actual value ' function ( ) { new x ( y ) . @ a ; } '
-TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 8 of test - Decompilation with new operator redeaux expected:  function ( ) { new ( x ( y ) . @ [ n : : a ] ) ; }  actual:  function ( ) { new x ( y ) . @ [ n : : a ] ; }  reason: Expected value ' function ( ) { new ( x ( y ) . @ [ n : : a ] ) ; } ', Actual value ' function ( ) { new x ( y ) . @ [ n : : a ] ; } '
-TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 9 of test - Decompilation with new operator redeaux expected:  function ( ) { new ( x ( y ) . @ [ n : : a ] ) ; }  actual:  function ( ) { new x ( y ) . @ [ n : : a ] ; }  reason: Expected value ' function ( ) { new ( x ( y ) . @ [ n : : a ] ) ; } ', Actual value ' function ( ) { new x ( y ) . @ [ n : : a ] ; } '
-TEST_ID=e4x/decompilation/regress-352789.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 1 of test - Decompilation of new and .@ expected:  function ( ) { return new ( a ( ) . @ z ) ; }  actual:  function ( ) { return new a . @ z ; }  reason: Expected value ' function ( ) { return new ( a ( ) . @ z ) ; } ', Actual value ' function ( ) { return new a . @ z ; } '
-TEST_ID=e4x/decompilation/regress-429249.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=trap should not change decompilation <x/> : after trap expected:  function g ( ) { return <x/>; }  actual:  function g ( ) { return "<x/>"; }  reason: Expected value ' function g ( ) { return <x/>; } ', Actual value ' function g ( ) { return "<x/>"; } '
-TEST_ID=e4x/extensions/regress-337226.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/e4x/extensions/regress-337226.js:`.``*`: `(`ReferenceError: `)``?`reference to undefined XML name @mozilla.org/js/function::parseInt
-TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED
-TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED
-TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED
-TEST_ID=e4x/extensions/regress-410192.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 1 of test - Proper quoting of attribute by uneval/toSource expected: "v" actual: v reason: Expected value '"v"', Actual value 'v'
-TEST_ID=ecma/Math/15.8.2.5.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Infinity/Math.atan2(-0, 1) expected: -Infinity actual: Infinity reason: wrong value
-TEST_ID=ecma/Math/15.8.2.5.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Infinity/Math.atan2(-1, Infinity) expected: -Infinity actual: Infinity reason: wrong value
-TEST_ID=ecma/Math/15.8.2.6.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=9.2.2, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Infinity/Math.ceil(-0.9) expected: -Infinity actual: Infinity reason: wrong value
-TEST_ID=ecma/Math/15.8.2.6.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=9.2.2, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Infinity/Math.ceil(-Number.MIN_VALUE) expected: -Infinity actual: Infinity reason: wrong value
-TEST_ID=ecma/String/15.5.4.6-2.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=var f = new Object( String.prototype.indexOf ); f('[object Window @ `[`x0`-`9a`-`f`]``+` (native @ `[`x0`-`9a`-`f`]``+`)]') expected: 0 actual: -1 reason: wrong value
-TEST_ID=ecma/TypeConversion/9.2.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=!(0/0) expected: true actual: false reason: wrong value
-TEST_ID=ecma/TypeConversion/9.2.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=1000 % 0 ? true : false expected: false actual: true reason: wrong value
-TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=-s2 == -Infinity || -s2 == -1.7976931348623157e+308  expected: true actual: false reason: wrong value
-TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=parseInt(s2) == Infinity || parseInt(s2) == 1.7976931348623157e+308 expected: true actual: false reason: wrong value
-TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=parseInt(s2,10) == Infinity || parseInt(s2,10) == 1.7976931348623157e+308 expected: true actual: false reason: wrong value
-TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=-s2 == -Infinity || -s2 == -1.7976931348623157e+308  expected: true actual: false reason: wrong value
-TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=parseInt(s2) == Infinity || parseInt(s2) == 1.7976931348623157e+308 expected: true actual: false reason: wrong value
-TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=parseInt(s2,10) == Infinity || parseInt(s2,10) == 1.7976931348623157e+308 expected: true actual: false reason: wrong value
-TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=-s2 == -Infinity || -s2 == -1.7976931348623157e+308  expected: true actual: false reason: wrong value
-TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=parseInt(s2) == Infinity || parseInt(s2) == 1.7976931348623157e+308 expected: true actual: false reason: wrong value
-TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=parseInt(s2,10) == Infinity || parseInt(s2,10) == 1.7976931348623157e+308 expected: true actual: false reason: wrong value
-TEST_ID=ecma_3/Array/regress-322135-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=ecma_3/Array/regress-322135-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=ecma_3/Array/regress-322135-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=ecma_3/Array/regress-322135-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=PAGE STATUS: TIMED OUT
-TEST_ID=ecma_3/Array/regress-322135-03.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: TIMED OUT`|``.``*`/ecma_3/Array/regress-322135-03.js:`.``*`: out of memory`)`
-TEST_ID=ecma_3/Array/regress-322135-03.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=PAGE STATUS: TIMED OUT
-TEST_ID=ecma_3/Array/regress-322135-04.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: TIMED OUT`|``.``*`/ecma_3/Array/regress-322135-04.js:`.``*`: out of memory`)`
-TEST_ID=ecma_3/Array/regress-322135-04.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=PAGE STATUS: TIMED OUT
-TEST_ID=ecma_3/Array/regress-322135-04.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`/ecma_3/Array/regress-322135-04.js:`.``*`: out of memory
-TEST_ID=ecma_3/Array/regress-387501.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Array.prototype.toString|toSource|toLocaleString is not generic expected: TypeError: Array.prototype.toLocaleString called on incompatible String actual: f,o,o reason: Expected value 'TypeError: Array.prototype.toLocaleString called on incompatible String', Actual value 'f,o,o'
-TEST_ID=ecma_3/Array/regress-387501.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Array.prototype.toString|toSource|toLocaleString is not generic expected: TypeError: Array.prototype.toSource called on incompatible String actual: ["f", "o", "o"] reason: Expected value 'TypeError: Array.prototype.toSource called on incompatible String', Actual value '["f", "o", "o"]'
-TEST_ID=ecma_3/Array/regress-387501.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Array.prototype.toString|toSource|toLocaleString is not generic expected: TypeError: Array.prototype.toString called on incompatible String actual: f,o,o reason: Expected value 'TypeError: Array.prototype.toString called on incompatible String', Actual value 'f,o,o'
-TEST_ID=ecma_3/Date/15.9.4.3.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=15.9.4.3 - Date.UTC edge-case arguments.: date -1 expected: 30 actual: 1 reason: Expected value '30', Actual value '1'
-TEST_ID=ecma_3/Date/15.9.4.3.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=15.9.4.3 - Date.UTC edge-case arguments.: date 0 expected: 31 actual: 1 reason: Expected value '31', Actual value '1'
-TEST_ID=ecma_3/Date/15.9.4.3.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=15.9.4.3 - Date.UTC edge-case arguments.: date null expected: 31 actual: 1 reason: Expected value '31', Actual value '1'
-TEST_ID=ecma_3/Date/15.9.5.5-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`expected: -271821 actual: null
-TEST_ID=ecma_3/Date/15.9.5.5-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`expected: 275760 actual: null
-TEST_ID=ecma_3/ExecutionContexts/10.1.3-2.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`x is not a function
-TEST_ID=ecma_3/Expressions/11.10-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=11.10 - & should evaluate operands in order: order expected: o.valueOf, p.valueOf actual: , p.valueOfo.valueOf reason: Expected value 'o.valueOf, p.valueOf', Actual value ', p.valueOfo.valueOf'
-TEST_ID=ecma_3/Expressions/11.10-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=11.10 - ^ should evaluate operands in order: order expected: o.valueOf, p.valueOf actual: , p.valueOfo.valueOf reason: Expected value 'o.valueOf, p.valueOf', Actual value ', p.valueOfo.valueOf'
-TEST_ID=ecma_3/Expressions/11.10-03.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=11.10 - | should evaluate operands in order: order expected: o.valueOf, p.valueOf actual: , p.valueOfo.valueOf reason: Expected value 'o.valueOf, p.valueOf', Actual value ', p.valueOfo.valueOf'
-TEST_ID=ecma_3/Expressions/11.7.1-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=11.7.1 - << should evaluate operands in order: order expected: o.valueOf, p.valueOf actual: , p.valueOfo.valueOf reason: Expected value 'o.valueOf, p.valueOf', Actual value ', p.valueOfo.valueOf'
-TEST_ID=ecma_3/Expressions/11.7.2-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=11.7.2 - >> should evaluate operands in order: order expected: o.valueOf, p.valueOf actual: , p.valueOfo.valueOf reason: Expected value 'o.valueOf, p.valueOf', Actual value ', p.valueOfo.valueOf'
-TEST_ID=ecma_3/Expressions/11.7.3-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=11.7.3 - >>> should evaluate operands in order: order expected: o.valueOf, p.valueOf actual: , p.valueOfo.valueOf reason: Expected value 'o.valueOf, p.valueOf', Actual value ', p.valueOfo.valueOf'
-TEST_ID=ecma_3/LexicalConventions/7.9.1.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Automatic Semicolon insertion in postfix expressions: (xNL)-- y expected: SyntaxError: missing ; before statement actual: 0 reason: Type mismatch, expected type string, actual type number Expected value 'SyntaxError: missing ; before statement', Actual value '0'
-TEST_ID=ecma_3/Number/15.7.4.2-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`3.3.toString.length should be 1 expected: 1 actual: 0 reason: Expected value '1', Actual value '0'
-TEST_ID=ecma_3/Number/15.7.4.2-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`Expected value 'false', Actual value 'Error: illegal radix 0'
-TEST_ID=ecma_3/Operators/11.13.1-002.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=11.13.1 Simple Assignment should return type of RHS expected: string actual: number reason: Expected value 'string', Actual value 'number'
-TEST_ID=ecma_3/Operators/11.4.1-002.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: Type mismatch, expected type boolean, actual type string Expected value 'true', Actual value 'SyntaxError: invalid assignment left-hand side'
-TEST_ID=ecma_3/RegExp/15.10.2.12.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=15.10.2.12 - CharacterClassEscape d expected: false actual: true reason: Expected value 'false', Actual value 'true'
-TEST_ID=ecma_3/RegExp/regress-307456.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=ecma_3/RegExp/regress-330684.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/ecma_3/RegExp/regress-367888.js:`.``*`: out of memory
-TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/ecma_3/RegExp/regress-367888.js:`.``*`: out of memory
-TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/ecma_3/RegExp/regress-367888.js:`.``*`: out of memory
-TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/ecma_3/RegExp/regress-375642.js:`.``*`: out of memory
-TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/ecma_3/RegExp/regress-375642.js:`.``*`: out of memory
-TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/ecma_3/RegExp/regress-375642.js:`.``*`: out of memory
-TEST_ID=ecma_3/RegExp/regress-375711.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Do not assert with /[Q-b]/i.exec(""): /[Q-b]/i.exec("") expected: No Error actual: SyntaxError: invalid range in character class reason: Expected value 'No Error', Actual value 'SyntaxError: invalid range in character class'
-TEST_ID=ecma_3/RegExp/regress-375715-01-n.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: CRASHED `)``?``.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
-TEST_ID=ecma_3/RegExp/regress-375715-01-n.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=ecma_3/RegExp/regress-375715-01-n.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 3 actual: Actual exit 0, signal 0 reason: BUGNUMBER: 375715 STATUS: Do not assert: (c2 <= cs->length) && (c1 <= c2) PASSED! Do not assert: (c2 <= cs->length) && (c1 <= c2) /[Wb-G]/.exec("")
-TEST_ID=ecma_3/RegExp/regress-375715-03.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: CRASHED `)``?``.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
-TEST_ID=ecma_3/RegExp/regress-375715-03.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=ecma_3/RegExp/regress-375715-03.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: Testcase produced no output!
-TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: CRASHED `)``?``.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
-TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: Testcase produced no output!
-TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*` Expected value 'SyntaxError: invalid range in character class', Actual value ''
-TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 42 expected: ok actual: failure reason: Expected value 'ok', Actual value 'failure'
-TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 56 expected: |x|string|x|string|0|number|xyz|string||y|string||undefined|1|number|xyz|string|z actual: |x|string|x|string|0|number|xyz|string||y|string||string|1|number|xyz|string|z reason: Expected value '|x|string|x|string|0|number|xyz|string||y|string||undefined|1|number|xyz|string|z', Actual value '|x|string|x|string|0|number|xyz|string||y|string||string|1|number|xyz|string|z'
-TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 58 expected: xy|z|string||undefined|2|number|xyz|string| actual: xy|z|string||string|2|number|xyz|string| reason: Expected value 'xy|z|string||undefined|2|number|xyz|string|', Actual value 'xy|z|string||string|2|number|xyz|string|'
-TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 59 expected: xy|z|string||undefined|2|number|xyz|string| actual: xy|z|string||string|2|number|xyz|string| reason: Expected value 'xy|z|string||undefined|2|number|xyz|string|', Actual value 'xy|z|string||string|2|number|xyz|string|'
-TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 60 expected: xy|z|string||undefined|2|number|xyz|string| actual: xy|z|string||string|2|number|xyz|string| reason: Expected value 'xy|z|string||undefined|2|number|xyz|string|', Actual value 'xy|z|string||string|2|number|xyz|string|'
-TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 61 expected: xy|z|string||string|2|number|xyz|string| actual: xyz reason: Expected value 'xy|z|string||string|2|number|xyz|string|', Actual value 'xyz'
-TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 62 expected: x|y|string|y|string||undefined|1|number|xyz|string|z actual: x|y|string|y|string||string|1|number|xyz|string|z reason: Expected value 'x|y|string|y|string||undefined|1|number|xyz|string|z', Actual value 'x|y|string|y|string||string|1|number|xyz|string|z'
-TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 64 expected: x|y|string|y|string||undefined|1|number|xyyz|string||y|string|y|string||undefined|2|number|xyyz|string|z actual: x|y|string|y|string||string|1|number|xyyz|string||y|string|y|string||string|2|number|xyyz|string|z reason: Expected value 'x|y|string|y|string||undefined|1|number|xyyz|string||y|string|y|string||undefined|2|number|xyyz|string|z', Actual value 'x|y|string|y|string||string|1|number|xyyz|string||y|string|y|string||string|2|number|xyyz|string|z'
-TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 66 expected: xyy|z|string||undefined||string|3|number|xyyz|string| actual: xyy|z|string||string||string|3|number|xyyz|string| reason: Expected value 'xyy|z|string||undefined||string|3|number|xyyz|string|', Actual value 'xyy|z|string||string||string|3|number|xyyz|string|'
-TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 67 expected: x|y|string|1|number|xyz|string||string||undefined|y|string|z actual: x|y|string|1|number|xyz|string||string||string|y|string|z reason: Expected value 'x|y|string|1|number|xyz|string||string||undefined|y|string|z', Actual value 'x|y|string|1|number|xyz|string||string||string|y|string|z'
-TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 7 expected: /x/g/x/g/x/g actual: xnullx reason: Expected value '/x/g/x/g/x/g', Actual value 'xnullx'
-TEST_ID=ecma_3/String/regress-392378.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Regular Expression Non-participating Capture Groups are inaccurate in edge cases: "y".replace(/(x)?\1y/, function($0, $1){ return String($1); }) expected: undefined actual:  reason: Expected value 'undefined', Actual value ''
-TEST_ID=ecma_3/String/regress-392378.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Regular Expression Non-participating Capture Groups are inaccurate in edge cases: "y".replace(/(x)?y/, function($0, $1){ return $1; }) expected: undefined actual:  reason: Expected value 'undefined', Actual value ''
-TEST_ID=ecma_3/String/regress-392378.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Regular Expression Non-participating Capture Groups are inaccurate in edge cases: "y".replace(/(x)?y/, function($0, $1){ return String($1); }) expected: undefined actual:  reason: Expected value 'undefined', Actual value ''
-TEST_ID=ecma_3/String/regress-392378.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Regular Expression Non-participating Capture Groups are inaccurate in edge cases: "y".replace(/(x)?\1y/, function($0, $1){ return String($1); }) expected: undefined actual:  reason: Expected value 'undefined', Actual value ''
-TEST_ID=ecma_3/String/regress-392378.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Regular Expression Non-participating Capture Groups are inaccurate in edge cases: "y".replace(/(x)?y/, function($0, $1){ return $1; }) expected: undefined actual:  reason: Expected value 'undefined', Actual value ''
-TEST_ID=ecma_3/String/regress-392378.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Regular Expression Non-participating Capture Groups are inaccurate in edge cases: "y".replace(/(x)?y/, function($0, $1){ return String($1); }) expected: undefined actual:  reason: Expected value 'undefined', Actual value ''
-TEST_ID=ecma_3/Unicode/regress-352044-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*` Expected value 'SyntaxError: illegal character', Actual value ''
-TEST_ID=ecma_3/Unicode/regress-352044-02-n.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*` Expected value 'SyntaxError', Actual value 'No Error'
-TEST_ID=ecma_3/extensions/regress-274152.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Do not ignore unicode format-control characters: `[`0`-`2`]` expected: SyntaxError: illegal character actual:  reason: Expected value 'SyntaxError: illegal character', Actual value ''
-TEST_ID=ecma_3/extensions/regress-368516.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Ignore unicode BOM characters: `[`0`-`1`]` expected: No Error actual: SyntaxError: illegal character reason: Expected value 'No Error', Actual value 'SyntaxError: illegal character'
-TEST_ID=js1_2/function/regexparg-1.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=typeof f(/abc/) expected: object actual: function reason: wrong value
-TEST_ID=js1_2/function/regexparg-1.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=typeof new f(/abc/) expected: object actual: function reason: wrong value
-TEST_ID=js1_5/Array/11.1.4.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Elisons in Array literals should not be enumed Section 1 of test -  [,1]  expected: 1 actual: 01 reason: Expected value '1', Actual value '01'
-TEST_ID=js1_5/Array/11.1.4.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Elisons in Array literals should not be enumed Section 2 of test -  [,,1]  expected: 2 actual: 012 reason: Expected value '2', Actual value '012'
-TEST_ID=js1_5/Array/11.1.4.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Elisons in Array literals should not be enumed Section 4 of test -  [1,,]  expected: 0 actual: 01 reason: Expected value '0', Actual value '01'
-TEST_ID=js1_5/Array/regress-101964.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Section 1 of test -  expected: Truncation took less than `[`0`-`9`]``+` ms actual: Truncation took `[`0`-`9`]``+` ms reason: Expected value 'Truncation took less than `[`0`-`9`]``+` ms', Actual value 'Truncation took `[`0`-`9`]``+` ms'
-TEST_ID=js1_5/Array/regress-330812.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Array/regress-330812.js:`.``*`: out of memory
-TEST_ID=js1_5/Array/regress-330812.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Array/regress-330812.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Array/regress-330812.js:`.``*`: out of memory
-TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=2.6.22.*fc6, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=unknown, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=2.6.18.*el5, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=powerpc, TEST_KERNEL=8.11.0, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=9.2.2, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=powerpc, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Error/regress-354246.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/js1_5/Error/regress-354246.js:`.``*`: x is not defined
-TEST_ID=js1_5/Exceptions/regress-121658.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=powerpc, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Expressions/regress-394673.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*``(`InternalError:`|`reason:`)``?` too much recursion
-TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory
-TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory
-TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`SyntaxError: malformed formal parameter
-TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory
-TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory
-TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory
-TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`SyntaxError: malformed formal parameter
-TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory
-TEST_ID=js1_5/Function/regress-338121-03.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Function/regress-338121-03.js:`.``*`: out of memory
-TEST_ID=js1_5/Function/regress-338121-03.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Function/regress-338121-03.js:`.``*`: out of memory
-TEST_ID=js1_5/Function/regress-338121-03.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Function/regress-338121-03.js:`.``*`: out of memory
-TEST_ID=js1_5/GC/regress-203278-2.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/GC/regress-203278-2.js:102: out of memory
-TEST_ID=js1_5/GC/regress-203278-2.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=2.6.22.*fc6, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED signal 11
-TEST_ID=js1_5/GC/regress-338653.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: TIMED OUT`|`EXIT STATUS: CRASHED 0 signal 9`)`
-TEST_ID=js1_5/GC/regress-338653.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/GC/regress-338653.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED
-TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED
-TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=9.2.2, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 5 `.``*`/js1_5/GC/regress-346794.js:`.``*`: out of memory
-TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/GC/regress-348532.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Unknown expected: Unknown actual: error reason: http://test.mozilla.com/tests/mozilla.org/js/js1_5/GC/regress-348532.js:`.``*`: too much recursion
-TEST_ID=js1_5/GC/regress-348532.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/GC/regress-348532.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=2.6.18.*el5, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/GC/regress-383269-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*` uncaught exception: generate_big_object_graph() leaked
-TEST_ID=js1_5/GC/regress-383269-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*` uncaught exception: generate_big_object_graph() leaked
-TEST_ID=js1_5/GC/regress-383269-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*` uncaught exception: generate_big_object_graph() leaked
-TEST_ID=js1_5/GC/regress-383269-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: uncaught exception: generate_big_object_graph() leaked
-TEST_ID=js1_5/GC/regress-383269-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`uncaught exception: generate_big_object_graph() leaked
-TEST_ID=js1_5/GC/regress-383269-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`uncaught exception: generate_big_object_graph() leaked
-TEST_ID=js1_5/GC/regress-383269-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*` uncaught exception: generate_big_object_graph() leaked
-TEST_ID=js1_5/Regress/regress-203278-1.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Regress/regress-203278-1.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-203278-1.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=2.6.22.*fc6, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED signal 11
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=powerpc, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=powerpc, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=2.6.18.*el5, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=unknown, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3 `.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-303213.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=2.6.18.*el5, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 5 actual: Actual exit 0, signal 9
-TEST_ID=js1_5/Regress/regress-303213.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=2.6.18.*el5, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED signal 9
-TEST_ID=js1_5/Regress/regress-303213.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=2.6.22.*fc6, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-303213.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: TIMED OUT`|`EXIT STATUS: CRASHED`)`
-TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Regress/regress-312588.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED
-TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=powerpc, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Regress/regress-312588.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-314401.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-319384.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/js1_5/Regress/regress-319384.js:`.``*`: can't convert "foo" to an integer
-TEST_ID=js1_5/Regress/regress-320119.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=delegating objects and arguments, arity, caller, name: arguments no longer shared expected: false actual: true reason: Expected value 'false', Actual value 'true'
-TEST_ID=js1_5/Regress/regress-320119.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=delegating objects and arguments, arity, caller, name: arity no longer shared expected: false actual: true reason: Expected value 'false', Actual value 'true'
-TEST_ID=js1_5/Regress/regress-320119.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=delegating objects and arguments, arity, caller, name: caller no longer shared expected: false actual: true reason: Expected value 'false', Actual value 'true'
-TEST_ID=js1_5/Regress/regress-320119.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=delegating objects and arguments, arity, caller, name: name no longer shared expected: false actual: true reason: Expected value 'false', Actual value 'true'
-TEST_ID=js1_5/Regress/regress-328897.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: :0: uncaught exception: Permission denied to get property UnnamedClass.classes
-TEST_ID=js1_5/Regress/regress-328897.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=JS_ReportPendingException should expected: Error actual: No Error reason: Expected value 'Error', Actual value 'No Error'
-TEST_ID=js1_5/Regress/regress-328897.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: javascript:Components.classes:0: Script error.
-TEST_ID=js1_5/Regress/regress-330352.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 5 actual: Actual exit 0, signal 6 reason: ./js1_5/Regress/regress-330352.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-330352.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-330352.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=powerpc, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Regress/regress-346237.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Regress/regress-346237.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Regress/regress-346237.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-350268.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`: alert(6); } alert(5); expected: SyntaxError actual: No Error reason: Expected value 'SyntaxError', Actual value 'No Error'
-TEST_ID=js1_5/Regress/regress-350268.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`: } expected: SyntaxError actual: No Error reason: Expected value 'SyntaxError', Actual value 'No Error'
-TEST_ID=js1_5/Regress/regress-350268.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`: } { expected: SyntaxError actual: No Error reason: Expected value 'SyntaxError', Actual value 'No Error'
-TEST_ID=js1_5/Regress/regress-350268.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`: }}}}} expected: SyntaxError actual: No Error reason: Expected value 'SyntaxError', Actual value 'No Error'
-TEST_ID=js1_5/Regress/regress-352604.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`Assertion failure: !OBJ_GET_PROTO(cx, ctor), at `.``*`jsapi.c
-TEST_ID=js1_5/Regress/regress-352604.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: CRASHED 3`|` expected: Expected exit 0 actual: Actual exit 3`)`
-TEST_ID=js1_5/Regress/regress-362583.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`Assertion failure: caller->fun && !JSFUN_HEAVYWEIGHT_TEST(caller->fun->flags), at `.``*`jsscript.c:
-TEST_ID=js1_5/Regress/regress-362583.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 0 actual: Actual exit 3, signal 0 reason: Testcase produced no output!
-TEST_ID=js1_5/Regress/regress-3649-n.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 5 actual: Actual exit 0, signal 6 reason: ./js1_5/Regress/regress-3649-n.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-383674.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Statement that implicitly calls toString should not be optimized away as a "useless expression": 1 expected: toString called actual: toString not called reason: Expected value 'toString called', Actual value 'toString not called'
-TEST_ID=js1_5/Regress/regress-383674.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Statement that implicitly calls toString should not be optimized away as a "useless expression": 2 expected: toString called actual: toString not called reason: Expected value 'toString called', Actual value 'toString not called'
-TEST_ID=js1_5/Regress/regress-422348.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 5 `.``*`/js1_5/Regress/regress-422348.js:`.``*`: out of memory
-TEST_ID=js1_5/Regress/regress-422348.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/Regress/regress-422348.js:59: out of memory
-TEST_ID=js1_5/decompilation/regress-351219.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of immutable infinity, NaN decompile Infinity as 1/0 expected:  function ( ) { return 1 / 0 ; }  actual:  function ( ) { return Infinity ; }  reason: Expected value ' function ( ) { return 1 / 0 ; } ', Actual value ' function ( ) { return Infinity ; } '
-TEST_ID=js1_5/decompilation/regress-351219.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of immutable infinity, NaN: decompile NaN as 0/0 expected:  function ( ) { var NaN = 0 / 0 ; return NaN ; }  actual:  function ( ) { var NaN = NaN ; return NaN ; }  reason: Expected value ' function ( ) { var NaN = 0 / 0 ; return NaN ; } ', Actual value ' function ( ) { var NaN = NaN ; return NaN ; } '
-TEST_ID=js1_5/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of new parenthetic expressions expected:  function ( ) { new ( x ( y ) ( z ) ) ; }  actual:  function ( ) { new x ( y ) ( z ) ; }  reason: Expected value ' function ( ) { new ( x ( y ) ( z ) ) ; } ', Actual value ' function ( ) { new x ( y ) ( z ) ; } '
-TEST_ID=js1_5/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of new parenthetic expressions expected:  function ( ) { new ( x ( y ) . z ) ; }  actual:  function ( ) { new x ( y ) . z ; }  reason: Expected value ' function ( ) { new ( x ( y ) . z ) ; } ', Actual value ' function ( ) { new x ( y ) . z ; } '
-TEST_ID=js1_5/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of new parenthetic expressions expected:  function ( ) { new ( x ( z ) ) ( w ) ; }  actual:  function ( ) { new x ( z ) ( w ) ; }  reason: Expected value ' function ( ) { new ( x ( z ) ) ( w ) ; } ', Actual value ' function ( ) { new x ( z ) ( w ) ; } '
-TEST_ID=js1_5/decompilation/regress-352360.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of negative 0 expected:  function ( ) { return - 0 ; }  actual:  function ( ) { return 0 ; }  reason: Expected value ' function ( ) { return - 0 ; } ', Actual value ' function ( ) { return 0 ; } '
-TEST_ID=js1_5/decompilation/regress-352360.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of negative 0: 8 / eval("" + f)() expected: -Infinity actual: Infinity reason: Expected value '-Infinity', Actual value 'Infinity'
-TEST_ID=js1_5/decompilation/regress-352453.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/js1_5/decompilation/regress-352453.js:`.``*`: `(`SyntaxError: `)``?`invalid decrement operand
-TEST_ID=js1_5/decompilation/regress-353146.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of new expressions revisited expected:  function ( ) { return new ( p ( 2 ) [ 1 ] ) ; }  actual:  function ( ) { return new p ( 2 ) [ 1 ] ; }  reason: Expected value ' function ( ) { return new ( p ( 2 ) [ 1 ] ) ; } ', Actual value ' function ( ) { return new p ( 2 ) [ 1 ] ; } '
-TEST_ID=js1_5/decompilation/regress-356083.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation for ({this setter: function () { } })  expected:  function ( ) { return { this setter : function ( ) { } } ; }  actual:  function ( ) { return { ' this ' setter : function ( ) { } } ; }  reason: Expected value ' function ( ) { return { this setter : function ( ) { } } ; } ', Actual value ' function ( ) { return { ' this ' setter : function ( ) { } } ; } '
-TEST_ID=js1_5/decompilation/regress-356248.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of object literal with named getter expected:  function ( ) { return { set p y ( ) { } } ; }  actual:  function ( ) { return { set py ( ) { } } ; }  reason: Expected value ' function ( ) { return { set p y ( ) { } } ; } ', Actual value ' function ( ) { return { set py ( ) { } } ; } '
-TEST_ID=js1_5/decompilation/regress-371692.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Keep extra parentheses in conditional tests expected:  function ( ) { if ( ( i = 1 ) ) { a = 2 ; } }  actual:  function ( ) { if ( i = 1 ) { a = 2 ; } }  reason: Expected value ' function ( ) { if ( ( i = 1 ) ) { a = 2 ; } } ', Actual value ' function ( ) { if ( i = 1 ) { a = 2 ; } } '
-TEST_ID=js1_5/decompilation/regress-375882.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of switch with case 0/0 expected:  function ( ) { switch ( a ) { case 0 / 0 : a ; case 1 / 0 : b ; case 1 / - 0 : c ; case - 0 : d ; default : ; } }  actual:  function ( ) { switch ( a ) { case NaN : a ; case Infinity : b ; case - Infinity : c ; case 0 : d ; default : ; } }  reason: Expected value ' function ( ) { switch ( a ) { case 0 / 0 : a ; case 1 / 0 : b ; case 1 / - 0 : c ; case - 0 : d ; default : ; } } ', Actual value ' function ( ) { switch ( a ) { case NaN : a ; case Infinity : b ; case - Infinity : c ; case 0 : d ; default : ; } } '
-TEST_ID=js1_5/decompilation/regress-376564.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of new (eval()) expected:  function ( ) { new ( eval ( ) ) ; }  actual:  function ( ) { new eval ; }  reason: Expected value ' function ( ) { new ( eval ( ) ) ; } ', Actual value ' function ( ) { new eval ; } '
-TEST_ID=js1_5/decompilation/regress-376564.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of new (eval()) expected:  function ( ) { new ( g ( ) ) ; }  actual:  function ( ) { new g ; }  reason: Expected value ' function ( ) { new ( g ( ) ) ; } ', Actual value ' function ( ) { new g ; } '
-TEST_ID=js1_5/decompilation/regress-383721.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompiling Tabs: toString expected:  function ( ) { return "\ t "; }  actual:  function ( ) { return " "; }  reason: Expected value ' function ( ) { return "\ t "; } ', Actual value ' function ( ) { return " "; } '
-TEST_ID=js1_5/decompilation/regress-383721.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompiling Tabs: uneval expected:  ( function ( ) { return "\ t "; } )  actual:  ( function ( ) { return " "; } )  reason: Expected value ' ( function ( ) { return "\ t "; } ) ', Actual value ' ( function ( ) { return " "; } ) '
-TEST_ID=js1_5/extensions/regress-226507.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected:  actual: InternalError: too much recursion reason: Expected value '', Actual value 'InternalError: too much recursion'
-TEST_ID=js1_5/extensions/regress-226507.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected:  actual: InternalError: too much recursion reason: Expected value '', Actual value 'InternalError: too much recursion'
-TEST_ID=js1_5/extensions/regress-226507.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-226507.js:`.``*`: too much recursion
-TEST_ID=js1_5/extensions/regress-226507.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-226507.js:`.``*`: too much recursion
-TEST_ID=js1_5/extensions/regress-226507.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i686|x86|64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-226507.js:`.``*`: InternalError: too much recursion
-TEST_ID=js1_5/extensions/regress-226507.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i386, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-226507.js:`.``*`: InternalError: too much recursion
-TEST_ID=js1_5/extensions/regress-304897.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=uneval("\t"), uneval("\x09") expected: "\t" actual: "	" reason: Expected value '"\t"', Actual value '"	"'
-TEST_ID=js1_5/extensions/regress-322957.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=TryMethod should not eat getter exceptions expected: true actual: -1 reason: Type mismatch, expected type boolean, actual type number Expected value 'true', Actual value '-1'
-TEST_ID=js1_5/extensions/regress-330569.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-336409-1.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 5 actual: Actual exit 0, signal 6 reason: BUGNUMBER: 336409 STATUS: Integer overflow in js_obj_toSource --- NOTE: IN THIS TESTCASE, WE EXPECT EXIT CODE 0 --- --- NOTE: IN THIS TESTCASE, WE EXPECT EXIT CODE 5 --- STATUS: Creating 64MB string STATUS: Done. length = 67108864 STATUS: Creating object STATUS: object.toSource()
-TEST_ID=js1_5/extensions/regress-336409-2.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 5 actual: Actual exit 0, signal 6 reason: BUGNUMBER: 336409 STATUS: Integer overflow in js_obj_toSource --- NOTE: IN THIS TESTCASE, WE EXPECT EXIT CODE 0 --- --- NOTE: IN THIS TESTCASE, WE EXPECT EXIT CODE 5 --- STATUS: Creating 128MB string STATUS: Done. length = 134217728 STATUS: Creating object STATUS: object.toSource()
-TEST_ID=js1_5/extensions/regress-336410-1.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 5 actual: Actual exit 0, signal 6 reason: BUGNUMBER: 336410 STATUS: Integer overflow in array_toSource --- NOTE: IN THIS TESTCASE, WE EXPECT EXIT CODE 0 --- --- NOTE: IN THIS TESTCASE, WE EXPECT EXIT CODE 5 --- STATUS: Creating 64M length string STATUS: Done. length = 67108864 STATUS: Creating array STATUS: object.toSource()
-TEST_ID=js1_5/extensions/regress-336410-2.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 5 actual: Actual exit 0, signal 6 reason: BUGNUMBER: 336410 STATUS: Integer overflow in array_toSource --- NOTE: IN THIS TESTCASE, WE EXPECT EXIT CODE 0 --- --- NOTE: IN THIS TESTCASE, WE EXPECT EXIT CODE 5 --- STATUS: Creating 128M length string STATUS: Done. length = 134217728 STATUS: Creating array STATUS: object.toSource()
-TEST_ID=js1_5/extensions/regress-342960.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-342960.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=2.6.22.*fc6, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-342960.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-345967.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-345967.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-345967.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-345967.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-345967.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/extensions/regress-350531.js:`.``*`: out of memory
-TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i386), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/extensions/regress-350531.js:`.``*`: out of memory
-TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-351448.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_5/extensions/regress-351463-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`/([\d-\S]+)/.exec("a0- z") expected: a0-,a0- actual: SyntaxError: invalid range in character class reason: Expected value 'a0-,a0-', Actual value 'SyntaxError: invalid range in character class'
-TEST_ID=js1_5/extensions/regress-351463-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`/([\d-\s]+)/.exec("a0- z") expected: 0- ,0-  actual: SyntaxError: invalid range in character class reason: Expected value '0- ,0- ', Actual value 'SyntaxError: invalid range in character class'
-TEST_ID=js1_5/extensions/regress-352455.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Eval object with non-function getters/setters expected: SyntaxError: invalid getter usage actual:  reason: Expected value 'SyntaxError: invalid getter usage', Actual value ''
-TEST_ID=js1_5/extensions/regress-352604.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`Assertion failure: !OBJ_GET_PROTO(cx, ctor), at `.``*`jsapi.c
-TEST_ID=js1_5/extensions/regress-352604.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: CRASHED 3`|` expected: Expected exit 0 actual: Actual exit 3`)`
-TEST_ID=js1_5/extensions/regress-352604.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`Expected value 'function f() {NL}', Actual value 'function () {NL}'
-TEST_ID=js1_5/extensions/regress-353214.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of |function() { (function ([x]) { })(); eval("return 3;") }| expected:  function ( ) { ( function ( [ x ] ) { } ( ) ) ; eval ( " return 3 ;" ) ; }  actual:  function ( ) { ( function ( [ x ] ) { } ) ( ) ; eval ( " return 3 ;" ) ; }  reason: Expected value ' function ( ) { ( function ( [ x ] ) { } ( ) ) ; eval ( " return 3 ;" ) ; } ', Actual value ' function ( ) { ( function ( [ x ] ) { } ) ( ) ; eval ( " return 3 ;" ) ; } '
-TEST_ID=js1_5/extensions/regress-355622.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`Assertion failure: overwriting, at `.``*`jsscope.c:
-TEST_ID=js1_5/extensions/regress-355622.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=js1_5/extensions/regress-355622.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 0 actual: Actual exit 3, signal 0
-TEST_ID=js1_5/extensions/regress-355736.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of "[reserved]" has extra quotes: 1 expected:  function ( ) { [ super ] = q ; }  actual:  function ( ) { [ " super " ] = q ; }  reason: Expected value ' function ( ) { [ super ] = q ; } ', Actual value ' function ( ) { [ " super " ] = q ; } '
-TEST_ID=js1_5/extensions/regress-355736.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of "[reserved]" has extra quotes: 1: compile actual expected: No Error actual: SyntaxError: invalid assignment left-hand side reason: Expected value 'No Error', Actual value 'SyntaxError: invalid assignment left-hand side'
-TEST_ID=js1_5/extensions/regress-355736.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of "[reserved]" has extra quotes: 2 expected:  function ( ) { return { super getter : function ( ) { } } ; }  actual:  function ( ) { return { ' super ' getter : function ( ) { } } ; }  reason: Expected value ' function ( ) { return { super getter : function ( ) { } } ; } ', Actual value ' function ( ) { return { ' super ' getter : function ( ) { } } ; } '
-TEST_ID=js1_5/extensions/regress-355736.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of "[reserved]" has extra quotes: 3 expected:  function ( ) { [ goto ] = a ; }  actual:  function ( ) { [ " goto " ] = a ; }  reason: Expected value ' function ( ) { [ goto ] = a ; } ', Actual value ' function ( ) { [ " goto " ] = a ; } '
-TEST_ID=js1_5/extensions/regress-355736.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of "[reserved]" has extra quotes: 3: compile actual expected: No Error actual: SyntaxError: invalid assignment left-hand side reason: Expected value 'No Error', Actual value 'SyntaxError: invalid assignment left-hand side'
-TEST_ID=js1_5/extensions/regress-355820.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Remove non-standard Script object expected: undefined actual: function reason: Expected value 'undefined', Actual value 'function'
-TEST_ID=js1_5/extensions/regress-356085.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=js_obj_toString for getter/setter expected:  ( { set p y ( ) { } } )  actual:  ( { set p ( ) { } } )  reason: Expected value ' ( { set p y ( ) { } } ) ', Actual value ' ( { set p ( ) { } } ) '
-TEST_ID=js1_5/extensions/regress-363258.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Timer resolution expected: true actual: false reason: Expected value 'true', Actual value 'false'
-TEST_ID=js1_5/extensions/regress-363258.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Timer resolution expected: true actual: false reason: Expected value 'true', Actual value 'false'
-TEST_ID=js1_5/extensions/regress-365869.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=strict warning for object literal with duplicate propery names expected: TypeError: redeclaration of property 1 actual: No warning reason: Expected value 'TypeError: redeclaration of property 1', Actual value 'No warning'
-TEST_ID=js1_5/extensions/regress-365869.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=strict warning for object literal with duplicate propery names expected: TypeError: redeclaration of property a actual: No warning reason: Expected value 'TypeError: redeclaration of property a', Actual value 'No warning'
-TEST_ID=js1_5/extensions/regress-367923.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=strict warning for variable redeclares argument expected: TypeError: variable v redeclares argument actual: TypeError: variable v hides argument reason: Expected value 'TypeError: variable v redeclares argument', Actual value 'TypeError: variable v hides argument'
-TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Numeric sort performance expected: (tint/tstr < 3)=true actual: (tint/tstr < 3)=false reason: Expected value '(tint/tstr < 3)=true', Actual value '(tint/tstr < 3)=false'
-TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Numeric sort performance expected: (tint/tstr < 3)=true actual: (tint/tstr < 3)=false reason: Expected value '(tint/tstr < 3)=true', Actual value '(tint/tstr < 3)=false'
-TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Numeric sort performance expected: (tint/tstr < 3)=true actual: (tint/tstr < 3)=false reason: Expected value '(tint/tstr < 3)=true', Actual value '(tint/tstr < 3)=false'
-TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Numeric sort performance expected: (tint/tstr < 3)=true actual: (tint/tstr < 3)=false reason: Expected value '(tint/tstr < 3)=true', Actual value '(tint/tstr < 3)=false'
-TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/extensions/regress-371636.js:`.``*`: out of memory
-TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/extensions/regress-371636.js:`.``*`: out of memory
-TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`/js1_5/extensions/regress-371636.js:`.``*`: out of memory
-TEST_ID=js1_5/extensions/regress-375801.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=uneval should use "(void 0)" instead of "undefined": uneval expected:  ( { a : ( void 0 ) } )  actual:  ( { a : undefined } )  reason: Expected value ' ( { a : ( void 0 ) } ) ', Actual value ' ( { a : undefined } ) '
-TEST_ID=js1_5/extensions/regress-376052.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=javascript.options.anonfunfix to allow function (){} expressions: 3 expected: SyntaxError: syntax error actual: No Error reason: Expected value 'SyntaxError: syntax error', Actual value 'No Error'
-TEST_ID=js1_5/extensions/regress-379523.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of sharp declaration: 1 expected:  ( function ( ) { return # 1 = [ a ] ; } )  actual:  ( function ( ) { return # 1 = [ , a ] ; } )  reason: Expected value ' ( function ( ) { return # 1 = [ a ] ; } ) ', Actual value ' ( function ( ) { return # 1 = [ , a ] ; } ) '
-TEST_ID=js1_5/extensions/regress-379523.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of sharp declaration: 1 expected:  ( function ( ) { return # 1 = { a : b } ; } )  actual:  ( function ( ) { return # 1 = { , a : b } ; } )  reason: Expected value ' ( function ( ) { return # 1 = { a : b } ; } ) ', Actual value ' ( function ( ) { return # 1 = { , a : b } ; } ) '
-TEST_ID=js1_5/extensions/regress-379523.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of sharp declaration: 1: compile actual expected: No Error actual: SyntaxError: invalid property id reason: Expected value 'No Error', Actual value 'SyntaxError: invalid property id'
-TEST_ID=js1_5/extensions/regress-380831.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=uneval trying to output a getter function that is a sharp definition expected:  ( { b getter : # 1 = ( function ( ) { } ) , c getter : # 1 # } )  actual:  ( { b getter : # 1 = ( ) { } , c getter : # 1 # } )  reason: Expected value ' ( { b getter : # 1 = ( function ( ) { } ) , c getter : # 1 # } ) ', Actual value ' ( { b getter : # 1 = ( ) { } , c getter : # 1 # } ) '
-TEST_ID=js1_5/extensions/regress-380889.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`Assertion failure: op == JSOP_LOOKUPSWITCH, at `.``*`js.c:
-TEST_ID=js1_5/extensions/regress-380889.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: Testcase produced no output!
-TEST_ID=js1_5/extensions/regress-381205.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=uneval with special getter functions: global expected: ({get x p() {print(4);}}) actual: ({get x () {print(4);}) reason: Expected value '({get x p() {print(4);}})', Actual value '({get x () {print(4);})'
-TEST_ID=js1_5/extensions/regress-381304.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-381304.js:`.``*`: `(`SyntaxError: `)``?`missing : after property id
-TEST_ID=js1_5/extensions/regress-385134.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`, reason: Testcase produced no output!
-TEST_ID=js1_5/extensions/regress-407019.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`Expected match to '/Illegal operation on WrappedNative prototype object/', Actual value 'TypeError: window.Option is not a function'
-TEST_ID=js1_5/extensions/regress-429264.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=2.6.24.*fc8, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 0 signal 11
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("xxxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") expected: Sat Jan 01 -0051 00:00:00 `.``*` actual: xxxx-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51 reason: Expected value 'Sat Jan 01 -0051 00:00:00 `.``*`', Actual value 'xxxx-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") expected: -1 99 actual: -001 -1 reason: Expected value '-1 99', Actual value '-001 -1'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") expected: -51 49 actual: -051 -51 reason: Expected value '-51 49', Actual value '-051 -51'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") expected: -51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51 actual: -051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051 reason: Expected value '-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51', Actual value '-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("xxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") expected: xxx-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51 actual: xxx-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051 reason: Expected value 'xxx-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51', Actual value 'xxx-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") expected: -1 99 actual: 000/ 0/ reason: Expected value '-1 99', Actual value '000/ 0/'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") expected: -100 00 actual: 0/00 00 reason: Expected value '-100 00', Actual value '0/00 00'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") expected: -51 49 actual: 00+/ +/ reason: Expected value '-51 49', Actual value '00+/ +/'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") expected: 1851 51 actual: 1851 ,' reason: Expected value '1851 51', Actual value '1851 ,''
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") expected: 1899 99 actual: 1899 0/ reason: Expected value '1899 99', Actual value '1899 0/'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") expected: -9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999 actual: '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' reason: Expected value '-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999', Actual value ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") expected: 32767327673276732767327673276732767327673276732767327673276732767327673276732767327673276732767 actual: 2767276727672767276727672767276727672767276727672767276727672767276727672767 reason: Expected value '32767327673276732767327673276732767327673276732767327673276732767327673276732767327673276732767', Actual value '2767276727672767276727672767276727672767276727672767276727672767276727672767'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") expected: -51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51 actual: 00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/ reason: Expected value '-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51', Actual value '00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("xxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") expected: xxx-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51 actual: xxx00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/ reason: Expected value 'xxx-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51', Actual value 'xxx00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("xxxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") expected: xxxx-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999 actual: xxxx'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' reason: Expected value 'xxxx-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999', Actual value 'xxxx'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("xxxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") expected: xxxx32767327673276732767327673276732767327673276732767327673276732767327673276732767327673276732767 actual: xxxx2767276727672767276727672767276727672767276727672767276727672767276727672767 reason: Expected value 'xxxx32767327673276732767327673276732767327673276732767327673276732767327673276732767327673276732767', Actual value 'xxxx2767276727672767276727672767276727672767276727672767276727672767276727672767'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("xxxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") expected: Mon Jan 01 -9999 00:00:00 `.``*` actual: xxxx'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' reason: Expected value 'Mon Jan 01 -9999 00:00:00 `.``*`', Actual value 'xxxx'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("xxxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") expected: Sun Jan 01 32767 00:00:00 `.``*` actual: xxxx2767276727672767276727672767276727672767276727672767276727672767276727672767276727672767 reason: Expected value 'Sun Jan 01 32767 00:00:00 `.``*`', Actual value 'xxxx2767276727672767276727672767276727672767276727672767276727672767276727672767276727672767'
-TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("xxxxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") expected: Sun Jan 01 32767 00:00:00 `.``*` actual: xxxxx2767276727672767276727672767276727672767276727672767276727672767276727672767 reason: Expected value 'Sun Jan 01 32767 00:00:00 `.``*`', Actual value 'xxxxx2767276727672767276727672767276727672767276727672767276727672767276727672767'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=(-0400|-0500), TEST_DESCRIPTION=Date.toLocaleFormat("%H:%M") == Date.toLocaleFormat("%R") expected: 20:00 actual: Sat Jun 04 2005 `.``*` reason: Expected value '20:00', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=(-0400|-0500), TEST_DESCRIPTION=Date.toLocaleFormat("%H:%M:%S") == Date.toLocaleFormat("%T") expected: 20:00:00 actual: Sat Jun 04 2005 `.``*` reason: Expected value '20:00:00', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=(-0400|-0500), TEST_DESCRIPTION=Date.toLocaleFormat("%I:%M:%S %p") == Date.toLocaleFormat("%r") expected: 08:00:00 PM actual: Sat Jun 04 2005 `.``*` reason: Expected value '08:00:00 PM', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=(-0700|-0800), TEST_DESCRIPTION=Date.toLocaleFormat("%H:%M") == Date.toLocaleFormat("%R") expected: 17:00 actual: Sat Jun 04 2005 `.``*` reason: Expected value '17:00', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=(-0700|-0800), TEST_DESCRIPTION=Date.toLocaleFormat("%H:%M:%S") == Date.toLocaleFormat("%T") expected: 17:00:00 actual: Sat Jun 04 2005 `.``*` reason: Expected value '17:00:00', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=(-0700|-0800), TEST_DESCRIPTION=Date.toLocaleFormat("%I:%M:%S %p") == Date.toLocaleFormat("%r") expected: 05:00:00 PM actual: Sat Jun 04 2005 `.``*` reason: Expected value '05:00:00 PM', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%C") expected: 20 actual: Sat Jun 04 2005 `.``*` reason: Expected value '20', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%G") expected: 2005 actual: Sat Jun 04 2005 `.``*` reason: Expected value '2005', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%V") expected: 22 actual: Sat Jun 04 2005 `.``*` reason: Expected value '22', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%Y-%m-%d") == Date.toLocaleFormat("%F") expected: 2005-06-04 actual: Sat Jun 04 2005 `.``*` reason: Expected value '2005-06-04', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%b") == Date.toLocaleFormat("%h") expected: Jun actual: Sat Jun 04 2005 `.``*` reason: Expected value 'Jun', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%e") expected:  4 actual: Sat Jun 04 2005 `.``*` reason: Expected value ' 4', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%g") expected: 05 actual: Sat Jun 04 2005 `.``*` reason: Expected value '05', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%m/%d/%y") == Date.toLocaleFormat("%D") expected: 06/04/05 actual: Sat Jun 04 2005 `.``*` reason: Expected value '06/04/05', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%n") == "NL" expected: NL actual: Sat Jun 04 2005 `.``*` reason: Expected value 'NL', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%t") == "\t" expected: 	 actual: Sat Jun 04 2005 `.``*` reason: Expected value '	', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%u") expected: 6 actual: Sat Jun 04 2005 `.``*` reason: Expected value '6', Actual value 'Sat Jun 04 2005 `.``*`'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%C%y") == Date.toLocaleFormat("%Y") expected: 05 actual: 2005 reason: Expected value '05', Actual value '2005'
-TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Date.toLocaleFormat("%C%y") == Date.toLocaleFormat("%Y") expected: Sat Jun 04 2005 `.``*` actual: 2005 reason: Expected value 'Sat Jun 04 2005 `.``*`, Actual value '2005'
-TEST_ID=js1_6/Array/regress-320887.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=var x should not throw a ReferenceError expected: No error actual: ReferenceError: x is not defined reason: Expected value 'No error', Actual value 'ReferenceError: x is not defined'
-TEST_ID=js1_6/Array/regress-386030.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Array.reduce should ignore holes: 1 expected: PASS actual: FAIL, reduce reason: Expected value 'PASS', Actual value 'FAIL, reduce'
-TEST_ID=js1_6/Array/regress-386030.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Array.reduce should ignore holes: 2 expected: PASS actual: FAIL, reduceRight reason: Expected value 'PASS', Actual value 'FAIL, reduceRight'
-TEST_ID=js1_6/Regress/regress-353078.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Do not assert with bogus toString, map, split expected: TypeError: can't convert global to string actual: No Crash reason: Expected value 'TypeError: can't convert global to string', Actual value 'No Crash'
-TEST_ID=js1_7/block/regress-352422.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=let declaration must be direct child of block, top-level implicit block, or switch body block expected: SyntaxError actual:  reason: Expected value 'SyntaxError', Actual value ''
-TEST_ID=js1_7/block/regress-352609.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=p = {}; (p.z = [let (x = 3, y = 4) x])() expected: true actual: false reason: Expected match to '/TypeError: (p.z = \[let \(x = 3, y = 4\) x\]|.*Array.*) is not a function/', Actual value 'TypeError: p.z = [(let (x = 3, y = 4) x)] is not a function'
-TEST_ID=js1_7/block/regress-352786.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=let declaration must be direct child of block, top-level implicit block, or switch body block expected: SyntaxError actual:  reason: Expected value 'SyntaxError', Actual value ''
-TEST_ID=js1_7/block/regress-352907.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=let declaration must be direct child of block, top-level implicit block, or switch body block expected: SyntaxError actual:  reason: Expected value 'SyntaxError', Actual value ''
-TEST_ID=js1_7/block/regress-376410.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=let declaration must be direct child of block, top-level implicit block, or switch body block expected: SyntaxError actual:  reason: Expected value 'SyntaxError', Actual value ''
-TEST_ID=js1_7/decompilation/regress-346642-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of destructuring assignment: 14 expected:  function ( ) { while ( [ ] = e ) { } }  actual:  function ( ) { while ( ( [ ] = e ) ) { } }  reason: Expected value ' function ( ) { while ( [ ] = e ) { } } ', Actual value ' function ( ) { while ( ( [ ] = e ) ) { } } '
-TEST_ID=js1_7/decompilation/regress-346642-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of destructuring assignment: 15 expected:  function ( ) { while ( [ ] = a ( b ) ) { } }  actual:  function ( ) { while ( ( [ ] = a ( b ) ) ) { } }  reason: Expected value ' function ( ) { while ( [ ] = a ( b ) ) { } } ', Actual value ' function ( ) { while ( ( [ ] = a ( b ) ) ) { } } '
-TEST_ID=js1_7/decompilation/regress-350704.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of let nested in for expected:  function ( ) { try { } catch ( y ) { for ( z ( let ( y = 3 ) 4 ) ;; ) { } } }  actual:  function ( ) { try { } catch ( y ) { for ( z ( ( let ( y = 3 ) 4 ) ) ;; ) { } } }  reason: Expected value ' function ( ) { try { } catch ( y ) { for ( z ( let ( y = 3 ) 4 ) ;; ) { } } } ', Actual value ' function ( ) { try { } catch ( y ) { for ( z ( ( let ( y = 3 ) 4 ) ) ;; ) { } } } '
-TEST_ID=js1_7/decompilation/regress-352026.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of yield in argument lists expected:  function f ( ) { g ( ( ( let ( a = b ) c ) , d ) , e ) ; }  actual:  function f ( ) { g ( ( let ( a = b ) c , d ) , e ) ; }  reason: Expected value ' function f ( ) { g ( ( ( let ( a = b ) c ) , d ) , e ) ; } ', Actual value ' function f ( ) { g ( ( let ( a = b ) c , d ) , e ) ; } '
-TEST_ID=js1_7/decompilation/regress-352079.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of various operators expected:  function ( ) { f ( let ( y = 3 ) 4 ) ++; }  actual:  function ( ) { f ( ( let ( y = 3 ) 4 ) ) ++; }  reason: Expected value ' function ( ) { f ( let ( y = 3 ) 4 ) ++; } ', Actual value ' function ( ) { f ( ( let ( y = 3 ) 4 ) ) ++; } '
-TEST_ID=js1_7/decompilation/regress-352272.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of |let| in arg to lvalue returning function expected:  function ( ) { f ( let ( y = 3 ) 4 ) ++; }  actual:  function ( ) { f ( ( let ( y = 3 ) 4 ) ) ++; }  reason: Expected value ' function ( ) { f ( let ( y = 3 ) 4 ) ++; } ', Actual value ' function ( ) { f ( ( let ( y = 3 ) 4 ) ) ++; } '
-TEST_ID=js1_7/decompilation/regress-355786.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of for (a[b, this] in []) { } expected:  function ( ) { for ( a [ b , this ] in [ ] ) { } }  actual:  function ( ) { for ( let a [ ( b , this ) ] in [ ] ) { } }  reason: Expected value ' function ( ) { for ( a [ b , this ] in [ ] ) { } } ', Actual value ' function ( ) { for ( let a [ ( b , this ) ] in [ ] ) { } } '
-TEST_ID=js1_7/decompilation/regress-355786.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of for (a[b, this] in []) { }: compile actual expected: No Error actual: SyntaxError: missing ; after for-loop initializer reason: Expected value 'No Error', Actual value 'SyntaxError: missing ; after for-loop initializer'
-TEST_ID=js1_7/decompilation/regress-356247.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of let {} = [1] in a loop: g : (function() { for(let x in []) let {} = [1]; }) expected:  function ( ) { for ( let x in [ ] ) let [ ] = [ 1 ] ; }  actual:  function ( ) { for ( let x in [ ] ) { let [ ] = [ 1 ] ; } }  reason: Expected value ' function ( ) { for ( let x in [ ] ) let [ ] = [ 1 ] ; } ', Actual value ' function ( ) { for ( let x in [ ] ) { let [ ] = [ 1 ] ; } } '
-TEST_ID=js1_7/decompilation/regress-356247.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of let {} = [1] in a loop: g : (function() { while(0) let {} = [1]; }) expected:  function ( ) { while ( 0 ) let [ ] = [ 1 ] ; }  actual:  function ( ) { while ( 0 ) { let [ ] = [ 1 ] ; } }  reason: Expected value ' function ( ) { while ( 0 ) let [ ] = [ 1 ] ; } ', Actual value ' function ( ) { while ( 0 ) { let [ ] = [ 1 ] ; } } '
-TEST_ID=js1_7/decompilation/regress-375794.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of array comprehension with catch guard expected:  function ( ) { try { } catch ( a if [ b for each ( c in [ ] ) ] ) { } }  actual:  function ( ) { try { } catch ( a if [ b for each ( [ ] in [ ] ) ] ) { } }  reason: Expected value ' function ( ) { try { } catch ( a if [ b for each ( c in [ ] ) ] ) { } } ', Actual value ' function ( ) { try { } catch ( a if [ b for each ( [ ] in [ ] ) ] ) { } } '
-TEST_ID=js1_7/decompilation/regress-375794.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of array comprehension with catch guard: compile actual expected: No Error actual: SyntaxError: invalid for/in left-hand side reason: Expected value 'No Error', Actual value 'SyntaxError: invalid for/in left-hand side'
-TEST_ID=js1_7/decompilation/regress-380506.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of nested-for and for-if comprehensions expected:  function ( ) { return [ i * i for ( i in [ 0 ] ) if ( i % 2 ) ] ; }  actual:  function ( ) { return [ i * i for ( i in [ 0 ] ) ] ; }  reason: Expected value ' function ( ) { return [ i * i for ( i in [ 0 ] ) if ( i % 2 ) ] ; } ', Actual value ' function ( ) { return [ i * i for ( i in [ 0 ] ) ] ; } '
-TEST_ID=js1_7/decompilation/regress-380506.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of nested-for and for-if comprehensions expected:  function ( ) { return [ i * j for ( i in [ 0 ] ) for ( j in [ 1 ] ) ] ; }  actual:  function ( ) { return [ i * j for ( i in [ 0 ] ) ] ; }  reason: Expected value ' function ( ) { return [ i * j for ( i in [ 0 ] ) for ( j in [ 1 ] ) ] ; } ', Actual value ' function ( ) { return [ i * j for ( i in [ 0 ] ) ] ; } '
-TEST_ID=js1_7/decompilation/regress-381108.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of object literal should have space following : expected: true actual: false reason: Expected value 'true', Actual value 'false'
-TEST_ID=js1_7/decompilation/regress-429252.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=trap should not change decompilation of { let x }: after trap expected:  function f ( ) { { let x ; } }  actual:  function f ( ) { { let x ; } let x ; }  reason: Expected value ' function f ( ) { { let x ; } } ', Actual value ' function f ( ) { { let x ; } let x ; } '
-TEST_ID=js1_7/expressions/regress-421806.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
-TEST_ID=js1_7/expressions/regress-421806.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=js1_7/expressions/regress-421806.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 0 actual: Actual exit 3, signal 0 reason: Testcase produced no output!
-TEST_ID=js1_7/extensions/regress-351102-04.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: CRASHED `)``?``.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
-TEST_ID=js1_7/extensions/regress-351102-04.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=js1_7/extensions/regress-351102-04.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: Testcase produced no output!
-TEST_ID=js1_7/extensions/regress-351102-05.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: CRASHED `)``?``.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
-TEST_ID=js1_7/extensions/regress-351102-05.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=js1_7/extensions/regress-351102-05.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: Testcase produced no output!
-TEST_ID=js1_7/extensions/regress-367629.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Decompilation of result with native function as getter expected: ({get h encodeURI() {[native code]}}) actual: ({get h () {[native code]}) reason: Expected value '({get h encodeURI() {[native code]}})', Actual value '({get h () {[native code]})'
-TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*` Assertion failure: pnprop->pn_type == TOK_COLON, at `.``*`jsparse.c:
-TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*` Assertion failure: pnprop->pn_type == TOK_COLON, at `.``*`jsparse.c:
-TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=athlon, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*` Assertion failure: pnprop->pn_type == TOK_COLON, at `.``*`jsparse.c:
-TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 0 actual: Actual exit 3, signal 0 reason: Testcase produced no output!
-TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED signal 11
-TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED signal 10
-TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 5
-TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(athlon|i686|x86_64), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 0 signal 11, reason: Testcase produced no output!
-TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=(i386|powerpc), TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 0 signal 10, reason: Testcase produced no output!
-TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 4 signal 0, reason: Testcase produced no output!
-TEST_ID=js1_7/extensions/regress-379566.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Keywords after get|set expected:  ( { in getter : ( function ( ) { return this . for ; } ) , in setter : ( function ( value ) { this . for = value ; } ) } )  actual:  SyntaxError : missing : after property id  reason: Expected value ' ( { in getter : ( function ( ) { return this . for ; } ) , in setter : ( function ( value ) { this . for = value ; } ) } ) ', Actual value ' SyntaxError : missing : after property id '
-TEST_ID=js1_7/extensions/regress-379566.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Keywords after get|set: compile actual expected: No Error actual: SyntaxError: missing ; before statement reason: Expected value 'No Error', Actual value 'SyntaxError: missing ; before statement'
-TEST_ID=js1_7/extensions/regress-380933.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`Expected match to '/TypeError: Array.prototype.toSource called on incompatible Function/', Actual value 'No Error'
-TEST_ID=js1_7/extensions/regress-381301.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=uneval of object with native-function getter expected:  ( { get x decodeURI ( ) { [ native code ] } } )  actual:  ( { get x ( ) { [ native code ] } )  reason: Expected value ' ( { get x decodeURI ( ) { [ native code ] } } ) ', Actual value ' ( { get x ( ) { [ native code ] } ) '
-TEST_ID=js1_7/extensions/regress-381303.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=object toSource when a property has both a getter and a setter expected:  ( { get inn ( ) { return this . for ; } , set inn ( value ) { this . for = value ; } } )  actual:  ( { get inn ( ) { return this [ ' for ' ] ; } , set inn ( value ) { this [ ' for ' ] = value ; } } )  reason: Expected value ' ( { get inn ( ) { return this . for ; } , set inn ( value ) { this . for = value ; } } ) ', Actual value ' ( { get inn ( ) { return this [ ' for ' ] ; } , set inn ( value ) { this [ ' for ' ] = value ; } } ) '
-TEST_ID=js1_7/extensions/regress-429266.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*`Assertion failure: nuses == 0 || *pcstack[pcdepth - 1] == JSOP_ENTERBLOCK, at jsopcode.c:
-TEST_ID=js1_7/extensions/regress-429266.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 0 actual: Actual exit 3, signal 0 reason: BUGNUMBER: 429266 STATUS: Do not assert: nuses == 0 || *pcstack[pcdepth - 1] == JSOP_ENTERBLOCK
-TEST_ID=js1_7/geniter/regress-347739.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=generator_instance.close readonly and immune: 2 expected: Inside finally: 1 Inside finally: 2  actual: Inside finally: 2  reason: Expected value 'Inside finally: 1 Inside finally: 2 ', Actual value 'Inside finally: 2 '
-TEST_ID=js1_7/geniter/regress-349012-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/js1_7/geniter/regress-349012-01.js:`.``*`: yield from closing generator function gen() {try {try {yield 1;} finally {actual += "Inner finally";yield 2;}} finally {actual += ",Outer finally";}}
-TEST_ID=js1_7/geniter/regress-349012-01.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=closing a generator fails to report error if yield during close is ignored expected: Inner finally,Outer finally actual:  reason: Expected value 'Inner finally,Outer finally', Actual value ''
-TEST_ID=js1_7/geniter/regress-349331.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=test GC-invoke close expected: true actual: false reason: Expected value 'true', Actual value 'false'
-TEST_ID=js1_7/iterable/regress-340526-02.js, TEST_BRANCH=1.9.0, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Iterators: cross-referenced objects with close handler can delay close handler execution expected: 2 actual: 0 reason: Expected value '2', Actual value '0'
-TEST_ID=js1_7/iterable/regress-341815.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_7/iterable/regress-341815.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_7/iterable/regress-341815.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=powerpc, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_7/iterable/regress-341815.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=powerpc, TEST_KERNEL=8.11.0, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_7/iterable/regress-341821.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_7/iterable/regress-341821.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=mac, TEST_MACHINE=.*, TEST_PROCESSORTYPE=powerpc, TEST_KERNEL=8.11.0, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_7/iterable/regress-341821.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=i686, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_7/iterable/regress-415922.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`expected: Error: its enumeration failed actual: No exception
-TEST_ID=js1_7/lexical/regress-346642-03.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of destructuring assignment: 2 `(`expected: TypeError: x.t has no properties actual: TypeError: e1.t has no properties reason: Expected value 'TypeError: x.t has no properties', Actual value 'TypeError: e1.t has no properties'`|`expected: true actual: false reason: Expected match to '/TypeError: x.t (has no properties|is undefined)/', Actual value 'TypeError: e1.t `(`has no properties`|`is undefined`)`'`)`
-TEST_ID=js1_7/lexical/regress-346642-03.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=decompilation of destructuring assignment: 8 expected: TypeError: ++x is not a function actual: TypeError: ++e1 is not a function reason: Expected value 'TypeError: ++x is not a function', Actual value 'TypeError: ++e1 is not a function'
-TEST_ID=js1_7/lexical/regress-351515.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Invalid uses of yield, let keywords in js17: global: yield = 1 expected: SyntaxError: syntax error actual: SyntaxError: yield not in function reason: Expected value 'SyntaxError: syntax error', Actual value 'SyntaxError: yield not in function'
-TEST_ID=js1_7/regexp/yflag.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/js1_7/regexp/yflag.js:`.``*`: `(`SyntaxError: `)``?`invalid flag after regular expression
-TEST_ID=js1_7/regress/regress-350387.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/js1_7/regress/regress-350387.js:`.``*`: `(`ReferenceError: `)``?`x is not defined
-TEST_ID=js1_7/regress/regress-361566.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: CRASHED `)``?``.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
-TEST_ID=js1_7/regress/regress-361566.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=js1_7/regress/regress-361566.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: Testcase produced no output!
-TEST_ID=js1_7/regress/regress-363040-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Test reduce of empty array without initializer. : TypeError: reduce of empty array with no initial value expected: TypeError: reduce of empty array with no initial value actual: TypeError: arr0elms.reduce is not a function reason: Expected value 'TypeError: reduce of empty array with no initial value', Actual value 'TypeError: arr0elms.reduce is not a function'
-TEST_ID=js1_7/regress/regress-363040-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=Test reduceRight of empty array without initializer. : TypeError: reduce of empty array with no initial value expected: TypeError: reduce of empty array with no initial value actual: TypeError: arr0elms.reduceRight is not a function reason: Expected value 'TypeError: reduce of empty array with no initial value', Actual value 'TypeError: arr0elms.reduceRight is not a function'
-TEST_ID=js1_7/regress/regress-363040-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/js1_7/regress/regress-363040-01.js:`.``*`: `(`TypeError: `)``?`arr0elms.reduce is not a function
-TEST_ID=js1_7/regress/regress-363040-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/js1_7/regress/regress-363040-01.js:`.``*`: `(`TypeError: `)``?`arr0elms.reduce is not a function
-TEST_ID=js1_7/regress/regress-363040-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*` Expected value 'TypeError: reduce of empty array with no initial value', Actual value 'TypeError: arr0elms.reduce is not a function'
-TEST_ID=js1_7/regress/regress-363040-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/js1_7/regress/regress-363040-02.js:`.``*`: `(`TypeError: `)``?`arr.reduce is not a function
-TEST_ID=js1_7/regress/regress-363040-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`/js1_7/regress/regress-363040-02.js:`.``*`: `(`TypeError: `)``?`arr.reduce is not a function
-TEST_ID=js1_7/regress/regress-372331.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: `.``*`: uncaught exception: for-in binds name to early
-TEST_ID=js1_7/regress/regress-372331.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: uncaught exception: for-in binds name to early BUGNUMBER: 372331 STATUS: for-in should not bind name too early
-TEST_ID=js1_7/regress/regress-372331.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: BUGNUMBER: 372331 STATUS: for-in should not bind name too early uncaught exception: for-in binds name to early
-TEST_ID=js1_7/regress/regress-373827-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: CRASHED `)``?``.``*`Assertion failure: OBJ_GET_CLASS(cx, obj) == &js_BlockClass, at `.``*`jsinterp.c:
-TEST_ID=js1_7/regress/regress-373827-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=js1_7/regress/regress-373827-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: Testcase produced no output!
-TEST_ID=js1_7/regress/regress-373827-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`(`EXIT STATUS: CRASHED `)``?``.``*`Assertion failure: OBJ_GET_CLASS(cx, obj) == &js_BlockClass, at `.``*`jsinterp.c:
-TEST_ID=js1_7/regress/regress-373827-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=js1_7/regress/regress-373827-02.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: Testcase produced no output!
-TEST_ID=js1_7/regress/regress-373828.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`Assertion failure: op == JSOP_LEAVEBLOCKEXPR ? fp->spbase + OBJ_BLOCK_DEPTH(cx, obj) == sp - 1 : fp->spbase + OBJ_BLOCK_DEPTH(cx, obj) == sp, at `.``*`jsinterp.c:
-TEST_ID=js1_7/regress/regress-373828.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=js1_7/regress/regress-373828.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 0 actual: Actual exit 3, signal 0 reason: Testcase produced no output!
-TEST_ID=js1_7/regress/regress-375695.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
-TEST_ID=js1_7/regress/regress-375695.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=js1_7/regress/regress-375695.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=`.``*`reason: Testcase produced no output!
-TEST_ID=js1_7/regress/regress-385133-01.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=shell, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED
-TEST_ID=js1_7/regress/regress-389605.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=(browser|shell), TEST_OS=(linux|mac), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED `.``*` Assertion failure: OBJ_GET_CLASS(cx, obj) == &js_BlockClass, at `.``*`jsinterp.c:
-TEST_ID=js1_7/regress/regress-389605.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: CRASHED 3
-TEST_ID=js1_7/regress/regress-389605.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=win32, TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION= expected: Expected exit 0 actual: Actual exit 3, signal 0
-TEST_ID=js1_7/regress/regress-406477.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=eval of function x() in a function with an argument "x" and "let x" expected:  actual: Unexpected test_param_result value: 1NLUnexpected test_var_result value: 1NL reason: Expected value '', Actual value 'Unexpected test_param_result value: 1NLUnexpected test_var_result value: 1NL'
-TEST_ID=js1_7/regress/regress-410649.js, TEST_BRANCH=(1.8.1|1.9.0), TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=(browser|shell), TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=type for destructuring parameter case expected: function actual: number reason: Expected value 'function', Actual value 'number'
-TEST_ID=js1_8/genexps/regress-384991.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=(debug|opt), TEST_TYPE=browser, TEST_OS=(linux|mac|win32), TEST_MACHINE=.*, TEST_PROCESSORTYPE=.*, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
-TEST_ID=js1_8/regress/regress-384412.js, TEST_BRANCH=1.8.1, TEST_RESULT=FAILED, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_MACHINE=.*, TEST_PROCESSORTYPE=x86_64, TEST_KERNEL=.*, TEST_DATE=.*, TEST_TIMEZONE=.*, TEST_DESCRIPTION=EXIT STATUS: TIMED OUT
+TEST_ID=e4x/decompilation/decompile-xml-escapes.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 1 of test - Decompiler escapes line breaks/backslashes in E4X literals reason: Type mismatch, expected type boolean, actual type string Expected value 'false', Actual value ''function anonymous() {NL    return <![CDATA[\\\\]]>;NL}' does not contain '<![CDATA[\\]]>'!'
+TEST_ID=e4x/decompilation/decompile-xml-escapes.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 1 of test - Decompiler escapes line breaks/backslashes in E4X literals reason: Type mismatch, expected type boolean, actual type string Expected value 'false', Actual value ''function anonymous() {NL    return <?f bNLNLcNLc?>;NL}' does not contain '<?f bNLNLcNLc?>'!'
+TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 11 of test - Decompilation with new operator redeaux reason: Expected value ' function ( ) { new ( x ( y ) . n : : z ) ; } ', Actual value ' function ( ) { new x ( y ) . n : : z ; } '
+TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 12 of test - Decompilation with new operator redeaux reason: Expected value ' function ( ) { new ( x ( y ) . n : : z ) ; } ', Actual value ' function ( ) { new x ( y ) . n : : z ; } '
+TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 14 of test - Decompilation with new operator redeaux reason: Expected value ' function ( ) { new ( x ( y ) . n : : [ z ] ) ; } ', Actual value ' function ( ) { new x ( y ) . n : : [ z ] ; } '
+TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 15 of test - Decompilation with new operator redeaux reason: Expected value ' function ( ) { new ( x ( y ) . n : : [ z ] ) ; } ', Actual value ' function ( ) { new x ( y ) . n : : [ z ] ; } '
+TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 2 of test - Decompilation with new operator redeaux reason: Expected value ' function ( ) { new ( x ( y ) [ z ] ) ; } ', Actual value ' function ( ) { new x ( y ) [ z ] ; } '
+TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 3 of test - Decompilation with new operator redeaux reason: Expected value ' function ( ) { new ( x ( y ) [ z ] ) ; } ', Actual value ' function ( ) { new x ( y ) [ z ] ; } '
+TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 5 of test - Decompilation with new operator redeaux reason: Expected value ' function ( ) { new ( x ( y ) . @ a ) ; } ', Actual value ' function ( ) { new x ( y ) . @ a ; } '
+TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 6 of test - Decompilation with new operator redeaux reason: Expected value ' function ( ) { new ( x ( y ) . @ a ) ; } ', Actual value ' function ( ) { new x ( y ) . @ a ; } '
+TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 8 of test - Decompilation with new operator redeaux reason: Expected value ' function ( ) { new ( x ( y ) . @ [ n : : a ] ) ; } ', Actual value ' function ( ) { new x ( y ) . @ [ n : : a ] ; } '
+TEST_ID=e4x/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 9 of test - Decompilation with new operator redeaux reason: Expected value ' function ( ) { new ( x ( y ) . @ [ n : : a ] ) ; } ', Actual value ' function ( ) { new x ( y ) . @ [ n : : a ] ; } '
+TEST_ID=e4x/decompilation/regress-352789.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 1 of test - Decompilation of new and .@ reason: Expected value ' function ( ) { return new ( a ( ) . @ z ) ; } ', Actual value ' function ( ) { return new a . @ z ; } '
+TEST_ID=e4x/decompilation/regress-429249.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=trap should not change decompilation <x/> : after trap reason: Expected value ' function g ( ) { return <x/>; } ', Actual value ' function g ( ) { return "<x/>"; } '
+TEST_ID=e4x/Expressions/11.1.4-08.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 50 of test - 11.1.4 - XML Initializer - {} Expressions - 08 reason: Expected value 'true', Actual value 'false'
+TEST_ID=e4x/Expressions/11.1.4-08.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 51 of test - 11.1.4 - XML Initializer - {} Expressions - 08 reason: Expected value 'true', Actual value 'false'
+TEST_ID=e4x/Expressions/11.1.4-08.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 53 of test - 11.1.4 - XML Initializer - {} Expressions - 08 reason: Expected value 'true', Actual value 'false'
+TEST_ID=e4x/Expressions/11.1.4-08.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 54 of test - 11.1.4 - XML Initializer - {} Expressions - 08 reason: Expected value 'true', Actual value 'false'
+TEST_ID=e4x/Expressions/11.1.4-08.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 56 of test - 11.1.4 - XML Initializer - {} Expressions - 08 reason: Expected value 'true', Actual value 'false'
+TEST_ID=e4x/extensions/regress-337226.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=function::globalfunction Section  reason: `.``*`/e4x/extensions/regress-337226.js:`.``*`: reference to undefined XML name @mozilla.org/js/function::parseInt
+TEST_ID=e4x/extensions/regress-337226.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/e4x/extensions/regress-337226.js:`.``*`: ReferenceError: reference to undefined XML name @mozilla.org/js/function::parseInt
+TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`received signal 11
+TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`received signal 11
+TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/e4x/extensions/regress-374025.js:`.``*`: out of memory
+TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=e4x/extensions/regress-374025.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=e4x/extensions/regress-410192.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 1 of test - Proper quoting of attribute by uneval/toSource reason: Expected value '"v"', Actual value 'v'
+TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/e4x/GC/regress-324278.js:`.``*`: out of memory
+TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`/e4x/GC/regress-324278.js:`.``*`: out of memory
+TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=e4x/GC/regress-324278.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/e4x/GC/regress-324278.js:`.``*`: out of memory
+TEST_ID=e4x/Global/13.1.2.1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 4 of test - 13.1.2.1 - isXMLName() reason: Expected value 'exception', Actual value 'no exception'
+TEST_ID=e4x/Global/13.1.2.1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 6 of test - 13.1.2.1 - isXMLName() reason: Expected value '', Actual value '0xAA-0xAA : Invalid char accepted as start : Invalid Char accepted as other NL0xB5-0xB5 : Invalid char accepted as start : Invalid Char accepted as other NL0xB7-0xB7 : Other char not acceptedNL0xBA-0xBA : Invalid char accepted as start : Invalid Char accepted as other NL0x132-0x133 : Invalid char accepted as start : Invalid Char accepted as other NL0x13F-0x140 : Invalid char accepted as start : Invalid Char accepted as other NL0x149-0x149 : Invalid char accepted as start : Invalid Char accepted as other NL0x17F-0x17F : Invalid char accepted as start : Invalid Char accepted as other NL0x1C4-0x1CC : Invalid char accepted as start : Invalid Char accepted as other NL0x1F1-0x1F3 : Invalid char accepted as start : Invalid Char accepted as other NL0x2B0-0x2B8 : Invalid Char accepted as other NL0x2BB-0x2C1 : Start char not acceptedNL0x2E0-0x2E4 : Invalid Char accepted as other NL0x37A-0x37A : Invalid Char accepted as other NL0x387-0x387 : Other char not acceptedNL0x559-0x559 : Start char not acceptedNL0x587-0x587 : Invalid char accepted as start : Invalid Char accepted as other NL0x6E5-0x6E6 : Start char not acceptedNL0xEDC-0xEDD : Invalid char accepted as start : Invalid Char accepted as other NL0x1101-0x1101 : Invalid char accepted as start : Invalid Char accepted as other NL0x1104-0x1104 : Invalid char accepted as start : Invalid Char accepted as other NL0x1108-0x1108 : Invalid char accepted as start : Invalid Char accepted as other NL0x110A-0x110A : Invalid char accepted as start : Invalid Char accepted as other NL0x110D-0x110D : Invalid char accepted as start : Invalid Char accepted as other NL0x1113-0x113B : Invalid char accepted as start : Invalid Char accepted as other NL0x113D-0x113D : Invalid char accepted as start : Invalid Char accepted as other NL0x113F-0x113F : Invalid char accepted as start : Invalid Char accepted as other NL0x1141-0x114B : Invalid char accepted as start : Invalid Char accepted as other NL0x114D-0x114D : Invalid char accepted as start : Invalid Char accepted as other NL0x114F-0x114F : Invalid char accepted as start : Invalid Char accepted as other NL0x1151-0x1153 : Invalid char accepted as start : Invalid Char accepted as other NL0x1156-0x1158 : Invalid char accepted as start : Invalid Char accepted as other NL0x1162-0x1162 : Invalid char accepted as start : Invalid Char accepted as other NL0x1164-0x1164 : Invalid char accepted as start : Invalid Char accepted as other NL0x1166-0x1166 : Invalid char accepted as start : Invalid Char accepted as other NL0x1168-0x1168 : Invalid char accepted as start : Invalid Char accepted as other NL0x116A-0x116C : Invalid char accepted as start : Invalid Char accepted as other NL0x116F-0x1171 : Invalid char accepted as start : Invalid Char accepted as other NL0x1174-0x1174 : Invalid char accepted as start : Invalid Char accepted as other NL0x1176-0x119D : Invalid char accepted as start : Invalid Char accepted as other NL0x119F-0x11A2 : Invalid char accepted as start : Invalid Char accepted as other NL0x11A9-0x11AA : Invalid char accepted as start : Invalid Char accepted as other NL0x11AC-0x11AD : Invalid char accepted as start : Invalid Char accepted as other NL0x11B0-0x11B6 : Invalid char accepted as start : Invalid Char accepted as other NL0x11B9-0x11B9 : Invalid char accepted as start : Invalid Char accepted as other NL0x11BB-0x11BB : Invalid char accepted as start : Invalid Char accepted as other NL0x11C3-0x11EA : Invalid char accepted as start : Invalid Char accepted as other NL0x11EC-0x11EF : Invalid char accepted as start : Invalid Char accepted as other NL0x11F1-0x11F8 : Invalid char accepted as start : Invalid Char accepted as other NL0x207F-0x207F : Invalid char accepted as start : Invalid Char accepted as other NL0x20DD-0x20E0 : Invalid Char accepted as other NL0x2102-0x2102 : Invalid char accepted as start : Invalid Char accepted as other NL0x2107-0x2107 : Invalid char accepted as start : Invalid Char accepted as other NL0x210A-0x2113 : Invalid char accepted as start : Invalid Char accepted as other NL0x2115-0x2115 : Invalid char accepted as start : Invalid Char accepted as other NL0x2118-0x211D : Invalid char accepted as start : Invalid Char accepted as other NL0x2124-0x2124 : Invalid char accepted as start : Invalid Char accepted as other NL0x2128-0x2128 : Invalid char accepted as start : Invalid Char accepted as other NL0x212C-0x212D : Invalid char accepted as start : Invalid Char accepted as other NL0x212F-0x2131 : Invalid char accepted as start : Invalid Char accepted as other NL0x2133-0x2138 : Invalid char accepted as start : Invalid Char accepted as other NL0x2160-0x217F : Invalid char accepted as start : Invalid Char accepted as other NL0x309B-0x309C : Invalid Char accepted as other NL0x3131-0x318E : Invalid char accepted as start : Invalid Char accepted as other NL0xF900-0xFA2D : Invalid char accepted as start : Invalid Char accepted as other NL0xFB00-0xFB06 : Invalid char accepted as start : Invalid Char accepted as other NL0xFB13-0xFB17 : Invalid char accepted as start : Invalid Char accepted as other NL0xFB1E-0xFB1E : Invalid Char accepted as other NL0xFB1F-0xFB28 : Invalid char accepted as start : Invalid Char accepted as other NL0xFB2A-0xFB36 : Invalid char accepted as start : Invalid Char accepted as other NL0xFB38-0xFB3C : Invalid char accepted as start : Invalid Char accepted as other NL0xFB3E-0xFB3E : Invalid char accepted as start : Invalid Char accepted as other NL0xFB40-0xFB41 : Invalid char accepted as start : Invalid Char accepted as other NL0xFB43-0xFB44 : Invalid char accepted as start : Invalid Char accepted as other NL0xFB46-0xFBB1 : Invalid char accepted as start : Invalid Char accepted as other NL0xFBD3-0xFD3D : Invalid char accepted as start : Invalid Char accepted as other NL0xFD50-0xFD8F : Invalid char accepted as start : Invalid Char accepted as other NL0xFD92-0xFDC7 : Invalid char accepted as start : Invalid Char accepted as other NL0xFDF0-0xFDFB : Invalid char accepted as start : Invalid Char accepted as other NL0xFE20-0xFE23 : Invalid Char accepted as other NL0xFE70-0xFE72 : Invalid char accepted as start : Invalid Char accepted as other NL0xFE74-0xFE74 : Invalid char accepted as start : Invalid Char accepted as other NL0xFE76-0xFEFC : Invalid char accepted as start : Invalid Char accepted as other NL0xFF10-0xFF19 : Invalid Char accepted as other NL0xFF21-0xFF3A : Invalid char accepted as start : Invalid Char accepted as other NL0xFF41-0xFF5A : Invalid char accepted as start : Invalid Char accepted as other NL0xFF66-0xFF6F : Invalid char accepted as start : Invalid Char accepted as other NL0xFF70-0xFF70 : Invalid Char accepted as other NL0xFF71-0xFF9D : Invalid char accepted as start : Invalid Char accepted as other NL0xFF9E-0xFF9F : Invalid Char accepted as other NL0xFFA0-0xFFBE : Invalid char accepted as start : Invalid Char accepted as other NL0xFFC2-0xFFC7 : Invalid char accepted as start : Invalid Char accepted as other NL0xFFCA-0xFFCF : Invalid char accepted as start : Invalid Char accepted as other NL0xFFD2-0xFFD7 : Invalid char accepted as start : Invalid Char accepted as other NL0xFFDA-0xFFDC : Invalid char accepted as start : Invalid Char accepted as other NL'
+TEST_ID=e4x/Namespace/regress-292863.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 1 of test - Undeclaring namespace prefix should cause parse error reason: Expected value 'error', Actual value 'no error'
+TEST_ID=e4x/Regress/regress-319872.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=e4x/Regress/regress-319872.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/e4x/Regress/regress-319872.js:`.``*`: out of memory
+TEST_ID=e4x/Regress/regress-319872.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=e4x/Regress/regress-319872.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=e4x/Regress/regress-352223.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 1 of test - Reject invalid spaces in tags reason: Expected value 'SyntaxError: invalid XML name', Actual value ''
+TEST_ID=e4x/Regress/regress-352223.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 2 of test - Reject invalid spaces in tags reason: Expected value 'SyntaxError: invalid XML tag syntax', Actual value ''
+TEST_ID=e4x/Regress/regress-369032.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: kid2->parent == xml || !kid2->parent, at `.``*`jsxml.c:
+TEST_ID=e4x/Regress/regress-369032.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: kid2->parent == xml || !kid2->parent, at `.``*`jsxml.c:
+TEST_ID=e4x/Regress/regress-369032.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=e4x/Regress/regress-369032.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 2 of test - Do not assert: kid2->parent == xml || !kid2->parent reason: Expected value '<x>NL  <b>NL    <a>3</a>NL  </b>NL</x>', Actual value '<x>NL  <b>5</b>NL</x>'
+TEST_ID=e4x/Regress/regress-369740.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 3 of test - generic code for function:: reason: Expected value 'test', Actual value 'TypeError: can't set property @mozilla.org/js/function::toString in XMLList'
+TEST_ID=e4x/Regress/regress-370016.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=with (nonxmlobj) function:: Section  reason: `.``*`/e4x/Regress/regress-370016.js:`.``*`: reference to undefined XML name @mozilla.org/js/function::sin
+TEST_ID=e4x/Regress/regress-370016.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/e4x/Regress/regress-370016.js:`.``*`: ReferenceError: reference to undefined XML name @mozilla.org/js/function::sin
+TEST_ID=e4x/Regress/regress-370048-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=with (obj) function:: with xml lists Section  reason: `.``*`/e4x/Regress/regress-370048-01.js:`.``*`: reference to undefined XML name @mozilla.org/js/function::length
+TEST_ID=e4x/Regress/regress-370048-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/e4x/Regress/regress-370048-01.js:`.``*`: ReferenceError: reference to undefined XML name @mozilla.org/js/function::length
+TEST_ID=e4x/Regress/regress-370372.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=with (xmllist) function::name assignments Section  reason: `.``*`/e4x/Regress/regress-370372.js:`.``*`: reference to undefined XML name @mozilla.org/js/function::toString
+TEST_ID=e4x/Regress/regress-370372.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/e4x/Regress/regress-370372.js:`.``*`: ReferenceError: reference to undefined XML name @mozilla.org/js/function::toString
+TEST_ID=e4x/TypeConversion/10.2.1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 5 of test - 10.2.1 - XML.toXMLString reason: Expected value '
+TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 12 of test - 13.4.4.26 - XML normalize() reason: Expected value '1', Actual value '0'
+TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 13 of test - 13.4.4.26 - XML normalize() reason: Expected value '1', Actual value '0'
+TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 22 of test - 13.4.4.26 - XML normalize() reason: Expected value '<alpha><beta/> </alpha>', Actual value '<alpha><beta/></alpha>'
+TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 23 of test - 13.4.4.26 - XML normalize() reason: Expected value '2', Actual value '1'
+TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 3 of test - 13.4.4.26 - XML normalize() reason: Expected value '<alpha> <bravo> one </bravo> </alpha>', Actual value '<alpha><bravo> one </bravo></alpha>'
+TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 4 of test - 13.4.4.26 - XML normalize() reason: Expected value '<alpha>  </alpha>', Actual value '<alpha/>'
+TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 5 of test - 13.4.4.26 - XML normalize() reason: Expected value '2', Actual value '0'
+TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 6 of test - 13.4.4.26 - XML normalize() reason: Expected value '<alpha>  </alpha>', Actual value '<alpha/>'
+TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 7 of test - 13.4.4.26 - XML normalize() reason: Expected value '1', Actual value '0'
+TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 8 of test - 13.4.4.26 - XML normalize() reason: Expected value '<alpha>  <bravo> fun </bravo></alpha>', Actual value '<alpha><bravo> fun </bravo></alpha>'
+TEST_ID=e4x/XML/13.4.4.26.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 9 of test - 13.4.4.26 - XML normalize() reason: Expected value '2', Actual value '1'
+TEST_ID=e4x/XML/regress-324422-1.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/e4x/XML/regress-324422-1.js:`.``*`: out of memory
+TEST_ID=e4x/XML/regress-324422-1.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=e4x/XML/regress-324422-2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0400, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=e4x/XML/regress-324422-2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0700, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/e4x/XML/regress-324422-2.js:`.``*`: out of memory
+TEST_ID=e4x/XML/regress-324422-2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=e4x/XML/regress-324422-2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=e4x/XML/regress-324422-2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=e4x/XML/regress-324422-2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/e4x/XML/regress-324422-2.js:`.``*`: out of memory
+TEST_ID=e4x/XML/regress-324422-2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/e4x/XML/regress-324422-2.js:`.``*`: out of memory
+TEST_ID=e4x/XML/regress-324422-2.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/e4x/XML/regress-324422-2.js:`.``*`: out of memory
+TEST_ID=e4x/XML/regress-324422-2.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=e4x/XML/regress-376773.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=xmlsimple.stringmethod === xmlsimple.function::stringmethod Section 61 reason: `.``*`/e4x/XML/regress-376773.js:`.``*`: reference to undefined XML name @mozilla.org/js/function::charAt
+TEST_ID=e4x/XML/regress-376773.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=Section 61 of test - xmlsimple.stringmethod === xmlsimple.function::stringmethod reason:
+TEST_ID=ecma_3/Array/regress-322135-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=ecma_3/Array/regress-322135-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=ecma_3/Array/regress-322135-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=ecma_3/Array/regress-322135-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=ecma_3/Array/regress-322135-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=ecma_3/Array/regress-322135-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=ecma_3/Array/regress-322135-03.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=ecma_3/Array/regress-322135-03.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/Array/regress-322135-03.js:`.``*`: out of memory
+TEST_ID=ecma_3/Array/regress-322135-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=ecma_3/Array/regress-322135-04.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=ecma_3/Array/regress-322135-04.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/Array/regress-322135-04.js:`.``*`: out of memory
+TEST_ID=ecma_3/Array/regress-387501.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Array.prototype.toString|toSource|toLocaleString is not generic reason: Expected value 'TypeError: Array.prototype.toLocaleString called on incompatible String', Actual value 'f,o,o'
+TEST_ID=ecma_3/Array/regress-387501.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Array.prototype.toString|toSource|toLocaleString is not generic reason: Expected value 'TypeError: Array.prototype.toSource called on incompatible String', Actual value '["f", "o", "o"]'
+TEST_ID=ecma_3/Array/regress-387501.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Array.prototype.toString|toSource|toLocaleString is not generic reason: Expected value 'TypeError: Array.prototype.toString called on incompatible String', Actual value 'f,o,o'
+TEST_ID=ecma_3/Date/15.9.4.3.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=15.9.4.3 - Date.UTC edge-case arguments.: date 0 reason: Expected value '31', Actual value '1'
+TEST_ID=ecma_3/Date/15.9.4.3.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=15.9.4.3 - Date.UTC edge-case arguments.: date -1 reason: Expected value '30', Actual value '1'
+TEST_ID=ecma_3/Date/15.9.4.3.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=15.9.4.3 - Date.UTC edge-case arguments.: date null reason: Expected value '31', Actual value '1'
+TEST_ID=ecma_3/Date/15.9.5.5-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.prototype.toLocaleString should not clamp year: check toLocaleString reason: Expected value '-271821', Actual value 'null'
+TEST_ID=ecma_3/Date/15.9.5.5-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.prototype.toLocaleString should not clamp year: check toLocaleString reason: Expected value '275760', Actual value 'null'
+TEST_ID=ecma_3/ExecutionContexts/10.1.3-2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/ecma_3/ExecutionContexts/10.1.3-2.js:`.``*`: x is not a function
+TEST_ID=ecma_3/ExecutionContexts/10.1.3-2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/ExecutionContexts/10.1.3-2.js:`.``*`: TypeError: x is not a function
+TEST_ID=ecma_3/Expressions/11.10-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=11.10 - & should evaluate operands in order: order reason: Expected value 'o.valueOf, p.valueOf', Actual value ', p.valueOfo.valueOf'
+TEST_ID=ecma_3/Expressions/11.10-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=11.10 - ^ should evaluate operands in order: order reason: Expected value 'o.valueOf, p.valueOf', Actual value ', p.valueOfo.valueOf'
+TEST_ID=ecma_3/Expressions/11.10-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=11.10 - | should evaluate operands in order: order reason: Expected value 'o.valueOf, p.valueOf', Actual value ', p.valueOfo.valueOf'
+TEST_ID=ecma_3/Expressions/11.7.1-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=11.7.1 - << should evaluate operands in order: order reason: Expected value 'o.valueOf, p.valueOf', Actual value ', p.valueOfo.valueOf'
+TEST_ID=ecma_3/Expressions/11.7.2-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=11.7.2 - >> should evaluate operands in order: order reason: Expected value 'o.valueOf, p.valueOf', Actual value ', p.valueOfo.valueOf'
+TEST_ID=ecma_3/Expressions/11.7.3-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=11.7.3 - >>> should evaluate operands in order: order reason: Expected value 'o.valueOf, p.valueOf', Actual value ', p.valueOfo.valueOf'
+TEST_ID=ecma_3/extensions/regress-274152.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Do not ignore unicode format-control characters: 0 reason: Expected value 'SyntaxError: illegal character', Actual value ''
+TEST_ID=ecma_3/extensions/regress-274152.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Do not ignore unicode format-control characters: 1 reason: Expected value 'SyntaxError: illegal character', Actual value ''
+TEST_ID=ecma_3/extensions/regress-274152.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Do not ignore unicode format-control characters: 2 reason: Expected value 'SyntaxError: illegal character', Actual value ''
+TEST_ID=ecma_3/extensions/regress-368516.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Ignore unicode BOM characters: 0 reason: Expected value 'No Error', Actual value 'SyntaxError: illegal character'
+TEST_ID=ecma_3/LexicalConventions/7.9.1.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Automatic Semicolon insertion in postfix expressions: (xNL)-- y reason: Type mismatch, expected type string, actual type number Expected value 'SyntaxError: missing ; before statement', Actual value '0'
+TEST_ID=ecma_3/Number/15.7.4.2-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=3.3.toString.length should be 1 reason: Expected value '1', Actual value '0'
+TEST_ID=ecma_3/Number/15.7.4.2-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=num.toString(), num.toString(10), and num.toString(undefined) should all be equivalent reason: Type mismatch, expected type boolean, actual type object Expected value 'false', Actual value 'Error: illegal radix 0'
+TEST_ID=ecma_3/Operators/11.13.1-002.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=11.13.1 Simple Assignment should return type of RHS reason: Expected value 'string', Actual value 'number'
+TEST_ID=ecma_3/Operators/11.4.1-002.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=11.4.1 - The delete Operator - delete f() reason: Type mismatch, expected type boolean, actual type string Expected value 'true', Actual value 'SyntaxError: invalid assignment left-hand side'
+TEST_ID=ecma_3/RegExp/15.10.2.12.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=15.10.2.12 - CharacterClassEscape d reason: Expected value 'false', Actual value 'true'
+TEST_ID=ecma_3/RegExp/regress-307456.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=ecma_3/RegExp/regress-330684.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-367888.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-367888.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-367888.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-367888.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-367888.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-367888.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-367888.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=ecma_3/RegExp/regress-367888.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-367888.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-375642.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-375642.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-375642.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-375642.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-375642.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-375642.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-375642.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=ecma_3/RegExp/regress-375642.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/ecma_3/RegExp/regress-375642.js:`.``*`: out of memory
+TEST_ID=ecma_3/RegExp/regress-375711.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Do not assert with /[Q-b]/i.exec(""): /[Q-b]/i.exec("") reason: Expected value 'No Error', Actual value 'SyntaxError: invalid range in character class'
+TEST_ID=ecma_3/RegExp/regress-375715-01-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-01-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-01-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-01-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-01-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-01-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: (c2 <= cs->length) && (c1 <= c2), at `.``*`jsregexp.c:
+TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Do not assert: (c2 <= cs->length) && (c1 <= c2)(new RegExp("[ÃŸ-Ã‡]]", "i")).exec("") reason: Expected value 'SyntaxError: invalid range in character class', Actual value ''
+TEST_ID=ecma_3/RegExp/regress-375715-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Do not assert: (c2 <= cs->length) && (c1 <= c2)(new RegExp("[ß-Ç]]", "i")).exec("") reason: Expected value 'SyntaxError: invalid range in character class', Actual value ''
+TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 7 reason: Expected value '/x/g/x/g/x/g', Actual value 'xnullx'
+TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 42 reason: Expected value 'ok', Actual value 'failure'
+TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 56 reason: Expected value '|x|string|x|string|0|number|xyz|string||y|string||undefined|1|number|xyz|string|z', Actual value '|x|string|x|string|0|number|xyz|string||y|string||string|1|number|xyz|string|z'
+TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 58 reason: Expected value 'xy|z|string||undefined|2|number|xyz|string|', Actual value 'xy|z|string||string|2|number|xyz|string|'
+TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 59 reason: Expected value 'xy|z|string||undefined|2|number|xyz|string|', Actual value 'xy|z|string||string|2|number|xyz|string|'
+TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 60 reason: Expected value 'xy|z|string||undefined|2|number|xyz|string|', Actual value 'xy|z|string||string|2|number|xyz|string|'
+TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 61 reason: Expected value 'xy|z|string||string|2|number|xyz|string|', Actual value 'xyz'
+TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 62 reason: Expected value 'x|y|string|y|string||undefined|1|number|xyz|string|z', Actual value 'x|y|string|y|string||string|1|number|xyz|string|z'
+TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 64 reason: Expected value 'x|y|string|y|string||undefined|1|number|xyyz|string||y|string|y|string||undefined|2|number|xyyz|string|z', Actual value 'x|y|string|y|string||string|1|number|xyyz|string||y|string|y|string||string|2|number|xyyz|string|z'
+TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 66 reason: Expected value 'xyy|z|string||undefined||string|3|number|xyyz|string|', Actual value 'xyy|z|string||string||string|3|number|xyyz|string|'
+TEST_ID=ecma_3/String/15.5.4.11.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 67 reason: Expected value 'x|y|string|1|number|xyz|string||string||undefined|y|string|z', Actual value 'x|y|string|1|number|xyz|string||string||string|y|string|z'
+TEST_ID=ecma_3/String/regress-392378.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Regular Expression Non-participating Capture Groups are inaccurate in edge cases: "y".replace(/(x)?\1y/, function($0, $1){ return String($1); }) reason: Expected value 'undefined', Actual value ''
+TEST_ID=ecma_3/String/regress-392378.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Regular Expression Non-participating Capture Groups are inaccurate in edge cases: "y".replace(/(x)?y/, function($0, $1){ return $1; }) reason: Expected value 'undefined', Actual value ''
+TEST_ID=ecma_3/String/regress-392378.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Regular Expression Non-participating Capture Groups are inaccurate in edge cases: "y".replace(/(x)?y/, function($0, $1){ return String($1); }) reason: Expected value 'undefined', Actual value ''
+TEST_ID=ecma_3/Unicode/regress-352044-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=issues with Unicode escape sequences in JavaScript source code reason: Expected value 'SyntaxError: illegal character', Actual value ''
+TEST_ID=ecma_3/Unicode/regress-352044-02-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=issues with Unicode escape sequences in JavaScript source code reason: Expected value 'SyntaxError', Actual value 'No Error'
+TEST_ID=ecma/Math/15.8.2.5.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Infinity/Math.atan2(-0, 1) reason: wrong value
+TEST_ID=ecma/Math/15.8.2.5.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Infinity/Math.atan2(-1, Infinity) reason: wrong value
+TEST_ID=ecma/Math/15.8.2.6.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Infinity/Math.ceil(-0.9) reason: wrong value
+TEST_ID=ecma/Math/15.8.2.6.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Infinity/Math.ceil(-Number.MIN_VALUE) reason: wrong value
+TEST_ID=ecma/String/15.5.4.6-2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=var f = new Object( String.prototype.indexOf ); f('[object Window @ `.``*` (native @ `.``*`)]') reason: wrong value
+TEST_ID=ecma/TypeConversion/9.2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=!(0/0) reason: wrong value
+TEST_ID=ecma/TypeConversion/9.2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=1000 % 0 ? true : false reason: wrong value
+TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=.*, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=parseInt(s2,10) == Infinity || parseInt(s2,10) == 1.7976931348623157e+308 reason: wrong value
+TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=.*, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=parseInt(s2) == Infinity || parseInt(s2) == 1.7976931348623157e+308 reason: wrong value
+TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=.*, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=-s2 == -Infinity || -s2 == -1.7976931348623157e+308  reason: wrong value
+TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=.*, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=parseInt(s2,10) == Infinity || parseInt(s2,10) == 1.7976931348623157e+308 reason: wrong value
+TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=.*, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=parseInt(s2) == Infinity || parseInt(s2) == 1.7976931348623157e+308 reason: wrong value
+TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=.*, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=-s2 == -Infinity || -s2 == -1.7976931348623157e+308  reason: wrong value
+TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=.*, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=parseInt(s2,10) == Infinity || parseInt(s2,10) == 1.7976931348623157e+308 reason: wrong value
+TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=.*, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=parseInt(s2) == Infinity || parseInt(s2) == 1.7976931348623157e+308 reason: wrong value
+TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=.*, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=-s2 == -Infinity || -s2 == -1.7976931348623157e+308  reason: wrong value
+TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=.*, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=parseInt(s2,10) == Infinity || parseInt(s2,10) == 1.7976931348623157e+308 reason: wrong value
+TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=.*, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=parseInt(s2) == Infinity || parseInt(s2) == 1.7976931348623157e+308 reason: wrong value
+TEST_ID=ecma/TypeConversion/9.3.1-3.js, TEST_BRANCH=.*, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=-s2 == -Infinity || -s2 == -1.7976931348623157e+308  reason: wrong value
+TEST_ID=js1_2/function/regexparg-1.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=typeof f(/abc/) reason: wrong value
+TEST_ID=js1_2/function/regexparg-1.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=typeof new f(/abc/) reason: wrong value
+TEST_ID=js1_5/Array/11.1.4.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Elisons in Array literals should not be enumed Section 1 of test -  [,1]  reason: Expected value '1', Actual value '01'
+TEST_ID=js1_5/Array/11.1.4.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Elisons in Array literals should not be enumed Section 2 of test -  [,,1]  reason: Expected value '2', Actual value '012'
+TEST_ID=js1_5/Array/11.1.4.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Elisons in Array literals should not be enumed Section 4 of test -  [1,,]  reason: Expected value '0', Actual value '01'
+TEST_ID=js1_5/Array/regress-101964.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Section 1 of test -  reason: Expected value 'Truncation took less than 50 ms', Actual value 'Truncation took `.``*` ms'
+TEST_ID=js1_5/Array/regress-157652.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Array/regress-157652.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Array/regress-330812.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/Array/regress-330812.js:`.``*`: out of memory
+TEST_ID=js1_5/Array/regress-330812.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Array/regress-330812.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Array/regress-330812.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Array/regress-330812.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Array/regress-330812.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Array/regress-330812.js:`.``*`: out of memory
+TEST_ID=js1_5/Array/regress-330812.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Array/regress-330812.js:`.``*`: out of memory
+TEST_ID=js1_5/Array/regress-330812.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Array/regress-330812.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Array/regress-330812.js:`.``*`: out of memory
+TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/Array/regress-350256-03.js:`.``*`: out of memory
+TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0400, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`/js1_5/Array/regress-350256-03.js:`.``*`: out of memory
+TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Array/regress-350256-03.js:`.``*`: out of memory
+TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Array/regress-350256-03.js:`.``*`: out of memory
+TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Array/regress-350256-03.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/decompilation/regress-351219.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of immutable infinity, NaN decompile Infinity as 1/0 reason: Expected value ' function ( ) { return 1 / 0 ; } ', Actual value ' function ( ) { return Infinity ; } '
+TEST_ID=js1_5/decompilation/regress-351219.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of immutable infinity, NaN: decompile NaN as 0/0 reason: Expected value ' function ( ) { var NaN = 0 / 0 ; return NaN ; } ', Actual value ' function ( ) { var NaN = NaN ; return NaN ; } '
+TEST_ID=js1_5/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of new parenthetic expressions reason: Expected value ' function ( ) { new ( x ( y ) . z ) ; } ', Actual value ' function ( ) { new x ( y ) . z ; } '
+TEST_ID=js1_5/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of new parenthetic expressions reason: Expected value ' function ( ) { new ( x ( y ) ( z ) ) ; } ', Actual value ' function ( ) { new x ( y ) ( z ) ; } '
+TEST_ID=js1_5/decompilation/regress-352013.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of new parenthetic expressions reason: Expected value ' function ( ) { new ( x ( z ) ) ( w ) ; } ', Actual value ' function ( ) { new x ( z ) ( w ) ; } '
+TEST_ID=js1_5/decompilation/regress-352360.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of negative 0: 8 / eval("" + f)() reason: Expected value '-Infinity', Actual value 'Infinity'
+TEST_ID=js1_5/decompilation/regress-352360.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of negative 0 reason: Expected value ' function ( ) { return - 0 ; } ', Actual value ' function ( ) { return 0 ; } '
+TEST_ID=js1_5/decompilation/regress-352453.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/decompilation/regress-352453.js:`.``*`: invalid decrement operand
+TEST_ID=js1_5/decompilation/regress-352453.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/decompilation/regress-352453.js:`.``*`: SyntaxError: invalid decrement operand:; `.``*`/js1_5/decompilation/regress-352453.js:`.``*`:   var f = function() { (eval)(x)-- };; `.``*`/js1_5/decompilation/regress-352453.js:`.``*`:
+TEST_ID=js1_5/decompilation/regress-353146.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of new expressions revisited reason: Expected value ' function ( ) { return new ( p ( 2 ) [ 1 ] ) ; } ', Actual value ' function ( ) { return new p ( 2 ) [ 1 ] ; } '
+TEST_ID=js1_5/decompilation/regress-356083.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation for ({this setter: function () { } })  reason: Expected value ' function ( ) { return { this setter : function ( ) { } } ; } ', Actual value ' function ( ) { return { ' this ' setter : function ( ) { } } ; } '
+TEST_ID=js1_5/decompilation/regress-356248.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of object literal with named getter reason: Expected value ' function ( ) { return { set p y ( ) { } } ; } ', Actual value ' function ( ) { return { set py ( ) { } } ; } '
+TEST_ID=js1_5/decompilation/regress-371692.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Keep extra parentheses in conditional tests reason: Expected value ' function ( ) { if ( ( i = 1 ) ) { a = 2 ; } } ', Actual value ' function ( ) { if ( i = 1 ) { a = 2 ; } } '
+TEST_ID=js1_5/decompilation/regress-375882.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of switch with case 0/0 reason: Expected value ' function ( ) { switch ( a ) { case 0 / 0 : a ; case 1 / 0 : b ; case 1 / - 0 : c ; case - 0 : d ; default : ; } } ', Actual value ' function ( ) { switch ( a ) { case NaN : a ; case Infinity : b ; case - Infinity : c ; case 0 : d ; default : ; } } '
+TEST_ID=js1_5/decompilation/regress-376564.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of new (eval()) reason: Expected value ' function ( ) { new ( eval ( ) ) ; } ', Actual value ' function ( ) { new eval ; } '
+TEST_ID=js1_5/decompilation/regress-376564.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of new (eval()) reason: Expected value ' function ( ) { new ( g ( ) ) ; } ', Actual value ' function ( ) { new g ; } '
+TEST_ID=js1_5/decompilation/regress-383721.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompiling Tabs: toString reason: Expected value ' function ( ) { return "\ t "; } ', Actual value ' function ( ) { return " "; } '
+TEST_ID=js1_5/decompilation/regress-383721.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompiling Tabs: uneval reason: Expected value ' ( function ( ) { return "\ t "; } ) ', Actual value ' ( function ( ) { return " "; } ) '
+TEST_ID=js1_5/Error/regress-354246.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/Error/regress-354246.js:`.``*`: x is not defined
+TEST_ID=js1_5/Error/regress-354246.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Error/regress-354246.js:`.``*`: x is not defined
+TEST_ID=js1_5/Expressions/regress-394673.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/Expressions/regress-394673.js:`.``*`: too much recursion
+TEST_ID=js1_5/Expressions/regress-394673.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Expressions/regress-394673.js:`.``*`: InternalError: too much recursion
+TEST_ID=js1_5/extensions/regress-226507.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION= reason: Expected value '', Actual value 'InternalError: too much recursion'
+TEST_ID=js1_5/extensions/regress-226507.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION= reason: Expected value '', Actual value 'InternalError: too much recursion'
+TEST_ID=js1_5/extensions/regress-226507.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION= reason: Expected value '', Actual value 'InternalError: too much recursion'
+TEST_ID=js1_5/extensions/regress-304897.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=uneval("\t"), uneval("\x09") reason: Expected value '"\t"', Actual value '"	"'
+TEST_ID=js1_5/extensions/regress-322957.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=TryMethod should not eat getter exceptions reason: Type mismatch, expected type boolean, actual type number Expected value 'true', Actual value '-1'
+TEST_ID=js1_5/extensions/regress-330569.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-336409-1.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0700, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-336409-1.js:`.``*`: out of memory
+TEST_ID=js1_5/extensions/regress-336409-1.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336409-1.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336409-1.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336409-1.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0700, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-336409-1.js:`.``*`: out of memory
+TEST_ID=js1_5/extensions/regress-336409-1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0400, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336409-1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336409-1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336409-1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336409-1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336409-2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336410-1.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0700, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-336410-1.js:`.``*`: out of memory
+TEST_ID=js1_5/extensions/regress-336410-1.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336410-1.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336410-1.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336410-1.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0700, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-336410-1.js:`.``*`: out of memory
+TEST_ID=js1_5/extensions/regress-336410-1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0400, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336410-1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336410-1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336410-1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336410-1.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-336410-2.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-342960.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-342960.js:`.``*`: out of memory
+TEST_ID=js1_5/extensions/regress-342960.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-342960.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-345967.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-345967.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-345967.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-345967.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-345967.js, TEST_BRANCH=.*, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-345967.js, TEST_BRANCH=.*, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-345967.js, TEST_BRANCH=.*, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-350531.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-350531.js:`.``*`: out of memory
+TEST_ID=js1_5/extensions/regress-351448.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-351463-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Treat hyphens as not special adjacent to CharacterClassEscapes in character classes: /([\d-\s]+)/.exec("a0- z") reason: Expected value '0- ,0- ', Actual value 'SyntaxError: invalid range in character class'
+TEST_ID=js1_5/extensions/regress-351463-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Treat hyphens as not special adjacent to CharacterClassEscapes in character classes: /([\d-\S]+)/.exec("a0- z") reason: Expected value 'a0-,a0-', Actual value 'SyntaxError: invalid range in character class'
+TEST_ID=js1_5/extensions/regress-352455.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Eval object with non-function getters/setters reason: Expected value 'SyntaxError: invalid getter usage', Actual value ''
+TEST_ID=js1_5/extensions/regress-352604.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !OBJ_GET_PROTO(cx, ctor), at `.``*`jsapi.c:
+TEST_ID=js1_5/extensions/regress-352604.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !OBJ_GET_PROTO(cx, ctor), at `.``*`jsapi.c:
+TEST_ID=js1_5/extensions/regress-352604.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-352604.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Do not assert: !OBJ_GET_PROTO(cx, ctor) reason: Expected value 'function f() {NL}', Actual value 'function () {NL}'
+TEST_ID=js1_5/extensions/regress-353214.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of |function() { (function ([x]) { })(); eval("return 3;") }| reason: Expected value ' function ( ) { ( function ( [ x ] ) { } ( ) ) ; eval ( " return 3 ;" ) ; } ', Actual value ' function ( ) { ( function ( [ x ] ) { } ) ( ) ; eval ( " return 3 ;" ) ; } '
+TEST_ID=js1_5/extensions/regress-355622.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: overwriting, at `.``*`jsscope.c:
+TEST_ID=js1_5/extensions/regress-355622.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: overwriting, at `.``*`jsscope.c:
+TEST_ID=js1_5/extensions/regress-355622.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-355736.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of "[reserved]" has extra quotes: 1: compile actual reason: Expected value 'No Error', Actual value 'SyntaxError: invalid assignment left-hand side'
+TEST_ID=js1_5/extensions/regress-355736.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of "[reserved]" has extra quotes: 1 reason: Expected value ' function ( ) { [ super ] = q ; } ', Actual value ' function ( ) { [ " super " ] = q ; } '
+TEST_ID=js1_5/extensions/regress-355736.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of "[reserved]" has extra quotes: 2 reason: Expected value ' function ( ) { return { super getter : function ( ) { } } ; } ', Actual value ' function ( ) { return { ' super ' getter : function ( ) { } } ; } '
+TEST_ID=js1_5/extensions/regress-355736.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of "[reserved]" has extra quotes: 3: compile actual reason: Expected value 'No Error', Actual value 'SyntaxError: invalid assignment left-hand side'
+TEST_ID=js1_5/extensions/regress-355736.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of "[reserved]" has extra quotes: 3 reason: Expected value ' function ( ) { [ goto ] = a ; } ', Actual value ' function ( ) { [ " goto " ] = a ; } '
+TEST_ID=js1_5/extensions/regress-355820.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Remove non-standard Script object reason: Expected value 'undefined', Actual value 'function'
+TEST_ID=js1_5/extensions/regress-356085.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=js_obj_toString for getter/setter reason: Expected value ' ( { set p y ( ) { } } ) ', Actual value ' ( { set p ( ) { } } ) '
+TEST_ID=js1_5/extensions/regress-365869.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=strict warning for object literal with duplicate propery names reason: Expected value 'TypeError: redeclaration of property 1', Actual value 'No warning'
+TEST_ID=js1_5/extensions/regress-365869.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=strict warning for object literal with duplicate propery names reason: Expected value 'TypeError: redeclaration of property a', Actual value 'No warning'
+TEST_ID=js1_5/extensions/regress-367923.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=strict warning for variable redeclares argument reason: Expected value 'TypeError: variable v redeclares argument', Actual value 'TypeError: variable v hides argument'
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-371636.js:`.``*`: out of memory
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Numeric sort performance reason: Expected value '(tint/tstr < 3)=true', Actual value '(tint/tstr < 3)=false'
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Numeric sort performance reason: Expected value '(tint/tstr < 3)=true', Actual value '(tint/tstr < 3)=false'
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Numeric sort performance reason: Expected value '(tint/tstr < 3)=true', Actual value '(tint/tstr < 3)=false'
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Numeric sort performance reason: Expected value '(tint/tstr < 3)=true', Actual value '(tint/tstr < 3)=false'
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Numeric sort performance reason: Expected value '(tint/tstr < 3)=true', Actual value '(tint/tstr < 3)=false'
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Numeric sort performance reason: Expected value '(tint/tstr < 3)=true', Actual value '(tint/tstr < 3)=false'
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-371636.js:`.``*`: out of memory
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-371636.js:`.``*`: out of memory
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-371636.js:`.``*`: out of memory
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-371636.js:`.``*`: out of memory
+TEST_ID=js1_5/extensions/regress-371636.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Numeric sort performance reason: Expected value '(tint/tstr < 3)=true', Actual value '(tint/tstr < 3)=false'
+TEST_ID=js1_5/extensions/regress-375801.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=uneval should use "(void 0)" instead of "undefined": uneval reason: Expected value ' ( { a : ( void 0 ) } ) ', Actual value ' ( { a : undefined } ) '
+TEST_ID=js1_5/extensions/regress-376052.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=javascript.options.anonfunfix to allow function (){} expressions: 3 reason: Expected value 'SyntaxError: syntax error', Actual value 'No Error'
+TEST_ID=js1_5/extensions/regress-379523.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of sharp declaration: 1: compile actual reason: Expected value 'No Error', Actual value 'SyntaxError: invalid property id'
+TEST_ID=js1_5/extensions/regress-379523.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of sharp declaration: 1 reason: Expected value ' ( function ( ) { return # 1 = [ a ] ; } ) ', Actual value ' ( function ( ) { return # 1 = [ , a ] ; } ) '
+TEST_ID=js1_5/extensions/regress-379523.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of sharp declaration: 1 reason: Expected value ' ( function ( ) { return # 1 = { a : b } ; } ) ', Actual value ' ( function ( ) { return # 1 = { , a : b } ; } ) '
+TEST_ID=js1_5/extensions/regress-380831.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=uneval trying to output a getter function that is a sharp definition reason: Expected value ' ( { b getter : # 1 = ( function ( ) { } ) , c getter : # 1 # } ) ', Actual value ' ( { b getter : # 1 = ( ) { } , c getter : # 1 # } ) '
+TEST_ID=js1_5/extensions/regress-380889.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: op == JSOP_LOOKUPSWITCH, at `.``*`js.c:
+TEST_ID=js1_5/extensions/regress-380889.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: op == JSOP_LOOKUPSWITCH, at `.``*`js.c:
+TEST_ID=js1_5/extensions/regress-380889.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-381205.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=uneval with special getter functions: global reason: Expected value '({get x p() {print(4);}})', Actual value '({get x () {print(4);})'
+TEST_ID=js1_5/extensions/regress-381304.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-381304.js:`.``*`: missing : after property id
+TEST_ID=js1_5/extensions/regress-381304.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/extensions/regress-381304.js:`.``*`: SyntaxError: missing : after property id:; `.``*`/js1_5/extensions/regress-381304.js:`.``*`:     set in(value) {this.for = value;},; `.``*`/js1_5/extensions/regress-381304.js:`.``*`:
+TEST_ID=js1_5/extensions/regress-385134.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-385134.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-385134.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/extensions/regress-394967.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/extensions/regress-407019.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Do not assert: !JS_IsExceptionPending(cx) - Browser only reason: Expected match to '/Illegal operation on WrappedNative prototype object/', Actual value 'TypeError: window.Option is not a function'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("xxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") reason: Expected value 'xxx-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51', Actual value 'xxx-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") reason: Expected value '-1 99', Actual value '-001 -1'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") reason: Expected value '-51 49', Actual value '-051 -51'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") reason: Expected value '-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51', Actual value '-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051-051'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("xxxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") reason: Expected value 'Sat Jan 01 -0051 00:00:00 `.``*`', Actual value 'xxxx-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("xxxxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") reason: Expected value 'Sun Jan 01 32767 00:00:00 `.``*`', Actual value 'xxxxx2767276727672767276727672767276727672767276727672767276727672767276727672767'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("xxxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") reason: Expected value 'xxxx32767327673276732767327673276732767327673276732767327673276732767327673276732767327673276732767', Actual value 'xxxx2767276727672767276727672767276727672767276727672767276727672767276727672767'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("xxxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") reason: Expected value 'xxxx-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999', Actual value 'xxxx'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("xxxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") reason: Expected value 'Mon Jan 01 -9999 00:00:00 `.``*`', Actual value 'xxxx'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("xxxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") reason: Expected value 'Sun Jan 01 32767 00:00:00 `.``*`', Actual value 'xxxx2767276727672767276727672767276727672767276727672767276727672767276727672767276727672767'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("xxx%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") reason: Expected value 'xxx-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51', Actual value 'xxx00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") reason: Expected value '-100 00', Actual value '0/00 00'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") reason: Expected value '1851 51', Actual value '1851 ,''
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") reason: Expected value '1899 99', Actual value '1899 0/'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") reason: Expected value '-1 99', Actual value '000/ 0/'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%Y %y") reason: Expected value '-51 49', Actual value '00+/ +/'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") reason: Expected value '32767327673276732767327673276732767327673276732767327673276732767327673276732767327673276732767', Actual value '2767276727672767276727672767276727672767276727672767276727672767276727672767'
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") reason: Expected value '-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999-9999', Actual value ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
+TEST_ID=js1_5/extensions/toLocaleFormat-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y%Y") reason: Expected value '-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51-51', Actual value '00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/00+/'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%C%y") == Date.toLocaleFormat("%Y") reason: Expected value '05', Actual value '2005'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%C%y") == Date.toLocaleFormat("%Y") reason: Expected value 'Sat Jun 04 2005 20:00:00 `.``*`', Actual value '2005'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%b") == Date.toLocaleFormat("%h") reason: Expected value 'Jun', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%C") reason: Expected value '20', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%e") reason: Expected value ' 4', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%g") reason: Expected value '05', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%G") reason: Expected value '2005', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%H:%M") == Date.toLocaleFormat("%R") reason: Expected value '20:00', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%H:%M:%S") == Date.toLocaleFormat("%T") reason: Expected value '20:00:00', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%I:%M:%S %p") == Date.toLocaleFormat("%r") reason: Expected value '08:00:00 PM', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%m/%d/%y") == Date.toLocaleFormat("%D") reason: Expected value '06/04/05', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%n") == "NL" reason: Expected value 'NL', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%t") == "\t" reason: Expected value '	', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%u") reason: Expected value '6', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%V") reason: Expected value '22', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/extensions/toLocaleFormat-02.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Date.toLocaleFormat("%Y-%m-%d") == Date.toLocaleFormat("%F") reason: Expected value '2005-06-04', Actual value 'Sat Jun 04 2005 20:00:00 `.``*`'
+TEST_ID=js1_5/Function/regress-338001.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0400, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0700, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=Issues with JS_ARENA_ALLOCATE_CAST reason: Expected value 'InternalError: script stack space quota is exhausted', Actual value 'SyntaxError: malformed formal parameter'; messages: BUGNUMBER: 338121; `.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory; SyntaxError: malformed formal parameter
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Issues with JS_ARENA_ALLOCATE_CAST reason: Expected value 'InternalError: script stack space quota is exhausted', Actual value 'SyntaxError: malformed formal parameter'
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Issues with JS_ARENA_ALLOCATE_CAST reason: Expected value 'InternalError: script stack space quota is exhausted', Actual value 'SyntaxError: malformed formal parameter'; messages: BUGNUMBER: 338121; `.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory; SyntaxError: malformed formal parameter
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-01.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0400, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0700, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Issues with JS_ARENA_ALLOCATE_CAST reason: Expected value 'InternalError: script stack space quota is exhausted', Actual value 'SyntaxError: malformed formal parameter'; messages: BUGNUMBER: 338121; SyntaxError: malformed formal parameter
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=Issues with JS_ARENA_ALLOCATE_CAST reason: Expected value 'InternalError: script stack space quota is exhausted', Actual value 'SyntaxError: malformed formal parameter'; messages: BUGNUMBER: 338121; `.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory; SyntaxError: malformed formal parameter
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Issues with JS_ARENA_ALLOCATE_CAST reason: Expected value 'InternalError: script stack space quota is exhausted', Actual value 'SyntaxError: malformed formal parameter'; messages: BUGNUMBER: 338121; `.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory; SyntaxError: malformed formal parameter
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Issues with JS_ARENA_ALLOCATE_CAST reason: Expected value 'InternalError: script stack space quota is exhausted', Actual value 'SyntaxError: malformed formal parameter'
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-02.js:`.``*`: out of memory
+TEST_ID=js1_5/Function/regress-338121-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Function/regress-338121-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Function/regress-338121-03.js:`.``*`: out of memory
+TEST_ID=js1_5/GC/regress-203278-2.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/GC/regress-203278-2.js:`.``*`: out of memory
+TEST_ID=js1_5/GC/regress-311497.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-319980-01.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-338653.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0700, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/GC/regress-338653.js:`.``*`: out of memory
+TEST_ID=js1_5/GC/regress-338653.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-338653.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0700, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/GC/regress-338653.js:`.``*`: out of memory
+TEST_ID=js1_5/GC/regress-338653.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-338653.js, TEST_BRANCH=.*, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0400, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/GC/regress-338653.js, TEST_BRANCH=.*, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/GC/regress-338653.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/GC/regress-338653.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/GC/regress-338653.js:`.``*`: out of memory
+TEST_ID=js1_5/GC/regress-338653.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/GC/regress-338653.js:`.``*`: out of memory
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/GC/regress-346794.js:`.``*`: out of memory
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/GC/regress-346794.js:`.``*`: out of memory
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/GC/regress-346794.js:`.``*`: out of memory
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/GC/regress-346794.js:`.``*`: out of memory
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/GC/regress-346794.js:`.``*`: out of memory
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-346794.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/GC/regress-348532.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/GC/regress-348532.js:`.``*`: too much recursion
+TEST_ID=js1_5/GC/regress-383269-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`uncaught exception: generate_big_object_graph() leaked
+TEST_ID=js1_5/GC/regress-383269-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0400, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`uncaught exception: generate_big_object_graph() leaked
+TEST_ID=js1_5/GC/regress-383269-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*` uncaught exception: generate_big_object_graph() leaked
+TEST_ID=js1_5/GC/regress-383269-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*` uncaught exception: generate_big_object_graph() leaked
+TEST_ID=js1_5/GC/regress-383269-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`uncaught exception: generate_big_object_graph() leaked
+TEST_ID=js1_5/GC/regress-383269-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0400, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Unknown reason: :`.``*`: uncaught exception: generate_big_object_graph() leaked
+TEST_ID=js1_5/GC/regress-383269-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*` uncaught exception: generate_big_object_graph() leaked
+TEST_ID=js1_5/GC/regress-383269-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*` uncaught exception: generate_big_object_graph() leaked
+TEST_ID=js1_5/Regress/regress-203278-1.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-203278-1.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0400, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0700, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=-0400, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=.*, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-271716-n.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-271716-n.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-303213.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-303213.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-303213.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-312588.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-312588.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-312588.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-312588.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-312588.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-312588.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-319384.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-319384.js:`.``*`: can't convert "foo" to an integer
+TEST_ID=js1_5/Regress/regress-320119.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=delegating objects and arguments, arity, caller, name: arguments no longer shared reason: Expected value 'false', Actual value 'true'
+TEST_ID=js1_5/Regress/regress-320119.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=delegating objects and arguments, arity, caller, name: arity no longer shared reason: Expected value 'false', Actual value 'true'
+TEST_ID=js1_5/Regress/regress-320119.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=delegating objects and arguments, arity, caller, name: caller no longer shared reason: Expected value 'false', Actual value 'true'
+TEST_ID=js1_5/Regress/regress-320119.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=delegating objects and arguments, arity, caller, name: name no longer shared reason: Expected value 'false', Actual value 'true'
+TEST_ID=js1_5/Regress/regress-328897.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Unknown reason: :0: uncaught exception: Permission denied to get property UnnamedClass.classes
+TEST_ID=js1_5/Regress/regress-328897.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=JS_ReportPendingException should reason: Expected value 'Error', Actual value 'No Error'
+TEST_ID=js1_5/Regress/regress-328897.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Unknown reason: javascript:Components.classes:0: Script error.
+TEST_ID=js1_5/Regress/regress-329530.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-330352.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-330352.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-330352.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-330352.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-330352.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-330352.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-330352.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-346237.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-346237.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-346237.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-346237.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-346237.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-346237.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-350268.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=new Function with unbalanced braces: alert(6); } alert(5); reason: Expected value 'SyntaxError', Actual value 'No Error'
+TEST_ID=js1_5/Regress/regress-350268.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=new Function with unbalanced braces: } { reason: Expected value 'SyntaxError', Actual value 'No Error'
+TEST_ID=js1_5/Regress/regress-350268.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=new Function with unbalanced braces: } reason: Expected value 'SyntaxError', Actual value 'No Error'
+TEST_ID=js1_5/Regress/regress-350268.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=new Function with unbalanced braces: }}}}} reason: Expected value 'SyntaxError', Actual value 'No Error'
+TEST_ID=js1_5/Regress/regress-352604.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !OBJ_GET_PROTO(cx, ctor), at `.``*`jsapi.c:
+TEST_ID=js1_5/Regress/regress-352604.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !OBJ_GET_PROTO(cx, ctor), at `.``*`jsapi.c:
+TEST_ID=js1_5/Regress/regress-352604.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-362583.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: caller->fun && !JSFUN_HEAVYWEIGHT_TEST(caller->fun->flags), at `.``*`jsscript.c:
+TEST_ID=js1_5/Regress/regress-362583.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: caller->fun && !JSFUN_HEAVYWEIGHT_TEST(caller->fun->flags), at `.``*`jsscript.c:
+TEST_ID=js1_5/Regress/regress-362583.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_5/Regress/regress-3649-n.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-3649-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-3649-n.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-383674.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Statement that implicitly calls toString should not be optimized away as a "useless expression": 1 reason: Expected value 'toString called', Actual value 'toString not called'
+TEST_ID=js1_5/Regress/regress-383674.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Statement that implicitly calls toString should not be optimized away as a "useless expression": 2 reason: Expected value 'toString called', Actual value 'toString not called'
+TEST_ID=js1_5/Regress/regress-422348.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-422348.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-422348.js:`.``*`: out of memory
+TEST_ID=js1_5/Regress/regress-422348.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=No test results reported
+TEST_ID=js1_5/Regress/regress-422348.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_5/Regress/regress-422348.js:`.``*`: out of memory
+TEST_ID=js1_6/Array/regress-320887.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=var x should not throw a ReferenceError reason: Expected value 'No error', Actual value 'ReferenceError: x is not defined'
+TEST_ID=js1_6/Array/regress-386030.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Array.reduce should ignore holes: 1 reason: Expected value 'PASS', Actual value 'FAIL, reduce'
+TEST_ID=js1_6/Array/regress-386030.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Array.reduce should ignore holes: 2 reason: Expected value 'PASS', Actual value 'FAIL, reduceRight'
+TEST_ID=js1_6/Regress/regress-353078.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Do not assert with bogus toString, map, split reason: Expected value 'TypeError: can't convert global to string', Actual value 'No Crash'
+TEST_ID=js1_7/block/regress-352422.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=let declaration must be direct child of block, top-level implicit block, or switch body block reason: Expected value 'SyntaxError', Actual value ''
+TEST_ID=js1_7/block/regress-352609.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=p = {}; (p.z = [let (x = 3, y = 4) x])() reason: Expected match to '/TypeError: (p.z = \[let \(x = 3, y = 4\) x\]|.*Array.*) is not a function/', Actual value 'TypeError: p.z = [(let (x = 3, y = 4) x)] is not a function'
+TEST_ID=js1_7/block/regress-352786.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=let declaration must be direct child of block, top-level implicit block, or switch body block reason: Expected value 'SyntaxError', Actual value ''
+TEST_ID=js1_7/block/regress-352907.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=let declaration must be direct child of block, top-level implicit block, or switch body block reason: Expected value 'SyntaxError', Actual value ''
+TEST_ID=js1_7/block/regress-376410.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=let declaration must be direct child of block, top-level implicit block, or switch body block reason: Expected value 'SyntaxError', Actual value ''
+TEST_ID=js1_7/decompilation/regress-346642-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of destructuring assignment: 14 reason: Expected value ' function ( ) { while ( [ ] = e ) { } } ', Actual value ' function ( ) { while ( ( [ ] = e ) ) { } } '
+TEST_ID=js1_7/decompilation/regress-346642-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of destructuring assignment: 15 reason: Expected value ' function ( ) { while ( [ ] = a ( b ) ) { } } ', Actual value ' function ( ) { while ( ( [ ] = a ( b ) ) ) { } } '
+TEST_ID=js1_7/decompilation/regress-350704.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of let nested in for reason: Expected value ' function ( ) { try { } catch ( y ) { for ( z ( let ( y = 3 ) 4 ) ;; ) { } } } ', Actual value ' function ( ) { try { } catch ( y ) { for ( z ( ( let ( y = 3 ) 4 ) ) ;; ) { } } } '
+TEST_ID=js1_7/decompilation/regress-352026.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of yield in argument lists reason: Expected value ' function f ( ) { g ( ( ( let ( a = b ) c ) , d ) , e ) ; } ', Actual value ' function f ( ) { g ( ( let ( a = b ) c , d ) , e ) ; } '
+TEST_ID=js1_7/decompilation/regress-352079.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of various operators reason: Expected value ' function ( ) { f ( let ( y = 3 ) 4 ) ++; } ', Actual value ' function ( ) { f ( ( let ( y = 3 ) 4 ) ) ++; } '
+TEST_ID=js1_7/decompilation/regress-352272.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of |let| in arg to lvalue returning function reason: Expected value ' function ( ) { f ( let ( y = 3 ) 4 ) ++; } ', Actual value ' function ( ) { f ( ( let ( y = 3 ) 4 ) ) ++; } '
+TEST_ID=js1_7/decompilation/regress-355786.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of for (a[b, this] in []) { }: compile actual reason: Expected value 'No Error', Actual value 'SyntaxError: missing ; after for-loop initializer'
+TEST_ID=js1_7/decompilation/regress-355786.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of for (a[b, this] in []) { } reason: Expected value ' function ( ) { for ( a [ b , this ] in [ ] ) { } } ', Actual value ' function ( ) { for ( let a [ ( b , this ) ] in [ ] ) { } } '
+TEST_ID=js1_7/decompilation/regress-356247.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of let {} = [1] in a loop: g : (function() { for(let x in []) let {} = [1]; }) reason: Expected value ' function ( ) { for ( let x in [ ] ) let [ ] = [ 1 ] ; } ', Actual value ' function ( ) { for ( let x in [ ] ) { let [ ] = [ 1 ] ; } } '
+TEST_ID=js1_7/decompilation/regress-356247.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of let {} = [1] in a loop: g : (function() { while(0) let {} = [1]; }) reason: Expected value ' function ( ) { while ( 0 ) let [ ] = [ 1 ] ; } ', Actual value ' function ( ) { while ( 0 ) { let [ ] = [ 1 ] ; } } '
+TEST_ID=js1_7/decompilation/regress-375794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of array comprehension with catch guard: compile actual reason: Expected value 'No Error', Actual value 'SyntaxError: invalid for/in left-hand side'
+TEST_ID=js1_7/decompilation/regress-375794.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of array comprehension with catch guard reason: Expected value ' function ( ) { try { } catch ( a if [ b for each ( c in [ ] ) ] ) { } } ', Actual value ' function ( ) { try { } catch ( a if [ b for each ( [ ] in [ ] ) ] ) { } } '
+TEST_ID=js1_7/decompilation/regress-380506.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of nested-for and for-if comprehensions reason: Expected value ' function ( ) { return [ i * i for ( i in [ 0 ] ) if ( i % 2 ) ] ; } ', Actual value ' function ( ) { return [ i * i for ( i in [ 0 ] ) ] ; } '
+TEST_ID=js1_7/decompilation/regress-380506.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of nested-for and for-if comprehensions reason: Expected value ' function ( ) { return [ i * j for ( i in [ 0 ] ) for ( j in [ 1 ] ) ] ; } ', Actual value ' function ( ) { return [ i * j for ( i in [ 0 ] ) ] ; } '
+TEST_ID=js1_7/decompilation/regress-381108.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of object literal should have space following : reason: Expected value 'true', Actual value 'false'
+TEST_ID=js1_7/decompilation/regress-429252.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=trap should not change decompilation of { let x }: after trap reason: Expected value ' function f ( ) { { let x ; } } ', Actual value ' function f ( ) { { let x ; } let x ; } '
+TEST_ID=js1_7/expressions/regress-421806.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
+TEST_ID=js1_7/expressions/regress-421806.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
+TEST_ID=js1_7/expressions/regress-421806.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_7/extensions/regress-351102-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
+TEST_ID=js1_7/extensions/regress-351102-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
+TEST_ID=js1_7/extensions/regress-351102-04.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_7/extensions/regress-351102-05.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
+TEST_ID=js1_7/extensions/regress-351102-05.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
+TEST_ID=js1_7/extensions/regress-351102-05.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_7/extensions/regress-367629.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Decompilation of result with native function as getter reason: Expected value '({get h encodeURI() {[native code]}})', Actual value '({get h () {[native code]})'
+TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: pnprop->pn_type == TOK_COLON, at `.``*`jsparse.c:
+TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: pnprop->pn_type == TOK_COLON, at `.``*`jsparse.c:
+TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=
+TEST_ID=js1_7/extensions/regress-368224.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=; messages:
+TEST_ID=js1_7/extensions/regress-379566.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Keywords after get|set: compile actual reason: Expected value 'No Error', Actual value 'SyntaxError: missing ; before statement'
+TEST_ID=js1_7/extensions/regress-379566.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Keywords after get|set reason: Expected value ' ( { in getter : ( function ( ) { return this . for ; } ) , in setter : ( function ( value ) { this . for = value ; } ) } ) ', Actual value ' SyntaxError : missing : after property id '
+TEST_ID=js1_7/extensions/regress-380933.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Do not assert with uneval object with setter with modified proto reason: Expected match to '/TypeError: Array.prototype.toSource called on incompatible Function/', Actual value 'No Error'
+TEST_ID=js1_7/extensions/regress-381301.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=uneval of object with native-function getter reason: Expected value ' ( { get x decodeURI ( ) { [ native code ] } } ) ', Actual value ' ( { get x ( ) { [ native code ] } ) '
+TEST_ID=js1_7/extensions/regress-381303.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=object toSource when a property has both a getter and a setter reason: Expected value ' ( { get inn ( ) { return this . for ; } , set inn ( value ) { this . for = value ; } } ) ', Actual value ' ( { get inn ( ) { return this [ ' for ' ] ; } , set inn ( value ) { this [ ' for ' ] = value ; } } ) '
+TEST_ID=js1_7/geniter/regress-347739.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=generator_instance.close readonly and immune: 2 reason: Expected value 'Inside finally: 1 Inside finally: 2 ', Actual value 'Inside finally: 2 '
+TEST_ID=js1_7/geniter/regress-349012-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_7/geniter/regress-349012-01.js:`.``*`: yield from closing generator function gen() {try {try {yield 1;} finally {actual += "Inner finally";yield 2;}} finally {actual += ",Outer finally";}}
+TEST_ID=js1_7/geniter/regress-349012-01.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=closing a generator fails to report error if yield during close is ignored reason: Expected value 'Inner finally,Outer finally', Actual value ''
+TEST_ID=js1_7/geniter/regress-349331.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=test GC-invoke close reason: Expected value 'true', Actual value 'false'
+TEST_ID=js1_7/iterable/regress-340526-02.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Iterators: cross-referenced objects with close handler can delay close handler execution reason: Expected value '2', Actual value '0'
+TEST_ID=js1_7/iterable/regress-341815.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-341815.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-341815.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-341815.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-341815.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-341815.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-341815.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-341815.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-341821.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=1, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-341821.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-341821.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-341821.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-341821.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/iterable/regress-415922.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Support exception from withing JSNewEnumerateOp on JSENUMERATE_NEXT reason: Expected value 'Error: its enumeration failed', Actual value 'No exception r: color'
+TEST_ID=js1_7/lexical/regress-346642-03.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of destructuring assignment: 2 reason: Expected match to '/TypeError: x.t (has no properties|is undefined)/', Actual value 'TypeError: e1.t has no properties'
+TEST_ID=js1_7/lexical/regress-346642-03.js, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of destructuring assignment: 2 reason: Expected match to '/TypeError: x.t (has no properties|is undefined)/', Actual value 'TypeError: e1.t is undefined'
+TEST_ID=js1_7/lexical/regress-346642-03.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=decompilation of destructuring assignment: 8 reason: Expected value 'TypeError: ++x is not a function', Actual value 'TypeError: ++e1 is not a function'
+TEST_ID=js1_7/lexical/regress-351515.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Invalid uses of yield, let keywords in js17: global: yield = 1 reason: Expected value 'SyntaxError: syntax error', Actual value 'SyntaxError: yield not in function'
+TEST_ID=js1_7/regexp/yflag.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_7/regexp/yflag.js:`.``*`: invalid flag after regular expression
+TEST_ID=js1_7/regexp/yflag.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_7/regexp/yflag.js:`.``*`: SyntaxError: invalid flag after regular expression
+TEST_ID=js1_7/regress/regress-350387.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_7/regress/regress-350387.js:`.``*`: x is not defined
+TEST_ID=js1_7/regress/regress-350387.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_7/regress/regress-350387.js:`.``*`: ReferenceError: x is not defined
+TEST_ID=js1_7/regress/regress-361566.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
+TEST_ID=js1_7/regress/regress-361566.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
+TEST_ID=js1_7/regress/regress-361566.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_7/regress/regress-363040-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_7/regress/regress-363040-01.js:`.``*`: arr0elms.reduce is not a function
+TEST_ID=js1_7/regress/regress-363040-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=Test reduceRight of empty array without initializer. : TypeError: reduce of empty array with no initial value reason: Expected value 'TypeError: reduce of empty array with no initial value', Actual value 'TypeError: arr0elms.reduceRight is not a function';
+TEST_ID=js1_7/regress/regress-363040-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Test reduce of empty array without initializer. : TypeError: reduce of empty array with no initial value reason: Expected value 'TypeError: reduce of empty array with no initial value', Actual value 'TypeError: arr0elms.reduce is not a function'
+TEST_ID=js1_7/regress/regress-363040-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=Test reduceRight of empty array without initializer. : TypeError: reduce of empty array with no initial value reason: Expected value 'TypeError: reduce of empty array with no initial value', Actual value 'TypeError: arr0elms.reduceRight is not a function'
+TEST_ID=js1_7/regress/regress-363040-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*`/js1_7/regress/regress-363040-02.js:`.``*`: arr.reduce is not a function
+TEST_ID=js1_7/regress/regress-363040-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*`/js1_7/regress/regress-363040-02.js:`.``*`: TypeError: arr.reduce is not a function
+TEST_ID=js1_7/regress/regress-372331.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=browser, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=`.``*` uncaught exception: for-in binds name to early
+TEST_ID=js1_7/regress/regress-372331.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=`.``*` uncaught exception: for-in binds name to early
+TEST_ID=js1_7/regress/regress-373827-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: OBJ_GET_CLASS(cx, obj) == &js_BlockClass, at `.``*`jsinterp.c:
+TEST_ID=js1_7/regress/regress-373827-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: OBJ_GET_CLASS(cx, obj) == &js_BlockClass, at `.``*`jsinterp.c:
+TEST_ID=js1_7/regress/regress-373827-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_7/regress/regress-373827-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: OBJ_GET_CLASS(cx, obj) == &js_BlockClass, at `.``*`jsinterp.c:
+TEST_ID=js1_7/regress/regress-373827-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: OBJ_GET_CLASS(cx, obj) == &js_BlockClass, at `.``*`jsinterp.c:
+TEST_ID=js1_7/regress/regress-373827-02.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_7/regress/regress-373828.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: op == JSOP_LEAVEBLOCKEXPR ? fp->spbase + OBJ_BLOCK_DEPTH(cx, obj) == sp - 1 : fp->spbase + OBJ_BLOCK_DEPTH(cx, obj) == sp, at `.``*`jsinterp.c:
+TEST_ID=js1_7/regress/regress-373828.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: op == JSOP_LEAVEBLOCKEXPR ? fp->spbase + OBJ_BLOCK_DEPTH(cx, obj) == sp - 1 : fp->spbase + OBJ_BLOCK_DEPTH(cx, obj) == sp, at `.``*`jsinterp.c:
+TEST_ID=js1_7/regress/regress-373828.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_7/regress/regress-375695.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=darwin, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
+TEST_ID=js1_7/regress/regress-375695.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=linux, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=CRASHED.*, TEST_DESCRIPTION=`.``*`Assertion failure: !fp->blockChain || OBJ_GET_PARENT(cx, obj) == fp->blockChain, at `.``*`jsinterp.c:
+TEST_ID=js1_7/regress/regress-375695.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=.*, TEST_OS=nt, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=ABNORMAL.*, TEST_DESCRIPTION=
+TEST_ID=js1_7/regress/regress-385133-01.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=shell, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=TIMED OUT, TEST_DESCRIPTION=
+TEST_ID=js1_7/regress/regress-406477.js, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=eval of function x() in a function with an argument "x" and "let x" reason: Expected value '', Actual value 'Unexpected test_param_result value: 1NLUnexpected test_var_result value: 1NL'
+TEST_ID=js1_7/regress/regress-410649.js, TEST_BRANCH=.*, TEST_BUILDTYPE=.*, TEST_TYPE=.*, TEST_OS=.*, TEST_KERNEL=.*, TEST_PROCESSORTYPE=.*, TEST_MEMORY=.*, TEST_CPUSPEED=.*, TEST_TIMEZONE=.*, TEST_RESULT=FAILED, TEST_EXITSTATUS=NORMAL, TEST_DESCRIPTION=type for destructuring parameter case reason: Expected value 'function', Actual value 'number'
diff --git a/js/tests/remove-fixed-failures.sh b/js/tests/remove-fixed-failures.sh
new file mode 100644
--- /dev/null
+++ b/js/tests/remove-fixed-failures.sh
@@ -0,0 +1,82 @@
+#!/bin/bash
+# -*- Mode: Shell-script; tab-width: 4; indent-tabs-mode: nil; -*-
+
+# ***** BEGIN LICENSE BLOCK *****
+# Version: MPL 1.1/GPL 2.0/LGPL 2.1
+#
+# The contents of this file are subject to the Mozilla Public License Version
+# 1.1 (the "License"); you may not use this file except in compliance with
+# the License. You may obtain a copy of the License at
+# http://www.mozilla.org/MPL/
+#
+# Software distributed under the License is distributed on an "AS IS" basis,
+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+# for the specific language governing rights and limitations under the
+# License.
+#
+# The Original Code is Mozilla JavaScript Testing Utilities
+#
+# The Initial Developer of the Original Code is
+# Mozilla Corporation.
+# Portions created by the Initial Developer are Copyright (C) 2008
+# the Initial Developer. All Rights Reserved.
+#
+# Contributor(s): Bob Clary <bclary@bclary.com>
+#
+# Alternatively, the contents of this file may be used under the terms of
+# either the GNU General Public License Version 2 or later (the "GPL"), or
+# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+# in which case the provisions of the GPL or the LGPL are applicable instead
+# of those above. If you wish to allow use of your version of this file only
+# under the terms of either the GPL or the LGPL, and not to allow others to
+# use your version of this file under the terms of the MPL, indicate your
+# decision by deleting the provisions above and replace them with the notice
+# and other provisions required by the GPL or the LGPL. If you do not delete
+# the provisions above, a recipient may use your version of this file under
+# the terms of any one of the MPL, the GPL or the LGPL.
+#
+# ***** END LICENSE BLOCK *****
+
+if [[ ! -e "$1" || ! -e "$2" ]]; then
+    cat	<<EOF
+Usage: remove-fixed-failures.sh possible-fixes.log failures.log
+
+possible-fixes.log contains the possible fixes from the most recent
+test run.
+
+failures.log contains the current known failures.
+
+remove-fixed-failures.sh removes each pattern in possible-fixes.log
+from failures.log.
+
+The original failures.log is saved as failures.log.orig for safe keeping.
+
+EOF
+    exit 1
+fi
+
+fixes="$1"
+failures="$2"
+
+# save the original failures file in case of an error
+cp $failures $failures.orig
+
+# create a temporary file to contain the current list 
+# of failures.
+workfailures=`mktemp working-failures.XXXXX`
+workfixes=`mktemp working-fixes.XXXXX`
+
+trap "rm -f $workfailures; rm -f $temp" EXIT
+
+# create working copy of the failures file
+cp $failures $workfailures
+cp $fixes $workfixes
+
+sed -i 's|:[^:]*\.log||' $workfixes;
+
+grep -Fv -f $workfixes ${workfailures} > ${workfailures}.temp
+
+mv $workfailures.temp $workfailures
+
+mv $workfailures $failures
+
diff --git a/js/tests/runtests.sh b/js/tests/runtests.sh
--- a/js/tests/runtests.sh
+++ b/js/tests/runtests.sh
@@ -33,23 +33,23 @@
 # decision by deleting the provisions above and replace them with the notice
 # and other provisions required by the GPL or the LGPL. If you do not delete
 # the provisions above, a recipient may use your version of this file under
 # the terms of any one of the MPL, the GPL or the LGPL.
 #
 # ***** END LICENSE BLOCK *****
 
 if [[ -z "$TEST_DIR" ]]; then
-  cat <<EOF
+    cat <<EOF
 `basename $0`: error
 
 TEST_DIR, the location of the Sisyphus framework, 
 is required to be set prior to calling this script.
 EOF
-  exit 2
+    exit 2
 fi
 
 if [[ ! -e $TEST_DIR/bin/library.sh ]]; then
     echo "TEST_DIR=$TEST_DIR"
     echo ""
     echo "This script requires the Sisyphus testing framework. Please "
     echo "cvs check out the Sisyphys framework from mozilla/testing/sisyphus"
     echo "and set the environment variable TEST_DIR to the directory where it"
@@ -61,78 +61,75 @@ fi
 
 source $TEST_DIR/bin/library.sh
 
 TEST_JSDIR=`dirname $0`
 
 usage()
 {
     cat <<EOF
-usage: runtests.sh -p products -b branches -T  buildtypes -B buildcommands  -e extra [-v] \\
-                   -S -R -X excludetests -I includetests -c -t
+usage: runtests.sh -p products -b branches -e extra\\
+                   -T  buildtypes -B buildcommands  \\
+                   [-v] [-S] [-X excludetests] [-I includetests] [-c] [-t] \\
+                   [-Z n]
 
 variable            description
 ===============     ============================================================
 -p products         space separated list of js, firefox
--b branches         space separated list of branches 1.8.0, 1.8.1, 1.9.0
+-b branches         space separated list of branches 1.8.0, 1.8.1, 1.9.0, 1.9.1
+-e extra            optional. extra qualifier to pick build tree and mozconfig.
 -T buildtypes       space separated list of build types opt debug
--e extra            optional. extra qualifier to pick build tree and mozconfig.
 -B buildcommands    optional space separated list of build commands
                     clean, checkout, build. If not specified, defaults to
                     'clean checkout build'. 
                     If you wish to skip any build steps, simply specify a value
                     not containing any of the build commands, e.g. 'none'.
 -v                  optional. verbose - copies log file output to stdout.
 -S                  optional. summary - output tailered for use with
                     Buildbot|Tinderbox
--R                  optional. by default the browser test will start Firefox
-                    Spider and execute the tests one after another in the same
-                    process. -R will start an new instance of Firefox for each
-                    test. This has no effect for shell based tests.
 -X excludetests     optional. By default the test will exclude the 
                     tests listed in spidermonkey-n-\$branch.tests, 
                     performance-\$branch.tests. excludetests is a list of either
                     individual tests, manifest files or sub-directories which 
                     will override the default exclusion list.
 -I includetests     optional. By default the test will include the 
                     JavaScript tests appropriate for the branch. includetests is a
                     list of either individual tests, manifest files or 
                     sub-directories which will override the default inclusion 
                     list.
--Z n                optional. Set gczeal to n. Currently, only valid for 
-                    Gecko 1.9.0 and later.
 -c                  optional. By default the test will exclude tests 
                     which crash on this branch, test type, build type and 
                     operating system. -c will include tests which crash. 
                     Typically this should only be used in combination with -R. 
                     This has no effect on shell based tests which execute crash
                     tests regardless.
 -t                  optional. By default the test will exclude tests 
                     which time out on this branch, test type, build type and 
                     operating system. -t will include tests which timeout.
+-Z n                optional. Set gczeal to n. Currently, only valid for 
+                    debug builds of Gecko 1.8.1.15, 1.9.0 and later.
 
 if an argument contains more than one value, it must be quoted.
 EOF
     exit 2
 }
 
 verbose=0
 
-while getopts "p:b:T:B:e:X:I:Z:vSRct" optname;
+while getopts "p:b:T:B:e:X:I:Z:vSct" optname;
 do
     case $optname in
         p) products=$OPTARG;;
         b) branches=$OPTARG;;
         T) buildtypes=$OPTARG;;
         e) extra="$OPTARG"
             extraflag="-e $OPTARG";;
         B) buildcommands=$OPTARG;;
         v) verbose=1
             verboseflag="-v";;
-        R) restart=1;;
         S) summary=1;;
         X) excludetests=$OPTARG;;
         I) includetests=$OPTARG;;
         Z) gczeal="-Z $OPTARG";;
         c) crashes=1;;
         t) timeouts=1;;
     esac
 done
@@ -175,68 +172,66 @@ testlogfiles="`grep '^log:' $testlogfile
 
 fatalerrors=`grep 'FATAL ERROR' $testlogfiles | cat`
 if [[ -n "$fatalerrors" ]]; then
     testlogarray=( $testlogfiles )
     let itestlog=${#testlogarray[*]}-1
     error "`tail -n 20 ${testlogarray[$itestlog]}`" $LINENO
 fi
 
-case "$OSID" in
-    win32)
-        arch=all
-        kernel=all
-        ;;
-    linux)
-        arch="`uname -p`"
-        kernel="`uname -r | sed 's|\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\)[-.0-9]*\.\([a-zA-Z0-9]*\)|\1.\2.\3.*\4|'`"
-        ;;
-    mac)
-        arch="`uname -p`"
-        kernel=all
-        ;;
-    *)
-        error "$OSID not supported" $LINENO
-        ;;
-esac
-
 for testlogfile in $testlogfiles; do
 
     if [[ -n "$DEBUG" ]]; then
         dumpvars testlogfile
     fi
 
     case "$testlogfile" in
         *,js,*) testtype=shell;;
         *,firefox,*) testtype=browser;;
         *) error "unknown testtype in logfile $testlogfile" $LINENO;;
     esac
+
     case "$testlogfile" in
         *,opt,*) buildtype=opt;;
         *,debug,*) buildtype=debug;;
+        *,nightly,*) buildtype=opt;;
         *) error "unknown buildtype in logfile $testlogfile" $LINENO;;
     esac
+
     case "$testlogfile" in
         *,1.8.0*) branch=1.8.0;;
         *,1.8.1*) branch=1.8.1;;
         *,1.9.0*) branch=1.9.0;;
+        *,1.9.1*) branch=1.9.1;;
         *) error "unknown branch in logfile $testlogfile" $LINENO;;
     esac
     outputprefix=$testlogfile
 
     if [[ -n "$DEBUG" ]]; then
-        dumpvars branch buildtype testtype OSID testlogfile arch kernel outputprefix
+        dumpvars branch buildtype testtype OSID testlogfile TEST_PROCESSORTYPE TEST_KERNEL outputprefix
     fi
 
-    if ! $TEST_DIR/tests/mozilla.org/js/known-failures.pl -b $branch -T $buildtype -t $testtype -o "$OSID" -z `date +%z` -l $testlogfile -A "$arch" -K "$kernel" -r $TEST_JSDIR/failures.txt -O $outputprefix; then
+    if ! $TEST_DIR/tests/mozilla.org/js/known-failures.pl \
+        -b $branch \
+        -T $buildtype \
+        -t $testtype \
+        -o "$OSID" \
+        -K "$TEST_KERNEL" \
+        -A "$TEST_PROCESSORTYPE" \
+        -M "$TEST_MEMORY" \
+        -S "$TEST_CPUSPEED" \
+        -z `date +%z` \
+        -l $testlogfile \
+        -r $TEST_JSDIR/failures.txt \
+        -O $outputprefix; then
         error "known-failures.pl" $LINENO
     fi
 
     if [[ -n "$summary" ]]; then
-        
+
         # use let to work around mac problem where numbers were
         # output with leading characters.
         # if let's arg evaluates to 0, let will return 1
         # so we need to test
 
         if let npass="`grep TEST_RESULT=PASSED ${outputprefix}-results-all.log | wc -l`"; then true; fi
         if let nfail="`cat ${outputprefix}-results-failures.log | wc -l`"; then true; fi
         if let nfixes="`cat ${outputprefix}-results-possible-fixes.log | wc -l`"; then true; fi
@@ -247,11 +242,11 @@ for testlogfile in $testlogfiles; do
         cat "${outputprefix}-results-failures.log"
         echo -e "\nPossible Fixes:\n"
         cat "${outputprefix}-results-possible-fixes.log"
         echo -e "\nPossible Regressions:\n"
         cat "${outputprefix}-results-possible-regressions.log"
         echo -e "\nTinderboxPrint:<div title=\"$testlogfile\">\n"
         echo -e "\nTinderboxPrint:js tests<br/>$branch $buildtype $testtype<br/>$npass/$nfail<br/>F:$nfixes R:$nregressions"
         echo -e "\nTinderboxPrint:</div>\n"
+    fi
 
-    fi
 done
diff --git a/js/tests/shell.js b/js/tests/shell.js
--- a/js/tests/shell.js
+++ b/js/tests/shell.js
@@ -155,18 +155,18 @@ function TestCase(n, d, e, a)
 }
 
 TestCase.prototype.dump = function () {
   dump('\njstest: '      + this.path + ' ' +
        'bug: '         + this.bugnumber + ' ' +
        'result: '      + (this.passed ? 'PASSED':'FAILED') + ' ' +
        'type: '        + this.type + ' ' +
        'description: ' + toPrinted(this.description) + ' ' +
-       'expected: '    + toPrinted(this.expect) + ' ' +
-       'actual: '      + toPrinted(this.actual) + ' ' +
+//       'expected: '    + toPrinted(this.expect) + ' ' +
+//       'actual: '      + toPrinted(this.actual) + ' ' +
        'reason: '      + toPrinted(this.reason) + '\n');
 };
 
 /*
  * The test driver searches for such a phrase in the test output.
  * If such phrase exists, it will set n as the expected exit code.
  */
 function expectExitCode(n)
diff --git a/js/tests/sisyphus-javascript.patch b/js/tests/sisyphus-javascript.patch
new file mode 100644
--- /dev/null
+++ b/js/tests/sisyphus-javascript.patch
@@ -0,0 +1,4577 @@
+Index: Makefile
+===================================================================
+RCS file: /cvsroot/mozilla/js/tests/Makefile,v
+retrieving revision 1.16
+diff -p -U 8 -r1.16 Makefile
+--- Makefile	6 Feb 2008 20:06:39 -0000	1.16
++++ Makefile	25 Jun 2008 17:31:15 -0000
+@@ -17,21 +17,19 @@ spidermonkey-extensions-n.tests: $(TEST_
+ 	find . -name '*.js' | grep -v shell.js | grep -v browser.js | grep '/extensions/' | sed 's|\.\/||' | sort > $@
+ 
+ menu-list.txt:
+ 	echo "http://$(TEST_HTTP)/tests/mozilla.org/$(JSDIR)/menu.html" > menu-list.txt
+ 
+ confidential-failures.txt:
+ 	touch confidential-failures.txt
+ 
+-failures.txt: public-failures.txt confidential-failures.txt
+-	cp public-failures.txt public-failures.txt.save
+-	cp confidential-failures.txt confidential-failures.txt.save
+-	sort < public-failures.txt | uniq | ./create-patterns.pl > public-failures.$$
+-	mv public-failures.$$ public-failures.txt
+-	sort < confidential-failures.txt | uniq | ./create-patterns.pl > confidential-failures.$$
+-	mv confidential-failures.$$ confidential-failures.txt
+-	cat public-failures.txt confidential-failures.txt | sort | uniq > failures.txt
++public-failures.txt.expanded: public-failures.txt universe.data
++	pattern-expander.pl public-failures.txt > public-failures.txt.expanded
+ 
+-clean:
+-	rm -f menubody.html menu.html menu-list.txt failures.txt excluded-*.tests included-*.tests urllist*.html urllist*.tests
++confidential-failures.txt.expanded: confidential-failures.txt universe.data
++	pattern-expander.pl confidential-failures.txt > confidential-failures.txt.expanded
+ 
++failures.txt: public-failures.txt.expanded confidential-failures.txt.expanded
++	sort -u public-failures.txt.expanded confidential-failures.txt.expanded > failures.txt
+ 
++clean:
++	rm -f menubody.html menu.html menu-list.txt failures.txt *failures.txt.expanded excluded-*.tests included-*.tests urllist*.html urllist*.tests
+Index: Patterns.pm
+===================================================================
+RCS file: Patterns.pm
+diff -N Patterns.pm
+--- /dev/null	1 Jan 1970 00:00:00 -0000
++++ Patterns.pm	25 Jun 2008 17:31:15 -0000
+@@ -0,0 +1,223 @@
++# -*- Mode: Perl; tab-width: 4; indent-tabs-mode: nil; -*-
++# ***** BEGIN LICENSE BLOCK *****
++# Version: MPL 1.1/GPL 2.0/LGPL 2.1
++#
++# The contents of this file are subject to the Mozilla Public License Version
++# 1.1 (the "License"); you may not use this file except in compliance with
++# the License. You may obtain a copy of the License at
++# http://www.mozilla.org/MPL/
++#
++# Software distributed under the License is distributed on an "AS IS" basis,
++# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
++# for the specific language governing rights and limitations under the
++# License.
++#
++# The Original Code is Mozilla JavaScript Testing Utilities
++#
++# The Initial Developer of the Original Code is
++# Mozilla Corporation.
++# Portions created by the Initial Developer are Copyright (C) 2008
++# the Initial Developer. All Rights Reserved.
++#
++# Contributor(s): Bob Clary <bclary@bclary.com>
++#
++# Alternatively, the contents of this file may be used under the terms of
++# either the GNU General Public License Version 2 or later (the "GPL"), or
++# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
++# in which case the provisions of the GPL or the LGPL are applicable instead
++# of those above. If you wish to allow use of your version of this file only
++# under the terms of either the GPL or the LGPL, and not to allow others to
++# use your version of this file under the terms of the MPL, indicate your
++# decision by deleting the provisions above and replace them with the notice
++# and other provisions required by the GPL or the LGPL. If you do not delete
++# the provisions above, a recipient may use your version of this file under
++# the terms of any one of the MPL, the GPL or the LGPL.
++#
++# ***** END LICENSE BLOCK *****
++
++package Patterns;
++
++sub getuniversekey
++{
++    my ($machinerecord, $excludeduniversefield) = @_;
++    my $i;
++    my $key = '';
++
++#    dbg("getuniversekey: \$machinerecord=" . recordtostring($machinerecord) . ", \$excludeduniversefield=$excludeduniversefield");
++
++    for ($i = 0; $i < @universefields; $i++)
++    {
++#	dbg("getuniversekey: \$universefields[$i]=$universefields[$i]");
++
++        if ($universefields[$i] ne $excludeduniversefield)
++        {
++            $key .= $machinerecord->{$universefields[$i]}
++        }
++    }
++
++#    dbg("getuniversekey=$key");
++
++    return $key;
++}
++
++sub getuniverse
++{
++    my ($universekey, $excludeduniversefield) = @_;
++    my $i;
++    my $value;
++    my $testrun;
++    my @universe = ();
++    my %universehash = ();
++
++    dbg("getuniverse: \$universekey=$universekey, \$excludeduniversefield=$excludeduniversefield");
++
++    for ($i = 0; $i < @testruns; $i++)
++    {
++        $testrun = $testruns[$i];
++#	dbg("getuniverse: \$testruns[$i]=" . recordtostring($testrun));
++        $testrununiversekey = getuniversekey($testrun, $excludeduniversefield);
++#	dbg("getuniverse: \$testrununiversekey=$testrununiversekey");
++        if ($testrununiversekey =~ /$universekey/)
++        {
++#	    dbg("getuniverse: matched \$testrununiversekey=$testrununiversekey to \$universekey=$universekey");
++            $value = $testrun->{$excludeduniversefield};
++            
++#	    dbg("getuniverse: \$testrun->{$excludeduniversefield}=$value");
++
++            if (! $universehash{$value} )
++            {
++#		dbg("getuniverse: pushing $value");
++                push @universe, ($value);
++                $universehash{$value} = 1;
++            }
++        }
++    }
++    @universe = sort @universe;
++    dbg("getuniverse=" . join(',', @universe));
++    return @universe;
++}
++
++sub recordtostring
++{
++    my ($record) = @_;
++    my $j;
++    my $line   = '';
++    my $field;
++
++    for ($j = 0; $j < @recordfields - 1; $j++)
++    {
++        $field = $recordfields[$j];
++#	dbg("recordtostring: \$field=$field, \$record->{$field}=$record->{$field}");
++        $line .= "$field=$record->{$field}, ";
++    }
++    $field = $recordfields[$#recordfields];
++#    dbg("recordtodtring: \$field=$field, \$record->{$field}= $record->{$field}");
++    $line .= "$field=$record->{$field}";
++
++    return $line;
++}
++
++sub dumprecords
++{
++    my $record;
++    my $line;
++    my $prevline = '';
++    my $i;
++
++    dbg("dumping records");
++
++#    @records = sort sortrecords @records;
++
++    for ($i = 0; $i < @records; $i++)
++    {
++        $record = $records[$i];
++        $line   = recordtostring($record);
++        if ($line eq $prevline)
++        {
++#            dbg("DUPLICATE $line") if ($DEBUG);
++        }
++        else
++        {
++            print "$line\n";
++            $prevline = $line;
++        }
++    }
++}
++
++sub sortrecords
++{
++    return recordtostring($a) cmp recordtostring($b);
++}
++
++sub dbg 
++{
++    if ($DEBUG)
++    {
++	print STDERR "DEBUG: " . join(" ", @_) . "\n";
++    }
++}
++
++sub copyreference
++{
++    my ($fromreference) = @_;
++    my $toreference = {};
++    my $key;
++
++    foreach $key (keys %{$fromreference})
++    {
++	$toreference->{$key} = $fromreference->{$key};
++    }
++    return $toreference;
++}
++
++#my @recordfields;
++#my @universefields;
++#my %machines;
++#my @testruns;
++
++
++BEGIN 
++{
++    dbg("begin");
++
++    my $test_dir = $ENV{TEST_DIR} || "/work/mozilla/mozilla.com/test.mozilla.com/www";
++
++    $DEBUG = $ENV{DEBUG};
++
++    @recordfields   = ('TEST_ID', 'TEST_BRANCH', 'TEST_BUILDTYPE', 'TEST_TYPE', 'TEST_OS', 'TEST_KERNEL', 'TEST_PROCESSORTYPE', 'TEST_MEMORY', 'TEST_CPUSPEED', 'TEST_TIMEZONE', 'TEST_RESULT', 'TEST_EXITSTATUS', 'TEST_DESCRIPTION');
++    @sortkeyfields  = ('TEST_ID', 'TEST_RESULT', 'TEST_EXITSTATUS', 'TEST_DESCRIPTION', 'TEST_BRANCH', 'TEST_BUILDTYPE', 'TEST_TYPE', 'TEST_OS', 'TEST_KERNEL', 'TEST_PROCESSORTYPE', 'TEST_MEMORY', 'TEST_CPUSPEED', 'TEST_TIMEZONE', );
++    @universefields = ('TEST_BRANCH', 'TEST_BUILDTYPE', 'TEST_TYPE', 'TEST_OS', 'TEST_KERNEL', 'TEST_PROCESSORTYPE', 'TEST_MEMORY', 'TEST_CPUSPEED', 'TEST_TIMEZONE');
++
++    @records = ();
++
++    @testruns = ();
++
++    open TESTRUNS, "<$test_dir/tests/mozilla.org/js/universe.data" or die "$?";
++
++    while (<TESTRUNS>) {
++
++        chomp;
++
++        my $record = {};
++
++        my ($test_os, $test_kernel, $test_processortype, $test_memory, $test_cpuspeed, $test_timezone, $test_branch, $test_buildtype, $test_type) = $_ =~ 
++            /^TEST_OS=([^,]*), TEST_KERNEL=([^,]*), TEST_PROCESSORTYPE=([^,]*), TEST_MEMORY=([^,]*), TEST_CPUSPEED=([^,]*), TEST_TIMEZONE=([^,]*), TEST_BRANCH=([^,]*), TEST_BUILDTYPE=([^,]*), TEST_TYPE=([^,]*)/;
++
++        $record->{TEST_BRANCH}        = $test_branch;
++        $record->{TEST_BUILDTYPE}     = $test_buildtype;
++        $record->{TEST_TYPE}          = $test_type;
++        $record->{TEST_OS}            = $test_os;
++        $record->{TEST_KERNEL}        = $test_kernel;
++        $record->{TEST_PROCESSORTYPE} = $test_processortype;
++        $record->{TEST_MEMORY}        = $test_memory;
++        $record->{TEST_CPUSPEED}      = $test_cpuspeed;
++        $record->{TEST_TIMEZONE}      = $test_timezone;
++
++	push @testruns, ($record);
++    }
++
++    close TESTRUNS;
++
++}
++
++1;
+Index: changes.sh
+===================================================================
+RCS file: changes.sh
+diff -N changes.sh
+--- /dev/null	1 Jan 1970 00:00:00 -0000
++++ changes.sh	25 Jun 2008 17:31:15 -0000
+@@ -0,0 +1,120 @@
++#!/bin/bash
++# -*- Mode: Shell-script; tab-width: 4; indent-tabs-mode: nil; -*-
++
++# ***** BEGIN LICENSE BLOCK *****
++# Version: MPL 1.1/GPL 2.0/LGPL 2.1
++#
++# The contents of this file are subject to the Mozilla Public License Version
++# 1.1 (the "License"); you may not use this file except in compliance with
++# the License. You may obtain a copy of the License at
++# http://www.mozilla.org/MPL/
++#
++# Software distributed under the License is distributed on an "AS IS" basis,
++# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
++# for the specific language governing rights and limitations under the
++# License.
++#
++# The Original Code is Mozilla JavaScript Testing Utilities
++#
++# The Initial Developer of the Original Code is
++# Mozilla Corporation.
++# Portions created by the Initial Developer are Copyright (C) 2008
++# the Initial Developer. All Rights Reserved.
++#
++# Contributor(s): Bob Clary <bclary@bclary.com>
++#
++# Alternatively, the contents of this file may be used under the terms of
++# either the GNU General Public License Version 2 or later (the "GPL"), or
++# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
++# in which case the provisions of the GPL or the LGPL are applicable instead
++# of those above. If you wish to allow use of your version of this file only
++# under the terms of either the GPL or the LGPL, and not to allow others to
++# use your version of this file under the terms of the MPL, indicate your
++# decision by deleting the provisions above and replace them with the notice
++# and other provisions required by the GPL or the LGPL. If you do not delete
++# the provisions above, a recipient may use your version of this file under
++# the terms of any one of the MPL, the GPL or the LGPL.
++#
++# ***** END LICENSE BLOCK *****
++
++# usage: changes.sh [prefix]
++# 
++# combines the {prefix}*possible-fixes.log files into {prefix}possible-fixes.log
++# and {prefix}*possible-regressions.log files into 
++# possible-regressions.log.
++#
++# This script is useful in cases where log files from different machines, branches
++# and builds are being investigated.
++
++if cat /dev/null | sed -r 'q' > /dev/null 2>&1; then
++   SED="sed -r"
++elif cat /dev/null | sed -E 'q' > /dev/null 2>&1; then
++   SED="sed -E"
++else
++   echo "Neither sed -r or sed -E is supported"
++   exit 2
++fi
++
++workfile=`mktemp work.XXXXXXXX`
++if [ $? -ne 0 ]; then
++    echo "Unable to create working temp file"
++    exit 2
++fi
++
++for f in ${1}*results-possible-fixes.log*; do
++    case $f in
++	*.log)
++	    CAT=cat
++	    ;;
++	*.log.bz2)
++	    CAT=bzcat
++	    ;;
++	*.log.gz)
++	    CAT=zcat
++	    ;;
++	*.log.zip)
++	    CAT="unzip -c"
++	    ;;
++	*)
++	    echo "unknown log type: $f"
++	    exit 2
++	    ;;
++    esac
++
++    $CAT $f | $SED "s|$|:$f|" >> $workfile
++
++done
++
++sort -u $workfile > ${1}possible-fixes.log
++
++rm $workfile
++
++
++for f in ${1}*results-possible-regressions.log*; do
++    case $f in
++	*.log)
++	    CAT=cat
++	    ;;
++	*.log.bz2)
++	    CAT=bzcat
++	    ;;
++	*.log.gz)
++	    CAT=zcat
++	    ;;
++	*.log.zip)
++	    CAT="unzip -c"
++	    ;;
++	*)
++	    echo "unknown log type: $f"
++	    exit 2
++	    ;;
++    esac
++    $CAT $f >> $workfile
++done
++
++sort -u $workfile > ${1}possible-regressions.log
++
++rm $workfile
++
++
++
+Index: create-patterns.pl
+===================================================================
+RCS file: create-patterns.pl
+diff -N create-patterns.pl
+--- create-patterns.pl	1 Oct 2007 19:10:41 -0000	1.1
++++ /dev/null	1 Jan 1970 00:00:00 -0000
+@@ -1,264 +0,0 @@
+-#!/usr/bin/perl
+-# -*- Mode: Perl; tab-width: 4; indent-tabs-mode: nil; -*-
+-
+-# ***** BEGIN LICENSE BLOCK *****
+-# Version: MPL 1.1/GPL 2.0/LGPL 2.1
+-#
+-# The contents of this file are subject to the Mozilla Public License Version
+-# 1.1 (the "License"); you may not use this file except in compliance with
+-# the License. You may obtain a copy of the License at
+-# http://www.mozilla.org/MPL/
+-#
+-# Software distributed under the License is distributed on an "AS IS" basis,
+-# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+-# for the specific language governing rights and limitations under the
+-# License.
+-#
+-# The Original Code is Mozilla JavaScript Testing Utilities
+-#
+-# The Initial Developer of the Original Code is
+-# Mozilla Corporation.
+-# Portions created by the Initial Developer are Copyright (C) 2007
+-# the Initial Developer. All Rights Reserved.
+-#
+-# Contributor(s): Bob Clary <bclary@bclary.com>
+-#
+-# Alternatively, the contents of this file may be used under the terms of
+-# either the GNU General Public License Version 2 or later (the "GPL"), or
+-# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+-# in which case the provisions of the GPL or the LGPL are applicable instead
+-# of those above. If you wish to allow use of your version of this file only
+-# under the terms of either the GPL or the LGPL, and not to allow others to
+-# use your version of this file under the terms of the MPL, indicate your
+-# decision by deleting the provisions above and replace them with the notice
+-# and other provisions required by the GPL or the LGPL. If you do not delete
+-# the provisions above, a recipient may use your version of this file under
+-# the terms of any one of the MPL, the GPL or the LGPL.
+-#
+-# ***** END LICENSE BLOCK *****
+-
+-# make stderr, stdout unbuffered
+-
+-select STDERR; $| = 1;
+-select STDOUT; $| = 1;
+-
+-my $regchars = '\[\^\-\]\|\{\}\?\*\+\.\<\>\$\(\)';
+-
+-sub escape_patterns;
+-sub unescape_patterns;
+-sub debug;
+-
+-my $debug = $ENV{DEBUG};
+-my @outputlines = ();
+-my @inputlines = ();
+-
+-while (<ARGV>) {
+-    chomp;
+-
+-    # remove irrelevant data the caller is required to remove any
+-    # other data which should not be considered during the
+-    # consolidation such as TEST_MACHINE, etc.
+-
+-    s/TEST_DATE=[^,]*,/TEST_DATE=.*,/;
+-
+-    push @inputlines, ($_);
+-
+-}
+-
+-my @fieldnames = ('TEST_BRANCH', 'TEST_BUILDTYPE', 'TEST_TYPE', 'TEST_OS', 'TEST_PROCESSORTYPE', 'TEST_KERNEL', 'TEST_TIMEZONE');
+-
+-my $pass = 0;
+-my $changed = 1;
+-
+-while ($changed) {
+-
+-    # repeated loop until no changes are made.
+-
+-    ++$pass;
+-    $changed = 0;
+-
+-    debug "pass $pass, " . ($#inputlines + 1) . " inputlines, " . ($#outputlines + 1) . " outputlines\n";
+-
+-    foreach $field (@fieldnames) {
+-
+-        debug "pass $pass, processing $field, " . ($#inputlines + 1) . " inputlines, " . ($#outputlines + 1) . " outputlines\n";
+-
+-        # process each field across all lines so that later consolidations
+-        # will match consolidated field values
+-
+-        while ($inputline = shift(@inputlines)) {
+-
+-            debug "inputline $inputline\n";
+-
+-            # get the current field value from the current input line
+-
+-            ($inputvalue) = $inputline =~ /$field=\(?([^,\)]*)\)?,/;
+-
+-            if ($inputvalue eq '.*') {
+-
+-                # if the current input value is the any wildcard,
+-                # then there is no need to perform a consolidation
+-                # on the field.
+-
+-                push @outputlines, ($inputline);
+-
+-                next;
+-            }
+-
+-            # turn "off" any regular expression characters in the input line
+-
+-            $pattern = escape_pattern($inputline);
+-
+-            # Make the current field in the current pattern an any
+-            # wildcard so that it will match any value. We are looking
+-            # for all other lines that only differ from the current line by
+-            # the current field value 
+-
+-            $pattern =~ s/$field=[^,]*,/$field=.*,/;
+-
+-            # find the matches to the current pattern
+-
+-            debug "pattern: $pattern\n";
+-
+-            @matched   = grep /$pattern/, (@inputlines, @outputlines);
+-            @unmatched = grep !/$pattern/, @inputlines;
+-
+-            debug "" . ($#matched + 1) . " matched, " . ($#unmatched + 1) . " unmatched, " . ($#inputlines + 1) . " inputlines, " . ($#outputlines + 1) . " outputlines\n";
+-
+-            if (@matched) {
+-
+-                # the input line matched others
+-
+-                $outputvalue = $inputvalue;
+-
+-                foreach $matchline (@matched) {
+-
+-                    ($matchvalue) = $matchline =~ /$field=\(?([^,\)]*)\)?,/;
+-
+-                    if ( $inputvalue !~ /$matchvalue/ && $matchvalue !~ /$inputvalue/) {
+-
+-                        # the current match value and input value
+-                        # do not overlap so add the match
+-                        # field value as regular expression
+-                        # alternation | to the current field value 
+-
+-                        debug "adding regexp alternation to $field: inputvalue: $inputvalue, matchvalue: $matchvalue";
+-
+-                        $outputvalue .= "|$matchvalue";
+-                    }
+-                } # foreach matchline
+-
+-                # replace the current inputs field value with the
+-                # consolidated value
+-
+-                if ($outputvalue =~ /\|/) {
+-                    $outputvalue = "(" . join('|', sort(split(/\|/, $outputvalue))) . ")";
+-                }
+-                $inputline =~ s/$field=[^,]*,/$field=$outputvalue,/;
+-                debug "$inputline\n";
+-
+-                $changes = 1;
+-            }
+-            push @outputlines, ($inputline);
+-
+-            @inputlines = @unmatched;
+-
+-        } # while inputline
+-        
+-        @inputlines = @outputlines;
+-        @outputlines = ();
+-
+-    } # foreach field
+-}
+-
+-@inputlines = sort @inputlines;
+-
+-my $output = join"\n", @inputlines;
+-
+-debug "output: " . ($#inputlines + 1) . " lines\n";
+-
+-print "$output\n";
+-
+-### # look for over specified failures
+-### 
+-### $field = 'TEST_DESCRIPTION';
+-### 
+-### while ($inputline = shift(@inputlines)) {
+-### 
+-###     debug "inputline $inputline\n";
+-### 
+-###     # turn "off" any regular expression characters in the input line
+-### 
+-###     $pattern = escape_pattern($inputline);
+-### 
+-###     # Make the TEST_DESCRIPTION field in the current pattern an any
+-###     # wildcard so that it will match any value. We are looking
+-###     # for all other lines that only differ from the current line by
+-###     # the TEST_DESCRIPTION. These will be the potentially overspecified 
+-###     # failures.
+-### 
+-###     $pattern =~ s/$field=[^,]*,/$field=.*,/;
+-### 
+-###     # find the matches to the current pattern
+-### 
+-###     debug "pattern: $pattern\n";
+-### 
+-###     @matched   = grep /$pattern/, @inputlines;
+-###     @unmatched = grep !/$pattern/, @inputlines;
+-### 
+-###     debug "" . ($#matched + 1) . " matched, " . ($#unmatched + 1) . " unmatched, " . ($#inputlines + 1) . " inputlines, " . ($#outputlines + 1) . " outputlines\n";
+-### 
+-###     if (@matched) {
+-### 
+-###         # the inputline overspecifies an error
+-### 
+-###         push @matched, ($inputline);
+-### 
+-###         foreach $matchline (@matched) {
+-### 
+-###             print STDERR "OVERSPECIFIED? : $matchline\n";
+-### 
+-###         } # foreach matchline
+-### 
+-###     }
+-### 
+-###     @inputlines = @unmatched;
+-### 
+-### } # while inputline
+-### 
+-
+-
+-
+-sub escape_pattern {
+-
+-    # unlike the known-failures.pl, this escape escapes the entire 
+-    # line to make it not contain any active regular expression patterns
+-    # so that any matched will be literal and not regular
+-    my $line = shift;
+-
+-    chomp;
+-
+-    # replace unescaped regular expression characters in the 
+-    # description so they are not interpreted as regexp chars
+-    # when matching descriptions. leave the escaped regexp chars
+-    # `regexp alone so they can be unescaped later and used in 
+-    # pattern matching.
+-
+-    # see perldoc perlre
+-
+-    $line =~ s/\\/\\\\/g;
+-
+-    # escape regexpchars
+-    $line =~ s/([$regchars])/\\$1/g;
+-
+-    return "$line";
+-
+-}
+-
+-sub debug {
+-    my $msg;
+-    if ($debug) {
+-        $msg = shift;
+-        print "DEBUG: $msg\n";
+-    }
+-}
+Index: get-universe.sh
+===================================================================
+RCS file: get-universe.sh
+diff -N get-universe.sh
+--- /dev/null	1 Jan 1970 00:00:00 -0000
++++ get-universe.sh	25 Jun 2008 17:31:15 -0000
+@@ -0,0 +1,48 @@
++#!/bin/bash -e
++# -*- Mode: Shell-script; tab-width: 4; indent-tabs-mode: nil; -*-
++
++# ***** BEGIN LICENSE BLOCK *****
++# Version: MPL 1.1/GPL 2.0/LGPL 2.1
++#
++# The contents of this file are subject to the Mozilla Public License Version
++# 1.1 (the "License"); you may not use this file except in compliance with
++# the License. You may obtain a copy of the License at
++# http://www.mozilla.org/MPL/
++#
++# Software distributed under the License is distributed on an "AS IS" basis,
++# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
++# for the specific language governing rights and limitations under the
++# License.
++#
++# The Original Code is Mozilla JavaScript Testing Utilities
++#
++# The Initial Developer of the Original Code is
++# Mozilla Corporation.
++# Portions created by the Initial Developer are Copyright (C) 2007
++# the Initial Developer. All Rights Reserved.
++#
++# Contributor(s): Bob Clary <bclary@bclary.com>
++#
++# Alternatively, the contents of this file may be used under the terms of
++# either the GNU General Public License Version 2 or later (the "GPL"), or
++# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
++# in which case the provisions of the GPL or the LGPL are applicable instead
++# of those above. If you wish to allow use of your version of this file only
++# under the terms of either the GPL or the LGPL, and not to allow others to
++# use your version of this file under the terms of the MPL, indicate your
++# decision by deleting the provisions above and replace them with the notice
++# and other provisions required by the GPL or the LGPL. If you do not delete
++# the provisions above, a recipient may use your version of this file under
++# the terms of any one of the MPL, the GPL or the LGPL.
++#
++# ***** END LICENSE BLOCK *****
++
++# usage: get-universe.sh logfile(s) > universe.data
++#
++# get-universe.sh reads the processed javascript logs and writes to
++# stdout the unique set of fields to be used as the "universe" of test
++# run data. These values are used by pattern-expander.pl and
++# pattern-extracter.pl to encode the known failure files into regular
++# expressions.
++
++sed 's|.*\(TEST_BRANCH.*\), \(TEST_OS.*\), TEST_RESULT.*|\2, \1|' $@ | sort -u
+Index: known-failures.pl
+===================================================================
+RCS file: /cvsroot/mozilla/js/tests/known-failures.pl,v
+retrieving revision 1.5
+diff -p -U 8 -r1.5 known-failures.pl
+--- known-failures.pl	23 Mar 2008 21:42:44 -0000	1.5
++++ known-failures.pl	25 Jun 2008 17:31:16 -0000
+@@ -44,30 +44,32 @@ use Getopt::Mixed "nextOption";
+ sub debug;
+ sub usage;
+ sub parse_options;
+ sub escape_pattern;
+ sub unescape_pattern;
+ 
+ # option arguments
+ 
+-my $option_desc = "b=s branch>b T=s buildtype>T t=s testtype>t l=s rawlogfile>l f=s failurelogfile>f o=s os>o r=s patterns>r z=s timezone>z O=s outputprefix>O A=s arch>A K=s kernel>K D debug>D";
++my $option_desc = "b=s branch>b T=s buildtype>T t=s testtype>t o=s os>o K=s kernel>K A=s arch>A M=s memory>M S=s speed>S z=s timezone>z l=s rawlogfile>l f=s failurelogfile>f r=s patterns>r O=s outputprefix>O D debug>D";
+ 
+ my $testid;
+ my $branch;
+ my $buildtype;
+ my $testtype;
+ my $rawlogfile;
+ my $failurelogfile;
+ my $os;
+ my $patterns;
+ my $timezone;
+ my $outputprefix;
+ my $arch;
+ my $kernel;
++my $memory;
++my $cpuspeed;
+ my $debug = $ENV{DEBUG};
+ 
+ # pattern variables
+ 
+ my $knownfailurebranchpattern;
+ my $failurebranchpattern;
+ my $knownfailureospattern;
+ my $failureospattern;
+@@ -76,16 +78,20 @@ my $failurebuildtypepattern;
+ my $knownfailuretesttypepattern;
+ my $failuretesttypepattern;
+ my $knownfailuretimezonepattern;
+ my $failuretimezonepattern;
+ my $knownfailurearchpattern;
+ my $failurearchpattern;
+ my $knownfailurekernelpattern;
+ my $failurekernelpattern;
++my $knownfailurememorypattern;
++my $failurememorypattern;
++my $knownfailurecpuspeedpattern;
++my $failurecpuspeedpattern;
+ 
+ my @patterns;
+ my $pattern;
+ my @failures;
+ my @fixes;
+ my @excludedtests;
+ my $excludedtest;
+ my $excludedfile;
+@@ -139,44 +145,44 @@ foreach $includedfile ( @includedfiles )
+         s/\s+$//;
+ 
+         $includedtests{$_} = 1;
+     }
+     close INCLUDED;
+ }
+ 
+ debug "loading patterns $patterns";
+-debug "pattern filter: /^TEST_ID=[^,]*, TEST_BRANCH=$knownfailurebranchpattern, TEST_RESULT=[^,]*, TEST_BUILDTYPE=$knownfailurebuildtypepattern, TEST_TYPE=$knownfailuretesttypepattern, TEST_OS=$knownfailureospattern, TEST_MACHINE=[^,]*, TEST_PROCESSORTYPE=$knownfailurearchpattern, TEST_KERNEL=$knownfailurekernelpattern, TEST_DATE=[^,]*, TEST_TIMEZONE=$knownfailuretimezonepattern,/\n";
++debug "pattern filter: ^TEST_ID=[^,]*, TEST_BRANCH=$knownfailurebranchpattern, TEST_BUILDTYPE=$knownfailurebuildtypepattern, TEST_TYPE=$knownfailuretesttypepattern, TEST_OS=$knownfailureospattern, TEST_KERNEL=$knownfailurekernelpattern, TEST_PROCESSORTYPE=$knownfailurearchpattern, TEST_MEMORY=$knownfailurememorypattern, TEST_CPUSPEED=$knownfailurecpuspeedpattern, TEST_TIMEZONE=$knownfailuretimezonepattern,";
+ 
+ open PATTERNS, "<$patterns" or die "Unable to open known failure patterns file $patterns: $!\n";
+ while (<PATTERNS>) {
+     chomp;
+ 
+     s/\s+$//;
+ 
+     ($testid) = $_ =~ /^TEST_ID=([^,]*),/;
+ 
+     if (!$includedtests{$testid})
+     {
+         debug "test $testid was not included during this run";
+     }
+-    elsif ($_ =~ /^TEST_ID=[^,]*, TEST_BRANCH=$knownfailurebranchpattern, TEST_RESULT=[^,]*, TEST_BUILDTYPE=$knownfailurebuildtypepattern, TEST_TYPE=$knownfailuretesttypepattern, TEST_OS=$knownfailureospattern, TEST_MACHINE=[^,]*, TEST_PROCESSORTYPE=$knownfailurearchpattern, TEST_KERNEL=$knownfailurekernelpattern, TEST_DATE=[^,]*, TEST_TIMEZONE=$knownfailuretimezonepattern,/) {
++    elsif ($_ =~ /^TEST_ID=[^,]*, TEST_BRANCH=$knownfailurebranchpattern, TEST_BUILDTYPE=$knownfailurebuildtypepattern, TEST_TYPE=$knownfailuretesttypepattern, TEST_OS=$knownfailureospattern, TEST_KERNEL=$knownfailurekernelpattern, TEST_PROCESSORTYPE=$knownfailurearchpattern, TEST_MEMORY=$knownfailurememorypattern, TEST_CPUSPEED=$knownfailurecpuspeedpattern, TEST_TIMEZONE=$knownfailuretimezonepattern,/) {
+         debug "adding pattern  : $_";
+         push @patterns, (escape_pattern($_));   
+     }
+     else {
+         debug "skipping pattern: $_";
+     }
+ 
+ }
+ close PATTERNS;
+ 
+  # create a working copy of the current failures which match the users selection
+ 
+-debug "failure filter: ^TEST_ID=[^,]*, TEST_BRANCH=$failurebranchpattern, TEST_RESULT=FAIL[^,]*, TEST_BUILDTYPE=$failurebuildtypepattern, TEST_TYPE=$failuretesttypepattern, TEST_OS=$failureospattern, TEST_MACHINE=[^,]*, TEST_PROCESSORTYPE=$failurearchpattern, TEST_KERNEL=$failurekernelpattern, TEST_DATE=[^,]*, TEST_TIMEZONE=$failuretimezonepattern,";
++debug "failure filter: ^TEST_ID=[^,]*, TEST_BRANCH=$failurebranchpattern, TEST_BUILDTYPE=$failurebuildtypepattern, TEST_TYPE=$failuretesttypepattern, TEST_OS=$failureospattern, TEST_KERNEL=$failurekernelpattern, TEST_PROCESSORTYPE=$failurearchpattern, TEST_MEMORY=$failurememorypattern, TEST_CPUSPEED=$failurecpuspeedpattern, TEST_TIMEZONE=$failuretimezonepattern, TEST_RESULT=FAIL[^,]*,/";
+ 
+ if (defined($rawlogfile)) {
+ 
+     $failurelogfile = "$outputprefix-results-failures.log";
+     my $alllog      = "$outputprefix-results-all.log";
+ 
+     debug "writing failures $failurelogfile";
+ 
+@@ -184,39 +190,53 @@ if (defined($rawlogfile)) {
+     open ALLLOG, ">$alllog" or die "Unable to open $alllog $!\n";
+     open FAILURELOG, ">$failurelogfile" or die "Unable to open $failurelogfile $!\n";
+ 
+     while (<INPUTLOG>) {
+         chomp;
+ 
+         print ALLLOG "$_\n";
+ 
+-        if ($_ =~ /^TEST_ID=[^,]*, TEST_BRANCH=$failurebranchpattern, TEST_RESULT=FAIL[^,]*, TEST_BUILDTYPE=$failurebuildtypepattern, TEST_TYPE=$failuretesttypepattern, TEST_OS=$failureospattern, TEST_MACHINE=[^,]*, TEST_PROCESSORTYPE=$failurearchpattern, TEST_KERNEL=$failurekernelpattern, TEST_DATE=[^,]*, TEST_TIMEZONE=$failuretimezonepattern,/) {
++        if ($_ =~ /^TEST_ID=[^,]*, TEST_BRANCH=$failurebranchpattern, TEST_BUILDTYPE=$failurebuildtypepattern, TEST_TYPE=$failuretesttypepattern, TEST_OS=$failureospattern, TEST_KERNEL=$failurekernelpattern, TEST_PROCESSORTYPE=$failurearchpattern, TEST_MEMORY=$failurememorypattern, TEST_CPUSPEED=$failurecpuspeedpattern, TEST_TIMEZONE=$failuretimezonepattern, TEST_RESULT=FAIL[^,]*,/) {
+             debug "failure: $_";
+             push @failures, ($_);
+             print FAILURELOG "$_\n";
+         }
+     }
+     close INPUTLOG;
+     my $inputrc = $?;
+     close ALLLOG;
+     close FAILURELOG;
+ 
+     die "FATAL ERROR in post-process-logs.pl" if $inputrc != 0;
+-
+ }
+-else {
+-
++else 
++{
+     debug "loading failures $failurelogfile";
+ 
+-    open FAILURES, "<$failurelogfile" or die "Unable to open current failure log $failurelogfile: $!\n";
++    my $failurelogfilemode;
++
++    if ($failurelogfile =~ /\.bz2$/)
++    {
++        $failurelogfilemode = "bzcat $failurelogfile|";
++    }
++    elsif ($failurelogfile =~ /\.gz$/)
++    {
++        $failurelogfilemode = "zcat $failurelogfile|";
++    }
++    else
++    {
++        $failurelogfilemode = "<$failurelogfile";
++    }
++
++    open FAILURES, "$failurelogfilemode" or die "Unable to open current failure log $failurelogfile: $!\n";
+     while (<FAILURES>) {
+         chomp;
+ 
+-        if ($_ =~ /^TEST_ID=[^,]*, TEST_BRANCH=$failurebranchpattern, TEST_RESULT=FAIL[^,]*, TEST_BUILDTYPE=$failurebuildtypepattern, TEST_TYPE=$failuretesttypepattern, TEST_OS=$failureospattern, TEST_MACHINE=[^,]*, TEST_PROCESSORTYPE=$failurearchpattern, TEST_KERNEL=$failurekernelpattern, TEST_DATE=[^,]*, TEST_TIMEZONE=$failuretimezonepattern,/) {
++        if ($_ =~ /^TEST_ID=[^,]*, TEST_BRANCH=$failurebranchpattern, TEST_BUILDTYPE=$failurebuildtypepattern, TEST_TYPE=$failuretesttypepattern, TEST_OS=$failureospattern, TEST_KERNEL=$failurekernelpattern, TEST_PROCESSORTYPE=$failurearchpattern, TEST_MEMORY=$failurememorypattern, TEST_CPUSPEED=$failurecpuspeedpattern, TEST_TIMEZONE=$failuretimezonepattern, TEST_RESULT=FAIL[^,]*,/) {
+             debug "failure: $_";
+             push @failures, ($_);
+         }
+     }
+     close FAILURES;
+ }
+ 
+ debug "finding fixed bugs";
+@@ -338,35 +358,45 @@ sub debug {
+ sub usage {
+ 
+     my $msg = shift;
+ 
+     print STDERR <<EOF;
+ 
+ usage: $msg
+ 
+-known-failures.pl [-b|--branch] branch [-T|--buildtype] buildtype 
+-                  [-t|--testtype] testtype [-o os|--os] 
++known-failures.pl [-b|--branch] branch 
++                  [-T|--buildtype] buildtype 
++                  [-t|--testtype] testtype 
++                  [-o|--os] os
++                  [-K|--kernel] kernel
++                  [-A|--arch] arch
++                  [-M|--memory] memory
++                  [-S|--speed] speed
++                  [-z|--timezone] timezone 
++                  [-r|--patterns] patterns 
+                   ([-f|--failurelogfile] failurelogfile|[-l|--logfile] rawlogfile])
+-                  [-r|--patterns] patterns [-z|--timezone] timezone 
+                   [-O|--outputprefix] outputprefix
++                  [-D]
+ 
+     variable            description
+     ===============     ============================================================
+     -b branch           branch 1.8.0, 1.8.1, 1.9.0, all
+     -T buildtype        build type opt, debug, all
+     -t testtype         test type browser, shell, all
++    -o os               operating system nt, darwin, linux, all
++    -K kernel           kernel, all or a specific pattern
++    -A arch             architecture, all or a specific pattern
++    -M memory           memory in Gigabytes, all or a specific pattern
++    -S speed            speed, all or specific pattern
++    -z timezone         -0400, -0700, etc. default to user\'s zone
+     -l rawlogfile       raw logfile
+     -f failurelogfile   failure logfile
+-    -o os               operating system win32, mac, linux, all
+     -r patterns         known failure patterns
+-    -z timezone         -0400, -0700, etc. default to user\'s zone
+     -O outputprefix     output files will be generated with this prefix
+-    -A arch             architecture, all or a specific pattern
+-    -K kernel           kernel, all or a specific pattern
+     -D                  turn on debugging output
+ EOF
+ 
+     exit(2);
+ }
+ 
+ sub parse_options {
+     my ($option, $value);
+@@ -380,171 +410,216 @@ sub parse_options {
+             $branch = $value;
+         }
+         elsif ($option eq "T") {
+             $buildtype = $value;
+         }
+         elsif ($option eq "t") {
+             $testtype = $value;
+         }
+-        elsif ($option eq "l") {
+-            $rawlogfile = $value;
+-        }
+-        elsif ($option eq "f") {
+-            $failurelogfile = $value;
+-        }
+         elsif ($option eq "o") {
+             $os = $value;
+         }
+-        elsif ($option eq "r") {
+-            $patterns = $value;
++        elsif ($option eq "K") {
++            $kernel = $value;
++        }
++        elsif ($option eq "A") {
++            $arch = $value;
++        }
++        elsif ($option eq "M") {
++            $memory = $value;
++        }
++        elsif ($option eq "S") {
++            $cpuspeed = $value;
++            if ($cpuspeed < 4)
++            {
++                $cpuspeed = 'slow';
++            }
++            elsif ($cpuspeed < 9)
++            {
++                $cpuspeed = 'medium';
++            }
++            else
++            {
++                $cpuspeed = 'fast';
++            }
+         }
+         elsif ($option eq "z") {
+             $timezone = $value;
+         }
+-        elsif ($option eq "O") {
+-            $outputprefix = $value;
++        elsif ($option eq "r") {
++            $patterns = $value;
+         }
+-        elsif ($option eq "A") {
+-            $arch = $value;
++        elsif ($option eq "l") {
++            $rawlogfile = $value;
+         }
+-        elsif ($option eq "K") {
+-            $kernel = $value;
++        elsif ($option eq "f") {
++            $failurelogfile = $value;
++        }
++        elsif ($option eq "O") {
++            $outputprefix = $value;
+         }
+         elsif ($option eq "D") {
+             $debug = 1;
+         }
+ 
+     }
+ 
+     if ($debug) {
+-        print "branch=$branch, rawlogfile=$rawlogfile failurelogfile=$failurelogfile, os=$os, buildtype=$buildtype, testtype=$testtype, patterns=$patterns, timezone=$timezone, outputprefix=$outputprefix\n";
++        print "branch=$branch, buildtype=$buildtype, testtype=$testtype, os=$os, kernel=$kernel, arch=$arch, memory=$memory, cpuspeed=$cpuspeed, timezone=$timezone, patterns=$patterns, rawlogfile=$rawlogfile failurelogfile=$failurelogfile, outputprefix=$outputprefix\n";
+     }
+     Getopt::Mixed::cleanup();
+ 
+     if ( !defined($branch) ) {
+         usage "missing branch";
+     }
+ 
+-    if (!defined($rawlogfile) && !defined($failurelogfile)) {
+-        usage "missing logfile";
++    if (!defined($buildtype)) {
++        usage "missing buildtype";
+     }
+ 
++    if (!defined($testtype)) {
++        usage "missing testtype";
++    }
+ 
+     if (!defined($os)) { 
+         usage "missing os";
+     }
+ 
+-    if (!defined($buildtype)) {
+-        usage "missing buildtype";
++    if (!defined($memory)) {
++        $memory = 'all';
+     }
+ 
+-    if (!defined($testtype)) {
+-        usage "missing testtype";
++    if (!defined($cpuspeed)) {
++        $cpuspeed = 'all';
++    }
++
++    if (!defined($timezone)) {
++        usage "missing timezone";
+     }
+ 
+     if (!defined($patterns)) {
+         usage "missing patterns";
+     }
+ 
+-
+-    if (!defined($timezone)) {
+-        usage "missing timezone";
++    if (!defined($rawlogfile) && !defined($failurelogfile)) {
++        usage "missing logfile";
+     }
+ 
+-
+     if (!defined($outputprefix)) {
+         usage "missing outputprefix";
+     }
+ 
+     if ($branch eq "1.8.0") {
+-        $knownfailurebranchpattern = "([^,]*1\\.8\\.0[^,]*|\\.\\*)";
++        $knownfailurebranchpattern = "(1\\.8\\.0|\\.\\*)";
+         $failurebranchpattern      = "1\\.8\\.0";
+     }
+-    if ($branch eq "1.8.1") {
+-        $knownfailurebranchpattern = "([^,]*1\\.8\\.1[^,]*|\\.\\*)";
++    elsif ($branch eq "1.8.1") {
++        $knownfailurebranchpattern = "(1\\.8\\.1|\\.\\*)";
+         $failurebranchpattern      = "1\\.8\\.1";
+     }
+     elsif ($branch eq "1.9.0") {
+-        $knownfailurebranchpattern = "([^,]*1\\.9\\.0[^,]*|\\.\\*)";
++        $knownfailurebranchpattern = "(1\\.9\\.0|\\.\\*)";
+         $failurebranchpattern      = "1\\.9\\.0";
+     }
++    elsif ($branch eq "1.9.1") {
++        $knownfailurebranchpattern = "(1\\.9\\.1|\\.\\*)";
++        $failurebranchpattern      = "1\\.9\\.1";
++    }
+     elsif ($branch eq "all") {
+         $knownfailurebranchpattern = "[^,]*";
+         $failurebranchpattern      = "[^,]*";
+     }
+ 
+-    if ($os eq "win32") {
+-        $knownfailureospattern     = "([^,]*win32[^,]*|\\.\\*)";
+-        $failureospattern          = "win32";
+-    }
+-    elsif ($os eq "mac") {
+-        $knownfailureospattern     = "([^,]*mac[^,]*|\\.\\*)";
+-        $failureospattern          = "mac";
+-    }
+-    elsif ($os eq "linux") {
+-        $knownfailureospattern     = "([^,]*linux[^,]*|\\.\\*)";
+-        $failureospattern          = "linux";
+-    }
+-    elsif ($os eq "all") {
+-        $knownfailureospattern     = "[^,]*";
+-        $failureospattern          = "[^,]*";
+-    }
+-
+     if ($buildtype eq "opt") {
+-        $knownfailurebuildtypepattern = "([^,]*opt[^,]*|\\.\\*)";
++        $knownfailurebuildtypepattern = "(opt|\\.\\*)";
+         $failurebuildtypepattern      = "opt";
+     }
+     elsif ($buildtype eq "debug") {
+-        $knownfailurebuildtypepattern = "([^,]*debug[^,]*|\\.\\*)";
++        $knownfailurebuildtypepattern = "(debug|\\.\\*)";
+         $failurebuildtypepattern      = "debug";
+     }
+     elsif ($buildtype eq "all") {
+         $knownfailurebuildtypepattern = "[^,]*";
+         $failurebuildtypepattern      = "[^,]*";
+     }
+ 
+     if ($testtype eq "shell") {
+-        $knownfailuretesttypepattern = "([^,]*shell[^,]*|\\.\\*)";
++        $knownfailuretesttypepattern = "(shell|\\.\\*)";
+         $failuretesttypepattern      = "shell";
+     }
+     elsif ($testtype eq "browser") {
+-        $knownfailuretesttypepattern = "([^,]*browser[^,]*|\\.\\*)";
++        $knownfailuretesttypepattern = "(browser|\\.\\*)";
+         $failuretesttypepattern      = "browser";
+     }
+     elsif ($testtype eq "all") {
+         $knownfailuretesttypepattern = "[^,]*";
+         $failuretesttypepattern      = "[^,]*";
+     }
+ 
+-    if ($timezone eq "all") {
+-        $knownfailuretimezonepattern = "[^,]*";
+-        $failuretimezonepattern      = "[^,]*";
++    if ($os eq "nt") {
++        $knownfailureospattern     = "(nt|\\.\\*)";
++        $failureospattern          = "nt";
++    }
++    elsif ($os eq "darwin") {
++        $knownfailureospattern     = "(darwin|\\.\\*)";
++        $failureospattern          = "darwin";
++    }
++    elsif ($os eq "linux") {
++        $knownfailureospattern     = "(linux|\\.\\*)";
++        $failureospattern          = "linux";
++    }
++    elsif ($os eq "all") {
++        $knownfailureospattern     = "[^,]*";
++        $failureospattern          = "[^,]*";
++    }
++
++    if ($kernel ne  "all") {
++        $knownfailurekernelpattern = "(" . $kernel . "|\\.\\*)";
++        $failurekernelpattern      = "$kernel";
+     }
+     else {
+-        $knownfailuretimezonepattern = "([^,]*" . $timezone . "[^,]*|\\.\\*)";
+-        $failuretimezonepattern      = "$timezone";
++        $knownfailurekernelpattern = "[^,]*";
++        $failurekernelpattern      = "[^,]*";
+     }
+ 
+     if ($arch ne "all") {
+-        $knownfailurearchpattern = "([^,]*" . $arch . "[^,]*|\\.\\*)";
++        $knownfailurearchpattern = "(" . $arch . "|\\.\\*)";
+         $failurearchpattern      = "$arch";
+     }
+     else {
+         $knownfailurearchpattern = "[^,]*";
+         $failurearchpattern      = "[^,]*";
+     }
+ 
+-    if ($kernel ne  "all") {
+-        $knownfailurekernelpattern = "([^,]*" . $kernel . "[^,]*|\\.\\*)";
+-        $failurekernelpattern      = "$kernel";
++    if ($memory ne  "all") {
++        $knownfailurememorypattern = "(" . $memory . "|\\.\\*)";
++        $failurememorypattern      = "$memory";
+     }
+     else {
+-        $knownfailurekernelpattern = "[^,]*";
+-        $failurekernelpattern      = "[^,]*";
++        $knownfailurememorypattern = "[^,]*";
++        $failurememorypattern      = "[^,]*";
++    }
++
++    if ($cpuspeed ne  "all") {
++        $knownfailurecpuspeedpattern = "(" . $cpuspeed . "|\\.\\*)";
++        $failurecpuspeedpattern      = "$cpuspeed";
++    }
++    else {
++        $knownfailurecpuspeedpattern = "[^,]*";
++        $failurecpuspeedpattern      = "[^,]*";
++    }
++
++    if ($timezone eq "all") {
++        $knownfailuretimezonepattern = "[^,]*";
++        $failuretimezonepattern      = "[^,]*";
++    }
++    else {
++        $knownfailuretimezonepattern = "(" . $timezone . "|\\.\\*)";
++        $failuretimezonepattern      = "$timezone";
+     }
+ 
+ 
+ }
+ 
+ sub escape_pattern {
+ 
+     my $line = shift;
+Index: pattern-expander.pl
+===================================================================
+RCS file: pattern-expander.pl
+diff -N pattern-expander.pl
+--- /dev/null	1 Jan 1970 00:00:00 -0000
++++ pattern-expander.pl	25 Jun 2008 17:31:16 -0000
+@@ -0,0 +1,159 @@
++#!/usr/bin/perl -w
++# -*- Mode: Perl; tab-width: 4; indent-tabs-mode: nil; -*-
++# ***** BEGIN LICENSE BLOCK *****
++# Version: MPL 1.1/GPL 2.0/LGPL 2.1
++#
++# The contents of this file are subject to the Mozilla Public License Version
++# 1.1 (the "License"); you may not use this file except in compliance with
++# the License. You may obtain a copy of the License at
++# http://www.mozilla.org/MPL/
++#
++# Software distributed under the License is distributed on an "AS IS" basis,
++# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
++# for the specific language governing rights and limitations under the
++# License.
++#
++# The Original Code is Mozilla JavaScript Testing Utilities
++#
++# The Initial Developer of the Original Code is
++# Mozilla Corporation.
++# Portions created by the Initial Developer are Copyright (C) 2008
++# the Initial Developer. All Rights Reserved.
++#
++# Contributor(s): Bob Clary <bclary@bclary.com>
++#
++# Alternatively, the contents of this file may be used under the terms of
++# either the GNU General Public License Version 2 or later (the "GPL"), or
++# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
++# in which case the provisions of the GPL or the LGPL are applicable instead
++# of those above. If you wish to allow use of your version of this file only
++# under the terms of either the GPL or the LGPL, and not to allow others to
++# use your version of this file under the terms of the MPL, indicate your
++# decision by deleting the provisions above and replace them with the notice
++# and other provisions required by the GPL or the LGPL. If you do not delete
++# the provisions above, a recipient may use your version of this file under
++# the terms of any one of the MPL, the GPL or the LGPL.
++#
++# ***** END LICENSE BLOCK *****
++
++# usage: pattern-expander.pl knownfailures > knownfailures.expanded
++#
++# pattern-expander.pl reads the specified knownfailures file and
++# writes to stdout an expanded set of failures where the wildcards
++# ".*" are replaced with the set of possible values specified in the
++# universe.data file.
++
++use lib "/work/mozilla/mozilla.com/test.mozilla.com/www/tests/mozilla.org/js";
++
++use Patterns;
++
++package Patterns;
++
++processfile();
++
++sub processfile
++{
++    my ($i, $j);
++
++    while (<ARGV>) {
++
++        chomp;
++
++        $record = {};
++
++        my ($test_id, $test_branch, $test_buildtype, $test_type, $test_os, $test_kernel, $test_processortype, $test_memory, $test_cpuspeed, $test_timezone, $test_result, $test_exitstatus, $test_description) = $_ =~ 
++            /TEST_ID=([^,]*), TEST_BRANCH=([^,]*), TEST_BUILDTYPE=([^,]*), TEST_TYPE=([^,]*), TEST_OS=([^,]*), TEST_KERNEL=([^,]*), TEST_PROCESSORTYPE=([^,]*), TEST_MEMORY=([^,]*), TEST_CPUSPEED=([^,]*), TEST_TIMEZONE=([^,]*), TEST_RESULT=([^,]*), TEST_EXITSTATUS=([^,]*), TEST_DESCRIPTION=(.*)/;
++
++        $record->{TEST_ID}            = $test_id;
++        $record->{TEST_BRANCH}        = $test_branch;
++        $record->{TEST_BUILDTYPE}     = $test_buildtype;
++        $record->{TEST_TYPE}          = $test_type;
++        $record->{TEST_OS}            = $test_os;
++        $record->{TEST_KERNEL}        = $test_kernel;
++        $record->{TEST_PROCESSORTYPE} = $test_processortype;
++        $record->{TEST_MEMORY}        = $test_memory;
++        $record->{TEST_CPUSPEED}      = $test_cpuspeed;
++        $record->{TEST_TIMEZONE}      = $test_timezone;
++        $record->{TEST_RESULT}        = $test_result;
++        $record->{TEST_EXITSTATUS}    = $test_exitstatus;
++        $record->{TEST_DESCRIPTION}   = $test_description;
++
++        dbg("processfile: \$_=$_");
++
++        my @list1 = ();
++        my @list2 = ();
++
++        my $iuniversefield;
++        my $universefield;
++
++        $item1 = copyreference($record);
++        dbg("processfile: check copyreference");
++        dbg("processfile: \$record=" . recordtostring($record));
++        dbg("processfile: \$item1=" . recordtostring($item1));
++
++        push @list1, ($item1);
++
++        for ($iuniversefield = 0; $iuniversefield < @universefields; $iuniversefield++)
++        {
++            $universefield = $universefields[$iuniversefield];
++
++            dbg("processfile: \$universefields[$iuniversefield]=$universefield, \$record->{$universefield}=$record->{$universefield}");
++
++            for ($j = 0; $j < @list1; $j++)
++            {
++                $item1 = $list1[$j];
++                dbg("processfile: item1 \$list1[$j]=" . recordtostring($item1));
++                # create a reference to a copy of the hash referenced by $item1
++                if ($item1->{$universefield} ne '.*')
++                {
++                    dbg("processfile: literal value");
++                    $item2 = copyreference($item1);
++                    dbg("processfile: check copyreference");
++                    dbg("processfile: \$item1=" . recordtostring($item1));
++                    dbg("processfile: \$item2=" . recordtostring($item2));
++                    dbg("processfile: pushing existing record to list 2: " . recordtostring($item2));
++                    push @list2, ($item2);
++                }
++                else
++                {
++                    dbg("processfile: wildcard value");
++                    $keyfielduniversekey = getuniversekey($item1, $universefield);
++                    @keyfielduniverse = getuniverse($keyfielduniversekey, $universefield);
++
++                    dbg("processfile: \$keyfielduniversekey=$keyfielduniversekey, \@keyfielduniverse=" . join(',', @keyfielduniverse));
++
++                    for ($i = 0; $i < @keyfielduniverse; $i++)
++                    {
++                        $item2 = copyreference($item1);
++                        dbg("processfile: check copyreference");
++                        dbg("processfile: \$item1=" . recordtostring($item1));
++                        dbg("processfile: \$item2=" . recordtostring($item2));
++                        $item2->{$universefield} = $keyfielduniverse[$i];
++                        dbg("processfile: pushing new record to list 2 " . recordtostring($item2));
++                        push @list2, ($item2);
++                    }
++                }
++                for ($i = 0; $i < @list1; $i++)
++                {
++                    dbg("processfile: \$list1[$i]=" . recordtostring($list1[$i]));
++                }
++                for ($i = 0; $i < @list2; $i++)
++                {
++                    dbg("processfile: \$list2[$i]=" . recordtostring($list2[$i]));
++                }
++            }
++
++            @list1 = @list2;
++            @list2 = ();
++        }
++        for ($j = 0; $j < @list1; $j++)
++        {
++            $item1 = $list1[$j];
++            push @records, ($item1);
++        }
++    }
++    @records = sort sortrecords @records;
++
++    dumprecords();
++}
++
+Index: pattern-extracter.pl
+===================================================================
+RCS file: pattern-extracter.pl
+diff -N pattern-extracter.pl
+--- /dev/null	1 Jan 1970 00:00:00 -0000
++++ pattern-extracter.pl	25 Jun 2008 17:31:16 -0000
+@@ -0,0 +1,217 @@
++#!/usr/bin/perl -w
++# -*- Mode: Perl; tab-width: 4; indent-tabs-mode: nil; -*-
++# ***** BEGIN LICENSE BLOCK *****
++# Version: MPL 1.1/GPL 2.0/LGPL 2.1
++#
++# The contents of this file are subject to the Mozilla Public License Version
++# 1.1 (the "License"); you may not use this file except in compliance with
++# the License. You may obtain a copy of the License at
++# http://www.mozilla.org/MPL/
++#
++# Software distributed under the License is distributed on an "AS IS" basis,
++# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
++# for the specific language governing rights and limitations under the
++# License.
++#
++# The Original Code is Mozilla JavaScript Testing Utilities
++#
++# The Initial Developer of the Original Code is
++# Mozilla Corporation.
++# Portions created by the Initial Developer are Copyright (C) 2008
++# the Initial Developer. All Rights Reserved.
++#
++# Contributor(s): Bob Clary <bclary@bclary.com>
++#
++# Alternatively, the contents of this file may be used under the terms of
++# either the GNU General Public License Version 2 or later (the "GPL"), or
++# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
++# in which case the provisions of the GPL or the LGPL are applicable instead
++# of those above. If you wish to allow use of your version of this file only
++# under the terms of either the GPL or the LGPL, and not to allow others to
++# use your version of this file under the terms of the MPL, indicate your
++# decision by deleting the provisions above and replace them with the notice
++# and other provisions required by the GPL or the LGPL. If you do not delete
++# the provisions above, a recipient may use your version of this file under
++# the terms of any one of the MPL, the GPL or the LGPL.
++#
++# ***** END LICENSE BLOCK *****
++
++# usage: pattern-extracter.pl knownfailures.expanded > knownfailures
++#
++# pattern-extracter.pl reads the specified expanded knownfailures file
++# (see pattern-expander.pl) and writes to stdout a set of knownfailures
++# where repetitions of values found in the universe.data file are
++# replaced with wildcards ".*".
++
++use lib "/work/mozilla/mozilla.com/test.mozilla.com/www/tests/mozilla.org/js";
++
++use Patterns;
++
++package Patterns;
++
++
++my $universefield;
++
++processfile();
++
++sub processfile
++{
++    my $recordcurr = {};
++    my $recordprev;
++
++    my @output;
++    my $keycurr = '';
++    my $keyprev = '';
++    my @values = ();
++    my $universefielduniversekey; # universekey for universefield
++    my @universefielduniverse;
++    my $i;
++    my $j;
++    my $v;
++
++    while (<ARGV>) {
++
++        chomp;
++
++        $recordcurr = {};
++
++        my ($test_id, $test_branch, $test_buildtype, $test_type, $test_os, $test_kernel, $test_processortype, $test_memory, $test_cpuspeed, $test_timezone, $test_result, $test_exitstatus, $test_description) = $_ =~ 
++            /TEST_ID=([^,]*), TEST_BRANCH=([^,]*), TEST_BUILDTYPE=([^,]*), TEST_TYPE=([^,]*), TEST_OS=([^,]*), TEST_KERNEL=([^,]*), TEST_PROCESSORTYPE=([^,]*), TEST_MEMORY=([^,]*), TEST_CPUSPEED=([^,]*), TEST_TIMEZONE=([^,]*), TEST_RESULT=([^,]*), TEST_EXITSTATUS=([^,]*), TEST_DESCRIPTION=(.*)/;
++
++        $recordcurr->{TEST_ID}            = $test_id;
++        $recordcurr->{TEST_BRANCH}        = $test_branch;
++        $recordcurr->{TEST_BUILDTYPE}     = $test_buildtype;
++        $recordcurr->{TEST_TYPE}          = $test_type;
++        $recordcurr->{TEST_OS}            = $test_os;
++        $recordcurr->{TEST_KERNEL}        = $test_kernel;
++        $recordcurr->{TEST_PROCESSORTYPE} = $test_processortype;
++        $recordcurr->{TEST_MEMORY}        = $test_memory;
++        $recordcurr->{TEST_CPUSPEED}      = $test_cpuspeed;
++        $recordcurr->{TEST_TIMEZONE}      = $test_timezone;
++        $recordcurr->{TEST_RESULT}        = $test_result;
++        $recordcurr->{TEST_EXITSTATUS}    = $test_exitstatus;
++        $recordcurr->{TEST_DESCRIPTION}   = $test_description;
++
++        push @records, ($recordcurr);
++    }
++
++    for ($j = $#universefields; $j >= 0; $j--)
++    {
++        $universefield   = $universefields[$j];
++
++        @records = sort {getkey($a, $universefield) cmp getkey($b, $universefield);} @records;
++
++        $recordprev = $records[0];
++        $keyprev    = getkey($recordprev, $universefield);
++        @values     = ();
++
++        my $recordtemp;
++        my $keytemp;
++
++        dbg("processfile: begin processing records for \$universefields[$j]=$universefield");
++
++        for ($i = 0; $i < @records; $i++)
++        {
++            $recordcurr = $records[$i];
++            $keycurr = getkey($recordcurr, $universefield);
++
++            dbg("processfile: processing record[$i]");
++            dbg("processfile: recordprev: " . recordtostring($recordprev));
++            dbg("processfile: recordcurr: " . recordtostring($recordcurr));
++            dbg("processfile: \$keyprev=$keyprev");
++            dbg("processfile: \$keycurr=$keycurr");
++
++            if ($keycurr ne $keyprev)
++            {
++                # key changed, must output previous record
++                dbg("processfile: new key");
++                $universefielduniversekey = getuniversekey($recordprev, $universefield);
++                @universefielduniverse = getuniverse($universefielduniversekey, $universefield);
++                dbg("processfile: \@values: ". join(',', @values));
++                dbg("processfile: \$universefielduniversekey=$universefielduniversekey, \@universefielduniverse=" . join(',', @universefielduniverse));
++                @values = ('.*') if (arraysequal(\@values, \@universefielduniverse));
++                dbg("processfile: \@values=" . join(',', @values));
++
++                for ($v = 0; $v < @values; $v++)
++                {
++                    dbg("processfile: stuffing $values[$v]");
++                    $recordtemp = copyreference($recordprev);
++                    $recordtemp->{$universefield} = $values[$v];
++                    dbg("processfile: stuffed $recordtemp->{$universefield}");
++                    dbg("processfile: recordprev: " . recordtostring($recordprev));
++                    dbg("processfile: output: " . recordtostring($recordtemp));
++                    push @output, ($recordtemp);
++                }
++                @values = ();
++            }
++            dbg("processfile: collecting \$recordcurr->{$universefield}=$recordcurr->{$universefield}");
++            push @values, ($recordcurr->{$universefield});
++            $keyprev = $keycurr;
++            $recordprev = $recordcurr;
++        }
++        dbg("processfile: finish processing records for \$universefields[$j]=$universefield");
++        if (@values)
++        {
++            dbg("processfile: last record for \$universefields[$j]=$universefield has pending values");
++            $universefielduniversekey = getuniversekey($recordprev, $universefield);
++            @universefielduniverse = getuniverse($universefielduniversekey, $universefield);
++            dbg("processfile: \@values: ". join(',', @values));
++            dbg("processfile: \$universefielduniversekey=$universefielduniversekey, \@universefielduniverse=" . join(',', @universefielduniverse));
++            @values = ('.*') if (arraysequal(\@values, \@universefielduniverse));
++            dbg("processfile: \@values=" . join(',', @values));
++
++            for ($v = 0; $v < @values; $v++)
++            {
++                dbg("processfile: stuffing $values[$v]");
++                $recordtemp = copyreference($recordprev);
++                $recordtemp->{$universefield} = $values[$v];
++                dbg("processfile: stuffed $recordprev->{$universefield}");
++                dbg("processfile: recordprev: " . recordtostring($recordprev));
++                dbg("processfile: output: " . recordtostring($recordtemp));
++                push @output, ($recordtemp);
++            }
++            @values = ();
++        }
++        @records = @output;
++        @output = ();
++    }
++
++    @records = sort sortrecords @records;
++    dumprecords();
++}
++
++
++sub getkey 
++{
++    my ($record, $universefield) = @_;
++
++    my $i;
++
++    my $key = '';
++
++    for ($i = 0; $i < @sortkeyfields; $i++)
++    {
++        if ($sortkeyfields[$i] ne $universefield)
++        {
++            $key .= $record->{$sortkeyfields[$i]}
++        }
++    }
++    return $key;
++}
++
++sub arraysequal 
++{
++    my ($larrayref, $rarrayref) = @_;
++    my $i;
++
++    dbg("arraysequal: checking if " . (join ',', @{$larrayref}) . " is equal to " . (join ',', @{$rarrayref}));
++    return 0 if (@{$larrayref} != @{$rarrayref});
++
++    for ($i = 0; $i < @{$larrayref}; $i++)
++    {
++        return 0 if ($rarrayref->[$i] ne $larrayref->[$i]);
++    }
++    dbg("arraysequal: equal");
++    return 1;
++}
++
+Index: post-process-logs.pl
+===================================================================
+RCS file: /cvsroot/mozilla/js/tests/post-process-logs.pl,v
+retrieving revision 1.10
+diff -p -U 8 -r1.10 post-process-logs.pl
+--- post-process-logs.pl	3 Apr 2008 16:25:01 -0000	1.10
++++ post-process-logs.pl	25 Jun 2008 17:31:16 -0000
+@@ -57,33 +57,36 @@ $ENV{LC_ALL} = 'C';
+ 
+ (undef, $temp) = tempfile();
+ 
+ open TEMP, ">$temp" or
+     die "FATAL ERROR: Unable to open temporary file $temp for writing: $!\n";
+ 
+ local ($test_id,
+        $tmp_test_id,
++       $tmp_test_exit_status,
+        %test_id,
+        %test_reported,
+        $test_result, 
+        $test_type, 
+        $tmp_test_type,
+        $test_description, 
+        @messages,
+        $test_processortype, 
+        $test_kernel, 
+        $test_suite,
+-       $exit_status,
+-       $page_status,
++       $test_exit_status,
++       @expected_exit_code_list,
++       $expected_exit_code,
++       $exit_code,
+        $state);
+ 
+-local ($actual_exit, $actual_signal);
+-
+-local %test_reported       = ();
++local $test_memory = 0;
++local $test_cpuspeed = 0;
++local %test_reported = ();
+ 
+ while ($file = shift @ARGV)
+ {
+     @messages = ();
+ 
+     dbg "file: $file";
+ 
+     my $filename = basename $file;
+@@ -95,776 +98,491 @@ while ($file = shift @ARGV)
+            $test_machine,$test_global_target) = split /,/, $filename;
+ 
+     $test_branchid =~ s/[^0-9.]//g;
+     $test_global_target =~ s/.log$//;
+ 
+     local ($test_timezone) = $test_date;
+     $test_timezone =~ s/.*([-+]\d{4,4})/$1/;
+ 
+-    open FILE, "$file" or die "FATAL ERROR: unable to open $file for reading: $!\n";
++    my $filemode;
++
++    if ($file =~ /\.bz2$/)
++    {
++        $filemode = "bzcat $file|";
++    }
++    elsif ($file =~ /\.gz$/)
++    {
++        $filemode = "zcat $file|";
++    }
++    else
++    {
++        $filemode = "<$file";
++    }
++
++    open FILE, "$filemode" or die "FATAL ERROR: unable to open $file for reading: $!\n";
+ 
+     dbg "process header with environment variables used in test";
+ 
+     while (<FILE>)
+     {
+         $state = 'failure';
+ 
+         chomp;
+ 
+         # remove carriage returns, bels and other annoyances.
+         $_ =~ s/[\r]$//;
+         $_ =~ s/[\r]/CR/g;
+         $_ =~ s/[\x01-\x08]//g;
+         $_ =~ s/\s+$//;
+ 
+-        dbg  "INPUT: $_";
++        if ($debug)
++        {
++            dbg "\nINPUT: $_";
++        }
+ 
+-        last if ( $_ =~ /^environment: EOF/);
++        last if ( $_ =~ /^arguments:/);
+ 
+         if (($envvar, $envval) = $_ =~ /^environment: (TEST_[A-Z0-9_]*)=(.*)/ )
+         {
+             dbg "envvar=$envvar, envval=$envval";
++            if ($envvar =~ /TEST_KERNEL/)
++            {
++                $envval =~ s/([0-9]+)\.([0-9]+)\.([0-9]+).*/$1.$2.$3/;
++                dbg "found TEST_KERNEL";
++            }
+             $envvar =~ tr/A-Z/a-z/;
+             $$envvar = $envval;
+             dbg $envvar . "=" . $$envvar;
+         }
+         elsif (($envval) = $_ =~ /^environment: OSID=(.*)/ )
+         {
+             $test_os = $envval;
+         }
+     }
+ 
++    if ($test_cpuspeed < 4)
++    {
++        $test_cpuspeed = 'slow';
++    }
++    elsif ($test_cpuspeed < 9)
++    {
++        $test_cpuspeed = 'medium';
++    }
++    else
++    {
++        $test_cpuspeed = 'fast';
++    }
++
+     if ($test_product eq "js")
+     {
+-        while (<FILE>)
+-        {
+-            chomp;
++        $test_type       = "shell";
++    }
++    elsif ($test_product eq "firefox" || $test_product eq "thunderbird")
++    {
++        $test_buildtype  = "nightly" unless $test_buildtype;
++        $test_type       = "browser";
++    }
+ 
+-            dbg  "INPUT: $_";
++#  Expected sequence if all output written to the log.
++#
++#    Input                     
++# -----------------------------
++# JavaScriptTest: Begin Run    
++# JavaScriptTest: Begin Test t;
++# jstest: t                    
++# t:.*EXIT STATUS:             
++# JavaScriptTest: End Test t   
++# JavaScriptTest: End Run      
++# EOF                          
++# 
++    %test_id         = ();
++    @messages        = ();
++    $test_exit_status = '';
++    $state           = 'idle';
+ 
+-            if (/Wrote results to/)
+-            {
+-                $state = 'success';
+-                last;
+-            }
++    while (<FILE>)
++    {
++        chomp;
+ 
+-            $_ =~ s/[\r]$//;
+-            $_ =~ s/[\r]/CR/g;
+-            $_ =~ s/[\x01-\x08]//g;
+-            $_ =~ s/\s+$//;
++        if ($debug)
++        {
++            dbg "\nINPUT: '$_'";
++        }
+ 
+-            next if ( $_ !~ /^jstest: /);
++        $_ =~ s/[\r]$//;
++        $_ =~ s/[\r]/CR/g;
++        $_ =~ s/[\x01-\x08]//g;
++        $_ =~ s/\s+$//;
+ 
+-            ($test_id)          = $_ =~ /^jstest: (.*?) *bug:/;
+-            ($test_result)      = $_ =~ /result: (.*?) *type:/;
+-            ($test_type)        = $_ =~ /type: (.*?) *description:/;
+-            ($test_description) = $_ =~ /description: (.*)/;
++        if ( /^JavaScriptTest: Begin Run/)
++        {
++            dbg "Begin Run";
+ 
+-            if (!$test_description)
++            if ($state eq 'idle')
+             {
+-                $test_description = "";
++                $state = 'beginrun';
+             }
+             else
+             {
+-                ($actual_exit, $actual_signal) = $test_description =~ /expected: Expected exit [03] actual: Actual exit ([0-9]*), signal ([0-9]*)/;
+-                if (defined($actual_exit) or defined($actual_signal))
+-                {
+-                    if ($actual_exit > 3 || $actual_signal > 0)
+-                    {
+-                        $test_description =~ s/ *expected: Expected exit [03] actual: Actual exit ([0-9]*), signal ([0-9]*) /EXIT STATUS: CRASHED $actual_exit signal $actual_signal, /;
+-                    }
+-                }
+-                elsif ($test_result eq "FAILED TIMED OUT")
+-                {
+-                    $test_description = "EXIT STATUS: TIMED OUT, $test_description";
+-                    $test_result = "FAILED";
+-                }
++                warn "WARNING: state: $state, expected: idle, log: $file";
++                $state = 'beginrun';
+             }
++        }
++        elsif ( ($tmp_test_id) = $_ =~ /^JavaScriptTest: Begin Test ([^ ]*)/)
++        {
++            dbg "Begin Test: $tmp_test_id";
+ 
+-            if ($test_description =~ /error: can.t allocate region/ || /set a breakpoint in malloc_error_break/ || 
+-                /set a breakpoint in szone_error to debug/ || /malloc:.*mmap/ || /vm_allocate/ )
++            if ($state eq 'beginrun' || $state eq 'endtest')
+             {
+-                dbg "Adding message: /$test_id:0: out of memory";
+-                $test_description .= "; /$test_id:0: out of memory";
++                $state = 'runningtest';
++            }
++            else
++            {
++                warn "WARNING: state: $state, expected: beginrun, endtest, log: $file";
++                $state = 'runningtest';
+             }
+ 
+-            dbg "test_id:          $test_id";
+-            dbg "test_result:      $test_result";
+-            dbg "test_type:        $test_type";
+-            dbg "test_description: $test_description";
+-
+-            outputrecord $test_id, $test_description, $test_result;
++            $test_id{$state}         = $tmp_test_id;
++            @messages                = ();
++            @expected_exit_code_list = ();
++            $expected_exit_code      = ();
++
++            $test_id          = '';
++            $test_result      = '';
++            $test_exit_status = 'NORMAL'; # default to normal, so subtests will have a NORMAL status
++            $test_description = '';
+ 
+-            dbg "-";
++            push @expected_exit_code_list, (3) if ($tmp_test_id =~ /-n.js$/);
++            
+         }
+-    }
+-    elsif ($test_product eq "firefox")
+-    {
+-        %test_id         = ();
+-        @messages        = ();
+-
+-        $page_status     = '';
+-        $exit_status     = '';
+-        $test_buildtype  = "nightly" unless $test_buildtype;
+-        $test_type       = "browser";
++        elsif ( ($expected_exit_code) = $_ =~ /WE EXPECT EXIT CODE ([0-9]*)/ ) 
++        {
++            dbg "Expected Exit Code: $expected_exit_code";
+ 
++            push @expected_exit_code_list, ($expected_exit_code);
++        }
++        elsif ( ($tmp_test_id) = $_ =~ /^jstest: (.*?) *bug:/)
++        {
++            dbg "jstest: $tmp_test_id";
+ 
+-# non-restart mode. start spider; for each test { load test;} exit spider;
+-# restart mode.     for each test; { start spider; load test; exit spider; }
+-# 
+-#                    Expected sequence if all output written to the log.
+-#
+-#    Input                                            Initial State       Next State       userhook event                         outputrecord
+-# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
+-# Spider: Start.*start-spider.html                    idle                startrun
+-# Spider: Begin loading.*start-spider.html            startrun            startrun
+-# Start Spider: try.*EXIT STATUS: NORMAL              startrun            initialized
+-# Start Spider: try.*EXIT STATUS: (TIMED OUT|CRASHED) startrun            startrun
+-# Spider: Start.*urllist                              initialized         initialized      (non restart mode)
+-# Spider: Begin loading.*urllist                      initialized         initialized      (non restart mode)
+-# Spider: Finish loading.*urllist                     initialized         initialized      (non restart mode)
+-# Spider: Current Url:.*urllist                       initialized         initialized      (non restart mode)
+-# Spider: Start.*test=t;                              initialized         starttest        (has test id)
+-# JavaScriptTest: Begin Run                           starttest           starttest        onStart
+-# Spider: Begin loading.*test=t;                      starttest           loadingtest      (has test id)
+-# JavaScriptTest: Begin Test t;                       loadingtest         runningtest      onBeforePage (has test id)                         
+-# jstest: t                                           runningtest         reportingtest    (has test id)                          yes.        
+-# Spider: Finish loading.*t=t;                        reportingtest       loadedtest       (has test id)                                      
+-# Spider: Finish loading.*t=t;                        runningtest         pendingtest      (has test id)                                      
+-# Spider: Current Url:.*test=t;                       loadedtest          loadedtest       (has test id)                                      
+-# http://.*test=t;.*PAGE STATUS: NORMAL               loadedtest          loadedtest       onAfterPage (has test id)                          
+-# http://.*test=t;.*PAGE STATUS: TIMED OUT            loadedtest          endrun           onPageTimeout (has test id)            yes.        
+-# JavaScriptTest: t Elapsed time                      loadedtest          completedtest    checkTestCompleted (has test id)                   
+-# JavaScriptTest: End Test t                          completedtest       completedtest    checkTestCompleted (has test id)                   
+-# JavaScriptTest: End Test t                          endrun              endrun           onPageTimeout (has test id)                        
+-# Spider: Start.*test=t;                              completedtest       starttest        (non restart mode) (has test id)
+-# JavaScriptTest: End Run                             completedtest       endrun           onStop
+-# JavaScriptTest: End Run                             loadedtest          endrun           onStop
+-# Spider: Start.*test=t;                              endrun              starttest        (restart mode) (has test id)
+-# http://.*test=t;.*EXIT STATUS: NORMAL               endrun              endrun           (has test id)                          maybe.
+-# http://.*test=t;.*EXIT STATUS: TIMED OUT            endrun              endrun           (has test id)                          yes.
+-# http://.*test=t;.*EXIT STATUS: CRASHED              endrun              endrun           (has test id)                          yes.
+-# /work/mozilla/mozilla.com/test.mozilla.com/www$     endrun              success
+-# EOF                                                 success             success
+-# EOF                                                 endrun              failure
+-# 
+-# States        has test id
+-# -------------------------
+-# idle
+-# startrun
+-# initialized
+-# starttest     has test id
+-# loadingtest   has test id
+-# runningtest   has test id
+-# pendingtest   has test id
+-# reportingtest has test id
+-# loadedtest    has test id
+-# endrun        has test id
+-# completedtest has test id
+-# success
+-# failure
++#            if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
++#            {
++#                warn "WARNING: state: $state, expected runningtest, reportingtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
++#            }
+ 
+-        dbg "Assuming starting in restart mode";
++            if ($state eq 'runningtest')
++            {
++                $state = 'reportingtest';
++            }
++            elsif ($state eq 'reportingtest')
++            {
++                $state = 'reportingtest';
++            }
++            else
++            {
++                warn "WARNING: test_id: $test_id{$state}, state: $state, expected: runningtest, reportingtest, log: $file";
++                $state = 'reportingtest';
++            }
+ 
+-        $mode  = 'restart';
+-        $state = 'idle';
++            ($test_result)      = $_ =~ /result: (.*?) *type:/;
++            ($tmp_test_type)    = $_ =~ /type: (.*?) *description:/;
+ 
+-        while (<FILE>)
+-        {
+-            chomp;
++            die "FATAL ERROR: test_id: $test_id{$state}, jstest test type mismatch: start test_type: $test_type, current test_type: $tmp_test_type, test state: $state, log: $file" 
++                if ($test_type ne $tmp_test_type);
+ 
+-            # remove carriage returns, bels and other annoyances.
+-            $_ =~ s/[\r]$//;
+-            $_ =~ s/[\r]/CR/g;
+-            $_ =~ s/[\x01-\x08]//g;
+-            $_ =~ s/\s+$//;
++            ($test_description) = $_ =~ /description: (.*)/;
+ 
+-            if ($debug)
++            if (!$test_description)
+             {
+-                dbg "\nINPUT: $_";
++                $test_description = "";
+             }
++            $test_description .= '; messages: ' . (join '; ', @messages) . ';';
+ 
+-            # massage the input to make more uniform across test types and platforms
+-            s/\.js, line ([0-9]*): out of memory/.js:$1: out of memory/g;
++            outputrecord $tmp_test_id, $test_description, $test_result;
+ 
++            $test_id{$state} = $tmp_test_id;
++        }
++        elsif ( $state ne 'idle' && (($tmp_test_id) = $_ =~ /^([^:]*):.* EXIT STATUS: NORMAL/))
++        {
++            $test_exit_status = 'NORMAL';
++            dbg "Exit Status Normal: $tmp_test_id, $test_exit_status";
+ 
+-            if (/^Spider: Start.*start-spider.html/)
++            if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+             {
+-                if ($state eq 'idle')
+-                {
+-                    $state = 'startrun';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: idle, log: $file";
+-                    $state = 'startrun';
+-                }
++                warn "WARNING: state: $state, mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+             }
+-            elsif (/^Spider: Begin loading.*start-spider.html/)
++
++            if ($state eq 'reportingtest' || $state eq 'runningtest')
+             {
+-                if ($state eq 'startrun')
+-                {
+-                    $state = 'startrun';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: startrun, log: $file";
+-                    $state = 'startrun';
+-                }
++                $state = 'exitedtest';
+             }
+-            elsif (/^Start Spider: try.*EXIT STATUS: NORMAL/)
++            else
+             {
+-                if ($state eq 'startrun')
+-                {
+-                    $state = 'initialized';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: startrun, log: $file";
+-                    $state = 'initialized';
+-                }
++                warn "WARNING: state: $state, expected: reportingtest, runningtest, log: $file";
++                $state = 'exitedtest';
+             }
+-            elsif (/^Start Spider: try.*EXIT STATUS: (TIMED OUT|CRASHED)/)
++
++            if (! $test_reported{$tmp_test_id})
+             {
+-                if ($state eq 'startrun')
+-                {
+-                    $state = 'startrun';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: startrun, log: $file";
+-                    $state = 'startrun';
+-                }
++                dbg "No test results reported: $tmp_test_id";
++
++                $test_result = 'FAILED';
++                $test_description = 'No test results reported; messages: ' . (join '; ', @messages) . ';';
++                
++                outputrecord $tmp_test_id, $test_description, $test_result;
+             }
+-            elsif ( /^Spider: Start: -url .*test.mozilla.com.tests.mozilla.org.js.urllist-/)
+-            {
+-                dbg "Setting mode to nonrestart";
+ 
+-                $mode = 'nonrestart';
++            $test_id{$state} = $tmp_test_id;
++        }
++        elsif ( $state ne 'idle' && (($tmp_test_id) = $_ =~ /^([^:]*):.* EXIT STATUS: TIMED OUT/))
++        {
++            $test_exit_status = 'TIMED OUT';
++            dbg "Exit Status Timed Out: $tmp_test_id, $test_exit_status";
+ 
+-                if ($state eq 'initialized')
+-                {
+-                    $state = 'initialized';
+-                }
+-                elsif ($state eq 'starttest')
+-                {
+-                    $state = 'initialized';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: initialized, starttest, log: $file";
+-                    $state = 'initialized';
+-                }
+-            }
+-            elsif ( ($tmp_test_id) = $_ =~ /^Spider: Start.*http.*test=([^;]*);/)
++            if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+             {
+-                if ($state eq 'initialized')
+-                {
+-                    $state = 'starttest';
+-                }
+-                elsif ($state eq 'completedtest')
+-                {
+-                    $state = 'starttest';
+-                }
+-                elsif ($state eq 'endrun')
+-                {
+-                    $state = 'starttest';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: initialized, completedtest, endrun, log: $file";
+-                    $state = 'starttest';
+-                }
+-
+-                $test_id{$state} = $tmp_test_id;
+-                $test_id{'loadingtest'} = $test_id{'runningtest'} = $test_id{'reportingtest'} = $test_id{'loadedtest'} = $test_id{'endrun'} = $test_id {'completedtest'} = $test_id{'loadedtest'} = '';
+-                @messages = ();
++                warn "WARNING: state: $state, mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+             }
+-            elsif ( /^JavaScriptTest: Begin Run/)
++
++            if ($state eq 'reportingtest' || $state eq 'runningtest')
+             {
+-                if ($state eq 'starttest')
+-                {
+-                    $state = 'starttest';
+-                }
+-                elsif ($state eq 'initialized' && $mode eq 'nonrestart')
+-                {
+-                    $state = 'starttest';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: starttest or initialized in non restart mode, mode $mode, log: $file";
+-                    $state = 'starttest';
+-                }
++                $state = 'exitedtest';
+             }
+-            elsif ( ($tmp_test_id) = $_ =~ /^Spider: Begin loading http.*test=([^;]*);/)
++            else
+             {
+-                if ($mode eq 'restart' && $test_id{$state} && $tmp_test_id ne $test_id{$state})
+-                {
+-                    warn "WARNING: state: $state, expected starttest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+-                }
++                dbg "state: $state, expected: reportingtest, runningtest";
++                $state = 'exitedtest';
++            }
+ 
+-                if ($state eq 'starttest')
+-                {
+-                    $state = 'loadingtest';
+-                }
+-                elsif ($state eq 'initialized' && $mode eq 'nonrestart')
+-                {
+-                    $state = 'loadingtest';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: starttest or initialized in non restart mode, log: $file";
+-                    $state = 'loadingtest';
+-                }
++            $test_result     = 'FAILED';
++            $test_description .= '; messages: ' . (join '; ', @messages) . ';';
++            
++            outputrecord $tmp_test_id, $test_description, $test_result;
+ 
+-                $test_id{$state} = $tmp_test_id;
+-            }
+-            elsif ( ($tmp_test_id) = $_ =~ /^JavaScriptTest: Begin Test ([^ ]*)/)
+-            {
+-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+-                {
+-                    warn "WARNING: state: $state, expected loadingtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+-                }
++            $test_id{$state} = $tmp_test_id;
++        }
++        elsif ( $state ne 'idle' && (($tmp_test_id, $tmp_test_exit_status) = $_ =~ /^([^:]*):.* EXIT STATUS: (CRASHED signal [0-9]+ [A-Z]+) \([0-9.]+ seconds\)/))
++        {
++            $test_exit_status = $tmp_test_exit_status;
++            dbg "Exit Status Crashed: $tmp_test_id, $test_exit_status";
+ 
+-                if ($state eq 'loadingtest')
+-                {
+-                    $state = 'runningtest';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: loadingtest, log: $file";
+-                    $state = 'runningtest';
+-                }
++            if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
++            {
++                warn "WARNING: state: $state, mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
++            }
+ 
+-                $test_id{$state} = $tmp_test_id;
++            if ($state eq 'reportingtest' || $state eq 'runningtest')
++            {
++                $state = 'exitedtest';
+             }
+-            elsif ( ($tmp_test_id) = $_ =~ /^jstest: (.*?) *bug:/)
++            else
+             {
+-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+-                {
+-                    warn "WARNING: state: $state, expected runningtest, reportingtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+-                }
+-
+-                if ($state eq 'runningtest')
+-                {
+-                    $state = 'reportingtest';
+-                }
+-                elsif ($state eq 'reportingtest')
+-                {
+-                    $state = 'reportingtest';
+-                }
+-                elsif ($state eq 'pendingtest')
+-                {
+-                    $state = 'reportingtest';
+-                }
+-                else
+-                {
+-                    warn "WARNING: test_id: $test_id{$state}, state: $state, expected: runningtest, reportingtest, pendingtest, log: $file";
+-                    $state = 'reportingtest';
+-                }
+-
+-                ($test_result)      = $_ =~ /result: (.*?) *type:/;
+-                ($tmp_test_type)    = $_ =~ /type: (.*?) *description:/;
+-
+-                die "FATAL ERROR: test_id: $test_id{$state}, jstest test type mismatch: start test_type: $test_type, current test_type: $tmp_test_type, test state: $state, log: $file" 
+-                    if ($test_type ne $tmp_test_type);
+-
+-                ($test_description) = $_ =~ /description: (.*)/;
++                dbg "state: $state, expected: reportingtest, runningtest";
++                $state = 'exitedtest';
++            }
+ 
+-                if (!$test_description)
+-                {
+-                    $test_description = "";
+-                }
+-                $test_description .= ' ' . join '; ', @messages;
++            $test_result     = 'FAILED';
++            $test_description .= '; messages: ' . (join '; ', @messages) . ';';
++            
++            outputrecord $tmp_test_id, $test_description, $test_result;
+ 
+-                outputrecord $tmp_test_id, $test_description, $test_result;
++            $test_id{$state} = $tmp_test_id;
++        }
++        elsif ( $state ne 'idle' && (($tmp_test_id, $tmp_test_exit_status) = $_ =~ /^([^:]*):.* EXIT STATUS: (ABNORMAL [0-9]+) \([0-9.]+ seconds\)/))
++        {
++            $test_exit_status = $tmp_test_exit_status;
++            dbg "Exit Status Abnormal: $tmp_test_id, $test_exit_status";
+ 
+-                $test_id{$state} = $tmp_test_id;
+-            }
+-            elsif ( ($tmp_test_id) = $_ =~ /^Spider: Finish loading http.*test=([^;]*);/)
++            if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+             {
+-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+-                {
+-                    warn "WARNING: state: $state, expected reportingtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+-                }
+-
+-                if ($state eq 'reportingtest')
+-                {
+-                    $state = 'loadedtest';
+-                }
+-                else
+-                {
+-                    # probably an out of memory error or a browser only delayed execution test.
+-                    dbg "state: $state, expected: reportingtest. assuming test result is pending";
+-                    $state = 'pendingtest';
+-                }
+-
+-                $test_id{$state} = $tmp_test_id;
++                warn "WARNING: state: $state, mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+             }
+-            elsif ( ($tmp_test_id) = $_ =~ /^Spider: Current Url:.*test=([^;]*);/)
+-            {
+-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+-                {
+-                    warn "WARNING: state: $state, expected loadedtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+-                }
+-
+-                if ($state eq 'loadedtest')
+-                {
+-                    $state = 'loadedtest';
+-                }
+-                elsif ($state eq 'reportingtest')
+-                {
+-                    $state = 'loadedtest';
+-                }
+-                elsif ($state eq 'pendingtest')
+-                {
+-                    $state = 'pendingtest';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: loadedtest, reportingtest, pendingtest, log: $file";
+-                    $state = 'loadedtest';
+-                }
+ 
+-                $test_id{$state} = $tmp_test_id;
+-            }
+-            elsif ( ($tmp_test_id, $page_status) = $_ =~ /^http:.*test=([^;]*);.* (PAGE STATUS: NORMAL.*)/)
++            if ($state eq 'reportingtest'  || $state eq 'runningtest')
+             {
+-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+-                {
+-                    warn "WARNING: state: $state, expected loadedtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+-                }
+-
+-                if ($state eq 'loadedtest')
+-                {
+-                    $state = 'loadedtest';
+-                }
+-                elsif ($state eq 'pendingtest')
+-                {
+-                    $state = 'pendingtest';
+-                }
+-                elsif ($state eq 'reportingtest')
+-                {
+-                    # test was pending, but output a result.
+-                    $state = 'loadedtest';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: loadedtest, pendingtest, reportingtest, log: $file";
+-                    $state = 'loadedtest';
+-                }
+-
+-                $test_id{$state} = $tmp_test_id;
++                $state = 'exitedtest';
+             }
+-            elsif ( ($tmp_test_id, $page_status) = $_ =~ /^http:.*test=([^;]*);.* (PAGE STATUS: TIMED OUT.*)/)
++            else
+             {
+-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+-                {
+-                    warn "WARNING: state: $state, expected loadedtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+-                }
+-
+-                if ($state eq 'loadedtest')
+-                {
+-                    $state = 'endrun';
+-                }
+-                elsif ($state eq 'runningtest')
+-                {
+-                    $state = 'completedtest';
+-                }
+-                elsif ($state eq 'reportingtest')
+-                {
+-                    $state = 'completedtest';
+-                }
+-                elsif ($state eq 'pendingtest')
+-                {
+-                    $state = 'completedtest';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: loadedtest, runningtest, reportingtest, pendingtest, log: $file";
+-                    $state = 'endrun';
+-                }
++                dbg "state: $state, expected: reportingtest, runningtest";
++                $state = 'exitedtest';
++            }
+ 
+-                $test_result     = 'FAILED';
+-                $test_description = $page_status . ' ' . join '; ', @messages;;
+-                
+-                outputrecord $tmp_test_id, $test_description, $test_result;
++            ($exit_code) = $test_exit_status =~ /ABNORMAL ([0-9]+)/;
+ 
+-                $test_id{$state} = $tmp_test_id;
++            if (grep /$exit_code/, @expected_exit_code_list)
++            {
++                $test_result = 'PASSED';
+             }
+-            elsif ( ($tmp_test_id) = $_ =~ /^JavaScriptTest: ([^ ]*) Elapsed time/)
++            else
+             {
+-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+-                {
+-                    warn "WARNING: state: $state, expected loadedtest. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+-                }
++                $test_result = 'FAILED';
++            }
+ 
+-                if ($state eq 'loadedtest')
+-                {
+-                    $state = 'completedtest';
+-                }
+-                elsif ($state eq 'pendingtest')
+-                {
+-                    $state = 'pendingtest';
+-                }
+-                elsif ($state eq 'reportingtest')
+-                {
+-                    # test was pending, but has been reported.
+-                    $state = 'completedtest';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: loadedtest, loadedtest, pendingtest, reportingtest, log: $file";
+-                    $state = 'completedtest';
+-                }
++            $test_description .= '; messages: ' . (join '; ', @messages) . ';';
+ 
+-                $test_id{$state} = $tmp_test_id;
+-            }
+-            elsif ( ($tmp_test_id) = $_ =~ /^JavaScriptTest: End Test ([^ ]*)/)
+-            {
+-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+-                {
+-                    warn "WARNING: state: $state, expected completedtest, endrun. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+-                }
++            dbg "Exit Code: $exit_code, Test Result: $test_result, Expected Exit Codes: " . (join '; ', @expected_exit_code_list);
+ 
+-                if ($state eq 'completedtest')
+-                {
+-                    if ($mode eq 'restart')
+-                    {
+-                        $state = 'completedtest';
+-                    }
+-                    else
+-                    {
+-                        $state = 'starttest';
+-                    }
+-                }
+-                elsif ($state eq 'pendingtest')
+-                {
+-                    $state = 'completedtest';
++            outputrecord $tmp_test_id, $test_description, $test_result;
+ 
+-                    $test_result = 'UNKNOWN';
+-                    $test_description = 'No test results reported. ' . join '; ', @messages;
+-                    
+-                    outputrecord $tmp_test_id, $test_description, $test_result;
+-                }
+-                elsif ($state eq 'endrun')
+-                {
+-                    $state = 'endrun';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: completedtest, pendingtest, endrun, log: $file";
+-                    $state = 'completedtest';
+-                }
++            $test_id{$state} = $tmp_test_id;
++        }
++        elsif ( ($tmp_test_id) = $_ =~ /^JavaScriptTest: End Test ([^ ]*)/)
++        {
++            dbg "End Test: $tmp_test_id";
+ 
+-                $test_id{$state} = $tmp_test_id;
++            if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
++            {
++                warn "WARNING: state: $state, mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+             }
+-            elsif ( /^JavaScriptTest: End Run/)
++
++            if ($state eq 'exitedtest' || $state eq 'runningtest' || $state eq 'reportingtest')
+             {
+-                if ($state eq 'completedtest')
+-                {
+-                    $state = 'endrun';
+-                }
+-                elsif ($state eq 'loadedtest')
+-                {
+-                    $state = 'endrun';
+-                }
+-                elsif ($state eq 'pendingtest')
+-                {
+-                    $state = 'pendingtest';
+-                }
+-                elsif ($state eq 'starttest' && $mode eq 'nonrestart')
+-                {
+-                    # non restart mode, at last test.
+-                    $state = 'endrun';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: completedtest, loadedtest, pendingtest or starttest in non restart mode, log: $file";
+-                    $state = 'endrun';
+-                }
++                $state = 'endtest';
+             }
+-            elsif ( ($tmp_test_id, $exit_status) = $_ =~ /^http:.*test=([^;]*);.* (EXIT STATUS: NORMAL.*)/)
++            else
+             {
+-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+-                {
+-                    warn "WARNING: state: $state, expected endrun. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+-                }
+-
+-                if ($state eq 'endrun')
+-                {
+-                    $state = 'endrun';
+-                }
+-                elsif ($state eq 'completedtest')
+-                {
+-                    dbg "previously pending test $test_id{$state} completed and is now endrun";
+-                    $state = 'endrun';
+-                }
+-                else
+-                {
+-                    warn "WARNING: state: $state, expected: endrun, log: $file";
+-                    $state = 'endrun';
+-                }
++                warn "WARNING: state: $state, expected: runningtest, reportingtest, exitedtest, log: $file";
++                $state = 'endtest';
++            }
+ 
+-                if (! $test_reported{$tmp_test_id})
+-                {
+-                    $test_result = 'UNKNOWN';
+-                    $test_description = $exit_status . ' No test results reported. ' . join '; ', @messages;
+-                    
+-                    outputrecord $tmp_test_id, $test_description, $test_result;
+-                }
++            $test_id{$state} = $tmp_test_id;
++        }
++        elsif ( /^JavaScriptTest: End Run/)
++        {
++            dbg "End Run";
+ 
+-                $test_id{$state} = $tmp_test_id;
++            if ($state eq 'endtest')
++            {
++                $state = 'endrun';
+             }
+-            elsif ( ($tmp_test_id, $exit_status) = $_ =~ /^http:.*test=([^;]*);.* (EXIT STATUS: TIMED OUT.*)/)
++            else
+             {
+-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+-                {
+-                    warn "WARNING: state: $state, expected endrun. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+-                }
+-
+-                if ($state eq 'endrun')
+-                {
+-                    $state = 'endrun';
+-                }
+-                else
+-                {
+-                    dbg "state: $state, expected: endrun";
+-                    $state = 'endrun';
+-                }
+-
+-                $test_result     = 'FAILED';
+-                $test_description = $exit_status . ' ' . join '; ', @messages;
+-                
+-                outputrecord $tmp_test_id, $test_description, $test_result;
+-
+-                $test_id{$state} = $tmp_test_id;
++                warn "WARNING: state: $state, expected: endtest, log: $file";
++                $state = 'endrun';
+             }
+-            elsif ( ($tmp_test_id, $exit_status) = $_ =~ /^http:.*test=([^;]*);.* (EXIT STATUS: CRASHED.*)/)
++        }
++        elsif ($_ && 
++               !/^\s+$/ && 
++               !/^(STATUS:| *PASSED!| *FAILED!)/ && 
++               !/^JavaScriptTest:/ && 
++               !/^[*][*][*]/ && 
++               !/^[-+]{2,2}(WEBSHELL|DOMWINDOW)/ && 
++               !/^Spider:/ && 
++               !/real.*user.*sys.*$/ && 
++               !/user.*system.*elapsed/)
++        {
++            if ('runningtest, reportingtest' =~ /$state/)
+             {
+-                if ($test_id{$state} && $tmp_test_id ne $test_id{$state})
+-                {
+-                    warn "WARNING: state: $state, expected endrun. mismatched test_id: expected: $tmp_test_id, actual: $test_id{$state}, log: $file";
+-                }
+ 
+-                if ($state eq 'endrun')
+-                {
+-                    $state = 'endrun';
+-                }
+-                else
++                if (/error: can.t allocate region/ || /set a breakpoint in malloc_error_break/ || 
++                    /set a breakpoint in szone_error to debug/ || /malloc:.*mmap/ || /vm_allocate/ ||
++                    /terminate called after throwing an instance of 'std::bad_alloc'/)
+                 {
+-                    dbg "state: $state, expected: endrun";
+-                    $state = 'endrun';
++                    dbg "Adding message: $_ converted to /$test_id{$state}:0: out of memory";
++                    push @messages, ('/' . $test_id{$state} . ':0: out of memory');
+                 }
+-
+-                $test_result     = 'FAILED';
+-                $test_description = $exit_status . ' ' . join '; ', @messages;;
+-                
+-                outputrecord $tmp_test_id, $test_description, $test_result;
+-
+-                $test_id{$state} = $tmp_test_id;
+-            }
+-            elsif ( m@^(\/cygdrive\/.|\/.)?$test_dir$@)
+-            {
+-                if ($state eq 'endrun')
++                elsif (/\.js, line [0-9]+: out of memory/ )
+                 {
+-                    $state = 'success';
++                    s/\.js, line ([0-9]+): out of memory/\.js:$1:/;
++                    dbg "Adding message: $_ converted to /$test_id{$state}:0: out of memory";
++                    push @messages, ('/' . $test_id{$state} . ':0: out of memory');
+                 }
+                 else
+                 {
+-                    warn "WARNING: state: $state, expected: endrun, log: $file";
+-                    $state = 'success';
++                    dbg "Adding message: $_";
++                    push @messages, ($_);
+                 }
+-
+-                $test_id{$state} = $tmp_test_id;
+             }
+-            elsif (!/^ \=\>/ && !/^\s+$/ && !/^[*][*][*]/ && !/^[-+]{2,2}(WEBSHELL|DOMWINDOW)/ && !/^Spider:/ && 
+-                   !/^JavaScriptTest:/ && !/real.*user.*sys.*$/ && !/user.*system.*elapsed/)
+-            {
+-                if ('starttest, loadingtest, runningtest, reportingtest, pendingtest, loadedtest, endrun, completedtest' =~ /$state/)
+-                {
++        }
++        elsif ($debug)
++        {
++            dbg "Skipping: $_";
++        } 
+ 
+-                    if (/error: can.t allocate region/ || /set a breakpoint in malloc_error_break/ || 
+-                        /set a breakpoint in szone_error to debug/ || /malloc:.*mmap/ || /vm_allocate/ )
+-                    {
+-                        dbg "Adding message: $_ converted to /$test_id{$state}:0: out of memory";
+-                        push @messages, ('/' . $test_id{$state} . ':0: out of memory');
+-                    }
+-                    else
+-                    {
+-                        dbg "Adding message: $_";
+-                        push @messages, ($_);
+-                    }
+-                }
++        if ($debug)
++        {
++            if ($test_id{$state})
++            {
++                dbg "test_id{$state}=$test_id{$state}, " . (join '; ', @messages);
+             }
+-
+-            if ($debug)
++            else
+             {
+-                if ($test_id{$state})
+-                {
+-                    dbg "test_id{$state}=$test_id{$state}, " . join '; ', @messages;
+-                }
+-                else
+-                {
+-                    dbg "state=$state, " . join '; ', @messages;
+-                }
++                dbg "state=$state, " . (join '; ', @messages);
+             }
+         }
+     }
+-    close FILE;
+-
+-    undef $test_branchid;
+-    undef $test_date;
+-    undef $test_buildtype;
+-    undef $test_machine;
+-    undef $test_product;
+-    undef $test_suite;
+-
++    if ($state eq 'endrun')
++    {
++        $state = 'success';
++    }
+     die "FATAL ERROR: Test run terminated prematurely. state: $state, log: $file" if ($state ne 'success');
+-}
+ 
++}
++close FILE;
+ close TEMP;
+ 
++undef $test_branchid;
++undef $test_date;
++undef $test_buildtype;
++undef $test_machine;
++undef $test_product;
++undef $test_suite;
++
+ outresults;
+ 
+ unlink $temp;
+ 
+ sub dbg {
+     if ($debug)
+     {
+         my $msg = shift;
+         print STDERR "DEBUG: $msg\n";
+     }
+ }
+ 
+ sub outresults
+ {
++    dbg "sorting temp file $temp";
+     system("sort < $temp | uniq");
++    dbg "finished sorting";
+ }
+ 
+ sub outputrecord
+ {
+     my ($test_id, $test_description, $test_result) = @_;
+ 
+     # cut off the extra jstest: summaries as they duplicate the other
+     # output and follow it.
+     $test_description =~ s/jstest:.*//;
+ 
+-    if (length($test_description) > 6000)
+-    {
+-        $test_description = substr($test_description, 0, 6000);
+-    }
++#    if (length($test_description) > 6000)
++#    {
++#        $test_description = substr($test_description, 0, 6000);
++#    }
++#
+ 
+     my $output = 
+-        "TEST_ID=$test_id, TEST_BRANCH=$test_branchid, TEST_RESULT=$test_result, " .
+-        "TEST_BUILDTYPE=$test_buildtype, TEST_TYPE=$test_type, TEST_OS=$test_os, " . 
+-        "TEST_MACHINE=$test_machine, TEST_PROCESSORTYPE=$test_processortype, " . 
+-        "TEST_KERNEL=$test_kernel, TEST_DATE=$test_date, TEST_TIMEZONE=$test_timezone, " . 
+-        "TEST_DESCRIPTION=$test_description\n";
++        "TEST_ID=$test_id, " .
++        "TEST_BRANCH=$test_branchid, " .
++        "TEST_BUILDTYPE=$test_buildtype, " .
++        "TEST_TYPE=$test_type, " .
++        "TEST_OS=$test_os, " .
++        "TEST_KERNEL=$test_kernel, " .
++        "TEST_PROCESSORTYPE=$test_processortype, " .
++        "TEST_MEMORY=$test_memory, " .
++        "TEST_CPUSPEED=$test_cpuspeed, " . 
++        "TEST_TIMEZONE=$test_timezone, " . 
++        "TEST_RESULT=$test_result, " .
++        "TEST_EXITSTATUS=$test_exit_status, " .
++        "TEST_DESCRIPTION=$test_description, " .
++        "TEST_MACHINE=$test_machine, " .
++        "TEST_DATE=$test_date" .
++        "\n";
+ 
+     if ($debug)
+     {
+         dbg "RECORD: $output";
+     }
+     print TEMP $output;
+ 
+     $test_reported{$test_id} = 1;
+Index: process-logs.sh
+===================================================================
+RCS file: /cvsroot/mozilla/js/tests/process-logs.sh,v
+retrieving revision 1.3
+diff -p -U 8 -r1.3 process-logs.sh
+--- process-logs.sh	3 Apr 2008 16:25:02 -0000	1.3
++++ process-logs.sh	25 Jun 2008 17:31:16 -0000
+@@ -33,23 +33,23 @@
+ # decision by deleting the provisions above and replace them with the notice
+ # and other provisions required by the GPL or the LGPL. If you do not delete
+ # the provisions above, a recipient may use your version of this file under
+ # the terms of any one of the MPL, the GPL or the LGPL.
+ #
+ # ***** END LICENSE BLOCK *****
+ 
+ if [[ -z "$TEST_DIR" ]]; then
+-  cat <<EOF
++    cat <<EOF
+ `basename $0`: error
+ 
+ TEST_DIR, the location of the Sisyphus framework, 
+ is required to be set prior to calling this script.
+ EOF
+-  exit 2
++    exit 2
+ fi
+ 
+ if [[ ! -e $TEST_DIR/bin/library.sh ]]; then
+     echo "TEST_DIR=$TEST_DIR"
+     echo ""
+     echo "This script requires the Sisyphus testing framework. Please "
+     echo "cvs check out the Sisyphys framework from mozilla/testing/sisyphus"
+     echo "and set the environment variable TEST_DIR to the directory where it"
+@@ -69,54 +69,72 @@ usage()
+ usage: process-logs.sh.sh -l testlogfiles -A arch -K kernel
+ 
+ variable            description
+ ===============     ============================================================
+ testlogfiles        The test log to be processed. If testlogfiles is a file 
+                     pattern it must be single quoted to prevent the shell from
+                     expanding it before it is passed to the script.
+ 
++kernel              optional. The machine kernel as specified by uname -r
++                    If not specified, the script will attempt to determine the 
++                    value from the TEST_KERNEL line in the log. 
++                    'all'     - do not filter on machine kernel. Use this for
++                                Windows.
++                    For Linux distros, use the value of uname -r 
++                    and replace the minor version numbers with .* as in 
++                    2.6.23.1-21.fc7 -> 2.6.23.*fc7
+ arch                optional. The machine architecture as specified by uname -p
+                     If not specified, the script will attempt to determine the 
+                     value from the TEST_PROCESSORTYPE line in each log.
+                     'all'     - do not filter on machine architecture. Use this 
+                                 for Windows.
+                     'i686'    - Linux distros such as Fedora Core or RHEL or CentOS.
+                     'i386'    - Mac Intel
+                     'powerpc' - Mac PowerPC
+ 
+-kernel              optional. The machine kernel as specified by uname -r
+-                    If not specified, the script will attempt to determine the 
+-                    value from the TEST_KERNEL line in the log. 
+-                    'all'     - do not filter on machine kernel. Use this for
+-                                Windows.
+-                    For Linux distros, use the value of uname -r 
+-                    and replace the minor version numbers with .* as in 
+-                    2.6.23.1-21.fc7 -> 2.6.23.*fc7
+ EOF
+     exit 2
+ }
+ 
+ while getopts "l:A:K:" optname; 
+-  do
+-  case $optname in
+-      l) testlogfiles=$OPTARG;;
+-      A) optarch=$OPTARG;;
+-      K) optkernel=$OPTARG;;
+-  esac
++do
++    case $optname in
++        l) testlogfiles=$OPTARG;;
++        A) optarch=$OPTARG;;
++        K) optkernel=$OPTARG;;
++    esac
+ done
+ 
+ if [[ -z "$testlogfiles" ]]; then
+     usage
+ fi
+ 
+ for testlogfile in `ls $testlogfiles`; do
+ 
+     debug "testlogfile=$testlogfile"
+ 
++    case $testlogfile in
++	    *.log)
++            worktestlogfile=$testlogfile
++	        ;;
++	    *.log.bz2)
++            worktestlogfile=`mktemp $testlogfile.XXXXXX`
++            bunzip2 -c $testlogfile > $worktestlogfile
++	        ;;
++	    *.log.gz)
++            worktestlogfile=`mktemp $testlogfile.XXXXXX`
++	        gunzip -c $testlogfile > $worktestlogfile
++	        ;;
++	    *)
++	        echo "unknown log type: $f"
++	        exit 2
++	        ;;
++    esac
++
+     case "$testlogfile" in
+         *,js,*) testtype=shell;;
+         *,firefox,*) testtype=browser;;
+         *) error "unknown testtype in logfile $testlogfile" $LINENO;;
+     esac
+ 
+     debug "testtype=$testtype"
+ 
+@@ -128,72 +146,86 @@ for testlogfile in `ls $testlogfiles`; d
+     esac
+ 
+     debug "buildtype=$buildtype"
+ 
+     case "$testlogfile" in
+         *,1.8.0*) branch=1.8.0;;
+         *,1.8.1*) branch=1.8.1;;
+         *,1.9.0*) branch=1.9.0;;
++        *,1.9.1*) branch=1.9.1;;
+         *) 
+-            branch=`grep '^environment: TEST_BRANCH=' $testlogfile | sed 's|.*TEST_BRANCH=\(.*\)|\1|'`
++            branch=`grep -m 1 '^environment: TEST_BRANCH=' $worktestlogfile | sed 's|.*TEST_BRANCH=\(.*\)|\1|'`
+             if [[ -z "$branch" ]]; then
+                 error "unknown branch in logfile $testlogfile" $LINENO
+             fi
+             ;;
+     esac
+ 
+     debug "branch=$branch"
+ 
+     case "$testlogfile" in 
+-        *,win32,*) OSID=win32;;
++        *,nt,*) OSID=nt;;
+         *,linux,*) OSID=linux;;
+-        *,mac,*) OSID=mac;;
++        *,darwin,*) OSID=darwin;;
+         *) 
+-            OSID=`grep '^environment: OSID=' $testlogfile | sed 's|.*OSID=\(.*\)|\1|'`
++            OSID=`grep -m 1 '^environment: OSID=' $worktestlogfile | sed 's|.*OSID=\(.*\)|\1|'`
+             if [[ -z "$OSID" ]]; then
+                 error "unknown OS in logfile $testlogfile" $LINENO
+             fi
+             ;;
+     esac
+ 
+     debug "OSID=$OSID"
+ 
+     if [[ -n "$optkernel" ]]; then
+         kernel="$optkernel"
+     else
+-        if [[ "$OSID" == "win32" ]]; then
+-            kernel=all
+-        else
+-            kernel=`grep '^environment: TEST_KERNEL=' $testlogfile | sed 's|.*TEST_KERNEL=\(.*\)|\1|'`
+-            kernel=`echo $kernel | sed 's|\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\)[-.0-9]*\.\([a-zA-Z0-9]*\)|\1.\2.\3.*\4|'`
++        kernel=`grep -m 1 '^environment: TEST_KERNEL=' $worktestlogfile | sed 's|.*TEST_KERNEL=\(.*\)|\1|'`
++        if [[ "$OSID" == "linux" ]]; then
++            kernel=`echo $kernel | sed 's|\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\).*|\1.\2.\3|'`
+         fi
+     fi
+ 
+     debug "kernel=$kernel"
+ 
+     if [[ -n "$optarch" ]]; then
+         arch="$optarch"
+     else
+-        if [[ "$OSID" == "win32" ]]; then
+-            arch=all
+-        else
+-            arch=`grep '^environment: TEST_PROCESSORTYPE=' $testlogfile | sed 's|.*TEST_PROCESSORTYPE=\(.*\)|\1|'`
+-        fi
++        arch=`grep -m 1 '^environment: TEST_PROCESSORTYPE=' $worktestlogfile | sed 's|.*TEST_PROCESSORTYPE=\(.*\)|\1|'`
+     fi
+ 
+     debug "arch=$arch"
+ 
++    memory=`grep -m 1 '^environment: TEST_MEMORY=' $worktestlogfile | sed 's|.*TEST_MEMORY=\(.*\)|\1|'`
++    speed=`grep -m 1 '^environment: TEST_CPUSPEED=' $worktestlogfile | sed 's|.*TEST_CPUSPEED=\(.*\)|\1|'`
++
+     timezone=`basename $testlogfile | sed 's|^[-0-9]*\([-+]\)\([0-9]\{4,4\}\),.*|\1\2|'`
+ 
+     debug "timezone=$timezone"
+ 
+     outputprefix=$testlogfile
+ 
+     includetests="included-$branch-$testtype-$buildtype.tests"
+     excludetests="excluded-$branch-$testtype-$buildtype.tests"
+ 
+-    grep '^include: ' $testlogfile | sed 's|include: ||' > $TEST_DIR/tests/mozilla.org/js/$includetests
+-    grep '^exclude: ' $testlogfile | sed 's|exclude: ||' > $TEST_DIR/tests/mozilla.org/js/$excludetests
+-
+-    $TEST_DIR/tests/mozilla.org/js/known-failures.pl -b "$branch" -T "$buildtype" -t "$testtype" -o "$OSID" -z "$timezone" -l "$testlogfile" -A "$arch" -K "$kernel" -r "$TEST_JSDIR/failures.txt" -O "$outputprefix"
++    grep '^include: ' $worktestlogfile | sed 's|include: ||' > $TEST_DIR/tests/mozilla.org/js/$includetests
++    grep '^exclude: ' $worktestlogfile | sed 's|exclude: ||' > $TEST_DIR/tests/mozilla.org/js/$excludetests
+ 
++    $TEST_DIR/tests/mozilla.org/js/known-failures.pl \
++        -b "$branch" \
++        -T "$buildtype" \
++        -t "$testtype" \
++        -o "$OSID" \
++        -K "$kernel" \
++        -A "$arch" \
++        -M "$memory" \
++        -S "$speed" \
++        -z "$timezone" \
++        -r "$TEST_JSDIR/failures.txt" \
++        -l "$worktestlogfile" \
++        -O "$outputprefix"
++
++    if [[ "$testlogfile" != "$worktestlogfile" ]]; then
++        rm $worktestlogfile
++        unset worktestlogfile
++    fi
+ done
+Index: remove-fixed-failures.sh
+===================================================================
+RCS file: remove-fixed-failures.sh
+diff -N remove-fixed-failures.sh
+--- /dev/null	1 Jan 1970 00:00:00 -0000
++++ remove-fixed-failures.sh	25 Jun 2008 17:31:17 -0000
+@@ -0,0 +1,82 @@
++#!/bin/bash
++# -*- Mode: Shell-script; tab-width: 4; indent-tabs-mode: nil; -*-
++
++# ***** BEGIN LICENSE BLOCK *****
++# Version: MPL 1.1/GPL 2.0/LGPL 2.1
++#
++# The contents of this file are subject to the Mozilla Public License Version
++# 1.1 (the "License"); you may not use this file except in compliance with
++# the License. You may obtain a copy of the License at
++# http://www.mozilla.org/MPL/
++#
++# Software distributed under the License is distributed on an "AS IS" basis,
++# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
++# for the specific language governing rights and limitations under the
++# License.
++#
++# The Original Code is Mozilla JavaScript Testing Utilities
++#
++# The Initial Developer of the Original Code is
++# Mozilla Corporation.
++# Portions created by the Initial Developer are Copyright (C) 2008
++# the Initial Developer. All Rights Reserved.
++#
++# Contributor(s): Bob Clary <bclary@bclary.com>
++#
++# Alternatively, the contents of this file may be used under the terms of
++# either the GNU General Public License Version 2 or later (the "GPL"), or
++# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
++# in which case the provisions of the GPL or the LGPL are applicable instead
++# of those above. If you wish to allow use of your version of this file only
++# under the terms of either the GPL or the LGPL, and not to allow others to
++# use your version of this file under the terms of the MPL, indicate your
++# decision by deleting the provisions above and replace them with the notice
++# and other provisions required by the GPL or the LGPL. If you do not delete
++# the provisions above, a recipient may use your version of this file under
++# the terms of any one of the MPL, the GPL or the LGPL.
++#
++# ***** END LICENSE BLOCK *****
++
++if [[ ! -e "$1" || ! -e "$2" ]]; then
++    cat	<<EOF
++Usage: remove-fixed-failures.sh possible-fixes.log failures.log
++
++possible-fixes.log contains the possible fixes from the most recent
++test run.
++
++failures.log contains the current known failures.
++
++remove-fixed-failures.sh removes each pattern in possible-fixes.log
++from failures.log.
++
++The original failures.log is saved as failures.log.orig for safe keeping.
++
++EOF
++    exit 1
++fi
++
++fixes="$1"
++failures="$2"
++
++# save the original failures file in case of an error
++cp $failures $failures.orig
++
++# create a temporary file to contain the current list 
++# of failures.
++workfailures=`mktemp working-failures.XXXXX`
++workfixes=`mktemp working-fixes.XXXXX`
++
++trap "rm -f $workfailures; rm -f $temp" EXIT
++
++# create working copy of the failures file
++cp $failures $workfailures
++cp $fixes $workfixes
++
++sed -i 's|:[^:]*\.log||' $workfixes;
++
++grep -Fv -f $workfixes ${workfailures} > ${workfailures}.temp
++
++mv $workfailures.temp $workfailures
++
++mv $workfailures $failures
++
+Index: runtests.sh
+===================================================================
+RCS file: /cvsroot/mozilla/js/tests/runtests.sh,v
+retrieving revision 1.14
+diff -p -U 8 -r1.14 runtests.sh
+--- runtests.sh	1 May 2008 23:38:29 -0000	1.14
++++ runtests.sh	25 Jun 2008 17:31:17 -0000
+@@ -33,23 +33,23 @@
+ # decision by deleting the provisions above and replace them with the notice
+ # and other provisions required by the GPL or the LGPL. If you do not delete
+ # the provisions above, a recipient may use your version of this file under
+ # the terms of any one of the MPL, the GPL or the LGPL.
+ #
+ # ***** END LICENSE BLOCK *****
+ 
+ if [[ -z "$TEST_DIR" ]]; then
+-  cat <<EOF
++    cat <<EOF
+ `basename $0`: error
+ 
+ TEST_DIR, the location of the Sisyphus framework, 
+ is required to be set prior to calling this script.
+ EOF
+-  exit 2
++    exit 2
+ fi
+ 
+ if [[ ! -e $TEST_DIR/bin/library.sh ]]; then
+     echo "TEST_DIR=$TEST_DIR"
+     echo ""
+     echo "This script requires the Sisyphus testing framework. Please "
+     echo "cvs check out the Sisyphys framework from mozilla/testing/sisyphus"
+     echo "and set the environment variable TEST_DIR to the directory where it"
+@@ -61,78 +61,75 @@ fi
+ 
+ source $TEST_DIR/bin/library.sh
+ 
+ TEST_JSDIR=`dirname $0`
+ 
+ usage()
+ {
+     cat <<EOF
+-usage: runtests.sh -p products -b branches -T  buildtypes -B buildcommands  -e extra [-v] \\
+-                   -S -R -X excludetests -I includetests -c -t
++usage: runtests.sh -p products -b branches -e extra\\
++                   -T  buildtypes -B buildcommands  \\
++                   [-v] [-S] [-X excludetests] [-I includetests] [-c] [-t] \\
++                   [-Z n]
+ 
+ variable            description
+ ===============     ============================================================
+ -p products         space separated list of js, firefox
+--b branches         space separated list of branches 1.8.0, 1.8.1, 1.9.0
+--T buildtypes       space separated list of build types opt debug
++-b branches         space separated list of branches 1.8.0, 1.8.1, 1.9.0, 1.9.1
+ -e extra            optional. extra qualifier to pick build tree and mozconfig.
++-T buildtypes       space separated list of build types opt debug
+ -B buildcommands    optional space separated list of build commands
+                     clean, checkout, build. If not specified, defaults to
+                     'clean checkout build'. 
+                     If you wish to skip any build steps, simply specify a value
+                     not containing any of the build commands, e.g. 'none'.
+ -v                  optional. verbose - copies log file output to stdout.
+ -S                  optional. summary - output tailered for use with
+                     Buildbot|Tinderbox
+--R                  optional. by default the browser test will start Firefox
+-                    Spider and execute the tests one after another in the same
+-                    process. -R will start an new instance of Firefox for each
+-                    test. This has no effect for shell based tests.
+ -X excludetests     optional. By default the test will exclude the 
+                     tests listed in spidermonkey-n-\$branch.tests, 
+                     performance-\$branch.tests. excludetests is a list of either
+                     individual tests, manifest files or sub-directories which 
+                     will override the default exclusion list.
+ -I includetests     optional. By default the test will include the 
+                     JavaScript tests appropriate for the branch. includetests is a
+                     list of either individual tests, manifest files or 
+                     sub-directories which will override the default inclusion 
+                     list.
+--Z n                optional. Set gczeal to n. Currently, only valid for 
+-                    Gecko 1.9.0 and later.
+ -c                  optional. By default the test will exclude tests 
+                     which crash on this branch, test type, build type and 
+                     operating system. -c will include tests which crash. 
+                     Typically this should only be used in combination with -R. 
+                     This has no effect on shell based tests which execute crash
+                     tests regardless.
+ -t                  optional. By default the test will exclude tests 
+                     which time out on this branch, test type, build type and 
+                     operating system. -t will include tests which timeout.
++-Z n                optional. Set gczeal to n. Currently, only valid for 
++                    debug builds of Gecko 1.8.1.15, 1.9.0 and later.
+ 
+ if an argument contains more than one value, it must be quoted.
+ EOF
+     exit 2
+ }
+ 
+ verbose=0
+ 
+-while getopts "p:b:T:B:e:X:I:Z:vSRct" optname;
++while getopts "p:b:T:B:e:X:I:Z:vSct" optname;
+ do
+     case $optname in
+         p) products=$OPTARG;;
+         b) branches=$OPTARG;;
+         T) buildtypes=$OPTARG;;
+         e) extra="$OPTARG"
+             extraflag="-e $OPTARG";;
+         B) buildcommands=$OPTARG;;
+         v) verbose=1
+             verboseflag="-v";;
+-        R) restart=1;;
+         S) summary=1;;
+         X) excludetests=$OPTARG;;
+         I) includetests=$OPTARG;;
+         Z) gczeal="-Z $OPTARG";;
+         c) crashes=1;;
+         t) timeouts=1;;
+     esac
+ done
+@@ -175,68 +172,66 @@ testlogfiles="`grep '^log:' $testlogfile
+ 
+ fatalerrors=`grep 'FATAL ERROR' $testlogfiles | cat`
+ if [[ -n "$fatalerrors" ]]; then
+     testlogarray=( $testlogfiles )
+     let itestlog=${#testlogarray[*]}-1
+     error "`tail -n 20 ${testlogarray[$itestlog]}`" $LINENO
+ fi
+ 
+-case "$OSID" in
+-    win32)
+-        arch=all
+-        kernel=all
+-        ;;
+-    linux)
+-        arch="`uname -p`"
+-        kernel="`uname -r | sed 's|\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\)[-.0-9]*\.\([a-zA-Z0-9]*\)|\1.\2.\3.*\4|'`"
+-        ;;
+-    mac)
+-        arch="`uname -p`"
+-        kernel=all
+-        ;;
+-    *)
+-        error "$OSID not supported" $LINENO
+-        ;;
+-esac
+-
+ for testlogfile in $testlogfiles; do
+ 
+     if [[ -n "$DEBUG" ]]; then
+         dumpvars testlogfile
+     fi
+ 
+     case "$testlogfile" in
+         *,js,*) testtype=shell;;
+         *,firefox,*) testtype=browser;;
+         *) error "unknown testtype in logfile $testlogfile" $LINENO;;
+     esac
++
+     case "$testlogfile" in
+         *,opt,*) buildtype=opt;;
+         *,debug,*) buildtype=debug;;
++        *,nightly,*) buildtype=opt;;
+         *) error "unknown buildtype in logfile $testlogfile" $LINENO;;
+     esac
++
+     case "$testlogfile" in
+         *,1.8.0*) branch=1.8.0;;
+         *,1.8.1*) branch=1.8.1;;
+         *,1.9.0*) branch=1.9.0;;
++        *,1.9.1*) branch=1.9.1;;
+         *) error "unknown branch in logfile $testlogfile" $LINENO;;
+     esac
+     outputprefix=$testlogfile
+ 
+     if [[ -n "$DEBUG" ]]; then
+-        dumpvars branch buildtype testtype OSID testlogfile arch kernel outputprefix
++        dumpvars branch buildtype testtype OSID testlogfile TEST_PROCESSORTYPE TEST_KERNEL outputprefix
+     fi
+ 
+-    if ! $TEST_DIR/tests/mozilla.org/js/known-failures.pl -b $branch -T $buildtype -t $testtype -o "$OSID" -z `date +%z` -l $testlogfile -A "$arch" -K "$kernel" -r $TEST_JSDIR/failures.txt -O $outputprefix; then
++    if ! $TEST_DIR/tests/mozilla.org/js/known-failures.pl \
++        -b $branch \
++        -T $buildtype \
++        -t $testtype \
++        -o "$OSID" \
++        -K "$TEST_KERNEL" \
++        -A "$TEST_PROCESSORTYPE" \
++        -M "$TEST_MEMORY" \
++        -S "$TEST_CPUSPEED" \
++        -z `date +%z` \
++        -l $testlogfile \
++        -r $TEST_JSDIR/failures.txt \
++        -O $outputprefix; then
+         error "known-failures.pl" $LINENO
+     fi
+ 
+     if [[ -n "$summary" ]]; then
+-        
++
+         # use let to work around mac problem where numbers were
+         # output with leading characters.
+         # if let's arg evaluates to 0, let will return 1
+         # so we need to test
+ 
+         if let npass="`grep TEST_RESULT=PASSED ${outputprefix}-results-all.log | wc -l`"; then true; fi
+         if let nfail="`cat ${outputprefix}-results-failures.log | wc -l`"; then true; fi
+         if let nfixes="`cat ${outputprefix}-results-possible-fixes.log | wc -l`"; then true; fi
+@@ -247,11 +242,11 @@ for testlogfile in $testlogfiles; do
+         cat "${outputprefix}-results-failures.log"
+         echo -e "\nPossible Fixes:\n"
+         cat "${outputprefix}-results-possible-fixes.log"
+         echo -e "\nPossible Regressions:\n"
+         cat "${outputprefix}-results-possible-regressions.log"
+         echo -e "\nTinderboxPrint:<div title=\"$testlogfile\">\n"
+         echo -e "\nTinderboxPrint:js tests<br/>$branch $buildtype $testtype<br/>$npass/$nfail<br/>F:$nfixes R:$nregressions"
+         echo -e "\nTinderboxPrint:</div>\n"
+-
+     fi
++
+ done
+Index: shell.js
+===================================================================
+RCS file: /cvsroot/mozilla/js/tests/shell.js,v
+retrieving revision 1.6
+diff -p -U 8 -r1.6 shell.js
+--- shell.js	25 Apr 2008 17:52:13 -0000	1.6
++++ shell.js	25 Jun 2008 17:31:17 -0000
+@@ -155,18 +155,18 @@ function TestCase(n, d, e, a)
+ }
+ 
+ TestCase.prototype.dump = function () {
+   dump('\njstest: '      + this.path + ' ' +
+        'bug: '         + this.bugnumber + ' ' +
+        'result: '      + (this.passed ? 'PASSED':'FAILED') + ' ' +
+        'type: '        + this.type + ' ' +
+        'description: ' + toPrinted(this.description) + ' ' +
+-       'expected: '    + toPrinted(this.expect) + ' ' +
+-       'actual: '      + toPrinted(this.actual) + ' ' +
++//       'expected: '    + toPrinted(this.expect) + ' ' +
++//       'actual: '      + toPrinted(this.actual) + ' ' +
+        'reason: '      + toPrinted(this.reason) + '\n');
+ };
+ 
+ /*
+  * The test driver searches for such a phrase in the test output.
+  * If such phrase exists, it will set n as the expected exit code.
+  */
+ function expectExitCode(n)
+Index: test-browser.sh
+===================================================================
+RCS file: test-browser.sh
+diff -N test-browser.sh
+--- test-browser.sh	1 May 2008 23:38:30 -0000	1.12
++++ /dev/null	1 Jan 1970 00:00:00 -0000
+@@ -1,336 +0,0 @@
+-#!/bin/bash -e
+-# -*- Mode: Shell-script; tab-width: 4; indent-tabs-mode: nil; -*-
+-
+-# ***** BEGIN LICENSE BLOCK *****
+-# Version: MPL 1.1/GPL 2.0/LGPL 2.1
+-#
+-# The contents of this file are subject to the Mozilla Public License Version
+-# 1.1 (the "License"); you may not use this file except in compliance with
+-# the License. You may obtain a copy of the License at
+-# http://www.mozilla.org/MPL/
+-#
+-# Software distributed under the License is distributed on an "AS IS" basis,
+-# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+-# for the specific language governing rights and limitations under the
+-# License.
+-#
+-# The Original Code is Mozilla JavaScript Testing Utilities
+-#
+-# The Initial Developer of the Original Code is
+-# Mozilla Corporation.
+-# Portions created by the Initial Developer are Copyright (C) 2007
+-# the Initial Developer. All Rights Reserved.
+-#
+-# Contributor(s): Bob Clary <bclary@bclary.com>
+-#
+-# Alternatively, the contents of this file may be used under the terms of
+-# either the GNU General Public License Version 2 or later (the "GPL"), or
+-# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+-# in which case the provisions of the GPL or the LGPL are applicable instead
+-# of those above. If you wish to allow use of your version of this file only
+-# under the terms of either the GPL or the LGPL, and not to allow others to
+-# use your version of this file under the terms of the MPL, indicate your
+-# decision by deleting the provisions above and replace them with the notice
+-# and other provisions required by the GPL or the LGPL. If you do not delete
+-# the provisions above, a recipient may use your version of this file under
+-# the terms of any one of the MPL, the GPL or the LGPL.
+-#
+-# ***** END LICENSE BLOCK *****
+-
+-if [[ -z "$TEST_DIR" ]]; then
+-    cat <<EOF
+-`basename $0`: error
+-
+-TEST_DIR, the location of the Sisyphus framework, 
+-is required to be set prior to calling this script.
+-EOF
+-    exit 2
+-fi
+-
+-if [[ ! -e $TEST_DIR/bin/library.sh ]]; then
+-    echo "TEST_DIR=$TEST_DIR"
+-    echo ""
+-    echo "This script requires the Sisyphus testing framework. Please "
+-    echo "cvs check out the Sisyphys framework from mozilla/testing/sisyphus"
+-    echo "and set the environment variable TEST_DIR to the directory where it"
+-    echo "located."
+-    echo ""
+-
+-    exit 2
+-fi
+-
+-source $TEST_DIR/bin/library.sh
+-
+-TEST_JSDIR=`dirname $0`
+-
+-TEST_JSEACH_TIMEOUT=${TEST_JSEACH_TIMEOUT:-485}
+-TEST_JSEACH_PAGE_TIMEOUT=${TEST_JSEACH_PAGE_TIMEOUT:-480}
+-TEST_JSALL_TIMEOUT=${TEST_JSALL_TIMEOUT:-21600}
+-TEST_WWW_JS=`echo $TEST_JSDIR|sed "s|$TEST_DIR||"`
+-
+-#
+-# options processing
+-#
+-usage()
+-{
+-    cat <<EOF
+-usage: $SCRIPT -p product -b branch -T buildtype -x executablepath -N profilename \\
+-               -R -X excludetests -I includetests -c -t -F [-d datafiles]
+-
+-variable            description
+-===============     ============================================================
+--p product          required. firefox|thunderbird
+--b branch           required. 1.8.0|1.8.1|1.9.0
+--T buildtype        required. one of opt debug
+--x executablepath   required. directory-tree containing executable 'product'
+--N profilename      required. profile name 
+--R                  optional. by default the browser test will start Firefox
+-                    spider and execute the tests one after another in the same
+-                    process. -R will start an new instance of Firefox for each
+-                    test.
+--X excludetests     optional. By default the test will exclude the 
+-                    tests listed in spidermonkey-n-\$branch.tests, 
+-                    performance-\$branch.tests. excludetests is a list of either
+-                    individual tests, manifest files or sub-directories which 
+-                    will override the default exclusion list.
+--I includetests     optional. By default the test will include the 
+-                    JavaScript tests appropriate for the branch. includetests is a
+-                    list of either individual tests, manifest files or 
+-                    sub-directories which will override the default inclusion 
+-                    list.
+--Z n                Set gczeal to n. Only valid for Gecko 1.9.0 and later.
+--c                  optional. By default the test will exclude tests 
+-                    which crash on this branch, test type, build type and 
+-                    operating system. -c will include tests which crash. 
+-                    Typically this should only be used in combination with -R. 
+-                    This has no effect on shell based tests which execute crash
+-                    tests regardless.
+--t                  optional. By default the test will exclude tests 
+-                    which time out on this branch, test type, build type and 
+-                    operating system. -t will include tests which timeout.
+--F                  optional. Just generate file lists without running any tests.
+--d datafiles        optional. one or more filenames of files containing 
+-                    environment variable definitions to be included.
+-
+-                    note that the environment variables should have the same 
+-                    names as in the "variable" column.
+-
+-if an argument contains more than one value, it must be quoted.
+-EOF
+-    exit 2
+-}
+-
+-while getopts "p:b:T:x:N:d:X:I:Z:RctF" optname
+-do 
+-    case $optname in
+-        p) product=$OPTARG;;
+-        b) branch=$OPTARG;;
+-        T) buildtype=$OPTARG;;
+-        N) profilename=$OPTARG;;
+-        x) executablepath=$OPTARG;;
+-        R) restart=1;;
+-        X) excludetests=$OPTARG;;
+-        I) includetests=$OPTARG;;
+-        c) crashes=1;;
+-        t) timeouts=1;;
+-        F) filesonly=1;;
+-        Z) gczeal=";gczeal=$OPTARG";;
+-        d) datafiles=$OPTARG;;
+-    esac
+-done
+-
+-# include environment variables
+-if [[ -n "$datafiles" ]]; then
+-    for datafile in $datafiles; do 
+-        source $datafile
+-    done
+-fi
+-
+-dumpvars product branch buildtype profilename executablepath restart excludetests includetests crashes timeouts filesonly gczeal datafiles | sed "s|^|arguments: |"
+-
+-if [[ -z "$product" || -z "$branch" || -z "$executablepath" || -z "$profilename" ]]; then
+-    usage
+-fi
+-
+-executable=`get_executable $product $branch $executablepath`
+-
+-pushd $TEST_JSDIR
+-
+-rm -f finished-$branch-browser-$buildtype
+-
+-if ! make failures.txt; then
+-    error "during make failures.txt" $LINENO
+-fi
+-
+-includetestsfile="included-$branch-browser-$buildtype.tests"
+-rm -f $includetestsfile
+-touch $includetestsfile
+-
+-if [[ -z "$includetests" ]]; then
+-    # by default include tests appropriate for the branch
+-    includetests="e4x ecma ecma_2 ecma_3 js1_1 js1_2 js1_3 js1_4 js1_5 js1_6"
+-
+-    case "$branch" in 
+-        1.8.0)
+-            ;;
+-        1.8.1)
+-            includetests="$includetests js1_7"
+-            ;;
+-        1.9.0)
+-            includetests="$includetests js1_7 js1_8"
+-            ;;
+-    esac
+-fi
+-
+-for i in $includetests; do
+-    if [[ -f "$i" ]]; then
+-        echo "# including $i" >> $includetestsfile
+-        if echo $i | grep -q '\.js$'; then
+-            echo $i >> $includetestsfile
+-        else
+-            cat $i >> $includetestsfile
+-        fi
+-    elif [[ -d "$i" ]]; then
+-        find $i -name '*.js' -print | egrep -v '(shell|browser|template|jsref|userhook.*|\.#.*)\.js' | sed 's/^\.\///' | sort >> $includetestsfile
+-    fi
+-done
+-
+-excludetestsfile="excluded-$branch-browser-$buildtype.tests"
+-rm -f $excludetestsfile
+-touch $excludetestsfile
+-
+-if [[ -z "$excludetests" ]]; then
+-    excludetests="spidermonkey-n-$branch.tests performance-$branch.tests"
+-fi
+-
+-for e in $excludetests; do
+-    if [[ -f "$e" ]]; then
+-        echo "# excluding $e" >> $excludetestsfile
+-        if echo $e | grep -q '\.js$'; then
+-            echo $e >> $excludetestsfile
+-        else
+-            cat $e >> $excludetestsfile
+-        fi
+-    elif [[ -d "$e" ]]; then
+-        find $e -name '*.js' -print | egrep -v '(shell|browser|template|jsref|userhook.*|\.#.*)\.js' | sed 's/^\.\///' | sort >> $excludetestsfile
+-    fi
+-done
+-
+-case "$OSID" in
+-    win32)
+-        arch='.*'
+-        kernel='.*'
+-        ;;
+-    linux)
+-        arch="`uname -p`"
+-        kernel="`uname -r | sed 's|\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\)[-.0-9]*\.\([a-zA-Z0-9]*\)|\1.\2.\3.*\4|'`"
+-        ;;
+-    mac)
+-        arch="`uname -p`"
+-        kernel='[^,]*'
+-        ;;
+-    *)
+-        error "$OSID not supported" $LINENO
+-        ;;
+-esac
+-
+-if [[ -z "$timeouts" ]]; then
+-    echo "# exclude tests that time out" >> $excludetestsfile
+-    egrep "TEST_BRANCH=([^,]*$branch[^,]*|[.][*]), TEST_RESULT=FAILED, TEST_BUILDTYPE=([^,]*$buildtype[^,]*|[.][*]), TEST_TYPE=([^,]*browser[^,]*|[.][*]), TEST_OS=([^,]*$OSID[^,]*|[.][*]), .*, TEST_PROCESSORTYPE=([^,]*$arch[^,]*|[.][*]), TEST_KERNEL=([^,]*$kernel[^,]*|[.][*]), .*, TEST_DESCRIPTION=.*EXIT STATUS: TIMED OUT" \
+-        failures.txt  | sed 's/TEST_ID=\([^,]*\),.*/\1/' | sort | uniq >> $excludetestsfile
+-fi
+-
+-if [[ -z "$crashes" ]]; then
+-    echo "# exclude tests that crash" >> $excludetestsfile
+-    pattern="TEST_BRANCH=([^,]*$branch[^,]*|[.][*]), TEST_RESULT=FAILED, TEST_BUILDTYPE=([^,]*$buildtype[^,]*|[.][*]), TEST_TYPE=([^,]*browser[^,]*|[.][*]), TEST_OS=([^,]*$OSID[^,]*|[.][*]), .*, TEST_PROCESSORTYPE=([^,]*$arch[^,]*|[.][*]), TEST_KERNEL=([^,]*$kernel[^,]*|[.][*]), .*, TEST_DESCRIPTION=.*"
+-    case "$buildtype" in
+-        opt)
+-            pattern="${pattern}EXIT STATUS: CRASHED"
+-            ;;
+-        debug)
+-            pattern="${pattern}(EXIT STATUS: CRASHED|Assertion failure:)"
+-            ;;
+-    esac
+-    egrep "$pattern" failures.txt  | sed 's/TEST_ID=\([^,]*\),.*/\1/' | sort | uniq >> $excludetestsfile
+-
+-fi
+-
+-urllist="urllist-$branch-browser-$buildtype.tests"
+-urlhtml="urllist-$branch-browser-$buildtype.html"
+-
+-rm -f $urllist $urlhtml
+-
+-cat > $urlhtml <<EOF
+-<html xmlns="http://www.w3.org/1999/xhtml">
+-<head>
+-<title>JavaScript Tests</title>
+-</head>
+-<body>
+-<ul>
+-EOF
+-
+-cat $includetestsfile | while read jsfile
+-do
+-    if echo $jsfile | grep -q '^#'; then
+-        continue
+-    fi
+-
+-    if ! grep -q $jsfile $excludetestsfile; then
+-
+-        result=`echo $jsfile | sed 's/.*js\([0-9]\)_\([0-9]\).*/\1.\2/'`
+-
+-        case $result in
+-            1.5) version=";version=1.5";;
+-            1.6) version=";version=1.6";;
+-            1.7) version=";version=1.7";;
+-            1.8) version=";version=1.8";;
+-            1.9) version=";version=1.9";;
+-            2.0) version=";version=2.0";;
+-            *) version="";;
+-        esac
+-        
+-        echo "http://$TEST_HTTP/$TEST_WWW_JS/js-test-driver-standards.html?test=$jsfile;language=type;text/javascript$version$gczeal" >> $urllist
+-        echo "<li><a href='http://$TEST_HTTP/$TEST_WWW_JS/js-test-driver-standards.html?test=$jsfile;language=type;text/javascript$version$gczeal'>$jsfile</a></li>" >> $urlhtml
+-    fi
+-done
+-
+-cat >> $urlhtml <<EOF
+-</ul>
+-</body>
+-</html>
+-EOF
+-
+-chmod a+r $urlhtml
+-
+-cat $includetestsfile | sed 's|^|include: |'
+-cat $excludetestsfile | sed 's|^|exclude: |'
+-
+-if [[ -z "$filesonly" ]]; then
+-    if [[ "$restart" == "1" ]]; then
+-        cat "$urllist" | while read url; 
+-        do 
+-            edit-talkback.sh -p "$product" -b "$branch" -x "$executablepath" -i "$url"
+-            if time timed_run.py $TEST_JSEACH_TIMEOUT "$url" \
+-                "$executable" -P "$profilename" \
+-                -spider -start -quit \
+-                -uri "$url" \
+-                -depth 0 -timeout "$TEST_JSEACH_PAGE_TIMEOUT" \
+-                -hook "http://$TEST_HTTP/$TEST_WWW_JS/userhookeach.js"; then
+-                true;
+-            fi
+-
+-        done
+-    else
+-        edit-talkback.sh -p "$product" -b "$branch" -x "$executablepath" -i "http://$TEST_HTTP/$TEST_WWW_JS/$urlhtml"
+-        if ! time timed_run.py $TEST_JSALL_TIMEOUT "http://$TEST_HTTP/$TEST_WWW_JS/$urlhtml" \
+-            "$executable" -P "$profilename" \
+-            -spider -start -quit \
+-            -uri "http://$TEST_HTTP/$TEST_WWW_JS/$urlhtml" \
+-            -depth 1 -timeout "$TEST_JSEACH_PAGE_TIMEOUT" \
+-            -hook "http://$TEST_HTTP/$TEST_WWW_JS/userhookeach.js"; then
+-            error "timed_run.py ended abnormally: $?" $LINENO
+-        fi
+-    fi
+-fi
+-
+-popd
+Index: test-shell.sh
+===================================================================
+RCS file: test-shell.sh
+diff -N test-shell.sh
+--- test-shell.sh	1 May 2008 23:38:30 -0000	1.11
++++ /dev/null	1 Jan 1970 00:00:00 -0000
+@@ -1,261 +0,0 @@
+-#!/bin/bash -e
+-# -*- Mode: Shell-script; tab-width: 4; indent-tabs-mode: nil; -*-
+-
+-# ***** BEGIN LICENSE BLOCK *****
+-# Version: MPL 1.1/GPL 2.0/LGPL 2.1
+-#
+-# The contents of this file are subject to the Mozilla Public License Version
+-# 1.1 (the "License"); you may not use this file except in compliance with
+-# the License. You may obtain a copy of the License at
+-# http://www.mozilla.org/MPL/
+-#
+-# Software distributed under the License is distributed on an "AS IS" basis,
+-# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+-# for the specific language governing rights and limitations under the
+-# License.
+-#
+-# The Original Code is Mozilla JavaScript Testing Utilities
+-#
+-# The Initial Developer of the Original Code is
+-# Mozilla Corporation.
+-# Portions created by the Initial Developer are Copyright (C) 2007
+-# the Initial Developer. All Rights Reserved.
+-#
+-# Contributor(s): Bob Clary <bclary@bclary.com>
+-#
+-# Alternatively, the contents of this file may be used under the terms of
+-# either the GNU General Public License Version 2 or later (the "GPL"), or
+-# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+-# in which case the provisions of the GPL or the LGPL are applicable instead
+-# of those above. If you wish to allow use of your version of this file only
+-# under the terms of either the GPL or the LGPL, and not to allow others to
+-# use your version of this file under the terms of the MPL, indicate your
+-# decision by deleting the provisions above and replace them with the notice
+-# and other provisions required by the GPL or the LGPL. If you do not delete
+-# the provisions above, a recipient may use your version of this file under
+-# the terms of any one of the MPL, the GPL or the LGPL.
+-#
+-# ***** END LICENSE BLOCK *****
+-
+-if [[ -z "$TEST_DIR" ]]; then
+-    cat <<EOF
+-`basename $0`: error
+-
+-TEST_DIR, the location of the Sisyphus framework, 
+-is required to be set prior to calling this script.
+-EOF
+-    exit 2
+-fi
+-
+-if [[ ! -e $TEST_DIR/bin/library.sh ]]; then
+-    echo "TEST_DIR=$TEST_DIR"
+-    echo ""
+-    echo "This script requires the Sisyphus testing framework. Please "
+-    echo "cvs check out the Sisyphys framework from mozilla/testing/sisyphus"
+-    echo "and set the environment variable TEST_DIR to the directory where it"
+-    echo "located."
+-    echo ""
+-
+-    exit 2
+-fi
+-
+-source $TEST_DIR/bin/library.sh
+-
+-TEST_JSDIR=`dirname $0`
+-TEST_JSSHELL_TIMEOUT=${TEST_JSSHELL_TIMEOUT:-480}
+-
+-#
+-# options processing
+-#
+-usage()
+-{
+-    cat <<EOF
+-usage: $SCRIPT -b branch -s sourcepath -T buildtype [-d datafiles]
+-
+-variable            description
+-===============     ===========================================================
+--p product          required. js
+--b branch           required. 1.8.0|1.8.1|1.9.0
+--s sourcepath       required. path to js shell source directory mozilla/js/src
+--T buildtype        required. one of opt debug
+--X excludetests     optional. By default the test will exclude the 
+-                    tests listed in spidermonkey-n-\$branch.tests, 
+-                    performance-\$branch.tests. excludetests is a list of either
+-                    individual tests, manifest files or sub-directories which 
+-                    will override the default exclusion list.
+--I includetests     optional. By default the test will include the 
+-                    JavaScript tests appropriate for the branch. includetests is a
+-                    list of either individual tests, manifest files or 
+-                    sub-directories which will override the default inclusion 
+-                    list.
+--Z n                optional. Set gczeal to n. Currently, only valid for 
+-                    Gecko 1.9.0 and later.
+--c                  optional. By default the test will exclude tests 
+-                    which crash on this branch, test type, build type and 
+-                    operating system. -c will include tests which crash. 
+-                    Typically this should only be used in combination with -R. 
+-                    This has no effect on shell based tests which execute crash
+-                    tests regardless.
+--t                  optional. By default the test will exclude tests 
+-                    which time out on this branch, test type, build type and 
+-                    operating system. -t will include tests which timeout.
+--d datafiles        optional. one or more filenames of files containing 
+-                    environment variable definitions to be included.
+-
+-EOF
+-    exit 2
+-}
+-
+-while getopts "b:s:T:d:X:I:Z:ct" optname
+-do 
+-    case $optname in
+-        b) branch=$OPTARG;;
+-        s) sourcepath=$OPTARG;;
+-        T) buildtype=$OPTARG;;
+-        X) excludetests=$OPTARG;;
+-        I) includetests=$OPTARG;;
+-        C) crashes=1;;
+-        T) timeouts=1;;
+-        Z) gczeal="-Z $OPTARG";;
+-        d) datafiles=$OPTARG;;
+-    esac
+-done
+-
+-# include environment variables
+-if [[ -n "$datafiles" ]]; then
+-    for datafile in $datafiles; do 
+-        source $datafile
+-    done
+-fi
+-
+-dumpvars branch sourcepath buildtype excludetests includetests crashes timeouts gczeal datafiles | sed "s|^|arguments: |"
+-
+-if [[ -z "$branch" || -z "$sourcepath" || -z "$buildtype" ]]; then
+-    usage
+-fi
+-
+-pushd $TEST_JSDIR
+-
+-rm -f finished-$branch-shell-$buildtype
+-
+-. config.sh
+-
+-executable="$sourcepath/$JS_OBJDIR/js$EXE_EXT"
+-
+-if ! make failures.txt; then
+-    error "during make failures.txt" $LINENO
+-fi
+-
+-#includetestsfile=`mktemp includetestsfile.XXXXX`
+-includetestsfile="included-$branch-shell-$buildtype.tests"
+-rm -f $includetestsfile
+-touch $includetestsfile
+-
+-if [[ -z "$includetests" ]]; then
+-
+-    # by default include tests appropriate for the branch
+-    includetests="e4x ecma ecma_2 ecma_3 js1_1 js1_2 js1_3 js1_4 js1_5 js1_6"
+-
+-    case "$branch" in 
+-        1.8.0)
+-            ;;
+-        1.8.1)
+-            includetests="$includetests js1_7"
+-            ;;
+-        1.9.0)
+-            includetests="$includetests js1_7 js1_8"
+-            ;;
+-    esac
+-fi
+-
+-for i in $includetests; do
+-    if [[ -f "$i" ]]; then
+-        echo "# including $i" >> $includetestsfile
+-        if echo $i | grep -q '\.js$'; then
+-            echo $i >> $includetestsfile
+-        else
+-            cat $i >> $includetestsfile
+-        fi
+-    elif [[ -d "$i" ]]; then
+-        find $i -name '*.js' -print | egrep -v '(shell|browser|template|jsref|userhook.*|\.#.*)\.js' | sed 's/^\.\///' | sort >> $includetestsfile
+-    fi
+-done
+-
+-#excludetestsfile=`mktemp excludetestsfile.XXXXX`
+-excludetestsfile="excluded-$branch-shell-$buildtype.tests"
+-rm -f $excludetestsfile
+-touch $excludetestsfile
+-
+-if [[ -z "$excludetests" ]]; then
+-    excludetests="spidermonkey-n-$branch.tests performance-$branch.tests"
+-fi
+-
+-for e in $excludetests; do
+-    if [[ -f "$e" ]]; then
+-        echo "# excluding $e" >> $excludetestsfile
+-        if echo $e | grep -q '\.js$'; then
+-            echo $e >> $excludetestsfile
+-        else
+-            cat $e >> $excludetestsfile
+-        fi
+-    elif [[ -d "$e" ]]; then
+-        find $e -name '*.js' -print | egrep -v '(shell|browser|template|userhook.*|\.#.*).js' | sed 's/^\.\///' | sort >> $excludetestsfile
+-    fi
+-done
+-
+-case "$OSID" in
+-    win32)
+-        arch='.*'
+-        kernel='.*'
+-        ;;
+-    linux)
+-        arch="`uname -p`"
+-        kernel="`uname -r | sed 's|\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\)[-.0-9]*\.\([a-zA-Z0-9]*\)|\1.\2.\3.*\4|'`"
+-        ;;
+-    mac)
+-        arch="`uname -p`"
+-        kernel='[^,]*'
+-        ;;
+-    *)
+-        error "$product-$branch-$buildtype: $OSID not supported" $LINENO
+-        ;;
+-esac
+-
+-if [[ -z "$timeouts" ]]; then
+-    echo "# exclude tests that time out" >> $excludetestsfile
+-    egrep "TEST_BRANCH=([^,]*$branch[^,]*|[.][*]), TEST_RESULT=FAILED, TEST_BUILDTYPE=([^,]*$buildtype[^,]*|[.][*]), TEST_TYPE=([^,]*shell[^,]*|[.][*]), TEST_OS=([^,]*$OSID[^,]*|[.][*]), .*, TEST_PROCESSORTYPE=([^,]*$arch[^,]*|[.][*]), TEST_KERNEL=([^,]*$kernel[^,]*|[.][*]), .*, TEST_DESCRIPTION=.*EXIT STATUS: TIMED OUT" \
+-        failures.txt  | sed 's/TEST_ID=\([^,]*\),.*/\1/' | sort | uniq >> $excludetestsfile
+-fi
+-
+-if [[ -z "$crashes" ]]; then
+-    echo "# exclude tests that crash" >> $excludetestsfile
+-    pattern="TEST_BRANCH=([^,]*$branch[^,]*|[.][*]), TEST_RESULT=FAILED, TEST_BUILDTYPE=([^,]*$buildtype[^,]*|[.][*]), TEST_TYPE=([^,]*shell[^,]*|[.][*]), TEST_OS=([^,]*$OSID[^,]*|[.][*]), .*, TEST_PROCESSORTYPE=([^,]*$arch[^,]*|[.][*]), TEST_KERNEL=([^,]*$kernel[^,]*|[.][*]), .*, TEST_DESCRIPTION=.*"
+-    case "$buildtype" in
+-        opt)
+-            pattern="${pattern}EXIT STATUS: CRASHED"
+-            ;;
+-        debug)
+-            pattern="${pattern}(EXIT STATUS: CRASHED|Assertion failure:)"
+-            ;;
+-    esac
+-    egrep "$pattern" failures.txt  | sed 's/TEST_ID=\([^,]*\),.*/\1/' | sort | uniq >> $excludetestsfile
+-
+-fi
+-
+-cat $includetestsfile | sed 's|^|include: |'
+-cat $excludetestsfile | sed 's|^|exclude: |'
+-
+-if ! time perl jsDriver.pl \
+-    -l $includetestsfile \
+-    -L $excludetestsfile \
+-    -s $executable \
+-    -e sm$buildtype \
+-    -o "-S 524288 $gczeal" \
+-    -R \
+-    -T $TEST_JSSHELL_TIMEOUT \
+-    -f /dev/null \
+-    -Q; then
+-    error "$product-$branch-$buildtype-$OSID: jsDriver.pl" $LINENO
+-fi
+-
+-popd
+Index: test.sh
+===================================================================
+RCS file: /cvsroot/mozilla/js/tests/test.sh,v
+retrieving revision 1.8
+diff -p -U 8 -r1.8 test.sh
+--- test.sh	10 Apr 2008 20:35:58 -0000	1.8
++++ test.sh	25 Jun 2008 17:31:17 -0000
+@@ -33,23 +33,23 @@
+ # decision by deleting the provisions above and replace them with the notice
+ # and other provisions required by the GPL or the LGPL. If you do not delete
+ # the provisions above, a recipient may use your version of this file under
+ # the terms of any one of the MPL, the GPL or the LGPL.
+ #
+ # ***** END LICENSE BLOCK *****
+ 
+ if [[ -z "$TEST_DIR" ]]; then
+-  cat <<EOF
++    cat <<EOF
+ `basename $0`: error
+ 
+ TEST_DIR, the location of the Sisyphus framework, 
+ is required to be set prior to calling this script.
+ EOF
+-  exit 2
++    exit 2
+ fi
+ 
+ if [[ ! -e $TEST_DIR/bin/library.sh ]]; then
+     echo "TEST_DIR=$TEST_DIR"
+     echo ""
+     echo "This script requires the Sisyphus testing framework. Please "
+     echo "cvs check out the Sisyphys framework from mozilla/testing/sisyphus"
+     echo "and set the environment variable TEST_DIR to the directory where it"
+@@ -58,60 +58,356 @@ if [[ ! -e $TEST_DIR/bin/library.sh ]]; 
+ 
+     exit 2
+ fi
+ 
+ source $TEST_DIR/bin/library.sh
+ 
+ TEST_JSDIR=`dirname $0`
+ 
++TEST_JSSHELL_TIMEOUT=${TEST_JSSHELL_TIMEOUT:-480}
++TEST_JSEACH_TIMEOUT=${TEST_JSEACH_TIMEOUT:-485}
++TEST_JSEACH_PAGE_TIMEOUT=${TEST_JSEACH_PAGE_TIMEOUT:-480}
++TEST_JSALL_TIMEOUT=${TEST_JSALL_TIMEOUT:-21600}
++TEST_WWW_JS=`echo $TEST_JSDIR|sed "s|$TEST_DIR||"`
++
+ #
+ # options processing
+ #
+ usage()
+ {
+     cat <<EOF
+-usage: $SCRIPT -d datafiles
+-
+-This script is used to dispatch to either test-browser.sh
+-for browser based JavaScript tests or test-shell.js for 
+-shell based JavaScript tests. It ignores all input arguments
+-except -d datafiles which it uses to pass data to the 
+-appropriate script.
++usage: test.sh -p product -b branch -T buildtype -x executablepath -N profilename \\
++               [-X excludetests] [-I includetests] [-c] [-t] [-F] [-d datafiles]
+ 
+ variable            description
+ ===============     ============================================================
++-p product          required. firefox|thunderbird|js
++-b branch           required. 1.8.0|1.8.1|1.9.0|1.9.1
++-s sourcepath       required for shell. path to js shell source directory mozilla/js/src
++-T buildtype        required. one of opt debug
++-x executablepath   required for browser. directory-tree containing executable 'product'
++-N profilename      required for browser. profile name 
++-X excludetests     optional. By default the test will exclude the 
++                    tests listed in spidermonkey-n-\$branch.tests, 
++                    performance-\$branch.tests. excludetests is a list of either
++                    individual tests, manifest files or sub-directories which 
++                    will override the default exclusion list.
++-I includetests     optional. By default the test will include the 
++                    JavaScript tests appropriate for the branch. includetests is a
++                    list of either individual tests, manifest files or 
++                    sub-directories which will override the default inclusion 
++                    list.
++-c                  optional. By default the test will exclude tests 
++                    which crash on this branch, test type, build type and 
++                    operating system. -c will include tests which crash. 
++                    Typically this should only be used in combination with -R. 
++                    This has no effect on shell based tests which execute crash
++                    tests regardless.
++-t                  optional. By default the test will exclude tests 
++                    which time out on this branch, test type, build type and 
++                    operating system. -t will include tests which timeout.
++-Z n                optional. Set gczeal to n. Currently, only valid for 
++                    debug builds of Gecko 1.8.1.15, 1.9.0 and later.
++-F                  optional. Just generate file lists without running any tests.
+ -d datafiles        optional. one or more filenames of files containing 
+                     environment variable definitions to be included.
+--Z n                optional. Set gczeal to n. Currently, only valid for 
+-                    Gecko 1.9.0 and later.
++
++                    note that the environment variables should have the same 
++                    names as in the "variable" column.
++
+ if an argument contains more than one value, it must be quoted.
+ EOF
+     exit 2
+ }
+ 
+-unset datafiles
+-
+-while getopts "d:Z:" optname ; 
++while getopts "p:b:s:T:x:N:d:X:I:Z:RctF" optname
+ do 
+     case $optname in
++        p) 
++            product=$OPTARG;;
++        b) 
++            branch=$OPTARG;;
++        T) 
++            buildtype=$OPTARG;;
++        s) 
++            sourcepath=$OPTARG;;
++        N) 
++            profilename=$OPTARG;;
++        x) 
++            executablepath=$OPTARG;;
++        X) 
++            excludetests=$OPTARG;;
++        I) 
++            includetests=$OPTARG;;
++        c) 
++            crashes=1;;
++        t) 
++            timeouts=1;;
++        F) 
++            filesonly=1;;
++        Z)  
++            gczealshell="-Z $OPTARG"
++            gczealbrowser=";gczeal=$OPTARG"
++            ;;
+         d) datafiles=$OPTARG;;
+-        Z) gczeal="-Z $OPTARG";;
+     esac
+ done
+ 
+-if [[ -z "$datafiles" ]]; then
+-    usage
++# include environment variables
++if [[ -n "$datafiles" ]]; then
++    for datafile in $datafiles; do 
++        source $datafile
++    done
++fi
++
++if [[ -n "$gczeal" && "$buildtype" != "debug" ]]; then
++    error "gczeal is supported for buildtype debug and not $buildtype"
++fi
++
++dumpvars product branch buildtype sourcepath profilename executablepath excludetests includetests crashes timeouts filesonly gczeal datafiles | sed "s|^|arguments: |"
++
++pushd $TEST_JSDIR
++
++case $product in
++    js)
++        if [[ -z "$branch" || -z "$buildtype"  || -z "$sourcepath" ]]; then
++            usage
++        fi
++        source config.sh
++        testtype=shell
++        executable="$sourcepath/$JS_OBJDIR/js$EXE_EXT"
++        ;;
++
++    firefox|thunderbird)
++        if [[ -z "$branch" || -z "$buildtype"  || -z "$executablepath" || -z "$profilename" ]]; then
++            usage
++        fi
++        testtype=browser
++        executable=`get_executable $product $branch $executablepath`
++
++        ;;
++    *)
++        echo "Unknown product: $product"
++        usage
++        ;;
++esac
++
++rm -f finished-$branch-$testtype-$buildtype
++
++if ! make failures.txt; then
++    error "during make failures.txt" $LINENO
++fi
++
++includetestsfile="included-$branch-$testtype-$buildtype.tests"
++rm -f $includetestsfile
++touch $includetestsfile
++
++if [[ -z "$includetests" ]]; then
++    # by default include tests appropriate for the branch
++    includetests="e4x ecma ecma_2 ecma_3 js1_1 js1_2 js1_3 js1_4 js1_5 js1_6"
++
++    case "$branch" in 
++        1.8.0)
++            ;;
++        1.8.1)
++            includetests="$includetests js1_7"
++            ;;
++        1.9.0)
++            includetests="$includetests js1_7 js1_8"
++            ;;
++        1.9.1)
++            includetests="$includetests js1_7 js1_8"
++            ;;
++    esac
++fi
++
++for i in $includetests; do
++    if [[ -f "$i" ]]; then
++        echo "# including $i" >> $includetestsfile
++        if echo $i | grep -q '\.js$'; then
++            echo $i >> $includetestsfile
++        else
++            cat $i >> $includetestsfile
++        fi
++    elif [[ -d "$i" ]]; then
++        find $i -name '*.js' -print | egrep -v '(shell|browser|template|jsref|userhook.*|\.#.*)\.js' | sed 's/^\.\///' | sort >> $includetestsfile
++    fi
++done
++
++excludetestsfile="excluded-$branch-$testtype-$buildtype.tests"
++rm -f $excludetestsfile
++touch $excludetestsfile
++
++if [[ -z "$excludetests" ]]; then
++    excludetests="spidermonkey-n-$branch.tests performance-$branch.tests"
+ fi
+ 
+-for data in $datafiles; do
+-    source $data
++for e in $excludetests; do
++    if [[ -f "$e" ]]; then
++        echo "# excluding $e" >> $excludetestsfile
++        if echo $e | grep -q '\.js$'; then
++            echo $e >> $excludetestsfile
++        else
++            cat $e >> $excludetestsfile
++        fi
++    elif [[ -d "$e" ]]; then
++        find $e -name '*.js' -print | egrep -v '(shell|browser|template|jsref|userhook.*|\.#.*)\.js' | sed 's/^\.\///' | sort >> $excludetestsfile
++    fi
+ done
+ 
+-case "$product" in
+-    firefox) testscript=$TEST_JSDIR/test-browser.sh;;
+-    js) testscript=$TEST_JSDIR/test-shell.sh;;
+-    *) echo "unknown product [$product]"
+-        exit 2
++# convert the numeric speed rating to a prose value
++if [[ $TEST_CPUSPEED -lt 4 ]]; then
++    TEST_CPUSPEED=slow
++elif [[ $TEST_CPUSPEED -lt 9 ]]; then
++    TEST_CPUSPEED=medium
++else
++    TEST_CPUSPEED=fast
++fi
++
++pattern="TEST_BRANCH=($branch|[.][*]), TEST_BUILDTYPE=($buildtype|[.][*]), TEST_TYPE=($testtype|[.][*]), TEST_OS=($OSID|[.][*]), TEST_KERNEL=($TEST_KERNEL|[.][*]), TEST_PROCESSORTYPE=($TEST_PROCESSORTYPE|[.][*]), TEST_MEMORY=($TEST_MEMORY|[.][*]), TEST_CPUSPEED=($TEST_CPUSPEED|[.][*]),"
++
++if [[ -z "$timeouts" ]]; then
++    echo "# exclude tests that time out" >> $excludetestsfile
++    echo "$pattern .*TEST_EXITSTATUS=TIMED OUT," >> $excludetestsfile
++    egrep "$pattern .*TEST_EXITSTATUS=TIMED OUT," failures.txt | \
++        sed 's/.*TEST_ID=\([^,]*\),.*/\1/' | sort -u >> $excludetestsfile
++fi
++
++if [[ -z "$crashes" ]]; then
++    echo "# exclude tests that crash" >> $excludetestsfile
++    echo "$pattern .*TEST_EXITSTATUS=(CRASHED|ABNORMAL)" >> $excludetestsfile
++    egrep "$pattern .*TEST_EXITSTATUS=(CRASHED|ABNORMAL)" failures.txt  | \
++        sed 's/.*TEST_ID=\([^,]*\),.*/\1/' | sort -u >> $excludetestsfile
++
++fi
++
++cat $includetestsfile | sed 's|^|include: |'
++cat $excludetestsfile | sed 's|^|exclude: |'
++
++case $testtype in
++    shell)
++        echo "JavaScriptTest: Begin Run"
++        cat $includetestsfile | while read jsfile
++        do
++            if echo $jsfile | grep -q '^#'; then
++                continue
++            fi
++
++            if ! grep -q $jsfile $excludetestsfile; then
++
++                result=`echo $jsfile | sed 's/.*js\([0-9]\)_\([0-9]\).*/\1.\2/'`
++
++                case $result in
++                    1.5) version="150";;
++                    1.6) version="160";;
++                    1.7) version="170";;
++                    1.8) version="180";;
++                    1.9) version="190";;
++                    2.0) version="200";;
++                    *) version="150";;
++                esac
++                
++                subsuitetestdir=`dirname $jsfile`
++                suitetestdir=`dirname $subsuitetestdir`
++                echo "JavaScriptTest: Begin Test $jsfile"
++                if eval $TIMECOMMAND timed_run.py $TEST_JSEACH_TIMEOUT \"$jsfile\" \
++                    $EXECUTABLE_DRIVER \
++                    $executable -v $version \
++                    -S 524288 \
++                    $gczealshell \
++                    -f ./shell.js \
++                    -f $suitetestdir/shell.js \
++                    -f $subsuitetestdir/shell.js \
++                    -f ./$jsfile \
++                    -f ./js-test-driver-end.js; then
++                    true
++                else
++                    rc=$?
++                fi
++                if [[ $rc == 99 ]]; then
++                    error "User Interrupt"
++                fi
++                echo "JavaScriptTest: End Test $jsfile"
++            fi
++        done
++        echo "JavaScriptTest: End Run"
++        ;;
++
++    browser)
++        urllist="urllist-$branch-$testtype-$buildtype.tests"
++        urlhtml="urllist-$branch-$testtype-$buildtype.html"
++
++        rm -f $urllist $urlhtml
++
++        cat > $urlhtml <<EOF
++<html xmlns="http://www.w3.org/1999/xhtml">
++<head>
++<title>JavaScript Tests</title>
++</head>
++<body>
++<ul>
++EOF
++
++        cat $includetestsfile | while read jsfile
++        do
++            if echo $jsfile | grep -q '^#'; then
++                continue
++            fi
++
++            if ! grep -q $jsfile $excludetestsfile; then
++
++                result=`echo $jsfile | sed 's/.*js\([0-9]\)_\([0-9]\).*/\1.\2/'`
++
++                case $result in
++                    1.5) version=";version=1.5";;
++                    1.6) version=";version=1.6";;
++                    1.7) version=";version=1.7";;
++                    1.8) version=";version=1.8";;
++                    1.9) version=";version=1.9";;
++                    2.0) version=";version=2.0";;
++                    *) version="";;
++                esac
++                
++                echo "http://$TEST_HTTP/$TEST_WWW_JS/js-test-driver-standards.html?test=$jsfile;language=type;text/javascript$version$gczealbrowser" >> $urllist
++                echo "<li><a href='http://$TEST_HTTP/$TEST_WWW_JS/js-test-driver-standards.html?test=$jsfile;language=type;text/javascript$version$gczealbrowser'>$jsfile</a></li>" >> $urlhtml
++            fi
++        done
++
++        cat >> $urlhtml <<EOF
++</ul>
++</body>
++</html>
++EOF
++
++        chmod a+r $urlhtml
++
++        if [[ -z "$filesonly" ]]; then
++            echo "JavaScriptTest: Begin Run"
++            cat "$urllist" | while read url; 
++            do 
++                edit-talkback.sh -p "$product" -b "$branch" -x "$executablepath" -i "$url"
++                jsfile=`echo $url | sed "s|http://$TEST_HTTP/$TEST_WWW_JS/js-test-driver-standards.html?test=\([^;]*\);.*|\1|"`
++                echo "JavaScriptTest: Begin Test $jsfile"
++                if eval $TIMECOMMAND timed_run.py $TEST_JSEACH_TIMEOUT \"$jsfile\" \
++                    $EXECUTABLE_DRIVER \
++                    \"$executable\" -P \"$profilename\" \
++                    -spider -start -quit \
++                    -uri \"$url\" \
++                    -depth 0 -timeout \"$TEST_JSEACH_PAGE_TIMEOUT\" \
++                    -hook \"http://$TEST_HTTP/$TEST_WWW_JS/userhookeach.js\"; then
++                    true
++                else
++                    rc=$?
++                fi
++                if [[ $rc == 99 ]]; then
++                    error "User Interrupt"
++                fi
++                echo "JavaScriptTest: End Test $jsfile"
++            done
++            echo "JavaScriptTest: End Run"
++        fi
++        ;;
++    *)
+         ;;
+ esac
+ 
+-$testscript -d "$datafiles" $gczeal
++popd
+Index: universe.data
+===================================================================
+RCS file: universe.data
+diff -N universe.data
+--- /dev/null	1 Jan 1970 00:00:00 -0000
++++ universe.data	25 Jun 2008 17:31:17 -0000
+@@ -0,0 +1,100 @@
++TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
++TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
++TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
++TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
++TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+Index: userhookeach.js
+===================================================================
+RCS file: /cvsroot/mozilla/js/tests/userhookeach.js,v
+retrieving revision 1.4
+diff -p -U 8 -r1.4 userhookeach.js
+--- userhookeach.js	10 Apr 2008 20:54:08 -0000	1.4
++++ userhookeach.js	25 Jun 2008 17:31:18 -0000
+@@ -49,17 +49,16 @@ var gCurrentTestValid;
+ var gPageStart;
+ var gPageStop;
+ 
+ function userOnStart()
+ {
+   try
+   {
+     dlog('userOnStart');
+-    cdump('JavaScriptTest: Begin Run');
+     registerDialogCloser();
+   }
+   catch(ex)
+   {
+     cdump('Spider: FATAL ERROR: userOnStart: ' + ex);
+   }
+ }
+ 
+@@ -67,17 +66,16 @@ function userOnBeforePage()
+ {
+   try
+   {
+     dlog('userOnBeforePage');
+     gPageStart = new Date();
+ 
+     gCurrentTestId = /test=(.*);language/.exec(gSpider.mCurrentUrl.mUrl)[1];
+     gCurrentTestValid = true;
+-    cdump('JavaScriptTest: Begin Test ' + gCurrentTestId);
+     gCurrentTestStart = new Date();
+   }
+   catch(ex)
+   {
+     cdump('Spider: WARNING ERROR: userOnBeforePage: ' + ex);
+     gCurrentTestValid = false;
+     gPageCompleted = true;
+   }
+@@ -85,46 +83,43 @@ function userOnBeforePage()
+ 
+ function userOnAfterPage()
+ {
+   try
+   {
+     dlog('userOnAfterPage');
+     gPageStop = new Date();
+ 
+-    cdump(gSpider.mCurrentUrl.mUrl + ': PAGE STATUS: NORMAL (' + ((gPageStop - gPageStart)/1000).toFixed(0) + ' seconds)');
+     checkTestCompleted();
+   }
+   catch(ex)
+   {
+     cdump('Spider: WARNING ERROR: userOnAfterPage: ' + ex);
+     gCurrentTestValid = false;
+     gPageCompleted = true;
+   }
+ }
+ 
+ function userOnStop()
+ {
+   try
+   {
+     // close any pending dialogs
+-    cdump('JavaScriptTest: End Run');
+     closeDialog();
+     unregisterDialogCloser();
+   }
+   catch(ex)
+   {
+     cdump('Spider: WARNING ERROR: userOnStop: ' + ex);
+   }
+ }
+ 
+ function userOnPageTimeout()
+ {
+   gPageStop = new Date();
+-  cdump(gSpider.mCurrentUrl.mUrl + ': PAGE STATUS: TIMED OUT (' + ((gPageStop - gPageStart)/1000).toFixed(0) + ' seconds)');
+   if (typeof gSpider.mDocument != 'undefined')
+   {
+     try
+     {
+       var win = gSpider.mDocument.defaultView;
+       if (win.wrappedJSObject)
+       {
+         win = win.wrappedJSObject;
+@@ -132,17 +127,16 @@ function userOnPageTimeout()
+       gPageCompleted = win.gPageCompleted = true;
+       checkTestCompleted();
+     }
+     catch(ex)
+     {
+       cdump('Spider: WARNING ERROR: userOnPageTimeout: ' + ex);
+     }
+   }
+-  cdump('JavaScriptTest: End Test ' + gCurrentTestId);
+ }
+ 
+ function checkTestCompleted()
+ {
+   try
+   {
+     dlog('checkTestCompleted()');
+ 
+@@ -176,17 +170,16 @@ function checkTestCompleted()
+         cdump('JavaScriptTest: ' + gCurrentTestId +
+               ' gTestcases array is empty. Tests not run.');
+         new win.TestCase(win.gTestFile, win.summary, 'Unknown', 'gTestcases array is empty. Tests not run..');
+       }
+       else
+       {
+       }
+       cdump('JavaScriptTest: ' + gCurrentTestId + ' Elapsed time ' + ((gCurrentTestStop - gCurrentTestStart)/1000).toFixed(2) + ' seconds');
+-      cdump('JavaScriptTest: End Test ' + gCurrentTestId);
+ 
+       gPageCompleted = true;
+     }
+     else
+     {
+       dlog('page not completed, recheck');
+       setTimeout(checkTestCompleted, gCheckInterval);
+     }
diff --git a/js/tests/test-browser.sh b/js/tests/test-browser.sh
deleted file mode 100755
--- a/js/tests/test-browser.sh
+++ /dev/null
@@ -1,336 +0,0 @@
-#!/bin/bash -e
-# -*- Mode: Shell-script; tab-width: 4; indent-tabs-mode: nil; -*-
-
-# ***** BEGIN LICENSE BLOCK *****
-# Version: MPL 1.1/GPL 2.0/LGPL 2.1
-#
-# The contents of this file are subject to the Mozilla Public License Version
-# 1.1 (the "License"); you may not use this file except in compliance with
-# the License. You may obtain a copy of the License at
-# http://www.mozilla.org/MPL/
-#
-# Software distributed under the License is distributed on an "AS IS" basis,
-# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
-# for the specific language governing rights and limitations under the
-# License.
-#
-# The Original Code is Mozilla JavaScript Testing Utilities
-#
-# The Initial Developer of the Original Code is
-# Mozilla Corporation.
-# Portions created by the Initial Developer are Copyright (C) 2007
-# the Initial Developer. All Rights Reserved.
-#
-# Contributor(s): Bob Clary <bclary@bclary.com>
-#
-# Alternatively, the contents of this file may be used under the terms of
-# either the GNU General Public License Version 2 or later (the "GPL"), or
-# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
-# in which case the provisions of the GPL or the LGPL are applicable instead
-# of those above. If you wish to allow use of your version of this file only
-# under the terms of either the GPL or the LGPL, and not to allow others to
-# use your version of this file under the terms of the MPL, indicate your
-# decision by deleting the provisions above and replace them with the notice
-# and other provisions required by the GPL or the LGPL. If you do not delete
-# the provisions above, a recipient may use your version of this file under
-# the terms of any one of the MPL, the GPL or the LGPL.
-#
-# ***** END LICENSE BLOCK *****
-
-if [[ -z "$TEST_DIR" ]]; then
-    cat <<EOF
-`basename $0`: error
-
-TEST_DIR, the location of the Sisyphus framework, 
-is required to be set prior to calling this script.
-EOF
-    exit 2
-fi
-
-if [[ ! -e $TEST_DIR/bin/library.sh ]]; then
-    echo "TEST_DIR=$TEST_DIR"
-    echo ""
-    echo "This script requires the Sisyphus testing framework. Please "
-    echo "cvs check out the Sisyphys framework from mozilla/testing/sisyphus"
-    echo "and set the environment variable TEST_DIR to the directory where it"
-    echo "located."
-    echo ""
-
-    exit 2
-fi
-
-source $TEST_DIR/bin/library.sh
-
-TEST_JSDIR=`dirname $0`
-
-TEST_JSEACH_TIMEOUT=${TEST_JSEACH_TIMEOUT:-485}
-TEST_JSEACH_PAGE_TIMEOUT=${TEST_JSEACH_PAGE_TIMEOUT:-480}
-TEST_JSALL_TIMEOUT=${TEST_JSALL_TIMEOUT:-21600}
-TEST_WWW_JS=`echo $TEST_JSDIR|sed "s|$TEST_DIR||"`
-
-#
-# options processing
-#
-usage()
-{
-    cat <<EOF
-usage: $SCRIPT -p product -b branch -T buildtype -x executablepath -N profilename \\
-               -R -X excludetests -I includetests -c -t -F [-d datafiles]
-
-variable            description
-===============     ============================================================
--p product          required. firefox|thunderbird
--b branch           required. 1.8.0|1.8.1|1.9.0
--T buildtype        required. one of opt debug
--x executablepath   required. directory-tree containing executable 'product'
--N profilename      required. profile name 
--R                  optional. by default the browser test will start Firefox
-                    spider and execute the tests one after another in the same
-                    process. -R will start an new instance of Firefox for each
-                    test.
--X excludetests     optional. By default the test will exclude the 
-                    tests listed in spidermonkey-n-\$branch.tests, 
-                    performance-\$branch.tests. excludetests is a list of either
-                    individual tests, manifest files or sub-directories which 
-                    will override the default exclusion list.
--I includetests     optional. By default the test will include the 
-                    JavaScript tests appropriate for the branch. includetests is a
-                    list of either individual tests, manifest files or 
-                    sub-directories which will override the default inclusion 
-                    list.
--Z n                Set gczeal to n. Only valid for Gecko 1.9.0 and later.
--c                  optional. By default the test will exclude tests 
-                    which crash on this branch, test type, build type and 
-                    operating system. -c will include tests which crash. 
-                    Typically this should only be used in combination with -R. 
-                    This has no effect on shell based tests which execute crash
-                    tests regardless.
--t                  optional. By default the test will exclude tests 
-                    which time out on this branch, test type, build type and 
-                    operating system. -t will include tests which timeout.
--F                  optional. Just generate file lists without running any tests.
--d datafiles        optional. one or more filenames of files containing 
-                    environment variable definitions to be included.
-
-                    note that the environment variables should have the same 
-                    names as in the "variable" column.
-
-if an argument contains more than one value, it must be quoted.
-EOF
-    exit 2
-}
-
-while getopts "p:b:T:x:N:d:X:I:Z:RctF" optname
-do 
-    case $optname in
-        p) product=$OPTARG;;
-        b) branch=$OPTARG;;
-        T) buildtype=$OPTARG;;
-        N) profilename=$OPTARG;;
-        x) executablepath=$OPTARG;;
-        R) restart=1;;
-        X) excludetests=$OPTARG;;
-        I) includetests=$OPTARG;;
-        c) crashes=1;;
-        t) timeouts=1;;
-        F) filesonly=1;;
-        Z) gczeal=";gczeal=$OPTARG";;
-        d) datafiles=$OPTARG;;
-    esac
-done
-
-# include environment variables
-if [[ -n "$datafiles" ]]; then
-    for datafile in $datafiles; do 
-        source $datafile
-    done
-fi
-
-dumpvars product branch buildtype profilename executablepath restart excludetests includetests crashes timeouts filesonly gczeal datafiles | sed "s|^|arguments: |"
-
-if [[ -z "$product" || -z "$branch" || -z "$executablepath" || -z "$profilename" ]]; then
-    usage
-fi
-
-executable=`get_executable $product $branch $executablepath`
-
-pushd $TEST_JSDIR
-
-rm -f finished-$branch-browser-$buildtype
-
-if ! make failures.txt; then
-    error "during make failures.txt" $LINENO
-fi
-
-includetestsfile="included-$branch-browser-$buildtype.tests"
-rm -f $includetestsfile
-touch $includetestsfile
-
-if [[ -z "$includetests" ]]; then
-    # by default include tests appropriate for the branch
-    includetests="e4x ecma ecma_2 ecma_3 js1_1 js1_2 js1_3 js1_4 js1_5 js1_6"
-
-    case "$branch" in 
-        1.8.0)
-            ;;
-        1.8.1)
-            includetests="$includetests js1_7"
-            ;;
-        1.9.0)
-            includetests="$includetests js1_7 js1_8"
-            ;;
-    esac
-fi
-
-for i in $includetests; do
-    if [[ -f "$i" ]]; then
-        echo "# including $i" >> $includetestsfile
-        if echo $i | grep -q '\.js$'; then
-            echo $i >> $includetestsfile
-        else
-            cat $i >> $includetestsfile
-        fi
-    elif [[ -d "$i" ]]; then
-        find $i -name '*.js' -print | egrep -v '(shell|browser|template|jsref|userhook.*|\.#.*)\.js' | sed 's/^\.\///' | sort >> $includetestsfile
-    fi
-done
-
-excludetestsfile="excluded-$branch-browser-$buildtype.tests"
-rm -f $excludetestsfile
-touch $excludetestsfile
-
-if [[ -z "$excludetests" ]]; then
-    excludetests="spidermonkey-n-$branch.tests performance-$branch.tests"
-fi
-
-for e in $excludetests; do
-    if [[ -f "$e" ]]; then
-        echo "# excluding $e" >> $excludetestsfile
-        if echo $e | grep -q '\.js$'; then
-            echo $e >> $excludetestsfile
-        else
-            cat $e >> $excludetestsfile
-        fi
-    elif [[ -d "$e" ]]; then
-        find $e -name '*.js' -print | egrep -v '(shell|browser|template|jsref|userhook.*|\.#.*)\.js' | sed 's/^\.\///' | sort >> $excludetestsfile
-    fi
-done
-
-case "$OSID" in
-    win32)
-        arch='.*'
-        kernel='.*'
-        ;;
-    linux)
-        arch="`uname -p`"
-        kernel="`uname -r | sed 's|\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\)[-.0-9]*\.\([a-zA-Z0-9]*\)|\1.\2.\3.*\4|'`"
-        ;;
-    mac)
-        arch="`uname -p`"
-        kernel='[^,]*'
-        ;;
-    *)
-        error "$OSID not supported" $LINENO
-        ;;
-esac
-
-if [[ -z "$timeouts" ]]; then
-    echo "# exclude tests that time out" >> $excludetestsfile
-    egrep "TEST_BRANCH=([^,]*$branch[^,]*|[.][*]), TEST_RESULT=FAILED, TEST_BUILDTYPE=([^,]*$buildtype[^,]*|[.][*]), TEST_TYPE=([^,]*browser[^,]*|[.][*]), TEST_OS=([^,]*$OSID[^,]*|[.][*]), .*, TEST_PROCESSORTYPE=([^,]*$arch[^,]*|[.][*]), TEST_KERNEL=([^,]*$kernel[^,]*|[.][*]), .*, TEST_DESCRIPTION=.*EXIT STATUS: TIMED OUT" \
-        failures.txt  | sed 's/TEST_ID=\([^,]*\),.*/\1/' | sort | uniq >> $excludetestsfile
-fi
-
-if [[ -z "$crashes" ]]; then
-    echo "# exclude tests that crash" >> $excludetestsfile
-    pattern="TEST_BRANCH=([^,]*$branch[^,]*|[.][*]), TEST_RESULT=FAILED, TEST_BUILDTYPE=([^,]*$buildtype[^,]*|[.][*]), TEST_TYPE=([^,]*browser[^,]*|[.][*]), TEST_OS=([^,]*$OSID[^,]*|[.][*]), .*, TEST_PROCESSORTYPE=([^,]*$arch[^,]*|[.][*]), TEST_KERNEL=([^,]*$kernel[^,]*|[.][*]), .*, TEST_DESCRIPTION=.*"
-    case "$buildtype" in
-        opt)
-            pattern="${pattern}EXIT STATUS: CRASHED"
-            ;;
-        debug)
-            pattern="${pattern}(EXIT STATUS: CRASHED|Assertion failure:)"
-            ;;
-    esac
-    egrep "$pattern" failures.txt  | sed 's/TEST_ID=\([^,]*\),.*/\1/' | sort | uniq >> $excludetestsfile
-
-fi
-
-urllist="urllist-$branch-browser-$buildtype.tests"
-urlhtml="urllist-$branch-browser-$buildtype.html"
-
-rm -f $urllist $urlhtml
-
-cat > $urlhtml <<EOF
-<html xmlns="http://www.w3.org/1999/xhtml">
-<head>
-<title>JavaScript Tests</title>
-</head>
-<body>
-<ul>
-EOF
-
-cat $includetestsfile | while read jsfile
-do
-    if echo $jsfile | grep -q '^#'; then
-        continue
-    fi
-
-    if ! grep -q $jsfile $excludetestsfile; then
-
-        result=`echo $jsfile | sed 's/.*js\([0-9]\)_\([0-9]\).*/\1.\2/'`
-
-        case $result in
-            1.5) version=";version=1.5";;
-            1.6) version=";version=1.6";;
-            1.7) version=";version=1.7";;
-            1.8) version=";version=1.8";;
-            1.9) version=";version=1.9";;
-            2.0) version=";version=2.0";;
-            *) version="";;
-        esac
-        
-        echo "http://$TEST_HTTP/$TEST_WWW_JS/js-test-driver-standards.html?test=$jsfile;language=type;text/javascript$version$gczeal" >> $urllist
-        echo "<li><a href='http://$TEST_HTTP/$TEST_WWW_JS/js-test-driver-standards.html?test=$jsfile;language=type;text/javascript$version$gczeal'>$jsfile</a></li>" >> $urlhtml
-    fi
-done
-
-cat >> $urlhtml <<EOF
-</ul>
-</body>
-</html>
-EOF
-
-chmod a+r $urlhtml
-
-cat $includetestsfile | sed 's|^|include: |'
-cat $excludetestsfile | sed 's|^|exclude: |'
-
-if [[ -z "$filesonly" ]]; then
-    if [[ "$restart" == "1" ]]; then
-        cat "$urllist" | while read url; 
-        do 
-            edit-talkback.sh -p "$product" -b "$branch" -x "$executablepath" -i "$url"
-            if time timed_run.py $TEST_JSEACH_TIMEOUT "$url" \
-                "$executable" -P "$profilename" \
-                -spider -start -quit \
-                -uri "$url" \
-                -depth 0 -timeout "$TEST_JSEACH_PAGE_TIMEOUT" \
-                -hook "http://$TEST_HTTP/$TEST_WWW_JS/userhookeach.js"; then
-                true;
-            fi
-
-        done
-    else
-        edit-talkback.sh -p "$product" -b "$branch" -x "$executablepath" -i "http://$TEST_HTTP/$TEST_WWW_JS/$urlhtml"
-        if ! time timed_run.py $TEST_JSALL_TIMEOUT "http://$TEST_HTTP/$TEST_WWW_JS/$urlhtml" \
-            "$executable" -P "$profilename" \
-            -spider -start -quit \
-            -uri "http://$TEST_HTTP/$TEST_WWW_JS/$urlhtml" \
-            -depth 1 -timeout "$TEST_JSEACH_PAGE_TIMEOUT" \
-            -hook "http://$TEST_HTTP/$TEST_WWW_JS/userhookeach.js"; then
-            error "timed_run.py ended abnormally: $?" $LINENO
-        fi
-    fi
-fi
-
-popd
diff --git a/js/tests/test-shell.sh b/js/tests/test-shell.sh
deleted file mode 100755
--- a/js/tests/test-shell.sh
+++ /dev/null
@@ -1,261 +0,0 @@
-#!/bin/bash -e
-# -*- Mode: Shell-script; tab-width: 4; indent-tabs-mode: nil; -*-
-
-# ***** BEGIN LICENSE BLOCK *****
-# Version: MPL 1.1/GPL 2.0/LGPL 2.1
-#
-# The contents of this file are subject to the Mozilla Public License Version
-# 1.1 (the "License"); you may not use this file except in compliance with
-# the License. You may obtain a copy of the License at
-# http://www.mozilla.org/MPL/
-#
-# Software distributed under the License is distributed on an "AS IS" basis,
-# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
-# for the specific language governing rights and limitations under the
-# License.
-#
-# The Original Code is Mozilla JavaScript Testing Utilities
-#
-# The Initial Developer of the Original Code is
-# Mozilla Corporation.
-# Portions created by the Initial Developer are Copyright (C) 2007
-# the Initial Developer. All Rights Reserved.
-#
-# Contributor(s): Bob Clary <bclary@bclary.com>
-#
-# Alternatively, the contents of this file may be used under the terms of
-# either the GNU General Public License Version 2 or later (the "GPL"), or
-# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
-# in which case the provisions of the GPL or the LGPL are applicable instead
-# of those above. If you wish to allow use of your version of this file only
-# under the terms of either the GPL or the LGPL, and not to allow others to
-# use your version of this file under the terms of the MPL, indicate your
-# decision by deleting the provisions above and replace them with the notice
-# and other provisions required by the GPL or the LGPL. If you do not delete
-# the provisions above, a recipient may use your version of this file under
-# the terms of any one of the MPL, the GPL or the LGPL.
-#
-# ***** END LICENSE BLOCK *****
-
-if [[ -z "$TEST_DIR" ]]; then
-    cat <<EOF
-`basename $0`: error
-
-TEST_DIR, the location of the Sisyphus framework, 
-is required to be set prior to calling this script.
-EOF
-    exit 2
-fi
-
-if [[ ! -e $TEST_DIR/bin/library.sh ]]; then
-    echo "TEST_DIR=$TEST_DIR"
-    echo ""
-    echo "This script requires the Sisyphus testing framework. Please "
-    echo "cvs check out the Sisyphys framework from mozilla/testing/sisyphus"
-    echo "and set the environment variable TEST_DIR to the directory where it"
-    echo "located."
-    echo ""
-
-    exit 2
-fi
-
-source $TEST_DIR/bin/library.sh
-
-TEST_JSDIR=`dirname $0`
-TEST_JSSHELL_TIMEOUT=${TEST_JSSHELL_TIMEOUT:-480}
-
-#
-# options processing
-#
-usage()
-{
-    cat <<EOF
-usage: $SCRIPT -b branch -s sourcepath -T buildtype [-d datafiles]
-
-variable            description
-===============     ===========================================================
--p product          required. js
--b branch           required. 1.8.0|1.8.1|1.9.0
--s sourcepath       required. path to js shell source directory mozilla/js/src
--T buildtype        required. one of opt debug
--X excludetests     optional. By default the test will exclude the 
-                    tests listed in spidermonkey-n-\$branch.tests, 
-                    performance-\$branch.tests. excludetests is a list of either
-                    individual tests, manifest files or sub-directories which 
-                    will override the default exclusion list.
--I includetests     optional. By default the test will include the 
-                    JavaScript tests appropriate for the branch. includetests is a
-                    list of either individual tests, manifest files or 
-                    sub-directories which will override the default inclusion 
-                    list.
--Z n                optional. Set gczeal to n. Currently, only valid for 
-                    Gecko 1.9.0 and later.
--c                  optional. By default the test will exclude tests 
-                    which crash on this branch, test type, build type and 
-                    operating system. -c will include tests which crash. 
-                    Typically this should only be used in combination with -R. 
-                    This has no effect on shell based tests which execute crash
-                    tests regardless.
--t                  optional. By default the test will exclude tests 
-                    which time out on this branch, test type, build type and 
-                    operating system. -t will include tests which timeout.
--d datafiles        optional. one or more filenames of files containing 
-                    environment variable definitions to be included.
-
-EOF
-    exit 2
-}
-
-while getopts "b:s:T:d:X:I:Z:ct" optname
-do 
-    case $optname in
-        b) branch=$OPTARG;;
-        s) sourcepath=$OPTARG;;
-        T) buildtype=$OPTARG;;
-        X) excludetests=$OPTARG;;
-        I) includetests=$OPTARG;;
-        C) crashes=1;;
-        T) timeouts=1;;
-        Z) gczeal="-Z $OPTARG";;
-        d) datafiles=$OPTARG;;
-    esac
-done
-
-# include environment variables
-if [[ -n "$datafiles" ]]; then
-    for datafile in $datafiles; do 
-        source $datafile
-    done
-fi
-
-dumpvars branch sourcepath buildtype excludetests includetests crashes timeouts gczeal datafiles | sed "s|^|arguments: |"
-
-if [[ -z "$branch" || -z "$sourcepath" || -z "$buildtype" ]]; then
-    usage
-fi
-
-pushd $TEST_JSDIR
-
-rm -f finished-$branch-shell-$buildtype
-
-. config.sh
-
-executable="$sourcepath/$JS_OBJDIR/js$EXE_EXT"
-
-if ! make failures.txt; then
-    error "during make failures.txt" $LINENO
-fi
-
-#includetestsfile=`mktemp includetestsfile.XXXXX`
-includetestsfile="included-$branch-shell-$buildtype.tests"
-rm -f $includetestsfile
-touch $includetestsfile
-
-if [[ -z "$includetests" ]]; then
-
-    # by default include tests appropriate for the branch
-    includetests="e4x ecma ecma_2 ecma_3 js1_1 js1_2 js1_3 js1_4 js1_5 js1_6"
-
-    case "$branch" in 
-        1.8.0)
-            ;;
-        1.8.1)
-            includetests="$includetests js1_7"
-            ;;
-        1.9.0)
-            includetests="$includetests js1_7 js1_8"
-            ;;
-    esac
-fi
-
-for i in $includetests; do
-    if [[ -f "$i" ]]; then
-        echo "# including $i" >> $includetestsfile
-        if echo $i | grep -q '\.js$'; then
-            echo $i >> $includetestsfile
-        else
-            cat $i >> $includetestsfile
-        fi
-    elif [[ -d "$i" ]]; then
-        find $i -name '*.js' -print | egrep -v '(shell|browser|template|jsref|userhook.*|\.#.*)\.js' | sed 's/^\.\///' | sort >> $includetestsfile
-    fi
-done
-
-#excludetestsfile=`mktemp excludetestsfile.XXXXX`
-excludetestsfile="excluded-$branch-shell-$buildtype.tests"
-rm -f $excludetestsfile
-touch $excludetestsfile
-
-if [[ -z "$excludetests" ]]; then
-    excludetests="spidermonkey-n-$branch.tests performance-$branch.tests"
-fi
-
-for e in $excludetests; do
-    if [[ -f "$e" ]]; then
-        echo "# excluding $e" >> $excludetestsfile
-        if echo $e | grep -q '\.js$'; then
-            echo $e >> $excludetestsfile
-        else
-            cat $e >> $excludetestsfile
-        fi
-    elif [[ -d "$e" ]]; then
-        find $e -name '*.js' -print | egrep -v '(shell|browser|template|userhook.*|\.#.*).js' | sed 's/^\.\///' | sort >> $excludetestsfile
-    fi
-done
-
-case "$OSID" in
-    win32)
-        arch='.*'
-        kernel='.*'
-        ;;
-    linux)
-        arch="`uname -p`"
-        kernel="`uname -r | sed 's|\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\)[-.0-9]*\.\([a-zA-Z0-9]*\)|\1.\2.\3.*\4|'`"
-        ;;
-    mac)
-        arch="`uname -p`"
-        kernel='[^,]*'
-        ;;
-    *)
-        error "$product-$branch-$buildtype: $OSID not supported" $LINENO
-        ;;
-esac
-
-if [[ -z "$timeouts" ]]; then
-    echo "# exclude tests that time out" >> $excludetestsfile
-    egrep "TEST_BRANCH=([^,]*$branch[^,]*|[.][*]), TEST_RESULT=FAILED, TEST_BUILDTYPE=([^,]*$buildtype[^,]*|[.][*]), TEST_TYPE=([^,]*shell[^,]*|[.][*]), TEST_OS=([^,]*$OSID[^,]*|[.][*]), .*, TEST_PROCESSORTYPE=([^,]*$arch[^,]*|[.][*]), TEST_KERNEL=([^,]*$kernel[^,]*|[.][*]), .*, TEST_DESCRIPTION=.*EXIT STATUS: TIMED OUT" \
-        failures.txt  | sed 's/TEST_ID=\([^,]*\),.*/\1/' | sort | uniq >> $excludetestsfile
-fi
-
-if [[ -z "$crashes" ]]; then
-    echo "# exclude tests that crash" >> $excludetestsfile
-    pattern="TEST_BRANCH=([^,]*$branch[^,]*|[.][*]), TEST_RESULT=FAILED, TEST_BUILDTYPE=([^,]*$buildtype[^,]*|[.][*]), TEST_TYPE=([^,]*shell[^,]*|[.][*]), TEST_OS=([^,]*$OSID[^,]*|[.][*]), .*, TEST_PROCESSORTYPE=([^,]*$arch[^,]*|[.][*]), TEST_KERNEL=([^,]*$kernel[^,]*|[.][*]), .*, TEST_DESCRIPTION=.*"
-    case "$buildtype" in
-        opt)
-            pattern="${pattern}EXIT STATUS: CRASHED"
-            ;;
-        debug)
-            pattern="${pattern}(EXIT STATUS: CRASHED|Assertion failure:)"
-            ;;
-    esac
-    egrep "$pattern" failures.txt  | sed 's/TEST_ID=\([^,]*\),.*/\1/' | sort | uniq >> $excludetestsfile
-
-fi
-
-cat $includetestsfile | sed 's|^|include: |'
-cat $excludetestsfile | sed 's|^|exclude: |'
-
-if ! time perl jsDriver.pl \
-    -l $includetestsfile \
-    -L $excludetestsfile \
-    -s $executable \
-    -e sm$buildtype \
-    -o "-S 524288 $gczeal" \
-    -R \
-    -T $TEST_JSSHELL_TIMEOUT \
-    -f /dev/null \
-    -Q; then
-    error "$product-$branch-$buildtype-$OSID: jsDriver.pl" $LINENO
-fi
-
-popd
diff --git a/js/tests/test.sh b/js/tests/test.sh
--- a/js/tests/test.sh
+++ b/js/tests/test.sh
@@ -33,23 +33,23 @@
 # decision by deleting the provisions above and replace them with the notice
 # and other provisions required by the GPL or the LGPL. If you do not delete
 # the provisions above, a recipient may use your version of this file under
 # the terms of any one of the MPL, the GPL or the LGPL.
 #
 # ***** END LICENSE BLOCK *****
 
 if [[ -z "$TEST_DIR" ]]; then
-  cat <<EOF
+    cat <<EOF
 `basename $0`: error
 
 TEST_DIR, the location of the Sisyphus framework, 
 is required to be set prior to calling this script.
 EOF
-  exit 2
+    exit 2
 fi
 
 if [[ ! -e $TEST_DIR/bin/library.sh ]]; then
     echo "TEST_DIR=$TEST_DIR"
     echo ""
     echo "This script requires the Sisyphus testing framework. Please "
     echo "cvs check out the Sisyphys framework from mozilla/testing/sisyphus"
     echo "and set the environment variable TEST_DIR to the directory where it"
@@ -58,60 +58,356 @@ if [[ ! -e $TEST_DIR/bin/library.sh ]]; 
 
     exit 2
 fi
 
 source $TEST_DIR/bin/library.sh
 
 TEST_JSDIR=`dirname $0`
 
+TEST_JSSHELL_TIMEOUT=${TEST_JSSHELL_TIMEOUT:-480}
+TEST_JSEACH_TIMEOUT=${TEST_JSEACH_TIMEOUT:-485}
+TEST_JSEACH_PAGE_TIMEOUT=${TEST_JSEACH_PAGE_TIMEOUT:-480}
+TEST_JSALL_TIMEOUT=${TEST_JSALL_TIMEOUT:-21600}
+TEST_WWW_JS=`echo $TEST_JSDIR|sed "s|$TEST_DIR||"`
+
 #
 # options processing
 #
 usage()
 {
     cat <<EOF
-usage: $SCRIPT -d datafiles
-
-This script is used to dispatch to either test-browser.sh
-for browser based JavaScript tests or test-shell.js for 
-shell based JavaScript tests. It ignores all input arguments
-except -d datafiles which it uses to pass data to the 
-appropriate script.
+usage: test.sh -p product -b branch -T buildtype -x executablepath -N profilename \\
+               [-X excludetests] [-I includetests] [-c] [-t] [-F] [-d datafiles]
 
 variable            description
 ===============     ============================================================
+-p product          required. firefox|thunderbird|js
+-b branch           required. 1.8.0|1.8.1|1.9.0|1.9.1
+-s sourcepath       required for shell. path to js shell source directory mozilla/js/src
+-T buildtype        required. one of opt debug
+-x executablepath   required for browser. directory-tree containing executable 'product'
+-N profilename      required for browser. profile name 
+-X excludetests     optional. By default the test will exclude the 
+                    tests listed in spidermonkey-n-\$branch.tests, 
+                    performance-\$branch.tests. excludetests is a list of either
+                    individual tests, manifest files or sub-directories which 
+                    will override the default exclusion list.
+-I includetests     optional. By default the test will include the 
+                    JavaScript tests appropriate for the branch. includetests is a
+                    list of either individual tests, manifest files or 
+                    sub-directories which will override the default inclusion 
+                    list.
+-c                  optional. By default the test will exclude tests 
+                    which crash on this branch, test type, build type and 
+                    operating system. -c will include tests which crash. 
+                    Typically this should only be used in combination with -R. 
+                    This has no effect on shell based tests which execute crash
+                    tests regardless.
+-t                  optional. By default the test will exclude tests 
+                    which time out on this branch, test type, build type and 
+                    operating system. -t will include tests which timeout.
+-Z n                optional. Set gczeal to n. Currently, only valid for 
+                    debug builds of Gecko 1.8.1.15, 1.9.0 and later.
+-F                  optional. Just generate file lists without running any tests.
 -d datafiles        optional. one or more filenames of files containing 
                     environment variable definitions to be included.
--Z n                optional. Set gczeal to n. Currently, only valid for 
-                    Gecko 1.9.0 and later.
+
+                    note that the environment variables should have the same 
+                    names as in the "variable" column.
+
 if an argument contains more than one value, it must be quoted.
 EOF
     exit 2
 }
 
-unset datafiles
-
-while getopts "d:Z:" optname ; 
+while getopts "p:b:s:T:x:N:d:X:I:Z:RctF" optname
 do 
     case $optname in
+        p) 
+            product=$OPTARG;;
+        b) 
+            branch=$OPTARG;;
+        T) 
+            buildtype=$OPTARG;;
+        s) 
+            sourcepath=$OPTARG;;
+        N) 
+            profilename=$OPTARG;;
+        x) 
+            executablepath=$OPTARG;;
+        X) 
+            excludetests=$OPTARG;;
+        I) 
+            includetests=$OPTARG;;
+        c) 
+            crashes=1;;
+        t) 
+            timeouts=1;;
+        F) 
+            filesonly=1;;
+        Z)  
+            gczealshell="-Z $OPTARG"
+            gczealbrowser=";gczeal=$OPTARG"
+            ;;
         d) datafiles=$OPTARG;;
-        Z) gczeal="-Z $OPTARG";;
     esac
 done
 
-if [[ -z "$datafiles" ]]; then
-    usage
+# include environment variables
+if [[ -n "$datafiles" ]]; then
+    for datafile in $datafiles; do 
+        source $datafile
+    done
 fi
 
-for data in $datafiles; do
-    source $data
-done
+if [[ -n "$gczeal" && "$buildtype" != "debug" ]]; then
+    error "gczeal is supported for buildtype debug and not $buildtype"
+fi
 
-case "$product" in
-    firefox) testscript=$TEST_JSDIR/test-browser.sh;;
-    js) testscript=$TEST_JSDIR/test-shell.sh;;
-    *) echo "unknown product [$product]"
-        exit 2
+dumpvars product branch buildtype sourcepath profilename executablepath excludetests includetests crashes timeouts filesonly gczeal datafiles | sed "s|^|arguments: |"
+
+pushd $TEST_JSDIR
+
+case $product in
+    js)
+        if [[ -z "$branch" || -z "$buildtype"  || -z "$sourcepath" ]]; then
+            usage
+        fi
+        source config.sh
+        testtype=shell
+        executable="$sourcepath/$JS_OBJDIR/js$EXE_EXT"
+        ;;
+
+    firefox|thunderbird)
+        if [[ -z "$branch" || -z "$buildtype"  || -z "$executablepath" || -z "$profilename" ]]; then
+            usage
+        fi
+        testtype=browser
+        executable=`get_executable $product $branch $executablepath`
+
+        ;;
+    *)
+        echo "Unknown product: $product"
+        usage
         ;;
 esac
 
-$testscript -d "$datafiles" $gczeal
+rm -f finished-$branch-$testtype-$buildtype
+
+if ! make failures.txt; then
+    error "during make failures.txt" $LINENO
+fi
+
+includetestsfile="included-$branch-$testtype-$buildtype.tests"
+rm -f $includetestsfile
+touch $includetestsfile
+
+if [[ -z "$includetests" ]]; then
+    # by default include tests appropriate for the branch
+    includetests="e4x ecma ecma_2 ecma_3 js1_1 js1_2 js1_3 js1_4 js1_5 js1_6"
+
+    case "$branch" in 
+        1.8.0)
+            ;;
+        1.8.1)
+            includetests="$includetests js1_7"
+            ;;
+        1.9.0)
+            includetests="$includetests js1_7 js1_8"
+            ;;
+        1.9.1)
+            includetests="$includetests js1_7 js1_8"
+            ;;
+    esac
+fi
+
+for i in $includetests; do
+    if [[ -f "$i" ]]; then
+        echo "# including $i" >> $includetestsfile
+        if echo $i | grep -q '\.js$'; then
+            echo $i >> $includetestsfile
+        else
+            cat $i >> $includetestsfile
+        fi
+    elif [[ -d "$i" ]]; then
+        find $i -name '*.js' -print | egrep -v '(shell|browser|template|jsref|userhook.*|\.#.*)\.js' | sed 's/^\.\///' | sort >> $includetestsfile
+    fi
+done
+
+excludetestsfile="excluded-$branch-$testtype-$buildtype.tests"
+rm -f $excludetestsfile
+touch $excludetestsfile
+
+if [[ -z "$excludetests" ]]; then
+    excludetests="spidermonkey-n-$branch.tests performance-$branch.tests"
+fi
+
+for e in $excludetests; do
+    if [[ -f "$e" ]]; then
+        echo "# excluding $e" >> $excludetestsfile
+        if echo $e | grep -q '\.js$'; then
+            echo $e >> $excludetestsfile
+        else
+            cat $e >> $excludetestsfile
+        fi
+    elif [[ -d "$e" ]]; then
+        find $e -name '*.js' -print | egrep -v '(shell|browser|template|jsref|userhook.*|\.#.*)\.js' | sed 's/^\.\///' | sort >> $excludetestsfile
+    fi
+done
+
+# convert the numeric speed rating to a prose value
+if [[ $TEST_CPUSPEED -lt 4 ]]; then
+    TEST_CPUSPEED=slow
+elif [[ $TEST_CPUSPEED -lt 9 ]]; then
+    TEST_CPUSPEED=medium
+else
+    TEST_CPUSPEED=fast
+fi
+
+pattern="TEST_BRANCH=($branch|[.][*]), TEST_BUILDTYPE=($buildtype|[.][*]), TEST_TYPE=($testtype|[.][*]), TEST_OS=($OSID|[.][*]), TEST_KERNEL=($TEST_KERNEL|[.][*]), TEST_PROCESSORTYPE=($TEST_PROCESSORTYPE|[.][*]), TEST_MEMORY=($TEST_MEMORY|[.][*]), TEST_CPUSPEED=($TEST_CPUSPEED|[.][*]),"
+
+if [[ -z "$timeouts" ]]; then
+    echo "# exclude tests that time out" >> $excludetestsfile
+    echo "$pattern .*TEST_EXITSTATUS=TIMED OUT," >> $excludetestsfile
+    egrep "$pattern .*TEST_EXITSTATUS=TIMED OUT," failures.txt | \
+        sed 's/.*TEST_ID=\([^,]*\),.*/\1/' | sort -u >> $excludetestsfile
+fi
+
+if [[ -z "$crashes" ]]; then
+    echo "# exclude tests that crash" >> $excludetestsfile
+    echo "$pattern .*TEST_EXITSTATUS=(CRASHED|ABNORMAL)" >> $excludetestsfile
+    egrep "$pattern .*TEST_EXITSTATUS=(CRASHED|ABNORMAL)" failures.txt  | \
+        sed 's/.*TEST_ID=\([^,]*\),.*/\1/' | sort -u >> $excludetestsfile
+
+fi
+
+cat $includetestsfile | sed 's|^|include: |'
+cat $excludetestsfile | sed 's|^|exclude: |'
+
+case $testtype in
+    shell)
+        echo "JavaScriptTest: Begin Run"
+        cat $includetestsfile | while read jsfile
+        do
+            if echo $jsfile | grep -q '^#'; then
+                continue
+            fi
+
+            if ! grep -q $jsfile $excludetestsfile; then
+
+                result=`echo $jsfile | sed 's/.*js\([0-9]\)_\([0-9]\).*/\1.\2/'`
+
+                case $result in
+                    1.5) version="150";;
+                    1.6) version="160";;
+                    1.7) version="170";;
+                    1.8) version="180";;
+                    1.9) version="190";;
+                    2.0) version="200";;
+                    *) version="150";;
+                esac
+                
+                subsuitetestdir=`dirname $jsfile`
+                suitetestdir=`dirname $subsuitetestdir`
+                echo "JavaScriptTest: Begin Test $jsfile"
+                if eval $TIMECOMMAND timed_run.py $TEST_JSEACH_TIMEOUT \"$jsfile\" \
+                    $EXECUTABLE_DRIVER \
+                    $executable -v $version \
+                    -S 524288 \
+                    $gczealshell \
+                    -f ./shell.js \
+                    -f $suitetestdir/shell.js \
+                    -f $subsuitetestdir/shell.js \
+                    -f ./$jsfile \
+                    -f ./js-test-driver-end.js; then
+                    true
+                else
+                    rc=$?
+                fi
+                if [[ $rc == 99 ]]; then
+                    error "User Interrupt"
+                fi
+                echo "JavaScriptTest: End Test $jsfile"
+            fi
+        done
+        echo "JavaScriptTest: End Run"
+        ;;
+
+    browser)
+        urllist="urllist-$branch-$testtype-$buildtype.tests"
+        urlhtml="urllist-$branch-$testtype-$buildtype.html"
+
+        rm -f $urllist $urlhtml
+
+        cat > $urlhtml <<EOF
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<title>JavaScript Tests</title>
+</head>
+<body>
+<ul>
+EOF
+
+        cat $includetestsfile | while read jsfile
+        do
+            if echo $jsfile | grep -q '^#'; then
+                continue
+            fi
+
+            if ! grep -q $jsfile $excludetestsfile; then
+
+                result=`echo $jsfile | sed 's/.*js\([0-9]\)_\([0-9]\).*/\1.\2/'`
+
+                case $result in
+                    1.5) version=";version=1.5";;
+                    1.6) version=";version=1.6";;
+                    1.7) version=";version=1.7";;
+                    1.8) version=";version=1.8";;
+                    1.9) version=";version=1.9";;
+                    2.0) version=";version=2.0";;
+                    *) version="";;
+                esac
+                
+                echo "http://$TEST_HTTP/$TEST_WWW_JS/js-test-driver-standards.html?test=$jsfile;language=type;text/javascript$version$gczealbrowser" >> $urllist
+                echo "<li><a href='http://$TEST_HTTP/$TEST_WWW_JS/js-test-driver-standards.html?test=$jsfile;language=type;text/javascript$version$gczealbrowser'>$jsfile</a></li>" >> $urlhtml
+            fi
+        done
+
+        cat >> $urlhtml <<EOF
+</ul>
+</body>
+</html>
+EOF
+
+        chmod a+r $urlhtml
+
+        if [[ -z "$filesonly" ]]; then
+            echo "JavaScriptTest: Begin Run"
+            cat "$urllist" | while read url; 
+            do 
+                edit-talkback.sh -p "$product" -b "$branch" -x "$executablepath" -i "$url"
+                jsfile=`echo $url | sed "s|http://$TEST_HTTP/$TEST_WWW_JS/js-test-driver-standards.html?test=\([^;]*\);.*|\1|"`
+                echo "JavaScriptTest: Begin Test $jsfile"
+                if eval $TIMECOMMAND timed_run.py $TEST_JSEACH_TIMEOUT \"$jsfile\" \
+                    $EXECUTABLE_DRIVER \
+                    \"$executable\" -P \"$profilename\" \
+                    -spider -start -quit \
+                    -uri \"$url\" \
+                    -depth 0 -timeout \"$TEST_JSEACH_PAGE_TIMEOUT\" \
+                    -hook \"http://$TEST_HTTP/$TEST_WWW_JS/userhookeach.js\"; then
+                    true
+                else
+                    rc=$?
+                fi
+                if [[ $rc == 99 ]]; then
+                    error "User Interrupt"
+                fi
+                echo "JavaScriptTest: End Test $jsfile"
+            done
+            echo "JavaScriptTest: End Run"
+        fi
+        ;;
+    *)
+        ;;
+esac
+
+popd
diff --git a/js/tests/universe.data b/js/tests/universe.data
new file mode 100644
--- /dev/null
+++ b/js/tests/universe.data
@@ -0,0 +1,100 @@
+TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=8.11.0, TEST_PROCESSORTYPE=powerpc32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=8.11.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=1, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=darwin, TEST_KERNEL=9.3.0, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=medium, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=4, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=1, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.18, TEST_PROCESSORTYPE=intel64, TEST_MEMORY=4, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0700, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=linux, TEST_KERNEL=2.6.25, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=3, TEST_CPUSPEED=slow, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.8.1, TEST_BUILDTYPE=opt, TEST_TYPE=shell
+TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=browser
+TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=debug, TEST_TYPE=shell
+TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=browser
+TEST_OS=nt, TEST_KERNEL=5.1, TEST_PROCESSORTYPE=intel32, TEST_MEMORY=2, TEST_CPUSPEED=fast, TEST_TIMEZONE=-0400, TEST_BRANCH=1.9.0, TEST_BUILDTYPE=opt, TEST_TYPE=shell
diff --git a/js/tests/userhookeach.js b/js/tests/userhookeach.js
--- a/js/tests/userhookeach.js
+++ b/js/tests/userhookeach.js
@@ -49,17 +49,16 @@ var gPageStart;
 var gPageStart;
 var gPageStop;
 
 function userOnStart()
 {
   try
   {
     dlog('userOnStart');
-    cdump('JavaScriptTest: Begin Run');
     registerDialogCloser();
   }
   catch(ex)
   {
     cdump('Spider: FATAL ERROR: userOnStart: ' + ex);
   }
 }
 
@@ -67,17 +66,16 @@ function userOnBeforePage()
 {
   try
   {
     dlog('userOnBeforePage');
     gPageStart = new Date();
 
     gCurrentTestId = /test=(.*);language/.exec(gSpider.mCurrentUrl.mUrl)[1];
     gCurrentTestValid = true;
-    cdump('JavaScriptTest: Begin Test ' + gCurrentTestId);
     gCurrentTestStart = new Date();
   }
   catch(ex)
   {
     cdump('Spider: WARNING ERROR: userOnBeforePage: ' + ex);
     gCurrentTestValid = false;
     gPageCompleted = true;
   }
@@ -85,46 +83,43 @@ function userOnBeforePage()
 
 function userOnAfterPage()
 {
   try
   {
     dlog('userOnAfterPage');
     gPageStop = new Date();
 
-    cdump(gSpider.mCurrentUrl.mUrl + ': PAGE STATUS: NORMAL (' + ((gPageStop - gPageStart)/1000).toFixed(0) + ' seconds)');
     checkTestCompleted();
   }
   catch(ex)
   {
     cdump('Spider: WARNING ERROR: userOnAfterPage: ' + ex);
     gCurrentTestValid = false;
     gPageCompleted = true;
   }
 }
 
 function userOnStop()
 {
   try
   {
     // close any pending dialogs
-    cdump('JavaScriptTest: End Run');
     closeDialog();
     unregisterDialogCloser();
   }
   catch(ex)
   {
     cdump('Spider: WARNING ERROR: userOnStop: ' + ex);
   }
 }
 
 function userOnPageTimeout()
 {
   gPageStop = new Date();
-  cdump(gSpider.mCurrentUrl.mUrl + ': PAGE STATUS: TIMED OUT (' + ((gPageStop - gPageStart)/1000).toFixed(0) + ' seconds)');
   if (typeof gSpider.mDocument != 'undefined')
   {
     try
     {
       var win = gSpider.mDocument.defaultView;
       if (win.wrappedJSObject)
       {
         win = win.wrappedJSObject;
@@ -132,17 +127,16 @@ function userOnPageTimeout()
       gPageCompleted = win.gPageCompleted = true;
       checkTestCompleted();
     }
     catch(ex)
     {
       cdump('Spider: WARNING ERROR: userOnPageTimeout: ' + ex);
     }
   }
-  cdump('JavaScriptTest: End Test ' + gCurrentTestId);
 }
 
 function checkTestCompleted()
 {
   try
   {
     dlog('checkTestCompleted()');
 
@@ -176,17 +170,16 @@ function checkTestCompleted()
         cdump('JavaScriptTest: ' + gCurrentTestId +
               ' gTestcases array is empty. Tests not run.');
         new win.TestCase(win.gTestFile, win.summary, 'Unknown', 'gTestcases array is empty. Tests not run..');
       }
       else
       {
       }
       cdump('JavaScriptTest: ' + gCurrentTestId + ' Elapsed time ' + ((gCurrentTestStop - gCurrentTestStart)/1000).toFixed(2) + ' seconds');
-      cdump('JavaScriptTest: End Test ' + gCurrentTestId);
 
       gPageCompleted = true;
     }
     else
     {
       dlog('page not completed, recheck');
       setTimeout(checkTestCompleted, gCheckInterval);
     }
diff --git a/layout/base/nsCaret.cpp b/layout/base/nsCaret.cpp
--- a/layout/base/nsCaret.cpp
+++ b/layout/base/nsCaret.cpp
@@ -67,16 +67,17 @@
 #include "nsBlockFrame.h"
 #include "nsISelectionController.h"
 #include "nsDisplayList.h"
 #include "nsCaret.h"
 #include "nsTextFrame.h"
 #include "nsXULPopupManager.h"
 #include "nsMenuPopupFrame.h"
 #include "nsTextFragment.h"
+#include "nsThemeConstants.h"
 
 // The bidi indicator hangs off the caret to one side, to show which
 // direction the typing is in. It needs to be at least 2x2 to avoid looking like 
 // an insignificant dot
 static const PRInt32 kMinBidiIndicatorPixels = 2;
 
 #ifdef IBMBIDI
 #include "nsIBidiKeyboard.h"
@@ -118,20 +119,24 @@ NS_IMETHODIMP nsCaret::Init(nsIPresShell
 
   // get nsILookAndFeel from the pres context, which has one cached.
   nsILookAndFeel *lookAndFeel = nsnull;
   nsPresContext *presContext = inPresShell->GetPresContext();
   
   // XXX we should just do this nsILookAndFeel consultation every time
   // we need these values.
   mCaretWidthCSSPx = 1;
+  mCaretAspectRatio = 0;
   if (presContext && (lookAndFeel = presContext->LookAndFeel())) {
     PRInt32 tempInt;
+    float tempFloat;
     if (NS_SUCCEEDED(lookAndFeel->GetMetric(nsILookAndFeel::eMetric_CaretWidth, tempInt)))
       mCaretWidthCSSPx = (nscoord)tempInt;
+    if (NS_SUCCEEDED(lookAndFeel->GetMetric(nsILookAndFeel::eMetricFloat_CaretAspectRatio, tempFloat)))
+      mCaretAspectRatio = tempFloat;
     if (NS_SUCCEEDED(lookAndFeel->GetMetric(nsILookAndFeel::eMetric_CaretBlinkTime, tempInt)))
       mBlinkRate = (PRUint32)tempInt;
     if (NS_SUCCEEDED(lookAndFeel->GetMetric(nsILookAndFeel::eMetric_ShowCaretDuringSelection, tempInt)))
       mShowDuringSelection = tempInt ? PR_TRUE : PR_FALSE;
   }
   
   // get the selection from the pres shell, and set ourselves up as a selection
   // listener
@@ -172,20 +177,22 @@ DrawCJKCaret(nsIFrame* aFrame, PRInt32 a
   if (!frag)
     return PR_FALSE;
   if (aOffset < 0 || aOffset >= frag->GetLength())
     return PR_FALSE;
   PRUnichar ch = frag->CharAt(aOffset);
   return 0x2e80 <= ch && ch <= 0xd7ff;
 }
 
-nsCaret::Metrics nsCaret::ComputeMetrics(nsIFrame* aFrame, PRInt32 aOffset)
+nsCaret::Metrics nsCaret::ComputeMetrics(nsIFrame* aFrame, PRInt32 aOffset, nscoord aCaretHeight)
 {
   // Compute nominal sizes in appunits
-  nscoord caretWidth = nsPresContext::CSSPixelsToAppUnits(mCaretWidthCSSPx);
+  nscoord caretWidth = (aCaretHeight * mCaretAspectRatio) +
+                       nsPresContext::CSSPixelsToAppUnits(mCaretWidthCSSPx);
+
   if (DrawCJKCaret(aFrame, aOffset)) {
     caretWidth += nsPresContext::CSSPixelsToAppUnits(1);
   }
   nscoord bidiIndicatorSize = nsPresContext::CSSPixelsToAppUnits(kMinBidiIndicatorPixels);
   bidiIndicatorSize = PR_MAX(caretWidth, bidiIndicatorSize);
 
   // Round them to device pixels. Always round down, except that anything
   // between 0 and 1 goes up to 1 so we don't let the caret disappear.
@@ -362,17 +369,17 @@ NS_IMETHODIMP nsCaret::GetCaretCoordinat
     if (outView)
       *outView = drawingView;
   }
   // now add the frame offset to the view offset, and we're done
   viewOffset += framePos;
   outCoordinates->x = viewOffset.x;
   outCoordinates->y = viewOffset.y;
   outCoordinates->height = theFrame->GetSize().height;
-  outCoordinates->width = ComputeMetrics(theFrame, theFrameOffset).mCaretWidth;
+  outCoordinates->width = ComputeMetrics(theFrame, theFrameOffset, outCoordinates->height).mCaretWidth;
   
   return NS_OK;
 }
 
 void nsCaret::DrawCaretAfterBriefDelay()
 {
   // Make sure readonly caret gets drawn again if it needs to be
   if (!mBlinkTimer) {
@@ -468,23 +475,46 @@ void nsCaret::UpdateCaretPosition()
   // A trick! Make the DrawCaret code recalculate the caret's current
   // position.
   mDrawn = PR_FALSE;
   DrawCaret(PR_FALSE);
 }
 
 void nsCaret::PaintCaret(nsDisplayListBuilder *aBuilder,
                          nsIRenderingContext *aCtx,
-                         const nsPoint &aOffset,
-                         nscolor aColor)
+                         nsIFrame* aForFrame,
+                         const nsPoint &aOffset)
 {
   NS_ASSERTION(mDrawn, "The caret shouldn't be drawing");
 
-  aCtx->SetColor(aColor);
-  aCtx->FillRect(mCaretRect + aOffset);
+  const nsRect drawCaretRect = mCaretRect + aOffset;
+  nscolor cssColor = aForFrame->GetStyleColor()->mColor;
+
+  // Only draw the native caret if the foreground color matches that of
+  // -moz-fieldtext (the color of the text in a textbox). If it doesn't match
+  // we are likely in contenteditable or a custom widget and we risk being hard to see
+  // against the background. In that case, fall back to the CSS color.
+  nsPresContext* presContext = aForFrame->PresContext();
+
+  if (GetHookRect().IsEmpty() && presContext) {
+    nsITheme *theme = presContext->GetTheme();
+    if (theme && theme->ThemeSupportsWidget(presContext, aForFrame, NS_THEME_TEXTFIELD_CARET)) {
+      nsILookAndFeel* lookAndFeel = presContext->LookAndFeel();
+      nscolor fieldText;
+      if (NS_SUCCEEDED(lookAndFeel->GetColor(nsILookAndFeel::eColor__moz_fieldtext, fieldText)) &&
+          fieldText == cssColor) {
+        theme->DrawWidgetBackground(aCtx, aForFrame, NS_THEME_TEXTFIELD_CARET,
+                                    drawCaretRect, drawCaretRect);
+        return;
+      }
+    }
+  }
+
+  aCtx->SetColor(cssColor);
+  aCtx->FillRect(drawCaretRect);
   if (!GetHookRect().IsEmpty())
     aCtx->FillRect(GetHookRect() + aOffset);
 }
 
 
 //-----------------------------------------------------------------------------
 NS_IMETHODIMP nsCaret::NotifySelectionChanged(nsIDOMDocument *, nsISelection *aDomSel, PRInt16 aReason)
 {
@@ -1171,17 +1201,17 @@ nsresult nsCaret::UpdateCaretRects(nsIFr
                                                        framePos);
   if (NS_FAILED(rv))
   {
     mCaretRect.Empty();
     return rv;
   }
 
   mCaretRect += framePos;
-  Metrics metrics = ComputeMetrics(aFrame, aFrameOffset);
+  Metrics metrics = ComputeMetrics(aFrame, aFrameOffset, mCaretRect.height);
   mCaretRect.width = metrics.mCaretWidth;
 
   // Clamp our position to be within our scroll frame. If we don't, then it
   // clips us, and we don't appear at all. See bug 335560.
   nsIFrame *scrollFrame =
     nsLayoutUtils::GetClosestFrameOfType(aFrame, nsGkAtoms::scrollFrame);
   if (scrollFrame)
   {
diff --git a/layout/base/nsCaret.h b/layout/base/nsCaret.h
--- a/layout/base/nsCaret.h
+++ b/layout/base/nsCaret.h
@@ -99,18 +99,18 @@ class nsCaret : public nsICaret,
       return nsnull;
     }
 
     void      InvalidateOutsideCaret();
     void      UpdateCaretPosition();
 
     void      PaintCaret(nsDisplayListBuilder *aBuilder,
                          nsIRenderingContext *aCtx,
-                         const nsPoint &aOffset,
-                         nscolor aColor);
+                         nsIFrame *aForFrame,
+                         const nsPoint &aOffset);
 
     void SetIgnoreUserModify(PRBool aIgnoreUserModify);
 
     //nsISelectionListener interface
     NS_DECL_NSISELECTIONLISTENER
 
     static void   CaretBlinkCallback(nsITimer *aTimer, void *aClosure);
   
@@ -141,17 +141,17 @@ protected:
                                          nsFrameSelection::HINT aFrameHint,
                                          PRUint8 aBidiLevel,
                                          PRBool aInvalidate);
 
     struct Metrics {
       nscoord mBidiIndicatorSize; // width and height of bidi indicator
       nscoord mCaretWidth;        // full caret width including bidi indicator
     };
-    Metrics ComputeMetrics(nsIFrame* aFrame, PRInt32 aOffset);
+    Metrics ComputeMetrics(nsIFrame* aFrame, PRInt32 aOffset, nscoord aCaretHeight);
 
     // Returns true if the caret should be drawn. When |mDrawn| is true,
     // this returns true, so that we erase the drawn caret. If |aIgnoreDrawnState|
     // is true, we don't take into account whether the caret is currently
     // drawn or not. This can be used to determine if the caret is drawn when
     // it shouldn't be.
     PRBool        MustDrawCaret(PRBool aIgnoreDrawnState);
 
@@ -191,16 +191,17 @@ protected:
 
     nsCOMPtr<nsITimer>              mBlinkTimer;
     nsCOMPtr<nsIRenderingContext>   mRendContext;
 
     // XXX these fields should go away and the values be acquired as needed,
     // probably by ComputeMetrics.
     PRUint32              mBlinkRate;         // time for one cyle (off then on), in milliseconds
     nscoord               mCaretWidthCSSPx;   // caret width in CSS pixels
+    float                 mCaretAspectRatio;  // caret width/height aspect ratio
     
     PRPackedBool          mVisible;           // is the caret blinking
 
     PRPackedBool          mDrawn;             // Denotes when the caret is physically drawn on the screen.
 
     PRPackedBool          mReadOnly;          // it the caret in readonly state (draws differently)      
     PRPackedBool          mShowDuringSelection; // show when text is selected
 
diff --git a/layout/base/nsDisplayList.cpp b/layout/base/nsDisplayList.cpp
--- a/layout/base/nsDisplayList.cpp
+++ b/layout/base/nsDisplayList.cpp
@@ -592,18 +592,17 @@ nsDisplayOutline::OptimizeVisibility(nsD
   return PR_TRUE;
 }
 
 void
 nsDisplayCaret::Paint(nsDisplayListBuilder* aBuilder,
     nsIRenderingContext* aCtx, const nsRect& aDirtyRect) {
   // Note: Because we exist, we know that the caret is visible, so we don't
   // need to check for the caret's visibility.
-  mCaret->PaintCaret(aBuilder, aCtx, aBuilder->ToReferenceFrame(mFrame),
-                     mFrame->GetStyleColor()->mColor);
+  mCaret->PaintCaret(aBuilder, aCtx, mFrame, aBuilder->ToReferenceFrame(mFrame));
 }
 
 PRBool
 nsDisplayBorder::OptimizeVisibility(nsDisplayListBuilder* aBuilder,
                                     nsRegion* aVisibleRegion) {
   if (!nsDisplayItem::OptimizeVisibility(aBuilder, aVisibleRegion))
     return PR_FALSE;
 
diff --git a/layout/base/nsICaret.h b/layout/base/nsICaret.h
--- a/layout/base/nsICaret.h
+++ b/layout/base/nsICaret.h
@@ -53,18 +53,18 @@ class nsIFrame;
 class nsIFrame;
 class nsIView;
 class nsIPresShell;
 class nsISelection;
 class nsIDOMNode;
 
 // IID for the nsICaret interface
 #define NS_ICARET_IID \
-{ 0x35d82f6b, 0x78f6, 0x4e8a, \
-  { 0xb9, 0x2a, 0x1a, 0x26, 0xac, 0x2c, 0xe8, 0x53 } }
+{ 0x48e23b7f, 0x264e, 0xab7d, \
+  { 0x20, 0x03, 0x2c, 0x79, 0x13, 0xe1, 0x09, 0x4d } }
 
 
 class nsICaret: public nsISupports
 {
 public:
   NS_DECLARE_STATIC_IID_ACCESSOR(NS_ICARET_IID)
 
   enum EViewCoordinates {
@@ -177,18 +177,18 @@ public:
    */
   virtual void UpdateCaretPosition() = 0;
 
   /** PaintCaret
    *  Actually paint the caret onto the given rendering context.
    */
   virtual void PaintCaret(nsDisplayListBuilder *aBuilder,
                           nsIRenderingContext *aCtx,
-                          const nsPoint &aOffset,
-                          nscolor aColor) = 0;
+                          nsIFrame *aForFrame,
+                          const nsPoint &aOffset) = 0;
 
   /**
    * Sets whether the caret should only be visible in nodes that are not
    * user-modify: read-only, or whether it should be visible in all nodes.
    *
    * @param aIgnoreUserModify PR_TRUE to have the cursor visible in all nodes,
    *                          PR_FALSE to have it visible in all nodes except
    *                          those with user-modify: read-only
diff --git a/layout/base/nsIPresShell.h b/layout/base/nsIPresShell.h
--- a/layout/base/nsIPresShell.h
+++ b/layout/base/nsIPresShell.h
@@ -97,20 +97,21 @@ class nsWeakFrame;
 class nsWeakFrame;
 class nsIScrollableFrame;
 class gfxASurface;
 class gfxContext;
 
 typedef short SelectionType;
 typedef PRUint32 nsFrameState;
 
-// 228a7d67-811b-4d75-85c0-1ee22c0d2af0
+
+// 23e048f6-49bb-4ac4-b900-c63865363ad3
 #define NS_IPRESSHELL_IID \
-{ 0x228a7d67, 0x811b, 0x4d75, \
-  { 0x85, 0xc0, 0x1e, 0xe2, 0x2c, 0x0d, 0x2a, 0xf0 } }
+{ 0x23e048f6, 0x49bb, 0x4ac4, \
+  { 0xb9, 0x00, 0xc6, 0x38, 0x65, 0x36, 0x3a, 0xd3 } }
 
 // Constants for ScrollContentIntoView() function
 #define NS_PRESSHELL_SCROLL_TOP      0
 #define NS_PRESSHELL_SCROLL_BOTTOM   100
 #define NS_PRESSHELL_SCROLL_LEFT     0
 #define NS_PRESSHELL_SCROLL_RIGHT    100
 #define NS_PRESSHELL_SCROLL_CENTER   50
 #define NS_PRESSHELL_SCROLL_ANYWHERE -1
@@ -380,16 +381,18 @@ public:
 
   NS_IMETHOD CancelAllPendingReflows() = 0;
 
   /**
    * Recreates the frames for a node
    */
   NS_IMETHOD RecreateFramesFor(nsIContent* aContent) = 0;
 
+  void PostRecreateFramesFor(nsIContent* aContent);
+  
   /**
    * Determine if it is safe to flush all pending notifications
    * @param aIsSafeToFlush PR_TRUE if it is safe, PR_FALSE otherwise.
    * 
    */
   NS_IMETHOD IsSafeToFlush(PRBool& aIsSafeToFlush) = 0;
 
   /**
diff --git a/layout/base/nsPresShell.cpp b/layout/base/nsPresShell.cpp
--- a/layout/base/nsPresShell.cpp
+++ b/layout/base/nsPresShell.cpp
@@ -3412,16 +3412,23 @@ PresShell::RecreateFramesFor(nsIContent*
   
   batch.EndUpdateViewBatch(NS_VMREFRESH_NO_SYNC);
 #ifdef ACCESSIBILITY
   InvalidateAccessibleSubtree(aContent);
 #endif
   return rv;
 }
 
+void
+nsIPresShell::PostRecreateFramesFor(nsIContent* aContent)
+{
+  FrameConstructor()->PostRestyleEvent(aContent, eReStyle_Self,
+          nsChangeHint_ReconstructFrame);
+}
+
 NS_IMETHODIMP
 PresShell::ClearFrameRefs(nsIFrame* aFrame)
 {
   mPresContext->EventStateManager()->ClearFrameRefs(aFrame);
   
   if (aFrame == mCurrentEventFrame) {
     mCurrentEventContent = aFrame->GetContent();
     mCurrentEventFrame = nsnull;
diff --git a/layout/build/Makefile.in b/layout/build/Makefile.in
--- a/layout/build/Makefile.in
+++ b/layout/build/Makefile.in
@@ -211,20 +211,16 @@ EXTRA_DSO_LDOPTS = \
 EXTRA_DSO_LDOPTS = \
 		$(LIBS_DIR) \
 		$(EXTRA_DSO_LIBS) \
 		$(MOZ_UNICHARUTIL_LIBS) \
 		$(MOZ_COMPONENT_LIBS) \
 		$(MOZ_JS_LIBS) \
 		$(NULL)
 
-ifdef NS_TRACE_MALLOC
-EXTRA_DSO_LIBS	+= tracemalloc
-endif
-
 ifdef MOZ_ENABLE_GTK2
 EXTRA_DSO_LDOPTS += $(MOZ_GTK2_LIBS) \
 		    -lXrender \
 		    $(NULL)
 endif
 
 ifneq (,$(filter mac cocoa,$(MOZ_WIDGET_TOOLKIT)))
 EXTRA_DSO_LDOPTS += \
diff --git a/layout/generic/nsSimplePageSequence.cpp b/layout/generic/nsSimplePageSequence.cpp
--- a/layout/generic/nsSimplePageSequence.cpp
+++ b/layout/generic/nsSimplePageSequence.cpp
@@ -647,16 +647,17 @@ nsSimplePageSequenceFrame::PrintNextPage
       nsLayoutUtils::PaintFrame(renderingContext, mCurrentPageFrame,
                                 drawingRegion, NS_RGBA(0,0,0,0));
 
       if (mSelectionHeight >= 0 && selectionY < mSelectionHeight) {
         selectionY += height;
         printedPageNum++;
         pf->SetPageNumInfo(printedPageNum, mTotalPages);
         conFrame->SetPosition(conFrame->GetPosition() + nsPoint(0, -height));
+        nsContainerFrame::PositionChildViews(conFrame);
 
         PR_PL(("***************** End Page (PrintNextPage) *****************\n"));
         rv = dc->EndPage();
         NS_ENSURE_SUCCESS(rv, rv);
       } else {
         continuePrinting = PR_FALSE;
       }
     }
diff --git a/layout/reftests/bugs/109735-1-ref.html b/layout/reftests/bugs/109735-1-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/109735-1-ref.html
@@ -0,0 +1,11 @@
+<!DOCTYPE html>
+<html>
+ <head>
+  <meta http-equiv="Content-type" content="text/html; charset=x-sjis">
+  <title>x-sjis overlap</title>
+ </head>
+ <body> 
+This is some regular old text
+This is some text in an anchor
+ </body>
+</html>
diff --git a/layout/reftests/bugs/109735-1.html b/layout/reftests/bugs/109735-1.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/109735-1.html
@@ -0,0 +1,11 @@
+<!DOCTYPE html>
+<html>
+ <head>
+  <meta http-equiv="Content-type" content="text/html; charset=x-sjis">
+  <title>x-sjis overlap</title>
+ </head>
+ <body> 
+This is some regular old text
+<a>This is some text in an anchor</a>
+ </body>
+</html>
diff --git a/layout/reftests/bugs/438981-1.xhtml b/layout/reftests/bugs/438981-1.xhtml
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/438981-1.xhtml
@@ -0,0 +1,11 @@
+<html xmlns="http://www.w3.org/1999/xhtml">
+<body id="realbody">
+</body>
+<body style="background:blue;">
+</body>
+<script>
+if (document.body != document.getElementById("realbody")) {
+  document.body.appendChild(document.createTextNode("FAIL"));
+}
+</script>
+</html>
diff --git a/layout/reftests/bugs/440112-ref.html b/layout/reftests/bugs/440112-ref.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/440112-ref.html
@@ -0,0 +1,21 @@
+<!DOCTYPE HTML>
+<html lang="en">
+<head>
+<meta http-equiv="content-type" content="text/html;charset=utf-8">
+
+<title>Bug 440112</title>
+</head>
+<body>
+<body style="background-color: orange">
+ <div id="wrapper" style="position: absolute; top: 30px; left: 30px; height: 150px;">
+    <form>
+
+     <textarea id="formElement" style="width: 200px; height: 50px;">
+</textarea>
+     </form>
+ </div>
+ <div style="background-color: orange; height: 150px; width: 120px; position: absolute; top: 25px; left: 130px;"></div>
+</body>
+
+</body>
+</html>
diff --git a/layout/reftests/bugs/440112.html b/layout/reftests/bugs/440112.html
new file mode 100644
--- /dev/null
+++ b/layout/reftests/bugs/440112.html
@@ -0,0 +1,20 @@
+<!DOCTYPE HTML>
+<html lang="en">
+<head>
+<meta http-equiv="content-type" content="text/html;charset=utf-8">
+
+<title>Bug 440112</title>
+</head>
+<body>
+<body style="background-color: orange">
+ <div id="wrapper" style="position: absolute; top: 30px; left: 30px; overflow:hidden; height: 150px; width: 100px">
+    <form>
+
+     <textarea id="formElement" style="width: 200px; height: 50px;">
+</textarea>
+     </form>
+ </div>
+</body>
+
+</body>
+</html>
diff --git a/layout/reftests/bugs/reftest.list b/layout/reftests/bugs/reftest.list
--- a/layout/reftests/bugs/reftest.list
+++ b/layout/reftests/bugs/reftest.list
@@ -71,16 +71,17 @@ fails == 25888-3r.html 25888-3r-ref.html
 == 97777-2.html 97777-2-ref.html
 == 98223-1.html 98223-1-ref.html
 == 98223-2.html 98223-2-ref.html
 == 99850-1a.html 99850-1-ref.html
 == 99850-1b.html 99850-1-ref.html
 == 99850-1c.html 99850-1-ref.html
 == 99850-1d.html 99850-1-ref.html
 == 105030-1.html 105030-1-ref.html
+== 109735-1.html 109735-1-ref.html
 == 120834-1a.html 120834-1-ref.html
 == 120834-2a.html 120834-2-ref.html
 == 120834-2b.html 120834-2-ref.html
 == 120834-2c.html 120834-2-ref.html
 == 120834-2d.html 120834-2-ref.html
 == 120834-2e.html 120834-2-ref.html
 == 120834-2f.html 120834-2-ref.html
 == 120834-2g.html 120834-2-ref.html
@@ -843,11 +844,13 @@ fails-if(MOZ_WIDGET_TOOLKIT=="gtk2") == 
 == 428521-1a.html 428521-1-ref.html
 == 428521-1b.html 428521-1-ref.html
 == 428521-1c.html 428521-1-ref.html
 random == 429849-1.html 429849-1-ref.html # bug 432288
 == 430412-1.html 430412-1-ref.html
 == 430813-1.html 430813-1-ref.html
 == 430813-2.html 430813-2-ref.html
 == 430813-3.html 430813-3-ref.html
+== 440112.html 440112-ref.html
 == 433640-1.html 433640-1-ref.html
+== 438981-1.xhtml about:blank
 == 439004-1.html 439004-1-ref.html
 == 439910.html 439910-ref.html
diff --git a/layout/reftests/svg/dynamic-rect-04.xhtml b/layout/reftests/svg/dynamic-rect-04.xhtml
new file mode 100644
--- /dev/null
+++ b/layout/reftests/svg/dynamic-rect-04.xhtml
@@ -0,0 +1,30 @@
+<?xml version="1.0"?>
+<!--
+     Any copyright is dedicated to the Public Domain.
+     http://creativecommons.org/licenses/publicdomain/
+-->
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+<title>Testcase reference file dynamic svg creation</title>
+<!-- From https://bugzilla.mozilla.org/show_bug.cgi?id=438867 -->
+<script>
+function m() {
+    var SVG_NS = "http://www.w3.org/2000/svg";
+    var svg = document.createElementNS(SVG_NS, 'svg');
+    svg.style.position = 'absolute';
+    svg.style.left = '0px';
+    svg.style.top = '0px';
+    document.body.appendChild(svg);
+    
+    var rect = document.createElementNS(SVG_NS, "rect");
+    rect.setAttribute('width', '100%');
+    rect.setAttribute('height', '100%');
+    rect.setAttribute('fill', 'lime');
+    svg.appendChild(rect);
+}
+</script>
+</head>
+<body onload="m();">
+<hr style="clear: both;"/>
+</body>
+</html>
diff --git a/layout/reftests/svg/dynamic-use-01.svg b/layout/reftests/svg/dynamic-use-01.svg
new file mode 100644
--- /dev/null
+++ b/layout/reftests/svg/dynamic-use-01.svg
@@ -0,0 +1,91 @@
+<!--
+     Any copyright is dedicated to the Public Domain.
+     http://creativecommons.org/licenses/publicdomain/
+-->
+<svg xmlns="http://www.w3.org/2000/svg" version="1.1"
+     xmlns:xlink="http://www.w3.org/1999/xlink">
+  <title>Testing that dynamic changes to the element for a given ID are reflected in 'use'</title>
+
+  <use id="u1" x="10%" xlink:href="#r1"/>
+  <script>
+    // force frame construction; test that parsing "r1" after frame construction
+    // is still bound to "u1" eventually
+    var rect = document.getElementById("u1").getBoundingClientRect();
+  </script>
+  <rect width="11%" height="100%" fill="lime" id="r1"/>
+
+  <rect width="11%" height="100%" fill="lime" id="x"/>
+  <use id="u2" x="20%" xlink:href="#r2"/>
+  <script>
+    var rect = document.getElementById("u2").getBoundingClientRect();
+    // check that changing an id to "r2" lets u2 find it
+    var r2 = document.getElementById("x");
+    r2.setAttribute("id", "r2");
+  </script>
+
+  <rect width="10%" height="100%" fill="red" id="r3"/>
+  <rect width="11%" height="100%" fill="lime" id="r3"/>
+  <use id="u3" x="30%" xlink:href="#r3"/>
+  <script>
+    var rect = document.getElementById("u3").getBoundingClientRect();
+    // check that removing the bad r3 lets u3 find the good one
+    var r3 = document.getElementById("r3");
+    r3.parentNode.removeChild(r3);
+  </script>
+
+  <rect width="10%" height="100%" fill="red" id="r4"/>
+  <rect width="11%" height="100%" fill="lime" id="r4"/>
+  <use id="u4" x="40%" xlink:href="#r4"/>
+  <script>
+    var rect = document.getElementById("u4").getBoundingClientRect();
+    // check that renaming the bad r4 lets u4 find the good one
+    var r4 = document.getElementById("r4");
+    r4.removeAttribute("id");
+  </script>
+
+  <rect width="10%" height="100%" fill="red" id="r5"/>
+  <use id="u5" x="50%" xlink:href="#r5"/>
+  <script>
+    var rect = document.getElementById("u5").getBoundingClientRect();
+    // check that changing u5's reference works
+    var u5 = document.getElementById("u5");
+    u5.setAttributeNS("http://www.w3.org/1999/xlink", "href", "#r1");
+  </script>
+
+  <rect width="10%" height="100%" fill="red" id="r6"/>
+  <rect width="11%" height="100%" fill="lime" id="r6-2"/>
+  <use id="u6" x="60%" xlink:href="#r6"/>
+  <script>
+    var rect = document.getElementById("u6").getBoundingClientRect();
+    // check that inserting a good element before the bad r6 works
+    var r6 = document.getElementById("r6-2");
+    r6.parentNode.removeChild(r6);
+    r6.setAttribute("id", "r6");
+    document.documentElement.insertBefore(r6, document.documentElement.firstChild);
+  </script>
+
+  <rect width="11%" height="100%" fill="lime" id="r7"/>
+  <rect width="10%" height="100%" fill="red" id="r7-2"/>
+  <use id="u7" x="70%" xlink:href="#r7"/>
+  <script>
+    var rect = document.getElementById("u7").getBoundingClientRect();
+    // check that inserting a bad element after a good one doesn't break anything
+    var r7 = document.getElementById("r7-2");
+    r7.parentNode.removeChild(r7);
+    r7.setAttribute("id", "r7");
+    document.documentElement.appendChild(r7);
+  </script>
+
+  <rect width="11%" height="100%" fill="lime" id="r8-2"/>
+  <rect width="10%" height="100%" fill="red" id="r8"/>
+  <use id="u8" x="80%" xlink:href="#r8"/>
+  <script>
+    var rect = document.getElementById("u8").getBoundingClientRect();
+    // check that renaming a good element to r8 works
+    var r8 = document.getElementById("r8-2");
+    r8.setAttribute("id", "r8");
+  </script>
+
+  <rect width="11%" height="100%" fill="lime"/>
+  <rect x="90%" width="11%" height="100%" fill="lime"/>
+</svg>
diff --git a/layout/reftests/svg/reftest.list b/layout/reftests/svg/reftest.list
--- a/layout/reftests/svg/reftest.list
+++ b/layout/reftests/svg/reftest.list
@@ -14,20 +14,22 @@ include moz-only/reftest.list
 == clip-surface-clone-01.svg clip-surface-clone-01-ref.svg
 == currentColor-01.svg pass.svg
 == currentColor-02.svg pass.svg
 == currentColor-03.svg pass.svg
 == dynamic-link-style-01.svg pass.svg
 == dynamic-rect-01.svg dynamic-rect-01-ref.svg
 == dynamic-rect-02.svg dynamic-rect-02-ref.svg
 == dynamic-rect-03.svg dynamic-rect-03-ref.svg
+== dynamic-rect-04.xhtml pass.svg
 == dynamic-reflow-01.svg dynamic-reflow-01-ref.svg
 == dynamic-text-01.svg dynamic-text-01-ref.svg
 == dynamic-text-02.svg dynamic-text-02-ref.svg
 == dynamic-text-03.svg dynamic-text-03-ref.svg
+== dynamic-use-01.svg pass.svg
 == fallback-color-01a.svg pass.svg
 == fallback-color-01b.svg pass.svg
 == fallback-color-02a.svg fallback-color-02-ref.svg
 == fallback-color-02b.svg fallback-color-02-ref.svg
 == fallback-color-03.svg pass.svg
 == filter-basic-01.svg pass.svg
 == filter-basic-02.svg pass.svg
 == filter-basic-03.svg pass.svg
@@ -54,17 +56,17 @@ random-if(MOZ_WIDGET_TOOLKIT=="cocoa") =
 == pseudo-classes-01.svg pass.svg
 == pseudo-classes-02.svg pseudo-classes-02-ref.svg
 == radialGradient-basic-01.svg pass.svg
 == radialGradient-basic-02.svg pass.svg
 == rect-with-rx-and-ry-01.svg pass.svg
 == rect-with-rx-or-ry-01.svg rect-with-rx-or-ry-01-ref.svg
 == rootElement-null-01.svg pass.svg
 == stroke-width-percentage-01.svg pass.svg
-fails == style-property-not-on-script-element-01.svg pass.svg
+== style-property-not-on-script-element-01.svg pass.svg
 == style-without-type-attribute.svg pass.svg
 == svg-in-foreignObject-01.xhtml svg-in-foreignObject-01-ref.xhtml
 == svg-in-foreignObject-02.xhtml svg-in-foreignObject-01-ref.xhtml # reuse -01-ref.xhtml
 random-if(MOZ_WIDGET_TOOLKIT=="gtk2") == text-font-weight-01.svg text-font-weight-01-ref.svg # bug 386713
 == text-gradient-01.svg text-gradient-01-ref.svg
 == text-in-link-01.svg text-in-link-01-ref.svg
 == text-scale-01.svg text-scale-01-ref.svg
 == text-style-01a.svg text-style-01-ref.svg
diff --git a/layout/svg/base/src/nsSVGContainerFrame.cpp b/layout/svg/base/src/nsSVGContainerFrame.cpp
--- a/layout/svg/base/src/nsSVGContainerFrame.cpp
+++ b/layout/svg/base/src/nsSVGContainerFrame.cpp
@@ -93,17 +93,19 @@ nsSVGContainerFrame::Init(nsIContent* aC
   return rv;
 }
 
 NS_IMETHODIMP
 nsSVGDisplayContainerFrame::Init(nsIContent* aContent,
                                  nsIFrame* aParent,
                                  nsIFrame* aPrevInFlow)
 {
-  AddStateBits(aParent->GetStateBits() & NS_STATE_SVG_NONDISPLAY_CHILD);
+  if (!(GetStateBits() & NS_STATE_IS_OUTER_SVG)) {
+    AddStateBits(aParent->GetStateBits() & NS_STATE_SVG_NONDISPLAY_CHILD);
+  }
   nsresult rv = nsSVGContainerFrameBase::Init(aContent, aParent, aPrevInFlow);
   return rv;
 }
 
 void
 nsSVGDisplayContainerFrame::Destroy()
 {
   nsSVGUtils::StyleEffects(this);
diff --git a/layout/svg/base/src/nsSVGGlyphFrame.cpp b/layout/svg/base/src/nsSVGGlyphFrame.cpp
--- a/layout/svg/base/src/nsSVGGlyphFrame.cpp
+++ b/layout/svg/base/src/nsSVGGlyphFrame.cpp
@@ -1303,16 +1303,19 @@ PRBool
 PRBool
 CharacterIterator::SetupForDirectTextRun(gfxContext *aContext, float aScale)
 {
   if (!mPositions.IsEmpty() || mInError)
     return PR_FALSE;
   aContext->SetMatrix(mInitialMatrix);
   aContext->Translate(mSource->mPosition);
   aContext->Scale(aScale, aScale);
+  // We are scaling the glyphs up/down to the size we want so we need to
+  // inverse scale the outline widths of those glyphs so they are invariant
+  aContext->SetLineWidth(aContext->CurrentLineWidth() / aScale);
   return PR_TRUE;
 }
 
 PRInt32
 CharacterIterator::NextChar()
 {
   if (mInError)
     return -1;
@@ -1353,16 +1356,19 @@ CharacterIterator::SetupFor(gfxContext *
     aContext->Translate(mSource->mPosition);
     aContext->Scale(aScale, aScale);
     aContext->Translate(gfxPoint(mCurrentAdvance, 0));
   } else {
     aContext->Translate(mPositions[mCurrentChar].pos);
     aContext->Rotate(mPositions[mCurrentChar].angle);
     aContext->Scale(aScale, aScale);
   }
+  // We are scaling the glyphs up/down to the size we want so we need to
+  // inverse scale the outline widths of those glyphs so they are invariant
+  aContext->SetLineWidth(aContext->CurrentLineWidth() / aScale);
 }
 
 CharacterPosition
 CharacterIterator::GetPositionData()
 {
   if (!mPositions.IsEmpty())
     return mPositions[mCurrentChar];
 
diff --git a/layout/svg/base/src/nsSVGOuterSVGFrame.cpp b/layout/svg/base/src/nsSVGOuterSVGFrame.cpp
--- a/layout/svg/base/src/nsSVGOuterSVGFrame.cpp
+++ b/layout/svg/base/src/nsSVGOuterSVGFrame.cpp
@@ -161,16 +161,18 @@ nsSVGOuterSVGFrame::nsSVGOuterSVGFrame(n
 {
 }
 
 NS_IMETHODIMP
 nsSVGOuterSVGFrame::Init(nsIContent* aContent,
                          nsIFrame* aParent,
                          nsIFrame* aPrevInFlow)
 {
+  AddStateBits(NS_STATE_IS_OUTER_SVG);
+
   nsresult rv = nsSVGOuterSVGFrameBase::Init(aContent, aParent, aPrevInFlow);
 
   nsIDocument* doc = mContent->GetCurrentDoc();
   if (doc) {
     // we only care about our content's zoom and pan values if it's the root element
     if (doc->GetRootContent() == mContent) {
       nsSVGSVGElement *SVGElement = static_cast<nsSVGSVGElement*>(mContent);
       SVGElement->GetCurrentTranslate(getter_AddRefs(mCurrentTranslate));
@@ -178,18 +180,16 @@ nsSVGOuterSVGFrame::Init(nsIContent* aCo
     }
     // AddMutationObserver checks that the observer is not already added.
     // sSVGMutationObserver has the same lifetime as the document so does
     // not need to be removed
     doc->AddMutationObserver(&sSVGMutationObserver);
   }
 
   SuspendRedraw();  // UnsuspendRedraw is in DidReflow
-
-  AddStateBits(NS_STATE_IS_OUTER_SVG);
 
   return rv;
 }
 
 //----------------------------------------------------------------------
 // nsISupports methods
 
 NS_INTERFACE_MAP_BEGIN(nsSVGOuterSVGFrame)
diff --git a/memory/jemalloc/ql.h b/memory/jemalloc/ql.h
new file mode 100644
--- /dev/null
+++ b/memory/jemalloc/ql.h
@@ -0,0 +1,114 @@
+/******************************************************************************
+ *
+ * Copyright (C) 2002 Jason Evans <jasone@canonware.com>.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice(s), this list of conditions and the following disclaimer
+ *    unmodified other than the allowable addition of one or more
+ *    copyright notices.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice(s), this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDER(S) ``AS IS'' AND ANY
+ * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT HOLDER(S) BE
+ * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+ * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+ * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
+ * BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
+ * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
+ * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
+ * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ *
+ ******************************************************************************/
+
+/*
+ * List definitions.
+ */
+#define ql_head(a_type)							\
+struct {								\
+	a_type *qlh_first;						\
+}
+
+#define ql_head_initializer(a_head) {NULL}
+
+#define ql_elm(a_type)	qr(a_type)
+
+/* List functions. */
+#define ql_new(a_head) do {						\
+	(a_head)->qlh_first = NULL;					\
+} while (0)
+
+#define ql_elm_new(a_elm, a_field) qr_new((a_elm), a_field)
+
+#define ql_first(a_head) ((a_head)->qlh_first)
+
+#define ql_last(a_head, a_field)					\
+	((ql_first(a_head) != NULL)					\
+	    ? qr_prev(ql_first(a_head), a_field) : NULL)
+
+#define ql_next(a_head, a_elm, a_field)					\
+	((ql_last(a_head, a_field) != (a_elm))				\
+	    ? qr_next((a_elm), a_field)	: NULL)
+
+#define ql_prev(a_head, a_elm, a_field)					\
+	((ql_first(a_head) != (a_elm)) ? qr_prev((a_elm), a_field)	\
+				       : NULL)
+
+#define ql_before_insert(a_head, a_qlelm, a_elm, a_field) do {		\
+	qr_before_insert((a_qlelm), (a_elm), a_field);			\
+	if (ql_first(a_head) == (a_qlelm)) {				\
+		ql_first(a_head) = (a_elm);				\
+	}								\
+} while (0)
+
+#define ql_after_insert(a_qlelm, a_elm, a_field)			\
+	qr_after_insert((a_qlelm), (a_elm), a_field)
+
+#define ql_head_insert(a_head, a_elm, a_field) do {			\
+	if (ql_first(a_head) != NULL) {					\
+		qr_before_insert(ql_first(a_head), (a_elm), a_field);	\
+	}								\
+	ql_first(a_head) = (a_elm);					\
+} while (0)
+
+#define ql_tail_insert(a_head, a_elm, a_field) do {			\
+	if (ql_first(a_head) != NULL) {					\
+		qr_before_insert(ql_first(a_head), (a_elm), a_field);	\
+	}								\
+	ql_first(a_head) = qr_next((a_elm), a_field);			\
+} while (0)
+
+#define ql_remove(a_head, a_elm, a_field) do {				\
+	if (ql_first(a_head) == (a_elm)) {				\
+		ql_first(a_head) = qr_next(ql_first(a_head), a_field);	\
+	}								\
+	if (ql_first(a_head) != (a_elm)) {				\
+		qr_remove((a_elm), a_field);				\
+	} else {							\
+		ql_first(a_head) = NULL;				\
+	}								\
+} while (0)
+
+#define ql_head_remove(a_head, a_type, a_field) do {			\
+	a_type *t = ql_first(a_head);					\
+	ql_remove((a_head), t, a_field);				\
+} while (0)
+
+#define ql_tail_remove(a_head, a_type, a_field) do {			\
+	a_type *t = ql_last(a_head, a_field);				\
+	ql_remove((a_head), t, a_field);				\
+} while (0)
+
+#define ql_foreach(a_var, a_head, a_field)				\
+	qr_foreach((a_var), ql_first(a_head), a_field)
+
+#define ql_reverse_foreach(a_var, a_head, a_field)			\
+	qr_reverse_foreach((a_var), ql_first(a_head), a_field)
diff --git a/memory/jemalloc/qr.h b/memory/jemalloc/qr.h
new file mode 100644
--- /dev/null
+++ b/memory/jemalloc/qr.h
@@ -0,0 +1,98 @@
+/******************************************************************************
+ *
+ * Copyright (C) 2002 Jason Evans <jasone@canonware.com>.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice(s), this list of conditions and the following disclaimer
+ *    unmodified other than the allowable addition of one or more
+ *    copyright notices.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice(s), this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDER(S) ``AS IS'' AND ANY
+ * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT HOLDER(S) BE
+ * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+ * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+ * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
+ * BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
+ * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
+ * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
+ * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ *
+ ******************************************************************************/
+
+/* Ring definitions. */
+#define qr(a_type)							\
+struct {								\
+	a_type	*qre_next;						\
+	a_type	*qre_prev;						\
+}
+
+/* Ring functions. */
+#define qr_new(a_qr, a_field) do {					\
+	(a_qr)->a_field.qre_next = (a_qr);				\
+	(a_qr)->a_field.qre_prev = (a_qr);				\
+} while (0)
+
+#define qr_next(a_qr, a_field) ((a_qr)->a_field.qre_next)
+
+#define qr_prev(a_qr, a_field) ((a_qr)->a_field.qre_prev)
+
+#define qr_before_insert(a_qrelm, a_qr, a_field) do {			\
+	(a_qr)->a_field.qre_prev = (a_qrelm)->a_field.qre_prev;		\
+	(a_qr)->a_field.qre_next = (a_qrelm);				\
+	(a_qr)->a_field.qre_prev->a_field.qre_next = (a_qr);		\
+	(a_qrelm)->a_field.qre_prev = (a_qr);				\
+} while (0)
+
+#define qr_after_insert(a_qrelm, a_qr, a_field)				\
+    do									\
+    {									\
+	(a_qr)->a_field.qre_next = (a_qrelm)->a_field.qre_next;		\
+	(a_qr)->a_field.qre_prev = (a_qrelm);				\
+	(a_qr)->a_field.qre_next->a_field.qre_prev = (a_qr);		\
+	(a_qrelm)->a_field.qre_next = (a_qr);				\
+    } while (0)
+
+#define qr_meld(a_qr_a, a_qr_b, a_field) do {				\
+	void *t;							\
+	(a_qr_a)->a_field.qre_prev->a_field.qre_next = (a_qr_b);	\
+	(a_qr_b)->a_field.qre_prev->a_field.qre_next = (a_qr_a);	\
+	t = (a_qr_a)->a_field.qre_prev;					\
+	(a_qr_a)->a_field.qre_prev = (a_qr_b)->a_field.qre_prev;	\
+	(a_qr_b)->a_field.qre_prev = t;					\
+} while (0)
+
+/* qr_meld() and qr_split() are functionally equivalent, so there's no need to
+ * have two copies of the code. */
+#define qr_split(a_qr_a, a_qr_b, a_field)				\
+	qr_meld((a_qr_a), (a_qr_b), a_field)
+
+#define qr_remove(a_qr, a_field) do {					\
+	(a_qr)->a_field.qre_prev->a_field.qre_next			\
+	    = (a_qr)->a_field.qre_next;					\
+	(a_qr)->a_field.qre_next->a_field.qre_prev			\
+	    = (a_qr)->a_field.qre_prev;					\
+	(a_qr)->a_field.qre_next = (a_qr);				\
+	(a_qr)->a_field.qre_prev = (a_qr);				\
+} while (0)
+
+#define qr_foreach(var, a_qr, a_field)					\
+	for ((var) = (a_qr);						\
+	    (var) != NULL;						\
+	    (var) = (((var)->a_field.qre_next != (a_qr))		\
+	    ? (var)->a_field.qre_next : NULL))
+
+#define qr_reverse_foreach(var, a_qr, a_field)				\
+	for ((var) = ((a_qr) != NULL) ? qr_prev(a_qr, a_field) : NULL;	\
+	    (var) != NULL;						\
+	    (var) = (((var) != (a_qr))					\
+	    ? (var)->a_field.qre_prev : NULL))
diff --git a/modules/plugin/tools/sdk/samples/scriptable/mac/plugin.cpp b/modules/plugin/tools/sdk/samples/scriptable/mac/plugin.cpp
--- a/modules/plugin/tools/sdk/samples/scriptable/mac/plugin.cpp
+++ b/modules/plugin/tools/sdk/samples/scriptable/mac/plugin.cpp
@@ -90,18 +90,20 @@ nsPluginInstance::nsPluginInstance(NPP a
 }
 
 nsPluginInstance::~nsPluginInstance()
 {
   // mScriptablePeer may be also held by the browser 
   // so releasing it here does not guarantee that it is over
   // we should take precaution in case it will be called later
   // and zero its mPlugin member
-  mScriptablePeer->SetInstance(NULL);
-  NS_IF_RELEASE(mScriptablePeer);
+  if (mScriptablePeer) {
+    mScriptablePeer->SetInstance(NULL);
+    NS_RELEASE(mScriptablePeer);
+  }
 }
 
 NPBool nsPluginInstance::init(NPWindow* aWindow)
 {
   if(aWindow == NULL)
     return FALSE;
   
   mWindow = aWindow;
diff --git a/modules/plugin/tools/sdk/samples/scriptable/unix/plugin.cpp b/modules/plugin/tools/sdk/samples/scriptable/unix/plugin.cpp
--- a/modules/plugin/tools/sdk/samples/scriptable/unix/plugin.cpp
+++ b/modules/plugin/tools/sdk/samples/scriptable/unix/plugin.cpp
@@ -1,9 +1,9 @@
-/* -*- Mode: C++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
+/* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
 /* ***** BEGIN LICENSE BLOCK *****
  * Version: MPL 1.1/GPL 2.0/LGPL 2.1
  *
  * The contents of this file are subject to the Mozilla Public License Version
  * 1.1 (the "License"); you may not use this file except in compliance with
  * the License. You may obtain a copy of the License at
  * http://www.mozilla.org/MPL/
  *
@@ -121,18 +121,20 @@ nsPluginInstance::nsPluginInstance(NPP a
 }
 
 nsPluginInstance::~nsPluginInstance()
 {
   // mScriptablePeer may be also held by the browser 
   // so releasing it here does not guarantee that it is over
   // we should take precaution in case it will be called later
   // and zero its mPlugin member
-  mScriptablePeer->SetInstance(NULL);
-  NS_IF_RELEASE(mScriptablePeer);
+  if (mScriptablePeer) {
+    mScriptablePeer->SetInstance(NULL);
+    NS_RELEASE(mScriptablePeer);
+  }
 }
 
 static void
 xt_event_handler(Widget xtwidget, nsPluginInstance *plugin, XEvent *xevent, Boolean *b)
 {
   switch (xevent->type) {
     case Expose:
       // get rid of all other exposure events
diff --git a/modules/plugin/tools/sdk/samples/scriptable/unix/plugin.h b/modules/plugin/tools/sdk/samples/scriptable/unix/plugin.h
--- a/modules/plugin/tools/sdk/samples/scriptable/unix/plugin.h
+++ b/modules/plugin/tools/sdk/samples/scriptable/unix/plugin.h
@@ -1,9 +1,9 @@
-/* -*- Mode: C++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
+/* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
 /* ***** BEGIN LICENSE BLOCK *****
  * Version: MPL 1.1/GPL 2.0/LGPL 2.1
  *
  * The contents of this file are subject to the Mozilla Public License Version
  * 1.1 (the "License"); you may not use this file except in compliance with
  * the License. You may obtain a copy of the License at
  * http://www.mozilla.org/MPL/
  *
diff --git a/modules/plugin/tools/sdk/samples/scriptable/windows/plugin.cpp b/modules/plugin/tools/sdk/samples/scriptable/windows/plugin.cpp
--- a/modules/plugin/tools/sdk/samples/scriptable/windows/plugin.cpp
+++ b/modules/plugin/tools/sdk/samples/scriptable/windows/plugin.cpp
@@ -1,9 +1,9 @@
-/* -*- Mode: C++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
+/* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
 /* ***** BEGIN LICENSE BLOCK *****
  * Version: MPL 1.1/GPL 2.0/LGPL 2.1
  *
  * The contents of this file are subject to the Mozilla Public License Version
  * 1.1 (the "License"); you may not use this file except in compliance with
  * the License. You may obtain a copy of the License at
  * http://www.mozilla.org/MPL/
  *
@@ -88,18 +88,20 @@ nsPluginInstance::nsPluginInstance(NPP a
 }
 
 nsPluginInstance::~nsPluginInstance()
 {
   // mScriptablePeer may be also held by the browser 
   // so releasing it here does not guarantee that it is over
   // we should take precaution in case it will be called later
   // and zero its mPlugin member
-  mScriptablePeer->SetInstance(NULL);
-  NS_IF_RELEASE(mScriptablePeer);
+  if (mScriptablePeer) {
+    mScriptablePeer->SetInstance(NULL);
+    NS_RELEASE(mScriptablePeer);
+  }
 }
 
 static LRESULT CALLBACK PluginWinProc(HWND, UINT, WPARAM, LPARAM);
 static WNDPROC lpOldProc = NULL;
 
 NPBool nsPluginInstance::init(NPWindow* aWindow)
 {
   if(aWindow == NULL)
diff --git a/modules/plugin/tools/sdk/samples/scriptable/windows/plugin.h b/modules/plugin/tools/sdk/samples/scriptable/windows/plugin.h
--- a/modules/plugin/tools/sdk/samples/scriptable/windows/plugin.h
+++ b/modules/plugin/tools/sdk/samples/scriptable/windows/plugin.h
@@ -1,9 +1,9 @@
-/* -*- Mode: C++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
+/* -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- */
 /* ***** BEGIN LICENSE BLOCK *****
  * Version: MPL 1.1/GPL 2.0/LGPL 2.1
  *
  * The contents of this file are subject to the Mozilla Public License Version
  * 1.1 (the "License"); you may not use this file except in compliance with
  * the License. You may obtain a copy of the License at
  * http://www.mozilla.org/MPL/
  *
diff --git a/testing/sisyphus/bin/build.sh b/testing/sisyphus/bin/build.sh
--- a/testing/sisyphus/bin/build.sh
+++ b/testing/sisyphus/bin/build.sh
@@ -75,26 +75,22 @@ case $product in
                     fi
                 fi
                 ;;
             linux)
                 executablepath=$product-$buildtype/dist/bin
             ;;
         esac
 
-        if [[ "$OSID" != "win32" ]]; then
+        if [[ "$OSID" != "nt" ]]; then
             #
             # patch unix-like startup scripts to exec instead of 
             # forking new processes
             #
             executable=`get_executable $product $branch $executablepath`
-            if [[ -z "$executable" ]]; then
-                error "get_executable $product $branch $executablepath returned empty path" $LINENO
-            fi
-
 
             executabledir=`dirname $executable`
 
             # patch to use exec to prevent forked processes
             cd "$executabledir"
             if [ -e "$product" ]; then
                 echo "$SCRIPT: patching $product"
                 cp $TEST_DIR/bin/$product.diff .
diff --git a/testing/sisyphus/bin/builder.sh b/testing/sisyphus/bin/builder.sh
--- a/testing/sisyphus/bin/builder.sh
+++ b/testing/sisyphus/bin/builder.sh
@@ -49,17 +49,17 @@ function usage()
 {
     cat<<EOF
 usage: 
 $SCRIPT -p products -b branches -B buildcommands -T buildtypes [-e extra] [-v]
 
 variable            description
 ===============     ===========================================================
 -p products         required. one or more of firefox thunderbird
--b branches         required. one or more of 1.8.0 1.8.1 1.9.0
+-b branches         required. one or more of 1.8.0 1.8.1 1.9.0 1.9.1
 -B buildcommands    required. one or more of clean checkout build
 -T buildtypes       required. one or more of opt debug
 -e extra            optional. extra qualifier to pick build tree and mozconfig.
 -d datafiles        optional. one or more filenames of files containing 
                     environment variable definitions to be included.
 -v                  optional. verbose - copies log file output to stdout.
 
 note that the environment variables should have the same names as in the 
@@ -81,22 +81,17 @@ while getopts $options optname ;
       e) extra="-$OPTARG"
           extraflag="-e $OPTARG";;
       d) datafiles=$OPTARG;;
       v) verbose=1;;
   esac
 done
 
 # include environment variables
-if [[ -n "$datafiles" ]]; then
-    for datafile in $datafiles; do 
-        cat $datafile | sed 's|^|data: |'
-        source $datafile
-    done
-fi
+loaddata $datafiles
 
 if [[ -z "$products" || -z "$branches" || -z "$buildcommands" || \
     -z "$buildtypes" ]]; then
     usage
 fi
 
 # clean first in case checkout changes the configuration
 if echo "$buildcommands" | grep -iq clean; then
diff --git a/testing/sisyphus/bin/check-spider.sh b/testing/sisyphus/bin/check-spider.sh
--- a/testing/sisyphus/bin/check-spider.sh
+++ b/testing/sisyphus/bin/check-spider.sh
@@ -50,17 +50,17 @@ function usage()
     cat <<EOF
 usage: 
 $SCRIPT -p product -b branch -x executablepath -N profilename 
        [-d datafiles]
 
 variable            description
 ===============     ============================================================
 -p product          required. firefox|thunderbird
--b branch           required. 1.8.0|1.8.1|1.9.0
+-b branch           required. 1.8.0|1.8.1|1.9.0|1.9.1
 -x executablepath   required. directory-tree containing executable named 
                     'product'
 -N profilename      required. name of profile to be used
 -d datafiles        optional. one or more filenames of files containing 
                     environment variable definitions to be included.
 
 note that the environment variables should have the same names as in the 
 "variable" column.
@@ -83,55 +83,43 @@ while getopts $options optname ;
       b) branch=$OPTARG;;
       x) executablepath=$OPTARG;;
       N) profilename=$OPTARG;;
       d) datafiles=$OPTARG;;
   esac
 done
 
 # include environment variables
-if [[ -n "$datafiles" ]]; then
-    for datafile in $datafiles; do 
-        cat $datafile | sed 's|^|data: |'
-        source $datafile
-    done
-fi
+loaddata $datafiles
 
 if [[ -z "$product" || -z "$branch" || -z "$executablepath" || -z "$profilename" ]]; 
     then
     usage
 fi
 
 if [[ "$product" != "firefox" && "$product" != "thunderbird" ]]; then
     error "product \"$product\" must be one of firefox or thunderbird" $LINENO
 fi
 
-if [[ "$branch" != "1.8.0" && "$branch" != "1.8.1" && "$branch" != "1.9.0" ]]; 
+if [[ "$branch" != "1.8.0" && "$branch" != "1.8.1" && "$branch" != "1.9.0"  && "$branch" != "1.9.1" ]]; 
     then
-    error "branch \"$branch\" must be one of 1.8.0, 1.8.1, 1.9.0" $LINENO
+    error "branch \"$branch\" must be one of 1.8.0, 1.8.1, 1.9.0 1.9.1" $LINENO
 fi
 
 executable=`get_executable $product $branch $executablepath`
-
-if [[ -z "$executable" ]]; then
-    error "get_executable $product $branch $executablepath returned empty path" $LINENO
-fi
-
-if [[ ! -x "$executable" ]]; then 
-    error "executable \"$executable\" is not executable" $LINENO
-fi
 
 if echo "$profilename" | egrep -qiv '[a-z0-9_]'; then
     error "profile name must consist of letters, digits or _" $LINENO
 fi
 
 echo # attempt to force Spider to load
 
 tries=1
 while ! $TEST_DIR/bin/timed_run.py ${TEST_STARTUP_TIMEOUT} "Start Spider: try $tries" \
+     $EXECUTABLE_DRIVER \
     "$executable" -P "$profilename" \
     -spider -start -quit \
     -uri "http://${TEST_HTTP}/bin/start-spider.html" \
     -hook "http://${TEST_HTTP}/bin/userhook-checkspider.js"; do
   let tries=tries+1
   if [ "$tries" -gt $TEST_STARTUP_TRIES  ]; then
       error "Failed to start spider. Exiting..." $LINENO
   fi
diff --git a/testing/sisyphus/bin/checkout.sh b/testing/sisyphus/bin/checkout.sh
--- a/testing/sisyphus/bin/checkout.sh
+++ b/testing/sisyphus/bin/checkout.sh
@@ -39,77 +39,182 @@
 
 source $TEST_DIR/bin/library.sh
 source $TEST_DIR/bin/set-build-env.sh $@
 
 if [[ -z "$TREE" ]]; then
     error "source tree not specified!" $LINENO
 fi
 
+if [[ "$branch" == "1.9.1" ]]; then
+
+    if [[ -z "$TEST_MOZILLA_HG" ]]; then
+        error "environment variable TEST_MOZILLA_HG must be set to the hg repository for branch 1.9.1"
+    fi
+
+    # maintain a local copy of the hg repository
+    # clone specific trees from it.
+
+    TEST_MOZILLA_HG_LOCAL=$BUILDDIR/hg.mozilla.org/`basename $TEST_MOZILLA_HG`
+
+    if [[ ! -d $BUILDDIR/hg.mozilla.org ]]; then
+        mkdir $BUILDDIR/hg.mozilla.org
+    fi
+
+    if [[ ! -d $TEST_MOZILLA_HG_LOCAL ]]; then
+        if ! hg clone -r $TEST_MOZILLA_HG_REV $TEST_MOZILLA_HG $TEST_MOZILLA_HG_LOCAL; then
+            error "during hg clone of $TEST_MOZILLA_HG" $LINENO
+        fi
+    fi
+
+    cd $TEST_MOZILLA_HG_LOCAL
+    hg pull
+fi
+
 cd $TREE
 
 case $product in
     firefox)
-        if [[ ! ( -d mozilla && \
-            -e mozilla/client.mk && \
-            -e "mozilla/$project/config/mozconfig" ) ]]; then
-            if ! eval cvs -z3 -q co $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS \
-                mozilla/client.mk mozilla/$project/config/mozconfig; then
-                error "during checkout of $project mozconfig" $LINENO
-            fi
-        fi
+        case $branch in
+            1.8.*|1.9.0)
+                if [[ ! ( -d mozilla && \
+                    -e mozilla/client.mk && \
+                    -e "mozilla/$project/config/mozconfig" ) ]]; then
+                    if ! eval cvs -z3 -q co $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS \
+                        mozilla/client.mk mozilla/$project/config/mozconfig; then
+                        error "during checkout of $project mozconfig" $LINENO
+                    fi
+                fi
+                if ! $buildbash $bashlogin -c "cd $TREE/mozilla; make -f client.mk checkout" 2>&1; then
+                    error "during checkout of $project tree" $LINENO
+                fi
+                ;;
 
-#        cd mozilla
+            1.9.1)
 
-        if ! $buildbash $bashlogin -c "cd $TREE/mozilla; make -f client.mk checkout" 2>&1; then
-            error "during checkout of $project tree" $LINENO
-        fi
+                if [[ ! -e mozilla/client.py ]]; then
+                    if ! hg clone $TEST_MOZILLA_HG_LOCAL $TREE/mozilla; then
+                        error "during hg clone of $TEST_MOZILLA_HG_LOCAL" $LINENO
+                    fi
+                fi
+
+                cd mozilla
+                hg pull -r $TEST_MOZILLA_HG_REV
+                
+                # do not use mozilla-build on windows systems as we 
+                # must use the cygwin python with the cygwin mercurial.
+
+                if ! python client.py checkout; then
+                    error "during checkout of $project tree" $LINENO
+                fi
+                ;;
+
+            *)
+                error "branch $branch not yet supported"
+                ;;
+        esac
         ;;
 
     thunderbird)
-        if [[ ! ( -d mozilla && \
-            -e mozilla/client.mk && \
-            -e "mozilla/$project/config/mozconfig" ) ]]; then
-            if ! eval cvs -z3 -q co $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS \
-                mozilla/client.mk mozilla/$project/config/mozconfig; then
-                error "during checkout of $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS $project mozconfig" $LINENO
-            fi
-        fi
-        if [[ ! ( -d mozilla && \
-            -e mozilla/client.mk && \
-            -e "mozilla/browser/config/mozconfig" ) ]]; then
-            if ! eval cvs -z3 -q co $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS \
-                mozilla/client.mk mozilla/browser/config/mozconfig; then
-                error "during checkout of $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS browser mozconfig" $LINENO
-            fi
-        fi
 
- #       cd mozilla
+        case $branch in
+            1.8.*|1.9.0)
+                if [[ ! ( -d mozilla && \
+                    -e mozilla/client.mk && \
+                    -e "mozilla/$project/config/mozconfig" ) ]]; then
+                    if ! eval cvs -z3 -q co $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS \
+                        mozilla/client.mk mozilla/$project/config/mozconfig; then
+                        error "during checkout of $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS $project mozconfig" $LINENO
+                    fi
+                fi
 
-        if ! $buildbash $bashlogin -c "cd $TREE/mozilla; make -f client.mk checkout" 2>&1; then
-            error "during checkout of $project tree" $LINENO
-        fi
+                if [[ ! ( -d mozilla && \
+                    -e mozilla/client.mk && \
+                    -e "mozilla/browser/config/mozconfig" ) ]]; then
+                    if ! eval cvs -z3 -q co $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS \
+                        mozilla/client.mk mozilla/browser/config/mozconfig; then
+                        error "during checkout of $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS browser mozconfig" $LINENO
+                    fi
+                fi
+
+                if ! $buildbash $bashlogin -c "cd $TREE/mozilla; make -f client.mk checkout" 2>&1; then
+                    error "during checkout of $project tree" $LINENO
+                fi
+                ;;
+
+            1.9.1)
+                if [[ ! -e mozilla/client.py ]]; then
+                    if ! hg clone $TEST_MOZILLA_HG_LOCAL $TREE/mozilla; then
+                        error "during hg clone of $TEST_MOZILLA_HG_LOCAL" $LINENO
+                    fi
+                fi
+
+                cd mozilla
+                hg pull -r $TEST_MOZILLA_HG_REV
+
+                # do not use mozilla-build on windows systems as we 
+                # must use the cygwin python with the cygwin mercurial.
+
+                if ! python client.py checkout; then
+                    error "during checkout of $project tree" $LINENO
+                fi
+                ;;
+
+            *)
+                error "branch $branch not yet supported"
+                ;;
+        esac
         ;;
 
     js) 
-        if [[ ! ( -d mozilla && \
-            -e mozilla/js && \
-            -e mozilla/js/src ) ]]; then
-            if ! eval cvs -z3 -q co $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS mozilla/js; then
-                error "during initial co $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS mozilla/js"
-            fi
-        fi
 
-        cd mozilla/js/src
+        case $branch in
+            1.8.*|1.9.0)
+                if [[ ! ( -d mozilla && \
+                    -e mozilla/js && \
+                    -e mozilla/js/src ) ]]; then
+                    if ! eval cvs -z3 -q co $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS mozilla/js; then
+                        error "during initial co $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS mozilla/js"
+                    fi
+                fi
 
-        if ! eval cvs -z3 -q update $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS -d -P 2>&1; then
-            error "during update $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS js/src" $LINENO
-        fi
+                cd mozilla/js/src
 
-        if ! cvs -z3 -q update -d -P -A editline config  2>&1; then
-            error "during checkout of js/src" $LINENO
-        fi
+                if ! eval cvs -z3 -q update $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS -d -P 2>&1; then
+                    error "during update $MOZ_CO_FLAGS $BRANCH_CO_FLAGS $DATE_CO_FLAGS js/src" $LINENO
+                fi
+
+                if ! cvs -z3 -q update -d -P -A editline config  2>&1; then
+                    error "during checkout of js/src" $LINENO
+                fi
+                ;;
+
+            1.9.1)
+
+                if [[ ! -e mozilla/client.py ]]; then
+                    if ! hg clone $TEST_MOZILLA_HG_LOCAL $TREE/mozilla; then
+                        error "during hg clone of $TEST_MOZILLA_HG_LOCAL" $LINENO
+                    fi
+                fi
+
+                cd mozilla
+                hg pull -r $TEST_MOZILLA_HG_REV
+
+                # do not use mozilla-build on windows systems as we 
+                # must use the cygwin python with the cygwin mercurial.
+
+                if ! python client.py checkout; then
+                    error "during checkout of $project tree" $LINENO
+                fi
+
+                cd js/src
+                ;;
+
+            *)
+                error "branch $branch not yet supported"
+                ;;
+        esac
         # end for js shell
         ;;
     *)
         error "unknown product $product" $LINENO
         ;;
 esac
diff --git a/testing/sisyphus/bin/create-profile.sh b/testing/sisyphus/bin/create-profile.sh
--- a/testing/sisyphus/bin/create-profile.sh
+++ b/testing/sisyphus/bin/create-profile.sh
@@ -48,17 +48,17 @@ function usage()
     cat <<EOF
 usage: 
 $SCRIPT -p product -b branch -x executablepath -D directory -N profilename 
        [-L profiletemplate] [-U user] [-d datafiles]
 
 variable            description
 ===============     ============================================================
 -p product          required. firefox|thunderbird
--b branch           required. 1.8.0|1.8.1|1.9.0
+-b branch           required. 1.8.0|1.8.1|1.9.0|1.9.1
 -x executablepath   required. directory-tree containing executable 'product'
 -D directory        required. directory where profile is to be created.
 -N profilename      required. profile name 
 -L profiletemplate  optional. location of a template profile to be used. 
 -U user             optional. user.js preferences file.
 -d datafiles        optional. one or more filenames of files containing 
                     environment variable definitions to be included.
 
@@ -81,65 +81,54 @@ while getopts $options optname ;
       N) profilename=$OPTARG;;
       L) profiletemplate=$OPTARG;;
       U) user=$OPTARG;;
       d) datafiles=$OPTARG;;
   esac
 done
 
 # include environment variables
-if [[ -n "$datafiles" ]]; then
-    for datafile in $datafiles; do 
-        cat $datafile | sed 's|^|data: |'
-        source $datafile
-    done
-fi
+loaddata $datafiles
 
 if [[ -z "$product" || -z "$branch" || -z "$executablepath" || \
     -z "$directory" || -z "$profilename" ]]; then
     usage
 fi
 
-if [[ "$product" != "firefox" && "$product" != "thunderbird" ]]; then
+if [[ "$product" != "firefox" && "$product" != "thunderbird" && "$product" ]]; then
     error "product \"$product\" must be one of firefox or thunderbird" $LINENO
 fi
 
-if [[ "$branch" != "1.8.0" && "$branch" != "1.8.1" && "$branch" != "1.9.0" ]]; 
+if [[ "$branch" != "1.8.0" && "$branch" != "1.8.1" && "$branch" != "1.9.0" && "$branch" != "1.9.1" ]]; 
     then
-    error "branch \"$branch\" must be one of 1.8.0, 1.8.1, 1.9.0" $LINENO
+    error "branch \"$branch\" must be one of 1.8.0, 1.8.1, 1.9.0 1.9.1" $LINENO
 fi
 
 executable=`get_executable $product $branch $executablepath`
-
-if [[ -z "$executable" ]]; then
-    error "get_executable $product $branch $executablepath returned empty path" $LINENO
-fi
-
-if [[ ! -x "$executable" ]]; then 
-    error "executable \"$executable\" is not executable" $LINENO
-fi
 
 $TEST_DIR/bin/create-directory.sh -d "$directory" -n 
 
 if echo "$profilename" | egrep -qiv '[a-z0-9_]'; then
     error "profile name \"$profilename\" must consist of letters, digits or _" $LINENO
 fi
 
-if [ $OSID == "win32" ]; then
+if [ $OSID == "nt" ]; then
     directoryospath=`cygpath -a -w $directory`
     if [[ -z "$directoryospath" ]]; then
 	    error "unable to convert unix path to windows path" $LINENO
     fi
 else
     directoryospath="$directory"
 fi
 
 echo "creating profile $profilename in directory $directory"
 
-if ! $TEST_DIR/bin/timed_run.py ${TEST_STARTUP_TIMEOUT} "-" $executable -CreateProfile "$profilename $directoryospath"; then
+if ! $TEST_DIR/bin/timed_run.py ${TEST_STARTUP_TIMEOUT} "-" \
+        $EXECUTABLE_DRIVER \
+        $executable -CreateProfile "$profilename $directoryospath"; then
 	error "creating profile $directory" $LINENO
 fi
 
 if [[ -n $profiletemplate ]]; then
 	if [[ ! -d $profiletemplate ]]; then
 	    error "profile template directory $profiletemplate does not exist" $LINENO
 	fi
 	echo "copying template profile $profiletemplate to $directory"
diff --git a/testing/sisyphus/bin/download.sh b/testing/sisyphus/bin/download.sh
--- a/testing/sisyphus/bin/download.sh
+++ b/testing/sisyphus/bin/download.sh
@@ -83,22 +83,17 @@ while getopts $options optname ;
       c) credentials=$OPTARG;;
       f) filepath=$OPTARG;;
       t) timeout=$OPTARG;;
       d) datafiles=$OPTARG;;
   esac
 done
 
 # include environment variables
-if [[ -n "$datafiles" ]]; then
-    for datafile in $datafiles; do 
-        cat $datafile | sed 's|^|data: |'
-        source $datafile
-    done
-fi
+loaddata $datafiles
 
 if [[ -z $url || -z $filepath ]]
     then
     usage
 fi
 
 if [[ -n "$credentials" ]]; then
     auth="--user $credentials"
diff --git a/testing/sisyphus/bin/edit-talkback.pl b/testing/sisyphus/bin/edit-talkback.pl
--- a/testing/sisyphus/bin/edit-talkback.pl
+++ b/testing/sisyphus/bin/edit-talkback.pl
@@ -66,25 +66,25 @@ sub editTalkback
         $ostype .= $_;
     }
     close OSTYPE;
 
     die "Unable to determine OSTYPE" if (!$ostype);
 
     if ($ostype =~ /cygwin/i)
     {
-        $os = "win32";
+        $os = "nt";
     }
     elsif ($ostype =~ /linux/i)
     {
         $os = "linux";
     }
     elsif ($ostype =~ /darwin/)
     {
-        $os = "mac";
+        $os = "darwin";
     }
     else
     {
         die "Unknown Operating System: $ostype";
     }
 
     if (!$binary)
     {
@@ -182,17 +182,17 @@ sub editTalkback
             print "vendorid=$vendorid\n";
             print "productid=$productid\n";
             print "platformid=$platformid\n";
             print "buildid=$buildid\n";
         }
 
         my $appdata;
 
-        if ($os eq "win32")
+        if ($os eq "nt")
         {
             # get application data directory in windows format
             $appdata = $ENV{APPDATA};
             if (!$appdata)
             {
                 die "Empty Windows Application Data directory\n";
             }
 
@@ -225,17 +225,17 @@ sub editTalkback
                 die "Unix format Windows Application Data directory is empty\n";
             }
             $talkbackdir = "$appdata/Talkback";
         }
         elsif ($os eq "linux")
         {
             $talkbackdir="$home/.fullcircle";
         }
-        elsif ($os eq "mac")
+        elsif ($os eq "darwin")
         {
             $talkbackdir="$home/Library/Application\ Support/FullCircle";
         }
         else
         {
             die "unknown os $os";
         }
 
@@ -245,17 +245,17 @@ sub editTalkback
             if (! mkdir "$talkbackdir", 755)
             {
                 die "unable to create $talkbackdir\n: $!";
             }
         }
 
         my $talkbackinidir;
 
-        if ($os eq "win32")
+        if ($os eq "nt")
         {
             $talkbackinidir="$talkbackdir/$vendorid/$productid/$platformid/$buildid/";
 
             if ( ! -e "$talkbackdir/$vendorid" )
             {
                 if (! mkdir "$talkbackdir/$vendorid", 755)
                 {
                     die "unable to make $talkbackdir/$vendorid: $!";
@@ -302,17 +302,17 @@ sub editTalkback
             if (! -e "$talkbackdir/$vendorid$productid$platformid$buildid" )
             {
                 if (! mkdir "$talkbackdir/$vendorid$productid$platformid$buildid", 755)
                 {
                     die "unable to make $talkbackdir/$vendorid$productid$platformid$buildid: $!";
                 }
             }
         }
-        elsif ($os eq "mac")
+        elsif ($os eq "darwin")
         {
             $talkbackinidir="$talkbackdir/$vendorid$productid$platformid$buildid";
             if (! -e "$talkbackdir/$vendorid$productid$platformid$buildid" )
             {
                 if (! mkdir "$talkbackdir/$vendorid$productid$platformid$buildid", 755)
                 {
                     die "unable to make $talkbackdir/$vendorid$productid$platformid$buildid: $!";
                 }
@@ -330,17 +330,17 @@ sub editTalkback
 
 
         if (!copy("/work/mozilla/mozilla.com/test.mozilla.com/www/talkback/$os/Talkback.ini", "Talkback.ini"))
         {
             die "unable to copy Talkback.ini: $!";
         }
         
         #print "patching Talkback.ini\n";
-        if ($os eq "win32")
+        if ($os eq "nt")
         {
             $rc = system(("sed", 
                           "-ibak", 
                           "-e", 
                           "s|URLEdit .*|URLEdit = \"mozqa:$talkbackid\"|", 
                           "Talkback.ini")) & 0xffff;
             if ($rc != 0)
             {
@@ -354,17 +354,17 @@ sub editTalkback
                           "-e",
                           "s|URLEditControl .*|URLEditControl = \"mozqa:$talkbackid\"|", 
                           "Talkback.ini")) & 0xffff;
             if ($rc != 0)
             {
                 die "unable to edit Talkback.ini: $!";
             }
         }
-        elsif ($os eq "mac")
+        elsif ($os eq "darwin")
         {
             $rc = system(("sed", 
                           "-ibak", 
                           "-e",
                           "s|URLEditControl .*|URLEditControl = \"mozqa:$talkbackid\"|", 
                           "Talkback.ini")) & 0xffff;
             if ($rc != 0)
             {
diff --git a/testing/sisyphus/bin/edit-talkback.sh b/testing/sisyphus/bin/edit-talkback.sh
--- a/testing/sisyphus/bin/edit-talkback.sh
+++ b/testing/sisyphus/bin/edit-talkback.sh
@@ -47,17 +47,17 @@ function usage()
 {
     cat <<EOF
 usage: 
 $SCRIPT -p product -b branch -x executablepath -i talkbackid [-d datafiles]
 
 variable            description
 ===============     ============================================================
 -p product          required. firefox|thunderbird
--b branch           required. 1.8.0|1.8.1|1.9.0
+-b branch           required. 1.8.0|1.8.1|1.9.0|1.9.1
 -x executablepath   required. directory-tree containing executable named 
                     'product'
 -i talkbackid       required. identifier to add to talkback url
 -d datafiles        optional. one or more filenames of files containing 
                     environment variable definitions to be included.
 
 note that the environment variables should have the same names as in the 
 "variable" column.
@@ -75,37 +75,24 @@ while getopts $options optname ;
       b) branch=$OPTARG;;
       x) executablepath=$OPTARG;;
       i) talkbackid=$OPTARG;;
       d) datafiles=$OPTARG;;
   esac
 done
 
 # include environment variables
-if [[ -n "$datafiles" ]]; then
-    for datafile in $datafiles; do 
-        cat $datafile | sed 's|^|data: |'
-        source $datafile
-    done
-fi
+loaddata $datafiles
 
 if [[ -z "$product" || -z "$branch" || \
     -z "$executablepath" || -z "$talkbackid" ]]; then
     usage
 fi
 
 executable=`get_executable $product $branch $executablepath`
-
-if [[ -z "$executable" ]]; then
-    error "get_executable $product $branch $executablepath returned empty path" $LINENO
-fi
-
-if [[ ! -x "$executable" ]]; then 
-    error "executable \"$executable\" is not executable" $LINENO
-fi
 
 executablepath=`dirname $executable`
 
 # escape & in talkback id to prevent replacements
 talkbackid=`echo $talkbackid | sed 's@&@\\\\&@g'`
 
 #
 # edit talkback to automatically submit
@@ -127,32 +114,32 @@ if [[ $talkback -eq 1 ]]; then
     # edit to automatically send talkback incidents
     if [[ ! -e master.sed ]]; then
         #echo "$0: editing talkback master.ini in `pwd`"
         cp $TEST_DIR/bin/master.sed .
         sed -f master.sed -i.bak master.ini
     fi
 
     case $OSID in
-        win32)
+        nt)
             vendorid=`dos2unix < master.ini | grep '^VendorID = "' | sed 's@VendorID = "\([^"]*\)"@\1@'`
             productid=`dos2unix < master.ini | grep '^ProductID = "' | sed 's@ProductID = "\([^"]*\)"@\1@'`
             platformid=`dos2unix < master.ini | grep '^PlatformID = "' | sed 's@PlatformID = "\([^"]*\)"@\1@'`
             buildid=`dos2unix < master.ini | grep '^BuildID = "' | sed 's@BuildID = "\([^"]*\)"@\1@'`
             appdata=`cygpath -a -d "$APPDATA"`
             talkbackdir="`cygpath -a -u $appdata`/Talkback"
             ;;
         linux)
             vendorid=`dos2unix < master.ini | grep '^VendorID = "' | sed 's@VendorID = "\([^"]*\)"@\1@'`
             productid=`dos2unix < master.ini | grep '^ProductID = "' | sed 's@ProductID = "\([^"]*\)"@\1@'`
             platformid=`dos2unix < master.ini | grep '^PlatformID = "' | sed 's@PlatformID = "\([^"]*\)"@\1@'`
             buildid=`dos2unix < master.ini | grep '^BuildID = "' | sed 's@BuildID = "\([^"]*\)"@\1@'`
             talkbackdir="$HOME/.fullcircle"
             ;;
-        mac)
+        darwin)
             # hack around Mac's use of spaces in directory names
             vendorid=`grep '^VendorID = "' master.ini | sed 's@VendorID = "\([^"]*\)"@\1@'`
             productid=`grep '^ProductID = "' master.ini | sed 's@ProductID = "\([^"]*\)"@\1@'`
             platformid=`grep '^PlatformID = "' master.ini | sed 's@PlatformID = "\([^"]*\)"@\1@'`
             buildid=`grep '^BuildID = "' master.ini | sed 's@BuildID = "\([^"]*\)"@\1@'`
             talkbackdir="$HOME/Library/Application Support/FullCircle"
             IFS=:
             ;;
@@ -163,38 +150,38 @@ if [[ $talkback -eq 1 ]]; then
 
     if [[ -z "$talkbackdir" ]]; then
         error "empty talkback directory" $LINENO
     fi
 
     mkdir -p "$talkbackdir"
     
     case $OSID in
-        win32)
+        nt)
             talkbackinidir="$talkbackdir/$vendorid/$productid/$platformid/$buildid"
             ;;
-        linux | mac )
+        linux | darwin )
             talkbackinidir="$talkbackdir/$vendorid$productid$platformid$buildid"
             ;;
     esac
     
     if [[ ! -d "$talkbackinidir" ]]; then
         create-directory.sh -d "$talkbackinidir" -n
     fi
 
     cd $talkbackinidir
 
     cp ${TEST_DIR}/talkback/$OSID/Talkback.ini .
 
     case "$OSID" in
-        win32)
+        nt)
             sed -i.bak "s@URLEdit .*@URLEdit = \"mozqa:$talkbackid\"@" Talkback.ini
             ;;
-        linux )
+        linux)
             sed -i.bak "s@URLEditControl .*@URLEditControl = \"mozqa:$talkbackid\"@" Talkback.ini
             ;;
-        mac )
+        darwin)
             sed -i.bak "s@URLEditControl .*@URLEditControl = \"mozqa:$talkbackid\"@" Talkback.ini
             ;;
         *)
             error "unknown os=$OSID" $LINENO
     esac
 fi
diff --git a/testing/sisyphus/bin/install-build.sh b/testing/sisyphus/bin/install-build.sh
--- a/testing/sisyphus/bin/install-build.sh
+++ b/testing/sisyphus/bin/install-build.sh
@@ -47,17 +47,17 @@ function usage()
 {
     cat <<EOF
 usage: 
 $SCRIPT -p product -b branch  -x executablepath -f filename [-d datafiles]
 
 variable            description
 ===============     ============================================================
 -p product          required. firefox|thunderbird
--b branch           required. 1.8.0|1.8.1|1.9.0
+-b branch           required. 1.8.0|1.8.1|1.9.0|1.9.1
 -x executablepath   required. directory where to install build
 -f filename         required. path to filename where installer is stored
 -d datafiles        optional. one or more filenames of files containing 
                     environment variable definitions to be included.
 
 note that the environment variables should have the same names as in the 
 "variable" column.
 
@@ -74,45 +74,42 @@ while getopts $options optname ;
       b) branch=$OPTARG;;
       x) executablepath=$OPTARG;;
       f) filename=$OPTARG;;
       d) datafiles=$OPTARG;;
   esac
 done
 
 # include environment variables
-if [[ -n "$datafiles" ]]; then
-    for datafile in $datafiles; do 
-        cat $datafile | sed 's|^|data: |'
-        source $datafile
-    done
-fi
+loaddata $datafiles
 
 if [[ -z "$product" || -z "$branch" || -z "$executablepath" || -z "$filename" ]]
     then
     usage
 fi
 
 $TEST_DIR/bin/uninstall-build.sh -p "$product" -b "$branch" -x "$executablepath"
 
 $TEST_DIR/bin/create-directory.sh -d "$executablepath" -n
 
 filetype=`file $filename`
 
-if [[ $OSID == "win32" ]]; then
+if [[ $OSID == "nt" ]]; then
 
     if echo $filetype | grep -iq windows; then
 	    chmod u+x "$filename"
 	    if [[ $branch == "1.8.0" ]]; then
 	        $filename -ms -hideBanner -dd `cygpath -a -w "$executablepath"`
 	    else
 	        $filename /S /D=`cygpath -a -w "$executablepath"`
 	    fi
     elif echo  $filetype | grep -iq 'zip archive'; then
 	    unzip -o -d "$executablepath" "$filename"
+        find $executablepath -name '*.exe' | xargs chmod u+x
+        find $executablepath -name '*.dll' | xargs chmod u+x
     else
 	    error "$unknown file type $filetype" $LINENO
     fi
 
 else
     
     case "$OSID" in
         linux)
@@ -147,19 +144,17 @@ else
         ;;
     esac
 
     #
     # patch unix-like startup scripts to exec instead of 
     # forking new processes
     #
     executable=`get_executable $product $branch $executablepath`
-    if [[ -z "$executable" ]]; then
-        error "get_executable $product $branch $executablepath returned empty directory" $LINENO
-    fi
+
     executabledir=`dirname $executable`
 
     # patch to use exec to prevent forked processes
     cd "$executabledir"
     if [ -e "$product" ]; then
 	    echo "$SCRIPT: patching $product"
 	    cp $TEST_DIR/bin/$product.diff .
 	    patch -N -p0 < $product.diff
diff --git a/testing/sisyphus/bin/install-extensions.sh b/testing/sisyphus/bin/install-extensions.sh
--- a/testing/sisyphus/bin/install-extensions.sh
+++ b/testing/sisyphus/bin/install-extensions.sh
@@ -34,33 +34,33 @@
 # and other provisions required by the GPL or the LGPL. If you do not delete
 # the provisions above, a recipient may use your version of this file under
 # the terms of any one of the MPL, the GPL or the LGPL.
 #
 # ***** END LICENSE BLOCK *****
 
 source $TEST_DIR/bin/library.sh
 
-echo "$SCRIPT $@"
+TEST_STARTUP_TRIES=${TEST_STARTUP_TRIES:-3}
 
 #
 # options processing
 #
 options="p:b:x:N:E:d:"
 function usage()
 {
     cat <<EOF
 usage: 
 $SCRIPT -p product -b branch -x executablepath -N profilename -E extensions 
        [-d datafiles]
 
 variable            description
 ===============     ============================================================
 -p product          required. firefox|thunderbird
--b branch           required. 1.8.0|1.8.1|1.9.0
+-b branch           required. 1.8.0|1.8.1|1.9.0|1.9.1
 -x executablepath   required. directory-tree containing executable named 
                     'product'
 -N profilename      required. profile name 
 -E extensions       required. path to directory containing xpis to be installed
 -d datafiles        optional. one or more filenames of files containing 
                     environment variable definitions to be included.
 
 note that the environment variables should have the same names as in the 
@@ -80,82 +80,83 @@ while getopts $options optname ;
       x) executablepath=$OPTARG;;
       N) profilename=$OPTARG;;
       E) extensions=$OPTARG;;
       d) datafiles=$OPTARG;;
   esac
 done
 
 # include environment variables
-if [[ -n "$datafiles" ]]; then
-    for datafile in $datafiles; do 
-        cat $datafile | sed 's|^|data: |'
-        source $datafile
-    done
-fi
+loaddata $datafiles
 
 if [[ -z "$product" || -z "$branch" || \
     -z "$executablepath" || -z "$profilename" || -z "$extensions" ]]; then
     usage
 fi
 
 if [[ "$product" != "firefox" && "$product" != "thunderbird" ]]; then
     error "product \"$product\" must be one of firefox or thunderbird" $LINENO
 fi
 
-if [[ "$branch" != "1.8.0" && "$branch" != "1.8.1" && "$branch" != "1.9.0" ]]; 
+if [[ "$branch" != "1.8.0" && "$branch" != "1.8.1" && "$branch" != "1.9.0" && "$branch" != "1.9.1" ]]; 
     then
-    error "branch \"$branch\" must be one of 1.8.0, 1.8.1, 1.9.0" $LINENO
+    error "branch \"$branch\" must be one of 1.8.0, 1.8.1, 1.9.0 1.9.1" $LINENO
 fi
 
 executable=`get_executable $product $branch $executablepath`
-
-if [[ -z "$executable" ]]; then
-    error "get_executable $product $branch $executablepath returned empty path" $LINENO
-fi
-
-if [[ ! -x "$executable" ]]; then 
-    error "executable \"$executable\" is not executable" $LINENO
-fi
 
 if echo $profilename | egrep -qiv '[a-z0-9_]'; then
     error "profile name must consist of letters, digits or _" $LINENO
 fi
 
 for extension in $extensions/all/*.xpi; do 
     if [[ $extension == "$extensions/all/*.xpi" ]]; then
 	    break
     fi
-    if [[ "$OSID" == "win32" ]]; then
+    if [[ "$OSID" == "nt" ]]; then
         extensionos=`cygpath -a -w $extension`
     else
         extensionos="$extension"
     fi
 
     echo installing $extension
-    $TEST_DIR/bin/timed_run.py ${TEST_STARTUP_TIMEOUT} "-" $executable -P $profilename -install-global-extension "$extensionos"
+    let tries=1
+    while ! $TEST_DIR/bin/timed_run.py ${TEST_STARTUP_TIMEOUT} "Install extension $extension: try $tries" \
+        $EXECUTABLE_DRIVER \
+        $executable -P $profilename -install-global-extension "$extensionos"; do
+        let tries=tries+1
+        if [[ "$tries" -gt $TEST_STARTUP_TRIES ]]; then
+            error "Failed to install extension $extension. Exiting..." $LINENO
+        fi
+        sleep 30
+    done
     # there is no reliable method of determining if the install worked 
     # from the output or from the exit code.
 done
 
 for extension in $extensions/$OSID/*; do 
     if [[ $extension == "$extensions/$OSID/*" ]]; then
 	    break
     fi
-    if [[ "$OSID" == "win32" ]]; then
+    if [[ "$OSID" == "nt" ]]; then
         extensionos=`cygpath -a -w $extension`
     else
         extensionos="$extension"
     fi
 
     echo installing $extension
-    if ! $TEST_DIR/bin/timed_run.py ${TEST_STARTUP_TIMEOUT} "-" $executable -P $profilename -install-global-extension "$extensionos"; then
-        error "Failed to install $extensionos" $LINENO
-    fi
-
+    let tries=1
+    while ! $TEST_DIR/bin/timed_run.py ${TEST_STARTUP_TIMEOUT} "Install extension $extension: try $tries" \
+        $executable -P $profilename -install-global-extension "$extensionos"; do
+        let tries=tries+1
+        if [[ "$tries" -gt $TEST_STARTUP_TRIES ]]; then
+            error "Failed to install extension $extension. Exiting..." $LINENO
+        fi
+        sleep 30
+    done
 done
 
 # restart twice to make extension manager happy
 
 if ! $TEST_DIR/bin/timed_run.py ${TEST_STARTUP_TIMEOUT} "install extensions - first restart" \
     $executable -P $profilename "http://${TEST_HTTP}/bin/install-extensions-1.html"; then
     echo "Ignoring 1st failure to load the install-extensions page"
 fi
diff --git a/testing/sisyphus/bin/install-plugins.sh b/testing/sisyphus/bin/install-plugins.sh
--- a/testing/sisyphus/bin/install-plugins.sh
+++ b/testing/sisyphus/bin/install-plugins.sh
@@ -47,17 +47,17 @@ function usage()
 {
     cat <<EOF
 usage: 
 $SCRIPT -p product -b branch -x executablepath -D directory [-d datafiles]
 
 variable            description
 ===============     ============================================================
 -p product          required. firefox|thunderbird
--b branch           required. 1.8.0|1.8.1|1.9.0
+-b branch           required. 1.8.0|1.8.1|1.9.0|1.9.1
 -x executablepath   required. path to browser executable
 -D directory        required. path to location of plugins/components
 -d datafiles        optional. one or more filenames of files containing 
                     environment 
                     variable definitions to be included.
 
 note that the environment variables should have the same names as in the 
 "variable" column.
@@ -75,42 +75,29 @@ while getopts $options optname ;
       b) branch=$OPTARG;;
       x) executablepath=$OPTARG;;
       D) directory=$OPTARG;;
       d) datafiles=$OPTARG;;
   esac
 done
 
 # include environment variables
-if [[ -n "$datafiles" ]]; then
-    for datafile in $datafiles; do 
-        cat $datafile | sed 's|^|data: |'
-        source $datafile
-    done
-fi
+loadata $datafiles
 
 if [[ -z "$product" || -z "$branch" || \
     -z "$executablepath" || -z "$directory" ]]; then
     usage
 fi
 
 if [[ "$product" != "firefox" && "$product" != "thunderbird" ]]; then
     error "product \"$product\" must be one of firefox or thunderbird" $LINENO
 fi
 
 executable=`get_executable $product $branch $executablepath`
 
-if [[ -z "$executable" ]]; then
-    error "get_executable $product $branch $executablepath returned empty path" $LINENO
-fi
-
-if [[ ! -x "$executable" ]]; then 
-    error "executable \"$executable\" is not executable" $LINENO
-fi
-
 executablepath=`dirname $executable`
 
 #
 # install plugins and components
 #
 echo "$SCRIPT: installing plugins from $directory/ in $executablepath/"
 cp -r "$directory/$OSID/" "$executablepath/"
 
diff --git a/testing/sisyphus/bin/library.sh b/testing/sisyphus/bin/library.sh
--- a/testing/sisyphus/bin/library.sh
+++ b/testing/sisyphus/bin/library.sh
@@ -80,51 +80,36 @@ function _exit()
     if [[ "$rc" -gt 0 && -n "$TEST_LOG" && "$SCRIPT" == "$currscript" ]]; then
         # only tail the log once at the top level script
         tail $TEST_LOG 1>&2
     fi
 }
 
 trap "_exit" EXIT
 
-    # error message
-    # output error message end exit 2
+# error message
+# output error message end exit 2
 
-    error()
-    {
-        local message=$1
-        local lineno=$2
+error()
+{
+    local message=$1
+    local lineno=$2
 
-        debug "error: $0:$LINENO"
+    debug "error: $0:$LINENO"
     
-        echo -e "FATAL ERROR in script $0:$lineno $message\n" 1>&2
-        if [[ "$0" == "-bash" || "$0" == "bash" ]]; then
-            return 0
-        fi
-        exit 2
-    } 
+    echo -e "FATAL ERROR in script $0:$lineno $message\n" 1>&2
+    if [[ "$0" == "-bash" || "$0" == "bash" ]]; then
+        return 0
+    fi
+    exit 2
+} 
 
 
 if [[ -z "$LIBRARYSH" ]]; then
     # skip remainder of script if it has already included
-
-    LIBRARYSH=1
-
-    # set time format for pipeline timing reports
-    TIMEFORMAT="Elapsed time %0R seconds, User %0U seconds, System %0S seconds, CPU %P%%"
-
-    MALLOC_CHECK_=2
-
-    ulimit -c 0
-
-    # debug msg
-    #
-    # output debugging message to stdout if $DEBUG is set
-
-    DEBUG=${DEBUG:-""}
 
     debug()
     {
         if [[ -n "$DEBUG" ]]; then
             echo "DEBUG: $@"
         fi
     }
 
@@ -132,24 +117,70 @@ if [[ -z "$LIBRARYSH" ]]; then
     #
     # output message to console, ie. stderr
 
     console()
     {
         echo -e "$@" 1>&2
     }
 
+    # loaddata
+    # 
+    # load data files into environment
+    loaddata()
+    {
+        local datafiles="$@"
+        local datafile
+        if [[ -n "$datafiles" ]]; then
+            for datafile in $datafiles; do 
+                if [[ ! -e "$datafile" ]]; then
+                    error "datafile $datafile does not exist"
+                fi
+                cat $datafile | sed 's|^|data: |'
+                if ! source $datafile; then
+                    error "Unable to load data file $datafile"
+                fi
+            done
+        fi
+    }
 
     # dumpenvironment
     #
     # output environment to stdout
 
     dumpenvironment()
     {
         set | grep '^[A-Z]' | sed 's|^|environment: |'
+    }
+
+    dumphardware()
+    {
+        echo "uname -a:`uname -a`"
+        echo "uname -s:`uname -s`"
+        echo "uname -n:`uname -n`"
+        echo "uname -r:`uname -r`"
+        echo "uname -v:`uname -v`"
+        echo "uname -m:`uname -m`"
+        echo "uname -p:`uname -p`"
+        if [[ "$OSID" != "darwin" ]]; then
+            echo "uname -i:`uname -i`"
+            echo "uname -o:`uname -o`"
+        fi
+
+        ulimit -a | sed 's|^|ulimit:|'
+
+        if [[ -e /proc/cpuinfo ]]; then
+            cat /proc/cpuinfo | sed 's|^|cpuinfo:|'
+        fi
+        if [[ -e /proc/meminfo ]]; then
+            cat /proc/meminfo | sed 's|^|meminfo:|'
+        fi
+        if which system_profiler 2> /dev/null; then
+            system_profiler | sed 's|^|system_profiler:|'
+        fi
     }
 
     # dumpvars varname1, ...
     #
     # dumps name=value pairs to stdout for each variable named 
     # in argument list
 
     dumpvars()
@@ -165,103 +196,94 @@ if [[ -z "$LIBRARYSH" ]]; then
     }
 
     # get_executable product branch directory
     #
     # writes path to product executable to stdout
 
     get_executable()
     {
-        get_executable_product="$1"
-        get_executable_branch="$2"
-        get_executable_directory="$3"
+        local get_executable_product="$1"
+        local get_executable_branch="$2"
+        local get_executable_directory="$3"
 
         if [[ -z "$get_executable_product" || \
             -z "$get_executable_branch" || \
             -z "$get_executable_directory" ]]; then
             error "usage: get_executable product branch directory"
         elif [[ ! -d "$get_executable_directory" ]]; then
             error "get_executable: executable directory \"$get_executable_directory\" does not exist"
         else
             # should use /u+x,g+x,a+x but mac os x uses an obsolete find
             # filter the output to remove extraneous file in dist/bin for
             # cvs builds on mac os x.
-            get_executable_name="$get_executable_product${EXE_EXT}"
-            case "$OSID" in
-                mac)
-                    get_executable_filter="Contents/MacOS/$get_executable_product"
-                    if [[ "$get_executable_product" == "thunderbird" ]]; then
-                        get_executable_name="$get_executable_product-bin"
-                    fi
-                    ;;
-                *)
-                    get_executable_filter="$get_executable_product"
-            esac
-            if find "$get_executable_directory" -perm +111 -type f \
-                -name "$get_executable_name" | \
-                grep "$get_executable_filter"; then
-                true
+            local executable=`(
+                get_executable_name="$get_executable_product${EXE_EXT}"
+                case "$OSID" in
+                    darwin)
+                        get_executable_filter="Contents/MacOS/$get_executable_product"
+                        if [[ "$get_executable_product" == "thunderbird" ]]; then
+                            get_executable_name="$get_executable_product-bin"
+                        fi
+                        ;;
+                    *)
+                        get_executable_filter="$get_executable_product"
+                        ;;
+                esac
+                if find "$get_executable_directory" -perm +111 -type f \
+                    -name "$get_executable_name" | \
+                    grep "$get_executable_filter"; then
+                    true
+                fi
+                )`
+
+            if [[ -z "$executable" ]]; then
+                error "get_executable $product $branch $executablepath returned empty path" $LINENO
             fi
+
+            if [[ ! -x "$executable" ]]; then 
+                error "executable \"$executable\" is not executable" $LINENO
+            fi
+
+            echo $executable
         fi
     }
 
     function get_scriptname()
     {
         debug "\$0: $0"
 
         local script
         if [[ "$0" == "-bash" || "$0" == "bash" ]]; then
             script="library.sh"
         else
             script=`basename $0`
         fi
         echo $script
     }
 
-    SCRIPT=`get_scriptname $0`
+    LIBRARYSH=1
 
-    if [[ -z "$TEST_DIR" ]]; then
-        # get the "bin" directory
-        TEST_DIR=`dirname $0`
-        # get the "bin" directory parent
-        TEST_DIR=`dirname $TEST_DIR`
-        if [[ ! -e "${TEST_DIR}/bin/library.sh" ]]; then
-            error "BAD TEST_DIR $TEST_DIR"
-        fi
-    fi
-    TEST_HTTP=${TEST_HTTP:-test.mozilla.com}
-    TEST_STARTUP_TIMEOUT=${TEST_STARTUP_TIMEOUT:-30}
+    MALLOC_CHECK_=2
 
-    TEST_MACHINE=`uname -n`
-    TEST_KERNEL=`uname -r`
-    TEST_PROCESSORTYPE=`uname -p`
+    ulimit -c 0
 
     # set path to make life easier
     if ! echo ${PATH} | grep -q $TEST_DIR/bin; then
         PATH=$TEST_DIR/bin:$PATH
-    fi
-
-    if echo $OSTYPE | grep -iq cygwin; then
-        OSID=win32
-        EXE_EXT=".exe"
-    elif echo $OSTYPE | grep -iq Linux; then
-        OSID=linux
-        EXE_EXT=
-    elif echo $OSTYPE | grep -iq darwin; then
-        OSID=mac
-        EXE_EXT=
-    else
-        error "Unknown OS $OSTYPE"
     fi
 
     # force en_US locale
     if ! echo "$LANG" | grep -q en_US; then
         LANG=en_US
         LC_TIME=en_US
     fi
+
+    # handle sorting non-ascii logs on mac os x 10.5.3
+    LC_ALL=C
 
     TEST_TIMEZONE=`date +%z`
 
     # save starting directory
     STARTDIR=`pwd`
 
     # location of the script.
     SCRIPTDIR=`dirname $0`
@@ -273,26 +295,118 @@ if [[ -z "$LIBRARYSH" ]]; then
     NO_EM_RESTART=1
 
     # bypass profile manager
     MOZ_BYPASS_PROFILE_AT_STARTUP=1
 
     # ah crap handler timeout
     MOZ_GDB_SLEEP=${MOZ_GDB_SLEEP:-10}
 
-    # no dialogs on asserts
-    XPCOM_DEBUG_BREAK=${XPCOM_DEBUG_BREAK:-warn}
-
     # no airbag
     unset MOZ_AIRBAG
-    MOZ_CRASHREPORTER_DISABLE=${MOZ_CRASHREPORTER_DISABLE:-1}
+    #MOZ_CRASHREPORTER_DISABLE=${MOZ_CRASHREPORTER_DISABLE:-1}
     MOZ_CRASHREPORTER_NO_REPORT=${MOZ_CRASHREPORTER_NO_REPORT:-1}
 
     #leak gauge
     #NSPR_LOG_MODULES=DOMLeak:5,DocumentLeak:5,nsDocShellLeak:5
+
+    TEST_CPUSPEED="`mips.pl`"
+    TEST_MEMORY="`memory.pl`"
+
+    # debug msg
+    #
+    # output debugging message to stdout if $DEBUG is set
+
+    DEBUG=${DEBUG:-""}
+
+    SCRIPT=`get_scriptname $0`
+
+    if [[ -z "$TEST_DIR" ]]; then
+        # get the "bin" directory
+        TEST_DIR=`dirname $0`
+        # get the "bin" directory parent
+        TEST_DIR=`dirname $TEST_DIR`
+        if [[ ! -e "${TEST_DIR}/bin/library.sh" ]]; then
+            error "BAD TEST_DIR $TEST_DIR"
+        fi
+    fi
+
+    TEST_HTTP=${TEST_HTTP:-test.mozilla.com}
+    TEST_STARTUP_TIMEOUT=${TEST_STARTUP_TIMEOUT:-30}
+    TEST_MACHINE=`uname -n`
+
+    kernel_name=`uname -s`
+
+    if [[ $kernel_name == 'Linux' ]]; then
+        OSID=linux
+        EXE_EXT=
+        TEST_KERNEL=`uname -r | sed 's|\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\)[-.0-9]*\.\([a-zA-Z0-9]*\)|\1.\2.\3|'`
+        TEST_PROCESSORTYPE=`cat /proc/cpuinfo | grep vendor | uniq | sed 's|vendor.* : \(.*\)|\1|'`
+        TIMECOMMAND='/usr/bin/time -f "Elapsed time %e seconds, User %U seconds, System %S seconds, CPU %P, Memory: %M"'
+
+        if echo $TEST_PROCESSORTYPE | grep -q 'Intel'; then
+            TEST_PROCESSORTYPE=intel
+        elif echo $TEST_PROCESSORTYPE | grep -q 'AMD'; then
+            TEST_PROCESSORTYPE=amd
+        fi
+
+        if uname -p | grep -q '64$'; then
+            TEST_PROCESSORTYPE=${TEST_PROCESSORTYPE}64
+        else
+            TEST_PROCESSORTYPE=${TEST_PROCESSORTYPE}32
+        fi
+
+    elif [[ $kernel_name == 'Darwin' ]]; then
+        OSID=darwin
+        EXE_EXT=
+        TEST_KERNEL=`uname -r`
+        TEST_PROCESSORTYPE=`uname -p`
+        TIMEFORMAT="Elapsed time %E seconds, User %U seconds, System %S seconds, CPU %P%"
+        TIMECOMMAND=time
+
+        if [[ $TEST_PROCESSORTYPE == "i386" ]]; then
+            TEST_PROCESSORTYPE=intel
+        fi
+
+        # assume 32bit for now...
+        TEST_PROCESSORTYPE=${TEST_PROCESSORTYPE}32
+
+    elif echo $kernel_name | grep -q CYGWIN; then
+        OSID=nt
+        EXE_EXT=".exe"
+        TEST_KERNEL=`echo $kernel_name | sed 's|[^.0-9]*\([.0-9]*\).*|\1|'`
+        TEST_PROCESSORTYPE=`cat /proc/cpuinfo | grep vendor | uniq | sed 's|vendor.* : \(.*\)|\1|'`
+        TIMECOMMAND='/usr/bin/time -f "Elapsed time %e seconds, User %U seconds, System %S seconds, CPU %P, Memory: %M"'
+
+        if echo $TEST_PROCESSORTYPE | grep -q 'Intel'; then
+            TEST_PROCESSORTYPE=intel
+        elif echo $TEST_PROCESSORTYPE | grep -q 'AMD'; then
+            TEST_PROCESSORTYPE=amd
+        fi
+
+        if uname -p | grep -q '64$'; then
+            TEST_PROCESSORTYPE=${TEST_PROCESSORTYPE}64
+        else
+            TEST_PROCESSORTYPE=${TEST_PROCESSORTYPE}32
+        fi
+
+    else
+        error "Unknown OS $kernel_name" $LINENO
+    fi
+
+    case $TEST_PROCESSORTYPE in
+        *32)
+            if [[ $TEST_MEMORY -gt 4 ]]; then
+                TEST_MEMORY=4
+            fi
+            ;;
+    esac
+
+    # no dialogs on asserts
+    XPCOM_DEBUG_BREAK=${XPCOM_DEBUG_BREAK:-warn}
 
     if [[ -z "$BUILDDIR" ]]; then
         case `uname -s` in
             MINGW*)
                 export BUILDDIR=/c/work/mozilla/builds
                 ;;
             *)
                 export BUILDDIR=/work/mozilla/builds
diff --git a/testing/sisyphus/bin/memory.pl b/testing/sisyphus/bin/memory.pl
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/bin/memory.pl
@@ -0,0 +1,180 @@
+#!/usr/bin/perl -w
+# -*- Mode: Perl; tab-width: 4; indent-tabs-mode: nil; -*-
+# ***** BEGIN LICENSE BLOCK *****
+# Version: MPL 1.1/GPL 2.0/LGPL 2.1
+#
+# The contents of this file are subject to the Mozilla Public License Version
+# 1.1 (the "License"); you may not use this file except in compliance with
+# the License. You may obtain a copy of the License at
+# http://www.mozilla.org/MPL/
+#
+# Software distributed under the License is distributed on an "AS IS" basis,
+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+# for the specific language governing rights and limitations under the
+# License.
+#
+# The Original Code is Mozilla Automated Testing Code.
+#
+# The Initial Developer of the Original Code is
+# Mozilla Corporation.
+# Portions created by the Initial Developer are Copyright (C) 2008
+# the Initial Developer. All Rights Reserved.
+#
+# Contributor(s): Bob Clary <bob@bclary.com>
+#
+# Alternatively, the contents of this file may be used under the terms of
+# either the GNU General Public License Version 2 or later (the "GPL"), or
+# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+# in which case the provisions of the GPL or the LGPL are applicable instead
+# of those above. If you wish to allow use of your version of this file only
+# under the terms of either the GPL or the LGPL, and not to allow others to
+# use your version of this file under the terms of the MPL, indicate your
+# decision by deleting the provisions above and replace them with the notice
+# and other provisions required by the GPL or the LGPL. If you do not delete
+# the provisions above, a recipient may use your version of this file under
+# the terms of any one of the MPL, the GPL or the LGPL.
+#
+# ***** END LICENSE BLOCK *****
+
+my $K = 1024;
+my $M = 1024 * $K;
+my $G = 1024 * $M;
+
+my $tmpmemory;
+my $unitmemory;
+my $raw_memory = 0;
+my $swap_memory = 0;
+my $ulimit_maxmemory = 0;
+my $ulimit_virtualmemory = 0;
+my $test_memory = 0;
+
+# hack around lack of available environment entries in both
+# cygwin perl and redhat perl
+open OSTYPE, "set | grep OSTYPE |" || die "Unable to open OSTYPE: $!";
+while (<OSTYPE>)
+{
+    chomp;
+    $ostype .= $_;
+}
+close OSTYPE;
+
+die "Unable to determine OSTYPE" if (!$ostype);
+
+if ($ostype =~ /linux/i || $ostype =~ /cygwin/i)
+{
+    open MEMINFO, "/proc/meminfo" or die "Unable to open /proc/meminfo";
+    while (<MEMINFO>)
+    {
+        if ( ($tmpmemory, $unitmemory) = $_ =~ /MemTotal:\s*([0-9]*) (kB)/)
+        {
+            die "Unknown memory unit meminfo MemTotal $unitmemory" if $unitmemory ne "kB";
+
+            $tmpmemory *= 1024;
+            $raw_memory = int($tmpmemory / $G + .5);
+        }
+        elsif ( ($tmpmemory, $unitmemory) = $_ =~ /SwapTotal:\s*([0-9]*) (kB)/)
+        {
+            die "Unknown memory unit meminfo SwapTotal $unitmemory" if $unitmemory ne "kB";
+
+            $tmpmemory *= 1024;
+            $swap_memory = int($tmpmemory / $G + .5);
+        }
+    }
+    close MEMINFO;
+}
+elsif ($ostype =~ /darwin/i)
+{
+    open SYSTEMPROFILER, "system_profiler|" or die "Unable to open system_profiler";
+    while (<SYSTEMPROFILER>)
+    {
+        if (  ($tmpmemory, $unitmemory) = $_ =~ /\s*Memory:\s*([0-9]*) ([a-zA-Z]*)/)
+        {
+            if ($unitmemory =~ /KB/)
+            {
+                $tmpmemory *= $K;
+            }
+            elsif ($unitmemory =~ /MB/)
+            {
+                $tmpmemory *= $M;
+            }
+            elsif ($unitmemory =~ /GB/)
+            {
+                $tmpmemory *= $G;
+            }
+            else
+            {
+                die "Unknown memory unit system_profiler $unitmemory";
+            }
+            $raw_memory = int($tmpmemory / $G + .5);
+        }
+    }
+    close SYSTEMPROFILER;
+}
+else
+{
+    die "Unknown Operating System: $ostype";
+}
+
+open ULIMIT, 'bash -c "ulimit -a"|' or die "Unable to open ulimit -a";
+
+while (<ULIMIT>)
+{
+    if (  ($unitmemory, $tmpmemory) = $_ =~ /max memory size + \(([a-zA-Z]*), \-m\) ([0-9]*)/)
+    {
+        if ($tmpmemory eq "")
+        {
+            $tmpmemory = 0;
+        }
+
+        if ($unitmemory =~ /kbytes/i)
+        {
+            $tmpmemory *= $K;
+        }
+        elsif ($unitmemory =~ /mbytes/i)
+        {
+            $tmpmemory *= $M;
+        }
+        elsif ($unitmemory =~ /gbytes/i)
+        {
+            $tmpmemory *= $G;
+        }
+        else
+        {
+            die "Unknown memory unit ulimit $unitmemory";
+        }
+
+        $ulimit_maxmemory = int($tmpmemory / $G + .5);
+    }
+    elsif (  ($unitmemory, $tmpmemory) = $_ =~ /virtual memory + \(([a-zA-Z]*), \-v\) ([0-9]*)/)
+    {
+        if ($tmpmemory eq "")
+        {
+            $tmpmemory = 0;
+        }
+
+        if ($unitmemory =~ /kbytes/i)
+        {
+            $tmpmemory *= $K;
+        }
+        elsif ($unitmemory =~ /mbytes/i)
+        {
+            $tmpmemory *= $M;
+        }
+        elsif ($unitmemory =~ /gbytes/i)
+        {
+            $tmpmemory *= $G;
+        }
+        else
+        {
+            die "Unknown virtual memory unit ulimit $unitmemory";
+        }
+
+        $ulimit_virtualmemory = int($tmpmemory / $G + .5);
+    }
+}
+close ULIMIT;
+
+$test_memory = $ulimit_virtualmemory > 0 ? $ulimit_virtualmemory : ($raw_memory + $swap_memory);
+
+print "$test_memory";
+
diff --git a/testing/sisyphus/bin/mips.pl b/testing/sisyphus/bin/mips.pl
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/bin/mips.pl
@@ -0,0 +1,72 @@
+#!/usr/bin/perl -w
+# -*- Mode: Perl; tab-width: 4; indent-tabs-mode: nil; -*-
+# ***** BEGIN LICENSE BLOCK *****
+# Version: MPL 1.1/GPL 2.0/LGPL 2.1
+#
+# The contents of this file are subject to the Mozilla Public License Version
+# 1.1 (the "License"); you may not use this file except in compliance with
+# the License. You may obtain a copy of the License at
+# http://www.mozilla.org/MPL/
+#
+# Software distributed under the License is distributed on an "AS IS" basis,
+# WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
+# for the specific language governing rights and limitations under the
+# License.
+#
+# The Original Code is Mozilla Automated Testing Code.
+#
+# The Initial Developer of the Original Code is
+# Mozilla Corporation.
+# Portions created by the Initial Developer are Copyright (C) 2008
+# the Initial Developer. All Rights Reserved.
+#
+# Contributor(s): Bob Clary <bob@bclary.com>
+#
+# Alternatively, the contents of this file may be used under the terms of
+# either the GNU General Public License Version 2 or later (the "GPL"), or
+# the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
+# in which case the provisions of the GPL or the LGPL are applicable instead
+# of those above. If you wish to allow use of your version of this file only
+# under the terms of either the GPL or the LGPL, and not to allow others to
+# use your version of this file under the terms of the MPL, indicate your
+# decision by deleting the provisions above and replace them with the notice
+# and other provisions required by the GPL or the LGPL. If you do not delete
+# the provisions above, a recipient may use your version of this file under
+# the terms of any one of the MPL, the GPL or the LGPL.
+#
+# ***** END LICENSE BLOCK *****
+
+# Calculate a relative speed measurement based on 
+# iterating over a simple loop in perl. Print the
+# result as millions of iterations per cpu second.
+
+sub mips
+{
+    my $tries = 3;        # repeat count to get average
+    my $m     = 1000000;  # scale to million iterations/second
+    my $l     = 10000000; # number of iterations to time
+    my $cpu   = 0;        # cpu time accumlator
+    my $dummy = 0;        # dummy variable to prevent optimizations
+    my $i;
+    my $start;
+    my $stop;
+    my $a;
+
+    for ($a = 0; $a < $tries; ++$a)
+    {
+        $start = (times)[0];
+        for ($i = 0; $i < $l; ++$i)
+        {
+            $dummy += $i;
+        }
+        $stop = (times)[0];
+        $cpu += $stop - $start;
+    }
+    $cpu /= $tries;
+
+    print "" . int($l/($cpu*$m)) . "\n";
+
+    return $dummy; # reuse dummy variable
+}
+
+mips;
diff --git a/testing/sisyphus/bin/set-build-env.sh b/testing/sisyphus/bin/set-build-env.sh
--- a/testing/sisyphus/bin/set-build-env.sh
+++ b/testing/sisyphus/bin/set-build-env.sh
@@ -32,22 +32,26 @@
 # use your version of this file under the terms of the MPL, indicate your
 # decision by deleting the provisions above and replace them with the notice
 # and other provisions required by the GPL or the LGPL. If you do not delete
 # the provisions above, a recipient may use your version of this file under
 # the terms of any one of the MPL, the GPL or the LGPL.
 #
 # ***** END LICENSE BLOCK *****
 
+if [[ -z "$LIBRARYSH" ]]; then
+    source $TEST_DIR/bin/library.sh
+fi
+
 export MOZ_CVS_FLAGS="-z3 -q"
 export MOZILLA_OFFICIAL=1
 export BUILD_OFFICIAL=1
 
 if [[ -z "$CVSROOT" ]]; then
-    if grep -q mozqa@qm-mini-ubuntu01 ~/.ssh/id_dsa.pub; then
+    if grep -q buildbot@qm ~/.ssh/id_dsa.pub; then
         export CVSROOT=:ext:unittest@cvs.mozilla.org:/cvsroot
     else
         export CVSROOT=:pserver:anonymous@cvs-mirror.mozilla.org:/cvsroot
     fi
 fi
 
 #
 # options processing
@@ -55,17 +59,17 @@ options="p:b:T:e:"
 options="p:b:T:e:"
 usage()
 {
     cat <<EOF
 
 usage: set-build-env.sh -p product -b branch -T buildtype [-e extra]
 
 -p product      [firefox|thunderbird]
--b branch       [1.8.0|1.8.1|1.9.0]
+-b branch       [1.8.0|1.8.1|1.9.0|1.9.1]
 -T buildtype    [opt|debug]
 -e extra        extra qualifier to pick mozconfig and tree
 
 EOF
 }
 
 myexit()
 {
@@ -86,19 +90,23 @@ for step in step1; do # dummy loop for h
     unset product branch buildtype extra
 
     while getopts $options optname ; 
       do 
       case $optname in
           p) product=$OPTARG;;
           b) branch=$OPTARG;;
           T) buildtype=$OPTARG;;
-          e) extra=$OPTARG;;
+          e) extra="-$OPTARG";;
       esac
     done
+
+    # include environment variables
+    datafiles=$TEST_DIR/data/$product,$branch$extra,$buildtype.data
+    loaddata $datafiles
 
     # echo product=$product, branch=$branch, buildtype=$buildtype, extra=$extra
 
     if [[ -z "$product" || -z "$branch" || -z "$buildtype" ]]; then
         echo -n "missing"
         if [[ -z "$product" ]]; then
             echo -n " -p product"
         fi
@@ -108,32 +116,35 @@ for step in step1; do # dummy loop for h
         if [[ -z "$buildtype" ]]; then
             echo -n " -T buildtype"
         fi
         usage
         myexit 1
     fi
 
     if [[ $branch == "1.8.0" ]]; then
-        export BRANCH_CO_FLAGS="-r MOZILLA_1_8_0_BRANCH"
+        export BRANCH_CO_FLAGS=${BRANCH_CO_FLAGS:--r MOZILLA_1_8_0_BRANCH}
     elif [[ $branch == "1.8.1" ]]; then
-        export BRANCH_CO_FLAGS="-r MOZILLA_1_8_BRANCH"
+        export BRANCH_CO_FLAGS=${BRANCH_CO_FLAGS:--r MOZILLA_1_8_BRANCH}
     elif [[ $branch == "1.9.0" ]]; then
+        export BRANCH_CO_FLAGS="";
+    elif [[ $branch == "1.9.1" ]]; then
+        # XXX: mozilla-central
         export BRANCH_CO_FLAGS="";
     else
         echo "Unknown branch: $branch"
         myexit 1
     fi
 
     if [[ -n "$MOZ_CO_DATE" ]]; then
         export DATE_CO_FLAGS="-D \"$MOZ_CO_DATE\""
     fi
 
-    case `uname -s` in 
-        CYGWIN*)
+    case $OSID in 
+        nt)
 
             # On Windows, Sisyphus is run under Cygwin, so the OS will be CYGWIN
             # regardless. Check if mozilla-build has been installed to the default
             # location, and if so, set up to call mozilla-build to perform the actual
             # build steps.
             # 
             # To make life simpler, change the mount point of the C: drive in cygwin from
             # /cygdrive/c to /c via mount -c /
@@ -142,36 +153,32 @@ for step in step1; do # dummy loop for h
             # 
             # Note that all commands *except* make client.mk will be performed in cygwin.
             #
             # Note that when calling a command string of the form $buildbash --login -c "command",
             # you must cd to the desired directory as part of "command" since msys will set the 
             # directory to the home directory prior to executing the command.
 
             if [[ -e "/c/mozilla-build" ]]; then
-                OSID=win32
                 export BUILDDIR=${BUILDDIR:-/c/work/mozilla/builds}
                 export buildbash="/c/mozilla-build/msys/bin/bash"
-                export platform=i686
                 export bashlogin=--login # this is for msys' bash.
 
                 if echo $branch | egrep -q '^1\.8'; then
                     export MOZ_TOOLS="/c/mozilla-build/moztools-180compat"
                     source ${TEST_DIR}/bin/set-msvc6-env.sh
                 else
                     export MOZ_TOOLS="/c/mozilla-build/moztools"
                     source ${TEST_DIR}/bin/set-msvc8-env.sh
                 fi
 
                 echo moztools Location: $MOZ_TOOLS
             else
-                OSID=win32
                 export BUILDDIR=${BUILDDIR:-/work/mozilla/builds}
                 export buildbash="/bin/bash"
-                export platform=i686
                 export bashlogin=-l
 
                 if echo $branch | egrep -q '^1\.8'; then
                     export MOZ_TOOLS="$BUILDDIR/moztools"
                     source ${TEST_DIR}/bin/set-msvc6-env.sh
                 else
                     export MOZ_TOOLS="$BUILDDIR/moztools-static"
                     source ${TEST_DIR}/bin/set-msvc8-env.sh
@@ -183,113 +190,112 @@ for step in step1; do # dummy loop for h
             # now convert TEST_DIR and BUILDDIR to cross compatible paths using
             # the common cygdrive prefix for cygwin and msys
             TEST_DIR_WIN=`cygpath -w $TEST_DIR`
             BUILDDIR_WIN=`cygpath -w $BUILDDIR`
             TEST_DIR=`cygpath -u $TEST_DIR_WIN`
             BUILDDIR=`cygpath -u $BUILDDIR_WIN`
             ;;
 
-        Linux)
-            OSID=linux
+        linux)
             export BUILDDIR=${BUILDDIR:-/work/mozilla/builds}
             export buildbash="/bin/bash"
-            export platform=`uname -p`
             export bashlogin=-l
 
             # if a 64 bit linux system, assume the 
             # compiler is in the standard reference
             # location /tools/gcc/bin/
-            case "$platform" in
-                x86_64)
+            case "$TEST_PROCESSORTYPE" in
+                *64)
                     export PATH=/tools/gcc/bin:$PATH
                     ;;
             esac
             
             ;;
-        Darwin)
-            OSID=mac
-
+        darwin)
             export BUILDDIR=${BUILDDIR:-/work/mozilla/builds}
             export buildbash="/bin/bash"
-            export platform=`uname -p`
             export bashlogin=-l
             ;;
         *)
             ;;
     esac
 
     export SHELL=$buildbash
     export CONFIG_SHELL=$buildbash
     export CONFIGURE_ENV_ARGS=$buildbash
 
+
+    export TEST_MOZILLA_HG=${TEST_MOZILLA_HG:-http://hg.mozilla.org/mozilla-central/}
+    export TEST_MOZILLA_HG_REV=${TEST_MOZILLA_HG_REV:-tip}
+
     if [[ -z $extra ]]; then
         export TREE="$BUILDDIR/$branch"
     else
-        export TREE="$BUILDDIR/$branch-$extra"
+        export TREE="$BUILDDIR/$branch$extra"
 
         #
         # extras can't be placed in mozconfigs since not all parts
         # of the build system use mozconfig (e.g. js shell) and since
         # the obj directory is not configurable for them as well thus
         # requiring separate source trees
         #
 
         case "$extra" in
-            too-much-gc)
+            -too-much-gc)
                 export XCFLAGS="-DWAY_TOO_MUCH_GC=1"
                 export CFLAGS="-DWAY_TOO_MUCH_GC=1"
                 export CXXFLAGS="-DWAY_TOO_MUCH_GC=1"
                 ;;
-            gcov)
+            -gcov)
 
-                if [[ "$OSID" == "win32" ]]; then
-                    echo "win32 does not support gcov"
+                if [[ "$OSID" == "nt" ]]; then
+                    echo "NT does not support gcov"
                     myexit 1
                 fi
                 export CFLAGS="--coverage"
                 export CXXFLAGS="--coverage"
                 export XCFLAGS="--coverage"
                 export OS_CFLAGS="--coverage"
                 export LDFLAGS="--coverage"
                 export XLDOPTS="--coverage"	
                 ;;
-            jprof)
+            -jprof)
                 ;;
         esac
     fi
 
     if [[ ! -d $TREE ]]; then
         echo "Build directory $TREE does not exist"
         myexit 2
     fi
 
     # here project refers to either browser or mail
     # and is used to find mozilla/(browser|mail)/config/mozconfig
     if [[ $product == "firefox" ]]; then
         project=browser
-        export MOZCONFIG="$TREE/mozconfig-firefox-$OSID-$platform-$buildtype"
+        export MOZCONFIG="$TREE/mozconfig-firefox-$OSID-$TEST_PROCESSORTYPE-$buildtype"
     elif [[ $product == "thunderbird" ]]; then
         project=mail
-        export MOZCONFIG="$TREE/mozconfig-thunderbird-$OSID-$platform-$buildtype"
+        export MOZCONFIG="$TREE/mozconfig-thunderbird-$OSID-$TEST_PROCESSORTYPE-$buildtype"
     else
         echo "Assuming project=browser for product: $product"
         project=browser
-        export MOZCONFIG="$TREE/mozconfig-firefox-$OSID-$platform-$buildtype"
+        export MOZCONFIG="$TREE/mozconfig-firefox-$OSID-$TEST_PROCESSORTYPE-$buildtype"
     fi
 
     # js shell builds
     if [[ $buildtype == "debug" ]]; then
         unset BUILD_OPT
     else
         export BUILD_OPT=1
     fi
 
     case "$OSID" in
-        mac)
+        darwin)
             export JS_EDITLINE=1 # required for mac
             ;;
     esac
     # end js shell builds
 
     set | sed 's/^/environment: /'
     echo "mozconfig: $MOZCONFIG"
     cat $MOZCONFIG | sed 's/^/mozconfig: /'
diff --git a/testing/sisyphus/bin/test-setup.sh b/testing/sisyphus/bin/test-setup.sh
--- a/testing/sisyphus/bin/test-setup.sh
+++ b/testing/sisyphus/bin/test-setup.sh
@@ -54,17 +54,17 @@ usage:
        [-N profilename [-D profiledirectory [-L profiletemplate 
          [-U userpreferences]]]]
        [-E extensiondir]
        [-d datafiles] 
 
 variable            description
 ===============     ===========================================================
 -p product          required. one of firefox thunderbird
--b branch           required. one of 1.8.0 1.8.1 1.9.0
+-b branch           required. one of 1.8.0 1.8.1 1.9.0 1.9.1
 -u url              optional. url where to download build
 -f filepath         optional. location to save downloaded build or to find
                     previously downloaded build. If not specified, the
                     default will be the basename of the url saved to the
                     /tmp directory. If there is no basename, then the
                     filepath will be /tmp/\$product-\$branch-file.
 -B buildcommands    optional. one or more of clean checkout build
 -T buildtype        optional. one of opt debug
@@ -124,35 +124,31 @@ while getopts $options optname ;
 
       E) extensiondir="$OPTARG";;
 
       d) datafiles="$OPTARG";;
   esac
 done
 
 # include environment variables
-if [[ -n "$datafiles" ]]; then
-    for datafile in $datafiles; do 
-        cat $datafile | sed 's|^|data: |'
-        source $datafile
-    done
-fi
+loaddata $datafiles
 
 TEST_PRODUCT=$product
 TEST_BRANCH=$branch
 TEST_BUILDCOMMANDS=$buildcommands
 TEST_BUILDTYPE=$buildtype
 TEST_EXECUTABLEPATH=$executablepath
 TEST_PROFILENAME=$profilename
 TEST_PROFILETEMPLATE=$profiletemplate
 TEST_USERPREFERENCES=$userpreferences
 TEST_EXTENSIONDIR=$extensiondir
 TEST_DATAFILES=$datafiles
 
 dumpenvironment
+dumphardware
 
 if [[ -z "$product" || -z "$branch" ]]; then
     echo "product and branch are required"
     usage
 fi
 
 if [[ ( -n "$url" || -n "$filepath" ) && ( -n "$buildcommands" ) ]]; then
     echo "you can not both download and build cvs builds at the same time"
diff --git a/testing/sisyphus/bin/tester.sh b/testing/sisyphus/bin/tester.sh
--- a/testing/sisyphus/bin/tester.sh
+++ b/testing/sisyphus/bin/tester.sh
@@ -107,9 +107,32 @@ for data in $datalist; do
     if [[ "$verbose" == "1" ]]; then
         test-setup.sh -d $TEST_DIR/data/$data.data 2>&1 | tee -a $TEST_LOG
         $testscript $testargs -d $TEST_DIR/data/$data.data 2>&1 | tee -a $TEST_LOG
     else
         test-setup.sh -d $TEST_DIR/data/$data.data >> $TEST_LOG 2>&1
         $testscript $testargs -d $TEST_DIR/data/$data.data >> $TEST_LOG 2>&1
     fi
 
+    if [[ "$XPCOM_DEBUG_BREAK" == "stack" ]]; then
+        case $OSID in
+            nt)
+                ;;
+            linux)
+                if which fix-linux-stack.pl > /dev/null; then
+                    fix-linux-stack.pl < $TEST_LOG > $TEST_LOG.tmp
+                    mv $TEST_LOG.tmp $TEST_LOG
+                else
+                    error "XPCOM_DEBUG_BREAK=stack specified but fix-linux-stack.pl is not available"
+                fi
+                ;;
+            darwin)
+                if which fix-macosx-stack.pl > /dev/null; then
+                    fix-macosx-stack.pl < $TEST_LOG > $TEST_LOG.tmp
+                    mv $TEST_LOG.tmp $TEST_LOG
+                else
+                    error "XPCOM_DEBUG_BREAK=stack specified but fix-macosx-stack.pl is not available"
+                fi
+                ;;
+        esac
+    fi
+
 done
diff --git a/testing/sisyphus/bin/timed_run.py b/testing/sisyphus/bin/timed_run.py
--- a/testing/sisyphus/bin/timed_run.py
+++ b/testing/sisyphus/bin/timed_run.py
@@ -15,16 +15,17 @@
 # The Original Code is mozilla.org code.
 #
 # The Initial Developer of the Original Code is
 # Mozilla Foundation.
 # Portions created by the Initial Developer are Copyright (C) 2004
 # the Initial Developer. All Rights Reserved.
 #
 # Contributor(s): Chris Cooper
+#                 Jesse Ruderman
 #
 # Alternatively, the contents of this file may be used under the terms of
 # either the GNU General Public License Version 2 or later (the "GPL"), or
 # the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
 # in which case the provisions of the GPL or the LGPL are applicable instead
 # of those above. If you wish to allow use of your version of this file only
 # under the terms of either the GPL or the LGPL, and not to allow others to
 # use your version of this file under the terms of the MPL, indicate your
@@ -50,41 +51,50 @@ prefix = sys.argv[2]
 prefix = sys.argv[2]
 elapsedtime = 0
 
 if prefix == "-":
     prefix = ''
 else:
     prefix = prefix + ':'
 
+def getSignalName(num):
+    for p in dir(signal):
+        if p.startswith("SIG") and not p.startswith("SIG_"):
+            if getattr(signal, p) == num:
+                return p
+    return "UNKNOWN"
+
 def alarm_handler(signum, frame):
     global pid
     global prefix
     try:
-        print "%s EXIT STATUS: TIMED OUT (%s seconds)" % (prefix, sys.argv[1])
+	stoptime = time.time()
+	elapsedtime = stoptime - starttime
+        print "\n%s EXIT STATUS: TIMED OUT (%s seconds)\n" % (prefix, elapsedtime)
         flushkill(pid, signal.SIGKILL)
     except OSError, e:
-        print "timed_run.py: exception trying to kill process: %d (%s)" % (e.errno, e.strerror)
+        print "\ntimed_run.py: exception trying to kill process: %d (%s)\n" % (e.errno, e.strerror)
         pass
     flushexit(exitTimeout)
 
 def forkexec(command, args):
     global prefix
     global elapsedtime
     #print command
     #print args
     try:
         pid = os.fork()
         if pid == 0:  # Child
             os.execvp(command, args)
             flushbuffers()
         else:  # Parent
             return pid
     except OSError, e:
-        print "%s ERROR: %s %s failed: %d (%s) (%f seconds)" % (prefix, command, args, e.errno, e.strerror, elapsedtime)
+        print "\n%s ERROR: %s %s failed: %d (%s) (%f seconds)\n" % (prefix, command, args, e.errno, e.strerror, elapsedtime)
         flushexit(exitOSError)
 
 def flushbuffers():
         sys.stdout.flush()
         sys.stderr.flush()
 
 def flushexit(rc):
         flushbuffers()
@@ -101,31 +111,37 @@ try:
 	pid = forkexec(sys.argv[3], sys.argv[3:])
 	status = os.waitpid(pid, 0)[1]
 	signal.alarm(0) # Cancel the alarm
 	stoptime = time.time()
 	elapsedtime = stoptime - starttime
 	# it appears that linux at least will on "occasion" return a status
 	# when the process was terminated by a signal, so test signal first.
 	if os.WIFSIGNALED(status):
-	    print "%s EXIT STATUS: CRASHED signal %d (%f seconds)" % (prefix, os.WTERMSIG(status), elapsedtime)
-	    flushexit(exitSignal)
+            signum = os.WTERMSIG(status)
+            if signum == 2:
+                msg = 'INTERRUPT'
+                rc = exitInterrupt
+            else:
+                msg = 'CRASHED'
+                rc = exitSignal
+
+            print "\n%s EXIT STATUS: %s signal %d %s (%f seconds)\n" % (prefix, msg, signum, getSignalName(signum), elapsedtime)
+            flushexit(rc)
+
 	elif os.WIFEXITED(status):
 	    rc = os.WEXITSTATUS(status)
 	    msg = ''
 	    if rc == 0:
 	        msg = 'NORMAL'
-	    elif rc < 3:
+	    else:
 	        msg = 'ABNORMAL ' + str(rc)
 		rc = exitSignal
-	    else:
-	        msg = 'CRASHED ' + str(rc)
-		rc = exitSignal
 
-	    print "%s EXIT STATUS: %s (%f seconds)" % (prefix, msg, elapsedtime)
+	    print "\n%s EXIT STATUS: %s (%f seconds)\n" % (prefix, msg, elapsedtime)
 	    flushexit(rc)
 	else:
-	    print "%s EXIT STATUS: NONE (%f seconds)" % (prefix, elapsedtime)
+	    print "\n%s EXIT STATUS: NONE (%f seconds)\n" % (prefix, elapsedtime)
 	    flushexit(0)
 except KeyboardInterrupt:
 	flushkill(pid, 9)
 	flushexit(exitInterrupt)
 
diff --git a/testing/sisyphus/bin/uninstall-build.sh b/testing/sisyphus/bin/uninstall-build.sh
--- a/testing/sisyphus/bin/uninstall-build.sh
+++ b/testing/sisyphus/bin/uninstall-build.sh
@@ -47,17 +47,17 @@ function usage()
 {
     cat <<EOF
 usage: 
 $SCRIPT -p product -b branch  -x executablepath [-d datafiles]
 
 variable            description
 ===============     ============================================================
 -p product          required. firefox|thunderbird
--b branch           required. 1.8.0|1.8.1|1.9.0
+-b branch           required. 1.8.0|1.8.1|1.9.0|1.9.1
 -x executablepath   required. directory where build is installed
 -d datafiles        optional. one or more filenames of files containing 
                     environment variable definitions to be included.
 
 note that the environment variables should have the same names as in the 
 "variable" column.
 
 Uninstalls build located in directory-tree 'executablepath'
@@ -75,63 +75,54 @@ while getopts $options optname ;
       p) product=$OPTARG;;
       b) branch=$OPTARG;;
       x) executablepath=$OPTARG;;
       d) datafiles=$OPTARG;;
   esac
 done
 
 # include environment variables
-if [[ -n "$datafiles" ]]; then
-    for datafile in $datafiles; do 
-        cat $datafile | sed 's|^|data: |'
-        source $datafile
-    done
-fi
+loaddata $datafiles
 
 if [[ -z "$product" || -z "$branch" || -z "$executablepath" ]]
     then
     usage
 fi
 
 
 if [[ ! -d "$executablepath" ]]; then
     exit 0
 fi
 
 executable=`get_executable $product $branch $executablepath`
 
-if [[ -z "$executable" ]]; then
-    exit 0
-fi
-
 executabledir=`dirname $executable`
 
-if [[ $OSID == "win32" ]]; then
+if [[ $OSID == "nt" ]]; then
     # see http://nsis.sourceforge.net/Docs/Chapter3.html
 
     # if the directory already exists, attempt to uninstall
     # any existing installation.
 
     if [[ -d "$executabledir/uninstall" ]]; then
 
-        if [[ $branch == "1.8.0" ]]; then
+        if [[ "$branch" == "1.8.0" ]]; then
             uninstallexe="$executabledir/uninstall/uninstall.exe"
             uninstallini="$executabledir/uninstall/uninstall.ini"
             if [[ -n "$uninstallexe"  && -e "$uninstallexe" ]]; then
                 if sed -i.bak 's/Run Mode=Normal/Run Mode=Silent/' $uninstallini; 
                     then
                     # uninstall.exe will return non zero exit codes 
                     # for no damn reason.
                     if $uninstallexe; then
                         true
                     fi
                 fi
             fi
-        elif [[ $branch == "1.8.1" || $branch == "1.9.0" ]]; then
+        elif [[ "$branch" == "1.8.1" || "$branch" == "1.9.0" || "$branch" == "1.9.1" ]]; then
             uninstalloldexe="$executabledir/uninstall/uninst.exe"
             uninstallnewexe="$executabledir/uninstall/helper.exe"
             if [[ -n "$uninstallnewexe" && -e "$uninstallnewexe" ]]; then
                 $uninstallnewexe /S /D=`cygpath -a -w $executabledir | sed 's@\\\\@\\\\\\\\@g'`
             elif [[ -n "$uninstalloldexe" && -e "$uninstalloldexe" ]]; then
                 $uninstalloldexe /S /D=`cygpath -a -w $executabledir | sed 's@\\\\@\\\\\\\\@g'`
             else
                 uninstallexe="$executabledir/$product/uninstall/uninstaller.exe"
diff --git a/testing/sisyphus/bin/userhook-checkspider.js b/testing/sisyphus/bin/userhook-checkspider.js
--- a/testing/sisyphus/bin/userhook-checkspider.js
+++ b/testing/sisyphus/bin/userhook-checkspider.js
@@ -45,17 +45,47 @@ function userOnStart()
 }
 
 function userOnBeforePage()
 {
 }
 
 function userOnAfterPage()
 {
+  var win = gSpider.mDocument.defaultView;
+  if (win.wrappedJSObject)
+  {
+    win = win.wrappedJSObject;
+  }
+
+  dumpObject('navigator', win.navigator);
+
+  for (var i = 0; i < win.navigator.mimeTypes.length; i++)
+  {
+    dumpObject('navigator.mimeTypes[' + i + ']', win.navigator.mimeTypes[i]);
+  }
+
+  for (var i = 0; i < win.navigator.plugins.length; i++)
+  {
+    dumpObject('navigator.plugins[' + i + ']', win.navigator.plugins[i]);
+  }
+
   gPageCompleted = true;
+}
+
+function dumpObject(name, object)
+{
+  for (var p in object)
+  {
+    if (/(string|number)/.test(typeof object[p]))
+    {
+      cdump(name + '.' + p + ':' + object[p]);
+    }
+  }
+
 }
 
 function userOnStop()
 {
 }
 
 
 gConsoleListener.onConsoleMessage = 
diff --git a/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,darwin.data b/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,darwin.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,darwin.data
@@ -0,0 +1,11 @@
+allurl=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/1.5.0.12-candidates/rc2/
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/mac/en-US/Firefox%202.0.0.14.dmg
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=ftp
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,linux.data b/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,linux.data
--- a/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,linux.data
+++ b/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,linux.data
@@ -1,11 +1,11 @@ allurl=http://ftp.mozilla.org/pub/mozill
 allurl=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/1.5.0.12-candidates/rc2/
 product=firefox
 branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/linux-i686/en-US/firefox-2.0.0.13.tar.gz
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/linux-i686/en-US/firefox-2.0.0.14.tar.gz
 profilename=firefox-1.8.1-profile
 profiledirectory=/tmp/firefox-1.8.1-profile
 executablepath=/tmp/firefox-1.8.1
 userpreferences=${TEST_DIR}/prefs/test-user.js
 extensiondir=${TEST_DIR}/xpi
 test=ftp
 buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,mac.data b/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,mac.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,mac.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/1.5.0.12-candidates/rc2/
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/mac/en-US/Firefox%202.0.0.13.dmg
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=ftp
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,nt.data b/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,nt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,nt.data
@@ -0,0 +1,11 @@
+allurl=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/1.5.0.12-candidates/rc2/
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/win32/en-US/Firefox%20Setup%202.0.0.14.exe
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=ftp
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,win32.data b/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,win32.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,firefox-1.5.0-ftp,win32.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/1.5.0.12-candidates/rc2/
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/win32/en-US/Firefox%20Setup%202.0.0.13.exe
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=ftp
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,darwin.data b/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,darwin.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,darwin.data
@@ -0,0 +1,11 @@
+allurl=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2.0.0.14-candidates/rc2/
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/mac/en-US/Firefox%202.0.0.14.dmg
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=ftp
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,linux.data b/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,linux.data
--- a/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,linux.data
+++ b/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,linux.data
@@ -1,11 +1,11 @@ allurl=http://ftp.mozilla.org/pub/mozill
-allurl=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2.0.0.13-candidates/rc2/
+allurl=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2.0.0.14-candidates/rc2/
 product=firefox
 branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/linux-i686/en-US/firefox-2.0.0.13.tar.gz
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/linux-i686/en-US/firefox-2.0.0.14.tar.gz
 profilename=firefox-1.8.1-profile
 profiledirectory=/tmp/firefox-1.8.1-profile
 executablepath=/tmp/firefox-1.8.1
 userpreferences=${TEST_DIR}/prefs/test-user.js
 extensiondir=${TEST_DIR}/xpi
 test=ftp
 buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,mac.data b/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,mac.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,mac.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2.0.0.13-candidates/rc2/
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/mac/en-US/Firefox%202.0.0.13.dmg
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=ftp
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,nt.data b/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,nt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,nt.data
@@ -0,0 +1,11 @@
+allurl=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2.0.0.14-candidates/rc2/
+product=firefox
+branch=1.8.1
+url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-trunk/firefox-3.0pre.en-US.win32.zip
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=ftp
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,win32.data b/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,win32.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,firefox-2.0.0-ftp,win32.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2.0.0.13-candidates/rc2/
-product=firefox
-branch=1.8.1
-url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-trunk/firefox-3.0pre.en-US.win32.zip
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=ftp
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-all,darwin.data b/testing/sisyphus/data/download-check,firefox-all,darwin.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,firefox-all,darwin.data
@@ -0,0 +1,11 @@
+allurl=http://www.mozilla.com/en-US/firefox/all.html
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/mac/en-US/Firefox%202.0.0.14.dmg
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=all
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-all,linux.data b/testing/sisyphus/data/download-check,firefox-all,linux.data
--- a/testing/sisyphus/data/download-check,firefox-all,linux.data
+++ b/testing/sisyphus/data/download-check,firefox-all,linux.data
@@ -1,11 +1,11 @@ allurl=http://www.mozilla.com/en-US/fire
 allurl=http://www.mozilla.com/en-US/firefox/all.html
 product=firefox
 branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/linux-i686/en-US/firefox-2.0.0.13.tar.gz
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/linux-i686/en-US/firefox-2.0.0.14.tar.gz
 profilename=firefox-1.8.1-profile
 profiledirectory=/tmp/firefox-1.8.1-profile
 executablepath=/tmp/firefox-1.8.1
 userpreferences=${TEST_DIR}/prefs/test-user.js
 extensiondir=${TEST_DIR}/xpi
 test=all
 buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-all,mac.data b/testing/sisyphus/data/download-check,firefox-all,mac.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,firefox-all,mac.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://www.mozilla.com/en-US/firefox/all.html
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/mac/en-US/Firefox%202.0.0.13.dmg
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=all
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-all,nt.data b/testing/sisyphus/data/download-check,firefox-all,nt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,firefox-all,nt.data
@@ -0,0 +1,11 @@
+allurl=http://www.mozilla.com/en-US/firefox/all.html
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/win32/en-US/Firefox%20Setup%202.0.0.14.exe
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=all
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-all,win32.data b/testing/sisyphus/data/download-check,firefox-all,win32.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,firefox-all,win32.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://www.mozilla.com/en-US/firefox/all.html
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/win32/en-US/Firefox%20Setup%202.0.0.13.exe
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=all
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-all-older,darwin.data b/testing/sisyphus/data/download-check,firefox-all-older,darwin.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,firefox-all-older,darwin.data
@@ -0,0 +1,11 @@
+allurl=http://khan.landfill.bugzilla.org/en-US/firefox/all-older.html
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/mac/en-US/Firefox%202.0.0.14.dmg
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=all
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-all-older,linux.data b/testing/sisyphus/data/download-check,firefox-all-older,linux.data
--- a/testing/sisyphus/data/download-check,firefox-all-older,linux.data
+++ b/testing/sisyphus/data/download-check,firefox-all-older,linux.data
@@ -1,11 +1,11 @@ allurl=http://khan.landfill.bugzilla.org
 allurl=http://khan.landfill.bugzilla.org/en-US/firefox/all-older.html
 product=firefox
 branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/linux-i686/en-US/firefox-2.0.0.13.tar.gz
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/linux-i686/en-US/firefox-2.0.0.14.tar.gz
 profilename=firefox-1.8.1-profile
 profiledirectory=/tmp/firefox-1.8.1-profile
 executablepath=/tmp/firefox-1.8.1
 userpreferences=${TEST_DIR}/prefs/test-user.js
 extensiondir=${TEST_DIR}/xpi
 test=all
 buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-all-older,mac.data b/testing/sisyphus/data/download-check,firefox-all-older,mac.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,firefox-all-older,mac.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://khan.landfill.bugzilla.org/en-US/firefox/all-older.html
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/mac/en-US/Firefox%202.0.0.13.dmg
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=all
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-all-older,nt.data b/testing/sisyphus/data/download-check,firefox-all-older,nt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,firefox-all-older,nt.data
@@ -0,0 +1,11 @@
+allurl=http://khan.landfill.bugzilla.org/en-US/firefox/all-older.html
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/win32/en-US/Firefox%20Setup%202.0.0.14.exe
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=all
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,firefox-all-older,win32.data b/testing/sisyphus/data/download-check,firefox-all-older,win32.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,firefox-all-older,win32.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://khan.landfill.bugzilla.org/en-US/firefox/all-older.html
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/win32/en-US/Firefox%20Setup%202.0.0.13.exe
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=all
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,darwin.data b/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,darwin.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,darwin.data
@@ -0,0 +1,11 @@
+allurl=http://releases.mozilla.org/pub/mozilla.org/thunderbird/releases/1.5.0.14/
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/mac/en-US/Firefox%202.0.0.14.dmg
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=ftp
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,linux.data b/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,linux.data
--- a/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,linux.data
+++ b/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,linux.data
@@ -1,11 +1,11 @@ allurl=http://releases.mozilla.org/pub/m
 allurl=http://releases.mozilla.org/pub/mozilla.org/thunderbird/releases/1.5.0.14/
 product=firefox
 branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/linux-i686/en-US/firefox-2.0.0.13.tar.gz
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/linux-i686/en-US/firefox-2.0.0.14.tar.gz
 profilename=firefox-1.8.1-profile
 profiledirectory=/tmp/firefox-1.8.1-profile
 executablepath=/tmp/firefox-1.8.1
 userpreferences=${TEST_DIR}/prefs/test-user.js
 extensiondir=${TEST_DIR}/xpi
 test=ftp
 buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,mac.data b/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,mac.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,mac.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://releases.mozilla.org/pub/mozilla.org/thunderbird/releases/1.5.0.14/
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/mac/en-US/Firefox%202.0.0.13.dmg
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=ftp
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,nt.data b/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,nt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,nt.data
@@ -0,0 +1,11 @@
+allurl=http://releases.mozilla.org/pub/mozilla.org/thunderbird/releases/1.5.0.14/
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/win32/en-US/Firefox%20Setup%202.0.0.14.exe
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=ftp
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,win32.data b/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,win32.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,thunderbird-1.5.0-ftp,win32.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://releases.mozilla.org/pub/mozilla.org/thunderbird/releases/1.5.0.14/
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/win32/en-US/Firefox%20Setup%202.0.0.13.exe
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=ftp
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,darwin.data b/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,darwin.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,darwin.data
@@ -0,0 +1,11 @@
+allurl=http://ftp.mozilla.org/pub/mozilla.org/thunderbird/releases/2.0.0.14/
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/mac/en-US/Firefox%202.0.0.14.dmg
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=ftp
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,linux.data b/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,linux.data
--- a/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,linux.data
+++ b/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,linux.data
@@ -1,11 +1,11 @@ allurl=http://ftp.mozilla.org/pub/mozill
-allurl=http://ftp.mozilla.org/pub/mozilla.org/thunderbird/releases/2.0.0.12/
+allurl=http://ftp.mozilla.org/pub/mozilla.org/thunderbird/releases/2.0.0.14/
 product=firefox
 branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/linux-i686/en-US/firefox-2.0.0.13.tar.gz
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/linux-i686/en-US/firefox-2.0.0.14.tar.gz
 profilename=firefox-1.8.1-profile
 profiledirectory=/tmp/firefox-1.8.1-profile
 executablepath=/tmp/firefox-1.8.1
 userpreferences=${TEST_DIR}/prefs/test-user.js
 extensiondir=${TEST_DIR}/xpi
 test=ftp
 buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,mac.data b/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,mac.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,mac.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://ftp.mozilla.org/pub/mozilla.org/thunderbird/releases/2.0.0.12/
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/mac/en-US/Firefox%202.0.0.13.dmg
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=ftp
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,nt.data b/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,nt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,nt.data
@@ -0,0 +1,11 @@
+allurl=http://ftp.mozilla.org/pub/mozilla.org/thunderbird/releases/2.0.0.14/
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/win32/en-US/Firefox%20Setup%202.0.0.14.exe
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=ftp
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,win32.data b/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,win32.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,thunderbird-2.0.0-ftp,win32.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://ftp.mozilla.org/pub/mozilla.org/thunderbird/releases/2.0.0.12/
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/win32/en-US/Firefox%20Setup%202.0.0.13.exe
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=ftp
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-all,darwin.data b/testing/sisyphus/data/download-check,thunderbird-all,darwin.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,thunderbird-all,darwin.data
@@ -0,0 +1,11 @@
+allurl=http://www.mozilla.com/en-US/thunderbird/all.html
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/mac/en-US/Firefox%202.0.0.14.dmg
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=all
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-all,linux.data b/testing/sisyphus/data/download-check,thunderbird-all,linux.data
--- a/testing/sisyphus/data/download-check,thunderbird-all,linux.data
+++ b/testing/sisyphus/data/download-check,thunderbird-all,linux.data
@@ -1,11 +1,11 @@ allurl=http://www.mozilla.com/en-US/thun
 allurl=http://www.mozilla.com/en-US/thunderbird/all.html
 product=firefox
 branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/linux-i686/en-US/firefox-2.0.0.13.tar.gz
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/linux-i686/en-US/firefox-2.0.0.14.tar.gz
 profilename=firefox-1.8.1-profile
 profiledirectory=/tmp/firefox-1.8.1-profile
 executablepath=/tmp/firefox-1.8.1
 userpreferences=${TEST_DIR}/prefs/test-user.js
 extensiondir=${TEST_DIR}/xpi
 test=all
 buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-all,mac.data b/testing/sisyphus/data/download-check,thunderbird-all,mac.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,thunderbird-all,mac.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://www.mozilla.com/en-US/thunderbird/all.html
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/mac/en-US/Firefox%202.0.0.13.dmg
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=all
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-all,nt.data b/testing/sisyphus/data/download-check,thunderbird-all,nt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,thunderbird-all,nt.data
@@ -0,0 +1,11 @@
+allurl=http://www.mozilla.com/en-US/thunderbird/all.html
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/win32/en-US/Firefox%20Setup%202.0.0.14.exe
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=all
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-all,win32.data b/testing/sisyphus/data/download-check,thunderbird-all,win32.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,thunderbird-all,win32.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://www.mozilla.com/en-US/thunderbird/all.html
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/win32/en-US/Firefox%20Setup%202.0.0.13.exe
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=all
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-all-older,darwin.data b/testing/sisyphus/data/download-check,thunderbird-all-older,darwin.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,thunderbird-all-older,darwin.data
@@ -0,0 +1,11 @@
+allurl=http://khan.landfill.bugzilla.org/en-US/thunderbird/all-older.html
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/mac/en-US/Firefox%202.0.0.14.dmg
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=all
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-all-older,linux.data b/testing/sisyphus/data/download-check,thunderbird-all-older,linux.data
--- a/testing/sisyphus/data/download-check,thunderbird-all-older,linux.data
+++ b/testing/sisyphus/data/download-check,thunderbird-all-older,linux.data
@@ -1,11 +1,11 @@ allurl=http://khan.landfill.bugzilla.org
 allurl=http://khan.landfill.bugzilla.org/en-US/thunderbird/all-older.html
 product=firefox
 branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/linux-i686/en-US/firefox-2.0.0.13.tar.gz
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/linux-i686/en-US/firefox-2.0.0.14.tar.gz
 profilename=firefox-1.8.1-profile
 profiledirectory=/tmp/firefox-1.8.1-profile
 executablepath=/tmp/firefox-1.8.1
 userpreferences=${TEST_DIR}/prefs/test-user.js
 extensiondir=${TEST_DIR}/xpi
 test=all
 buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-all-older,mac.data b/testing/sisyphus/data/download-check,thunderbird-all-older,mac.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,thunderbird-all-older,mac.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://khan.landfill.bugzilla.org/en-US/thunderbird/all-older.html
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/mac/en-US/Firefox%202.0.0.13.dmg
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=all
-buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-all-older,nt.data b/testing/sisyphus/data/download-check,thunderbird-all-older,nt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/download-check,thunderbird-all-older,nt.data
@@ -0,0 +1,11 @@
+allurl=http://khan.landfill.bugzilla.org/en-US/thunderbird/all-older.html
+product=firefox
+branch=1.8.1
+url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.14/win32/en-US/Firefox%20Setup%202.0.0.14.exe
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+test=all
+buildtype=nightly
diff --git a/testing/sisyphus/data/download-check,thunderbird-all-older,win32.data b/testing/sisyphus/data/download-check,thunderbird-all-older,win32.data
deleted file mode 100755
--- a/testing/sisyphus/data/download-check,thunderbird-all-older,win32.data
+++ /dev/null
@@ -1,11 +0,0 @@
-allurl=http://khan.landfill.bugzilla.org/en-US/thunderbird/all-older.html
-product=firefox
-branch=1.8.1
-url=http://releases.mozilla.org/pub/mozilla.org/firefox/releases/2.0.0.13/win32/en-US/Firefox%20Setup%202.0.0.13.exe
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-test=all
-buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.8.0,nightly-darwin.data b/testing/sisyphus/data/firefox,1.8.0,nightly-darwin.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.8.0,nightly-darwin.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.8.0
+url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla1.8.0/firefox-1.5.0.12eol.en-US.mac.dmg
+profilename=firefox-1.8.0-profile
+profiledirectory=/tmp/firefox-1.8.0-profile
+executablepath=/tmp/firefox-1.8.0
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.8.0,nightly-mac.data b/testing/sisyphus/data/firefox,1.8.0,nightly-mac.data
deleted file mode 100755
--- a/testing/sisyphus/data/firefox,1.8.0,nightly-mac.data
+++ /dev/null
@@ -1,9 +0,0 @@
-product=firefox
-branch=1.8.0
-url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla1.8.0/firefox-1.5.0.12eol.en-US.mac.dmg
-profilename=firefox-1.8.0-profile
-profiledirectory=/tmp/firefox-1.8.0-profile
-executablepath=/tmp/firefox-1.8.0
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.8.0,nightly-nt.data b/testing/sisyphus/data/firefox,1.8.0,nightly-nt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.8.0,nightly-nt.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.8.0
+url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla1.8.0/firefox-1.5.0.12eol.en-US.win32.zip
+profilename=firefox-1.8.0-profile
+profiledirectory=/tmp/firefox-1.8.0-profile
+executablepath=/tmp/firefox-1.8.0
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.8.0,nightly-win32.data b/testing/sisyphus/data/firefox,1.8.0,nightly-win32.data
deleted file mode 100755
--- a/testing/sisyphus/data/firefox,1.8.0,nightly-win32.data
+++ /dev/null
@@ -1,9 +0,0 @@
-product=firefox
-branch=1.8.0
-url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla1.8.0/firefox-1.5.0.12eol.en-US.win32.zip
-profilename=firefox-1.8.0-profile
-profiledirectory=/tmp/firefox-1.8.0-profile
-executablepath=/tmp/firefox-1.8.0
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.8.1,nightly-darwin.data b/testing/sisyphus/data/firefox,1.8.1,nightly-darwin.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.8.1,nightly-darwin.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.8.1
+url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla1.8/firefox-2.0.0.15pre.en-US.mac.dmg
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.8.1,nightly-linux.data b/testing/sisyphus/data/firefox,1.8.1,nightly-linux.data
--- a/testing/sisyphus/data/firefox,1.8.1,nightly-linux.data
+++ b/testing/sisyphus/data/firefox,1.8.1,nightly-linux.data
@@ -1,9 +1,9 @@ product=firefox
 product=firefox
 branch=1.8.1
-url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla1.8/firefox-2.0.0.14pre.en-US.linux-i686.tar.gz
+url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla1.8/firefox-2.0.0.15pre.en-US.linux-i686.tar.gz
 profilename=firefox-1.8.1-profile
 profiledirectory=/tmp/firefox-1.8.1-profile
 executablepath=/tmp/firefox-1.8.1
 userpreferences=${TEST_DIR}/prefs/test-user.js
 extensiondir=${TEST_DIR}/xpi
 buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.8.1,nightly-mac.data b/testing/sisyphus/data/firefox,1.8.1,nightly-mac.data
deleted file mode 100755
--- a/testing/sisyphus/data/firefox,1.8.1,nightly-mac.data
+++ /dev/null
@@ -1,9 +0,0 @@
-product=firefox
-branch=1.8.1
-url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla1.8/firefox-2.0.0.14pre.en-US.mac.dmg
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.8.1,nightly-nt.data b/testing/sisyphus/data/firefox,1.8.1,nightly-nt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.8.1,nightly-nt.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.8.1
+url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla1.8/firefox-2.0.0.15pre.en-US.win32.zip
+profilename=firefox-1.8.1-profile
+profiledirectory=/tmp/firefox-1.8.1-profile
+executablepath=/tmp/firefox-1.8.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.8.1,nightly-win32.data b/testing/sisyphus/data/firefox,1.8.1,nightly-win32.data
deleted file mode 100755
--- a/testing/sisyphus/data/firefox,1.8.1,nightly-win32.data
+++ /dev/null
@@ -1,9 +0,0 @@
-product=firefox
-branch=1.8.1
-url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla1.8/firefox-2.0.0.14pre.en-US.win32.zip
-profilename=firefox-1.8.1-profile
-profiledirectory=/tmp/firefox-1.8.1-profile
-executablepath=/tmp/firefox-1.8.1
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.9.0,nightly-darwin.data b/testing/sisyphus/data/firefox,1.9.0,nightly-darwin.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.0,nightly-darwin.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.0
+url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-trunk/firefox-3.0pre.en-US.mac.dmg
+profilename=firefox-1.9.0-profile
+profiledirectory=/tmp/firefox-1.9.0-profile
+executablepath=/tmp/firefox-1.9.0
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.9.0,nightly-mac.data b/testing/sisyphus/data/firefox,1.9.0,nightly-mac.data
deleted file mode 100755
--- a/testing/sisyphus/data/firefox,1.9.0,nightly-mac.data
+++ /dev/null
@@ -1,9 +0,0 @@
-product=firefox
-branch=1.9.0
-url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-trunk/firefox-3.0pre.en-US.mac.dmg
-profilename=firefox-1.9.0-profile
-profiledirectory=/tmp/firefox-1.9.0-profile
-executablepath=/tmp/firefox-1.9.0
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.9.0,nightly-nt.data b/testing/sisyphus/data/firefox,1.9.0,nightly-nt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.0,nightly-nt.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.0
+url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-trunk/firefox-3.0pre.en-US.win32.zip
+profilename=firefox-1.9.0-profile
+profiledirectory=/tmp/firefox-1.9.0-profile
+executablepath=/tmp/firefox-1.9.0
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.9.0,nightly-win32.data b/testing/sisyphus/data/firefox,1.9.0,nightly-win32.data
deleted file mode 100755
--- a/testing/sisyphus/data/firefox,1.9.0,nightly-win32.data
+++ /dev/null
@@ -1,9 +0,0 @@
-product=firefox
-branch=1.9.0
-url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-trunk/firefox-3.0pre.en-US.win32.zip
-profilename=firefox-1.9.0-profile
-profiledirectory=/tmp/firefox-1.9.0-profile
-executablepath=/tmp/firefox-1.9.0
-userpreferences=${TEST_DIR}/prefs/test-user.js
-extensiondir=${TEST_DIR}/xpi
-buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.9.0-gcov,debug.data b/testing/sisyphus/data/firefox,1.9.0-gcov,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.0-gcov,debug.data
@@ -0,0 +1,8 @@
+product=firefox
+branch=1.9.0
+profilename=firefox-1.9.0-gcov-profile
+profiledirectory=/tmp/firefox-1.9.0-gcov-profile
+executablepath=${BUILDDIR}/1.9.0-gcov/mozilla/firefox-debug/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=debug
diff --git a/testing/sisyphus/data/firefox,1.9.0-gcov,opt.data b/testing/sisyphus/data/firefox,1.9.0-gcov,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.0-gcov,opt.data
@@ -0,0 +1,8 @@
+product=firefox
+branch=1.9.0
+profilename=firefox-1.9.0-gcov-profile
+profiledirectory=/tmp/firefox-1.9.0-gcov-profile
+executablepath=${BUILDDIR}/1.9.0-gcov/mozilla/firefox-opt/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=opt
diff --git a/testing/sisyphus/data/firefox,1.9.0-jemalloc,debug.data b/testing/sisyphus/data/firefox,1.9.0-jemalloc,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.0-jemalloc,debug.data
@@ -0,0 +1,8 @@
+product=firefox
+branch=1.9.0
+profilename=firefox-1.9.0-jemalloc-profile
+profiledirectory=/tmp/firefox-1.9.0-jemalloc-profile
+executablepath=${BUILDDIR}/1.9.0-jemalloc/mozilla/firefox-debug/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=debug
diff --git a/testing/sisyphus/data/firefox,1.9.0-jemalloc,opt.data b/testing/sisyphus/data/firefox,1.9.0-jemalloc,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.0-jemalloc,opt.data
@@ -0,0 +1,8 @@
+product=firefox
+branch=1.9.0
+profilename=firefox-1.9.0-jemalloc-profile
+profiledirectory=/tmp/firefox-1.9.0-jemalloc-profile
+executablepath=${BUILDDIR}/1.9.0-jemalloc/mozilla/firefox-opt/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=opt
diff --git a/testing/sisyphus/data/firefox,1.9.0-jemalloc-test,debug.data b/testing/sisyphus/data/firefox,1.9.0-jemalloc-test,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.0-jemalloc-test,debug.data
@@ -0,0 +1,8 @@
+product=firefox
+branch=1.9.0
+profilename=firefox-1.9.0-jemalloc-test-profile
+profiledirectory=/tmp/firefox-1.9.0-jemalloc-test-profile
+executablepath=${BUILDDIR}/1.9.0-jemalloc-test/mozilla/firefox-debug/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=debug
diff --git a/testing/sisyphus/data/firefox,1.9.0-jemalloc-test,opt.data b/testing/sisyphus/data/firefox,1.9.0-jemalloc-test,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.0-jemalloc-test,opt.data
@@ -0,0 +1,8 @@
+product=firefox
+branch=1.9.0
+profilename=firefox-1.9.0-jemalloc-test-profile
+profiledirectory=/tmp/firefox-1.9.0-jemalloc-test-profile
+executablepath=${BUILDDIR}/1.9.0-jemalloc-test/mozilla/firefox-opt/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=opt
diff --git a/testing/sisyphus/data/firefox,1.9.1,debug.data b/testing/sisyphus/data/firefox,1.9.1,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1,debug.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-profile
+profiledirectory=/tmp/firefox-1.9.1-profile
+executablepath=${BUILDDIR}/1.9.1/mozilla/firefox-debug/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/firefox,1.9.1,nightly-darwin.data b/testing/sisyphus/data/firefox,1.9.1,nightly-darwin.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1,nightly-darwin.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-trunk/firefox-3.0pre.en-US.mac.dmg
+profilename=firefox-1.9.1-profile
+profiledirectory=/tmp/firefox-1.9.1-profile
+executablepath=/tmp/firefox-1.9.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.9.1,nightly-linux.data b/testing/sisyphus/data/firefox,1.9.1,nightly-linux.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1,nightly-linux.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-trunk/firefox-3.0pre.en-US.linux-i686.tar.bz2
+profilename=firefox-1.9.1-profile
+profiledirectory=/tmp/firefox-1.9.1-profile
+executablepath=/tmp/firefox-1.9.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.9.1,nightly-nt.data b/testing/sisyphus/data/firefox,1.9.1,nightly-nt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1,nightly-nt.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+url=http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-trunk/firefox-3.0pre.en-US.win32.zip
+profilename=firefox-1.9.1-profile
+profiledirectory=/tmp/firefox-1.9.1-profile
+executablepath=/tmp/firefox-1.9.1
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=nightly
diff --git a/testing/sisyphus/data/firefox,1.9.1,opt.data b/testing/sisyphus/data/firefox,1.9.1,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1,opt.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-profile
+profiledirectory=/tmp/firefox-1.9.1-profile
+executablepath=${BUILDDIR}/1.9.1/mozilla/firefox-opt/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=opt
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/firefox,1.9.1,too-much-gc,debug.data b/testing/sisyphus/data/firefox,1.9.1,too-much-gc,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1,too-much-gc,debug.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-too-much-gc-profile
+profiledirectory=/tmp/firefox-1.9.1-too-much-gc-profile
+executablepath=${BUILDDIR}/1.9.1-too-much-gc/mozilla/firefox-debug/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/firefox,1.9.1-actionmonkey,debug.data b/testing/sisyphus/data/firefox,1.9.1-actionmonkey,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1-actionmonkey,debug.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-test-profile
+profiledirectory=/tmp/firefox-1.9.1-test-profile
+executablepath=${BUILDDIR}/1.9.1-test/mozilla/firefox-debug/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/actionmonkey
diff --git a/testing/sisyphus/data/firefox,1.9.1-actionmonkey,opt.data b/testing/sisyphus/data/firefox,1.9.1-actionmonkey,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1-actionmonkey,opt.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-test-profile
+profiledirectory=/tmp/firefox-1.9.1-test-profile
+executablepath=${BUILDDIR}/1.9.1-test/mozilla/firefox-opt/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=opt
+TEST_MOZILLA_HG=http://hg.mozilla.org/actionmonkey
diff --git a/testing/sisyphus/data/firefox,1.9.1-jemalloc,debug.data b/testing/sisyphus/data/firefox,1.9.1-jemalloc,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1-jemalloc,debug.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-jemalloc-profile
+profiledirectory=/tmp/firefox-1.9.1-jemalloc-profile
+executablepath=${BUILDDIR}/1.9.1-jemalloc/mozilla/firefox-debug/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/firefox,1.9.1-jemalloc,opt.data b/testing/sisyphus/data/firefox,1.9.1-jemalloc,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1-jemalloc,opt.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-jemalloc-profile
+profiledirectory=/tmp/firefox-1.9.1-jemalloc-profile
+executablepath=${BUILDDIR}/1.9.1-jemalloc/mozilla/firefox-opt/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=opt
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/firefox,1.9.1-jemalloc-test,debug.data b/testing/sisyphus/data/firefox,1.9.1-jemalloc-test,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1-jemalloc-test,debug.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-jemalloc-test-profile
+profiledirectory=/tmp/firefox-1.9.1-jemalloc-test-profile
+executablepath=${BUILDDIR}/1.9.1-jemalloc-test/mozilla/firefox-debug/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/firefox,1.9.1-jemalloc-test,opt.data b/testing/sisyphus/data/firefox,1.9.1-jemalloc-test,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1-jemalloc-test,opt.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-jemalloc-test-profile
+profiledirectory=/tmp/firefox-1.9.1-jemalloc-test-profile
+executablepath=${BUILDDIR}/1.9.1-jemalloc-test/mozilla/firefox-opt/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=opt
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/firefox,1.9.1-jprof,debug.data b/testing/sisyphus/data/firefox,1.9.1-jprof,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1-jprof,debug.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-jprof-profile
+profiledirectory=/tmp/firefox-1.9.1-jprof-profile
+executablepath=${BUILDDIR}/1.9.1-jprof/mozilla/firefox-debug/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/firefox,1.9.1-jprof,opt.data b/testing/sisyphus/data/firefox,1.9.1-jprof,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1-jprof,opt.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-jprof-profile
+profiledirectory=/tmp/firefox-1.9.1-jprof-profile
+executablepath=${BUILDDIR}/1.9.1-jprof/mozilla/firefox-opt/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=opt
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/firefox,1.9.1-test,debug.data b/testing/sisyphus/data/firefox,1.9.1-test,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1-test,debug.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-test-profile
+profiledirectory=/tmp/firefox-1.9.1-test-profile
+executablepath=${BUILDDIR}/1.9.1-test/mozilla/firefox-debug/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/firefox,1.9.1-test,opt.data b/testing/sisyphus/data/firefox,1.9.1-test,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/firefox,1.9.1-test,opt.data
@@ -0,0 +1,9 @@
+product=firefox
+branch=1.9.1
+profilename=firefox-1.9.1-test-profile
+profiledirectory=/tmp/firefox-1.9.1-test-profile
+executablepath=${BUILDDIR}/1.9.1-test/mozilla/firefox-opt/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+buildtype=opt
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/js,1.9.0-gcov,debug.data b/testing/sisyphus/data/js,1.9.0-gcov,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/js,1.9.0-gcov,debug.data
@@ -0,0 +1,4 @@
+product=js
+branch=1.9.0
+sourcepath=${BUILDDIR}/1.9.0-gcov/mozilla/js/src
+buildtype=debug
diff --git a/testing/sisyphus/data/js,1.9.0-gcov,opt.data b/testing/sisyphus/data/js,1.9.0-gcov,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/js,1.9.0-gcov,opt.data
@@ -0,0 +1,4 @@
+product=js
+branch=1.9.0
+sourcepath=${BUILDDIR}/1.9.0-gcov/mozilla/js/src
+buildtype=opt
diff --git a/testing/sisyphus/data/js,1.9.1,debug.data b/testing/sisyphus/data/js,1.9.1,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/js,1.9.1,debug.data
@@ -0,0 +1,5 @@
+product=js
+branch=1.9.1
+sourcepath=${BUILDDIR}/1.9.1/mozilla/js/src
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/js,1.9.1,opt.data b/testing/sisyphus/data/js,1.9.1,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/js,1.9.1,opt.data
@@ -0,0 +1,5 @@
+product=js
+branch=1.9.1
+sourcepath=${BUILDDIR}/1.9.1/mozilla/js/src
+buildtype=opt
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/js,1.9.1,too-much-gc,debug.data b/testing/sisyphus/data/js,1.9.1,too-much-gc,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/js,1.9.1,too-much-gc,debug.data
@@ -0,0 +1,5 @@
+product=js
+branch=1.9.1
+sourcepath=${BUILDDIR}/1.9.1-too-much-gc/mozilla/js/src
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/js,1.9.1-actionmonkey,debug.data b/testing/sisyphus/data/js,1.9.1-actionmonkey,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/js,1.9.1-actionmonkey,debug.data
@@ -0,0 +1,5 @@
+product=js
+branch=1.9.1
+sourcepath=${BUILDDIR}/1.9.1/mozilla/js/src
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/actionmonkey
diff --git a/testing/sisyphus/data/js,1.9.1-actionmonkey,opt.data b/testing/sisyphus/data/js,1.9.1-actionmonkey,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/js,1.9.1-actionmonkey,opt.data
@@ -0,0 +1,5 @@
+product=js
+branch=1.9.1
+sourcepath=${BUILDDIR}/1.9.1/mozilla/js/src
+buildtype=opt
+TEST_MOZILLA_HG=http://hg.mozilla.org/actionmonkey
diff --git a/testing/sisyphus/data/js,1.9.1-test,debug.data b/testing/sisyphus/data/js,1.9.1-test,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/js,1.9.1-test,debug.data
@@ -0,0 +1,5 @@
+product=js
+branch=1.9.1
+sourcepath=${BUILDDIR}/1.9.1-test/mozilla/js/src
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/js,1.9.1-test,opt.data b/testing/sisyphus/data/js,1.9.1-test,opt.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/js,1.9.1-test,opt.data
@@ -0,0 +1,5 @@
+product=js
+branch=1.9.1
+sourcepath=${BUILDDIR}/1.9.1-test/mozilla/js/src
+buildtype=opt
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/thunderbird,1.9.1,debug.data b/testing/sisyphus/data/thunderbird,1.9.1,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/thunderbird,1.9.1,debug.data
@@ -0,0 +1,10 @@
+product=thunderbird
+branch=1.9.1
+profilename=thunderbird-1.9.1-profile
+profiledirectory=/tmp/thunderbird-1.9.1-profile
+executablepath=${BUILDDIR}/1.9.1/mozilla/thunderbird-debug/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+profiletemplate=${TEST_DIR}/profiles/imap
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
diff --git a/testing/sisyphus/data/thunderbird,1.9.1-test,debug.data b/testing/sisyphus/data/thunderbird,1.9.1-test,debug.data
new file mode 100644
--- /dev/null
+++ b/testing/sisyphus/data/thunderbird,1.9.1-test,debug.data
@@ -0,0 +1,13 @@
+product=thunderbird
+branch=1.9.1
+profilename=thunderbird-1.9.1-test-profile
+profiledirectory=/tmp/thunderbird-1.9.1-test-profile
+executablepath=${BUILDDIR}/1.9.1-test/mozilla/thunderbird-debug/dist
+userpreferences=${TEST_DIR}/prefs/test-user.js
+extensiondir=${TEST_DIR}/xpi
+profiletemplate=${TEST_DIR}/profiles/imap
+buildtype=debug
+TEST_MOZILLA_HG=http://hg.mozilla.org/mozilla-central
+
+
+
diff --git a/testing/sisyphus/tests/mozilla.org/download-page/collect-urls-userhook.js b/testing/sisyphus/tests/mozilla.org/download-page/collect-urls-userhook.js
--- a/testing/sisyphus/tests/mozilla.org/download-page/collect-urls-userhook.js
+++ b/testing/sisyphus/tests/mozilla.org/download-page/collect-urls-userhook.js
@@ -38,34 +38,34 @@ function collectLinks()
   {
   case 'Win32':
     os = 'win';
     break;
   case 'MacPPC':
   case 'MacIntel':
     os = 'osx';
     break;
-  case 'Linux i686':
+  case 'Linux*':
     os = 'linux';
     break;
   default:
     cdump('Error: Unknown OS ' + navigator.platform);
     return;
   }
     
   cdump('document.body: ' + win.document.body.innerHTML);
   var links = win.document.links;
 
   for (var ilink = 0; ilink < links.length; ilink++)
   {
     var link = links[ilink];
-    if (link.href.indexOf('download.html') != -1 && 
+    if (link.href.indexOf('http://download.mozilla.org') != -1 && 
         link.href.indexOf('os=' + os) != -1)
     {
-      var href = 'http://download.mozilla.org/?' + link.href.split('?')[1];
+      var href = link.href;
       cdump('href: ' + href);
     }
   }
 
   gPageCompleted = true;
 }
 
 
diff --git a/testing/sisyphus/tests/mozilla.org/download-page/test.sh b/testing/sisyphus/tests/mozilla.org/download-page/test.sh
--- a/testing/sisyphus/tests/mozilla.org/download-page/test.sh
+++ b/testing/sisyphus/tests/mozilla.org/download-page/test.sh
@@ -85,22 +85,24 @@ fi
 fi
 
 executable=`get_executable $product $branch $executablepath`
 
 urlfile=`mktemp /tmp/URLS.XXXX`
 
 if [[ "$test" == "all" ]]; then
     $TEST_DIR/bin/timed_run.py $TEST_DOWNLOAD_PAGE_TIMEOUT "test download" \
+        $EXECUTABLE_DRIVER \
 	"$executable" -P "$profilename" -spider -start -quit \
 	-uri "$allurl" -timeout=$TEST_DOWNLOAD_PAGE_TIMEOUT \
 	-hook "http://$TEST_HTTP/tests/mozilla.org/download-page/collect-urls-userhook.js" | \
 	grep 'href: ' | sed 's/^href: //' > $urlfile
 elif [[ "$test" == "ftp" ]]; then
     $TEST_DIR/bin/timed_run.py $TEST_DOWNLOAD_PAGE_TIMEOUT "test download" \
+        $EXECUTABLE_DRIVER \
 	"$executable" -P "$profilename" -spider -start -quit \
 	-uri "$allurl" -timeout=$TEST_DOWNLOAD_PAGE_TIMEOUT \
 	-hook "http://$TEST_HTTP/tests/mozilla.org/download-page/userhook-ftp.js" | \
 	grep 'href: ' | sed 's/^href: //' > $urlfile
 fi
 
 cat $urlfile | while read url; do
 
@@ -177,16 +179,17 @@ cat $urlfile | while read url; do
 	-x $downloadexecutablepath \
 	-N $downloadprofilename; then
 	continue
     fi
 
     downloadexecutable=`get_executable $downloadproduct $downloadbranch $downloadexecutablepath`
 
     $TEST_DIR/bin/timed_run.py $TEST_DOWNLOAD_BUILD_TIMEOUT "..." \
+        $EXECUTABLE_DRIVER \
 	"$downloadexecutable" \
 	-spider -P $downloadprofilename \
 	-uri "http://$TEST_HTTP/bin/buildinfo.html" \
 	-hook "http://$TEST_HTTP/tests/mozilla.org/download-page/userhook.js" \
 	-start -quit
 
     if ! uninstall-build.sh  -p "$downloadproduct" -b "$downloadbranch" \
 	-x $downloadexecutablepath; then
diff --git a/toolkit/components/Makefile.in b/toolkit/components/Makefile.in
--- a/toolkit/components/Makefile.in
+++ b/toolkit/components/Makefile.in
@@ -110,22 +110,21 @@ else
 else
 DIRS += passwordmgr
 ifndef MOZ_PLACES
 DIRS +=	history
 endif # MOZ_PLACES
 endif # MOZ_SUITE
 endif # MOZ_THUNDERBIRD
 
-ifndef MOZ_SUITE
-# XXX Suite doesn't want these just yet
+ifndef SUITE_USING_XPFE_DM
 ifdef MOZ_RDF
 DIRS +=	downloads
 endif
-endif # MOZ_SUITE
+endif # SUITE_USING_XPFE_DM
 
 ifdef MOZ_URL_CLASSIFIER
 DIRS += url-classifier
 endif
 
 DIRS += \
 	commandlines \
 	startup \
diff --git a/toolkit/components/build/Makefile.in b/toolkit/components/build/Makefile.in
--- a/toolkit/components/build/Makefile.in
+++ b/toolkit/components/build/Makefile.in
@@ -116,18 +116,17 @@ SHARED_LIBRARY_LIBS += ../parentalcontro
 SHARED_LIBRARY_LIBS += ../parentalcontrols/src/$(LIB_PREFIX)parentalcontrols_s.$(LIB_SUFFIX)
 LOCAL_INCLUDES += \
 	-I$(srcdir)/../parentalcontrols/src \
 	$(NULL)
 REQUIRES += parentalcontrols
 endif
 endif
 
-ifndef MOZ_SUITE
-# XXX Suite isn't ready to build this just yet
+ifndef SUITE_USING_XPFE_DM
 ifdef MOZ_RDF
 SHARED_LIBRARY_LIBS += ../downloads/src/$(LIB_PREFIX)download_s.$(LIB_SUFFIX)
 endif
 endif
 
 ifdef ALERTS_SERVICE
 SHARED_LIBRARY_LIBS += ../alerts/src/$(LIB_PREFIX)alerts_s.$(LIB_SUFFIX)
 endif
diff --git a/toolkit/components/build/nsToolkitCompsModule.cpp b/toolkit/components/build/nsToolkitCompsModule.cpp
--- a/toolkit/components/build/nsToolkitCompsModule.cpp
+++ b/toolkit/components/build/nsToolkitCompsModule.cpp
@@ -44,23 +44,22 @@
 #if defined(XP_WIN) && !defined(MOZ_DISABLE_PARENTAL_CONTROLS)
 #include "nsParentalControlsServiceWin.h"
 #endif
 
 #ifdef ALERTS_SERVICE
 #include "nsAlertsService.h"
 #endif
 
-#ifndef MOZ_SUITE
-// XXX Suite isn't ready to include this just yet
+#ifndef SUITE_USING_XPFE_DM
 #ifdef MOZ_RDF
 #include "nsDownloadManager.h"
 #include "nsDownloadProxy.h"
 #endif
-#endif // MOZ_SUITE
+#endif
 
 #include "nsTypeAheadFind.h"
 
 #ifdef MOZ_URL_CLASSIFIER
 #include "nsUrlClassifierDBService.h"
 #include "nsUrlClassifierStreamUpdater.h"
 #include "nsUrlClassifierUtils.h"
 #include "nsUrlClassifierHashCompleter.h"
@@ -79,24 +78,23 @@ NS_GENERIC_FACTORY_CONSTRUCTOR(nsUserInf
 #if defined(XP_WIN) && !defined(MOZ_DISABLE_PARENTAL_CONTROLS)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsParentalControlsServiceWin)
 #endif
 
 #ifdef ALERTS_SERVICE
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsAlertsService)
 #endif
 
-#ifndef MOZ_SUITE
-// XXX Suite isn't ready to include this just yet
+#ifndef SUITE_USING_XPFE_DM
 #ifdef MOZ_RDF
 NS_GENERIC_FACTORY_SINGLETON_CONSTRUCTOR(nsDownloadManager,
                                          nsDownloadManager::GetSingleton) 
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsDownloadProxy)
 #endif
-#endif // MOZ_SUITE
+#endif
 
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsTypeAheadFind)
 
 #ifdef MOZ_URL_CLASSIFIER
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsUrlClassifierStreamUpdater)
 NS_GENERIC_FACTORY_CONSTRUCTOR_INIT(nsUrlClassifierUtils, Init)
 NS_GENERIC_FACTORY_CONSTRUCTOR_INIT(nsUrlClassifierHashCompleter, Init)
 
@@ -144,29 +142,28 @@ static const nsModuleComponentInfo compo
     nsAlertsServiceConstructor },
 #endif
 #if defined(XP_WIN) && !defined(MOZ_DISABLE_PARENTAL_CONTROLS)
   { "Parental Controls Service",
     NS_PARENTALCONTROLSSERVICE_CID,
     NS_PARENTALCONTROLSSERVICE_CONTRACTID,
     nsParentalControlsServiceWinConstructor },
 #endif
-#ifndef MOZ_SUITE
-// XXX Suite isn't ready to include this just yet
+#ifndef SUITE_USING_XPFE_DM
 #ifdef MOZ_RDF
   { "Download Manager",
     NS_DOWNLOADMANAGER_CID,
     NS_DOWNLOADMANAGER_CONTRACTID,
     nsDownloadManagerConstructor },
   { "Download",
     NS_DOWNLOAD_CID,
     NS_TRANSFER_CONTRACTID,
     nsDownloadProxyConstructor },
 #endif
-#endif // MOZ_SUITE
+#endif
   { "TypeAheadFind Component",
     NS_TYPEAHEADFIND_CID,
     NS_TYPEAHEADFIND_CONTRACTID,
     nsTypeAheadFindConstructor
   },
 #ifdef MOZ_URL_CLASSIFIER
   { "Url Classifier DB Service",
     NS_URLCLASSIFIERDBSERVICE_CID,
diff --git a/toolkit/components/downloads/src/nsDownloadProxy.h b/toolkit/components/downloads/src/nsDownloadProxy.h
--- a/toolkit/components/downloads/src/nsDownloadProxy.h
+++ b/toolkit/components/downloads/src/nsDownloadProxy.h
@@ -42,17 +42,16 @@
 #include "nsIDownloadManager.h"
 #include "nsIPrefBranch.h"
 #include "nsIPrefService.h"
 #include "nsIMIMEInfo.h"
 #include "nsIFileURL.h"
 #include "nsIDownloadManagerUI.h"
 
 #define PREF_BDM_SHOWWHENSTARTING "browser.download.manager.showWhenStarting"
-#define PREF_BDM_USEWINDOW "browser.download.manager.useWindow"
 #define PREF_BDM_FOCUSWHENSTARTING "browser.download.manager.focusWhenStarting"
 
 class nsDownloadProxy : public nsITransfer
 {
 public:
 
   nsDownloadProxy() { }
   virtual ~nsDownloadProxy() { }
@@ -78,21 +77,17 @@ public:
     nsCOMPtr<nsIPrefService> prefs = do_GetService("@mozilla.org/preferences-service;1", &rv);
     NS_ENSURE_SUCCESS(rv, rv);
     nsCOMPtr<nsIPrefBranch> branch = do_QueryInterface(prefs);
 
     PRBool showDM = PR_TRUE;
     if (branch)
       branch->GetBoolPref(PREF_BDM_SHOWWHENSTARTING, &showDM);
 
-    PRBool useWindow = PR_TRUE;
-    if (branch)
-      branch->GetBoolPref(PREF_BDM_USEWINDOW, &useWindow);
-    
-    if (showDM && useWindow) {
+    if (showDM) {
       PRUint32 id;
       mInner->GetId(&id);
 
       nsCOMPtr<nsIDownloadManagerUI> dmui =
         do_GetService("@mozilla.org/download-manager-ui;1", &rv);
       NS_ENSURE_SUCCESS(rv, rv);
 
       PRBool visible;
diff --git a/toolkit/components/microformats/tests/Makefile.in b/toolkit/components/microformats/tests/Makefile.in
--- a/toolkit/components/microformats/tests/Makefile.in
+++ b/toolkit/components/microformats/tests/Makefile.in
@@ -44,12 +44,18 @@ include $(topsrcdir)/config/rules.mk
 include $(topsrcdir)/config/rules.mk
 
 _TEST_FILES = \
 		test_Microformats.html \
 		test_Microformats_hCard.html \
 		test_Microformats_geo.html \
 		test_Microformats_hCalendar.html \
 		test_Microformats_adr.html \
+		test_Microformats_count.html \
+		test_Microformats_getters.html \
+		test_Microformats_negative.html \
+		test_Microformats_add.html \
+		test_framerecursion.html \
+		geo.html \
 		$(NULL)
 
 libs::	$(_TEST_FILES)
-	$(INSTALL) $^ $(DEPTH)/_tests/testing/mochitest/tests/browser/microformats/test
+	$(INSTALL) $^ $(DEPTH)/_tests/testing/mochitest/tests/toolkit/components/microformats/tests
diff --git a/toolkit/components/microformats/tests/geo.html b/toolkit/components/microformats/tests/geo.html
new file mode 100644
--- /dev/null
+++ b/toolkit/components/microformats/tests/geo.html
@@ -0,0 +1,8 @@
+<html>
+  <body>
+    <span class="geo" id="01-geo-abbr-latlong" >
+      <abbr class="latitude" title="37.77">Northern</abbr>
+      <abbr class="longitude" title="-122.41">California</abbr>
+    </span>
+  </body>
+</html>
diff --git a/toolkit/components/microformats/tests/test_Microformats_add.html b/toolkit/components/microformats/tests/test_Microformats_add.html
new file mode 100644
--- /dev/null
+++ b/toolkit/components/microformats/tests/test_Microformats_add.html
@@ -0,0 +1,237 @@
+<html>
+<head>
+  <title>Testing Mixed Up Microformat APIs</title>
+  <script type="text/javascript" src="/MochiKit/MochiKit.js"></script>
+  <script type="text/javascript" src="/tests/SimpleTest/SimpleTest.js"></script>
+  <script type="text/javascript" src="/tests/SimpleTest/EventUtils.js"></script>
+  <link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css"></link>
+</head>
+<body id="contentbody">
+
+  <!-- Parsing tests are well covered, we're going to do some data type stuff
+       here -->
+  <div id="test1">
+    <p class="mftest" id="mftest-version1">
+      <span class="title"><b>Can Really be Anything, even HTML</b></span>
+      <span class="htmlval"><i>foo</i></span>
+      <span class="htmlval">what about just text?</span>
+      <span class="tel">011-23-45-7867-897890</span>
+      <span class="uri">http://www.mozilla.org </span>
+      <span class="email">mailto:joe@nowhere.org</span>
+      <span class="geo">
+        <span class="latitude">0.0</span>
+        <span class="longitude">0.0</span>
+      </span>
+      <span class="date">20080401T235900</span>
+    </p>
+  </div>
+
+  <!-- This one is invalid until we add the new version of the hTest MF -->
+  <div id="test2">
+    <span class="mftest" id="mftest-version2">
+      <abbr class="title" title="<b>Can Really be Anything, even HTML</b>"/>
+      <span class="uri" title="http://www.mozilla.org"/>
+      <abbr class="email" title="joe@nowhere.org">joe's email</ABBR>
+      <span class="geo">
+        <span class="latitude">0.0</span>
+        <span class="longitude">0.0"</span>
+      </span>
+      <!-- Throw a zulu in there! -->
+      <span class="date" title="20080401T235900Z"/>
+    </span>
+  </div>
+
+  <!-- This one is invalid in both versions (no title)-->
+  <div id="test3">
+    <div class="mftest">
+      <abbr class="htmlval" title="what about just text?">more values</abbr>  
+      <span class="uri">http://foo.com</span>
+    </div>
+  </div>
+
+  <!-- Contains an invalid geo -->
+  <div id="test4">
+    <span class="mftest">
+      <abbr class="title" title="<b>Can Really be Anything, even HTML</b>"/>
+      <abbr class="htmlval" title="<html><body>foo</body></html>">
+        An HTML document!
+      </abbr>
+      <abbr class="htmlval" title="what about just text?">more values</abbr>
+      <span class="tel" title="011-23-45-7867-897890"/>
+      <span class="uri" title="http://www.mozilla.org"/>
+      <abbr class="email" title="joe@nowhere.org">joe's email</ABBR>
+      <span class="geo">
+        <span class="latitude">659</span>
+        <span class="longitude">-362.5</span>
+      </span>
+      <span class="date" title="20080401T235900"/>
+    </span>
+  </div>
+
+  <!-- Contains an invalid date -->
+  <div id="test5">
+    <span class="mftest">
+      <abbr class="title htmlval" title="another test">thehtmlvaltodoescapeme</abbr>
+      <abbr class="date" title="200311T032Z">invalid date</abbr>
+    </span>
+  </div>
+
+  <!-- Ok, the test, here we go -->
+  <pre id="test">
+  <script class="testbody" type="text/javascript">
+
+  function hTest(node, validate) {
+    if (node)
+      Microformats.parser.newMicroformat(this, node, "hTest", validate);
+  }
+
+  hTest.prototype.toString = function () {
+    return("This is a test");
+  }
+
+  // Define a new microformat to add to the Microformats collection
+  var hTest_definition = {
+    mfObject: hTest,
+    className: "mftest",
+    required: ["title", "htmlval"],
+    properties: {
+      "title" : {},
+      "htmlval" : {
+        plural: true,
+        datatype: "HTML"
+      },
+      "tel" : {
+        datatype: "tel",
+      },
+      "uri" : {
+        dataypte: "anyURI"
+      },
+      "email" : {
+        datatype: "email"
+      },
+      "geo" : {
+        datatype: "microformat",
+        microformat: "geo"
+      },
+      "date" : {
+        datatype: "dateTime",
+      }
+    }
+  };
+
+  // Define another version of this microformat to overwrite it - this one
+  // removes the requirement to have a htmlval and also removes the tel prop.
+  var hTest_definition2 = {
+    mfObject: hTest,
+    className: "mftest",
+    required: ["title"],
+    properties: {
+      "title" : {},
+      "htmlval" : {
+        plural: true,
+        datatype: "HTML"
+      },
+      "uri" : {
+        dataypte: "anyURI"
+      },
+      "email" : {
+        datatype: "email"
+      },
+      "geo" : {
+        datatype: "microformat",
+        microformat: "geo"
+      },
+      "date" : {
+        datatype: "dateTime",
+      }
+    }
+  };
+  test_MicroformatsAPI();
+
+  function doTest3_4_and5() {
+    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
+    ok(Microformats, "Make sure we still have a microformats object");
+
+    var mfs = Microformats.get("hTest",
+                               document.getElementById("test3"),
+                               {recurseExternalFrames: true});
+
+    is(mfs.length, 0, "Check hTest 3 is invalid");
+
+    mfs = Microformats.get("hTest",
+                            document.getElementById("test4"),
+                            {recurseExternalFrames: true});
+
+    is(mfs.length, 1, "Check hTest 4 is valid");
+    // Test 4 is a valid hTest, but it's embedded Geo is invalid,
+    // test that assumption
+    ok(!(mfs.geo), "Ensure that the test 4 geo is reporting as invalid");
+
+    mfs = Microformats.get("hTest",
+                            document.getElementById("test5"),
+                            {recurseExternalFrames: true});
+    is(mfs.length, 1, "Check hTest 5 is valid");
+
+    try {
+      var jsDate = new Date(Microformats.parser.dateFromISO8601(mfs[0].date));
+      ok(false, "Invalid JS Date should throw");
+    } catch (ex) {
+      ok(true, "Check that getting invalid jsdate throws");
+    }
+  }
+
+  function test_MicroformatsAPI() {
+    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
+    Components.utils.import("resource://gre/modules/Microformats.js");
+
+    // Make sure they aren't microformats yet
+    is(Microformats.isMicroformat(document.getElementById("mftest-version1")),
+       false, "Check that the mfTest microformat does not exist yet");
+
+    try {
+      Microformats.add("hTest", hTest_definition);
+    } catch (ex) {
+      ok(false, "Threw while adding hTest definition 1");
+    }
+
+    ok(Microformats.isMicroformat(document.getElementById("mftest-version1")),
+       "Check that the mfTest microformat now exists");
+
+    var mf = Microformats.get("hTest", document.getElementById("test1"),
+                              {recurseExternalFrames: true});
+
+    is(mf.length, 1, "Check that test1 is a valid microformat");
+    is(mf[0].title, "Can Really be Anything, even HTML", "Check test1 title");
+
+    is(mf[0].geo.latitude, 0.0, "Check test1 geo");
+
+    // Make sure that our test2 doesn't pass validation until we add
+    // version 2 of the hTest microformat
+    var mf2 = Microformats.get("hTest", document.getElementById("test2"), {});
+    is(mf2.length, 0, "Check that the mfTest microformat version 2 is not a MF");
+
+    doTest3_4_and5(false);
+
+    // Ok, add the version 2 hTest
+    try {
+      Microformats.add("hTest", hTest_definition2);
+    } catch (ex) {
+      ok(false, "Threw while adding hTest definition 2");
+    }
+
+    // The old version's microformat is still valid
+    mf = Microformats.get("hTest", document.getElementById("test1"),
+                          {recurseExternalFrames: true});
+
+    ok(mf.length, 1, "Check that test1 is a valid microformat");
+
+    // Verify that the version 2 microformat is now also considered valid
+    var mf2 = Microformats.get("hTest", document.getElementById("test2"), {});
+
+    ok(mf2.length, 1, "Check that the mfTest microformat version 2 is now valid");
+    doTest3_4_and5(true);
+  }
+
+  </script>
+</body>
+</html>
diff --git a/toolkit/components/microformats/tests/test_Microformats_count.html b/toolkit/components/microformats/tests/test_Microformats_count.html
new file mode 100644
--- /dev/null
+++ b/toolkit/components/microformats/tests/test_Microformats_count.html
@@ -0,0 +1,155 @@
+<html>
+<head>
+  <title>Testing Mixed Up Microformat APIs</title>
+  <script type="text/javascript" src="/MochiKit/MochiKit.js"></script>
+  <script type="text/javascript" src="/tests/SimpleTest/SimpleTest.js"></script>
+  <script type="text/javascript" src="/tests/SimpleTest/EventUtils.js"></script>
+  <link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css"></link>
+</head>
+<body id="contentbody">
+  <!-- hCard -->
+  <p class="vcard" id="23-abbr-title-everything">
+<!-- perhaps the most annoying test ever -->
+    <abbr class="fn" title="John Doe">foo</abbr>
+    <span class="n">
+      <abbr class="honorific-prefix" title="Mister">Mr.</abbr>
+      <abbr class="given-name" title="Jonathan">John</abbr>
+      <abbr class="additional-name" title="John">J</abbr>
+      <abbr class="family-name" title="Doe-Smith">Doe</abbr>
+      <abbr class="honorific-suffix" title="Medical Doctor">M.D</abbr>
+    </span>
+    <abbr class="nickname" title="JJ">jj</abbr>
+    <abbr class="bday" title="2006-04-04">April 4, 2006</abbr>
+    <span class="adr">
+      <abbr class="post-office-box" title="Box 1234">B. 1234</abbr>
+      <abbr class="extended-address" title="Suite 100">Ste. 100</abbr>
+      <abbr class="street-address" title="123 Fake Street">123 Fake St.</abbr>
+      <abbr class="locality" title="San Francisco">San Fran</abbr>
+      <abbr class="region" title="California">CA</abbr>
+      <abbr class="postal-code" title="12345-6789">12345</abbr>
+      <abbr class="country-name" title="United States of America">USA</abbr>
+      <abbr class="type" title="work">workplace</abbr>
+    </span>
+    <abbr class="tel" title="415.555.1234">1234</abbr>
+    <abbr class="tel-type-value" title="work">workplace</abbr>
+<!--       mailer  -->
+    <abbr class="tz" title="-0700">Pacific Time</abbr>
+    <span class="geo">
+      <abbr class="latitude" title="37.77">Northern</abbr>
+      <abbr class="longitude" title="-122.41">California</abbr>
+    </span>
+    <abbr class="title" title="President">pres.</abbr> and
+    <abbr class="role" title="Chief">cat wrangler</abbr>
+<!--       <span class="agent"></span> -->
+    <span class="org">
+      <abbr class="organization-name" title="Intellicorp">foo</abbr>
+      <abbr class="organization-unit" title="Intelligence">bar</abbr>
+    </span>
+<!--       <abbr class="category" title=""></abbr> -->
+    <abbr class="note" title="this is a note">this is not a note</abbr>
+<!--       <abbr class="rev" title=""></abbr>  (revision datetime) -->
+<!--       <abbr class="sort-string" title=""></abbr> -->
+    <abbr class="uid" title="abcdefghijklmnopqrstuvwxyz">alpha</abbr>
+    <abbr class="class" title="public">pub</abbr>
+<!--       <abbr class="key" title=""></abbr> -->
+  </p>
+
+  <!-- hCalendar -->
+  <frameset>
+    <frame id="frame1">
+      <div>
+        <span class="notAMicroformat" id="notme">
+          <abbr> class="foo">I am not a microformat</abbr>
+          <abbr> class="title">Foolish title, not a format</abbr>
+        </span>
+      </div>
+    </frame>
+    <frame id="frame3">
+      <span class="geo" id="02-geo-abbr-latlong" >
+        <abbr class="latitude" title="75.77">Far Northern</abbr>
+        <abbr class="longitude" title="-122.41">Canada</abbr>
+      </span>
+    <frame id="frame2">
+      <div class="vcalendar">
+        <span class="vevent" id="15-calendar-xml-lang">
+          <a class="url" href="http://www.web2con.com/">
+          <span class="summary">Web 2.0 Conference</span>: 
+          <abbr class="dtstart" title="2005-10-05">October 5</abbr>-
+          <abbr class="dtend" title="2005-10-08">7</abbr>,
+          at the <span class="location">Argent Hotel, San Francisco, CA</span>
+          </a>
+        </span>
+      </div>
+    </frame>
+  </frameset>
+
+  <!-- Geo Fire the test from here so we know this is loaded at the outset -->
+  <iframe src="geo.html" onload="test_MicroformatsAPI();">
+  </iframe>
+
+  <!-- adr -->
+  <div class="adr" id="01-extended-address">
+    <span class="extended-address">Park Bench</span>
+  </div>
+  <!-- Ok, the test, here we go -->
+  <pre id="test">
+  <script class="testbody" type="text/javascript">
+
+  // Called from the onload of the iframe
+  function test_MicroformatsAPI() {
+    // I'm going to try to do this without getting XPConnect priv's, make sure
+    // we throw
+    try {
+      Components.utils.import("resource://gre/modules/Microformats.js");
+      ok(false, "Should not execute this code");
+    } catch(ex) {
+      ok(true, "Expected exception");
+    }
+
+    // Gonna do things the right way
+    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
+    Components.utils.import("resource://gre/modules/Microformats.js");
+
+    // Test Microformat frame recursion - start with counting
+    var count = Microformats.count("adr",
+                                   document.getElementById("contentbody"),
+                                   {recurseExternalFrames: false}, // do not recurse frames
+                                   0);    // current count
+    is(count, 2, "No frame recursion, finds 2 adr's (none in frames)");
+
+    // Try it with frame recursion
+    count = Microformats.count("adr",
+                               document.getElementById("contentbody"),
+                               {recurseExternalFrames: true},
+                               count);
+    // Should still find 2
+    is(count, 2, "Only 2 adr nodes, even when recursing frames");
+
+    // Since "recurseExternalFrames" only affects the external frames, the microformat
+    // in the <frameset> will always be counted.
+    count = Microformats.count("geo",
+                              document.getElementById("contentbody"),
+                              {recurseExternalFrames: false},
+                              0);
+    is(count, 2, "Should find two geo if we don't recurse external frames");
+
+    count = Microformats.count("geo",
+                              document.getElementById("contentbody"),
+                              {recurseExternalFrames: true},
+                              0);
+    is(count, 3, "Three geos,one outside, one in a frameset, and one in iframe");
+
+    count = Microformats.count("hCalendar",
+                               document.getElementById("contentbody"),
+                               {recurseExternalFrames: true},
+                               0);
+    is(count, 1, "One hCalendar");
+
+    count = Microformats.count("hCard",
+                               document.getElementById("contentbody"),
+                               {recurseExternalFrames: true});
+    is(count, 1, "One hCard");
+  }
+  </script>
+</body>
+</html>
diff --git a/toolkit/components/microformats/tests/test_Microformats_getters.html b/toolkit/components/microformats/tests/test_Microformats_getters.html
new file mode 100644
--- /dev/null
+++ b/toolkit/components/microformats/tests/test_Microformats_getters.html
@@ -0,0 +1,158 @@
+<html>
+<head>
+  <title>Testing Mixed Up Microformat APIs</title>
+  <script type="text/javascript" src="/MochiKit/MochiKit.js"></script>
+  <script type="text/javascript" src="/tests/SimpleTest/SimpleTest.js"></script>
+  <script type="text/javascript" src="/tests/SimpleTest/EventUtils.js"></script>
+  <link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css"></link>
+</head>
+<body id="contentbody">
+  <div id="content">
+    <!-- hCard -->
+    <p class="vcard" id="23-abbr-title-everything">
+      <!-- perhaps the most annoying test ever -->
+      <abbr class="fn" title="John Doe">foo</abbr>
+      <span class="n">
+        <abbr class="honorific-prefix" title="Mister">Mr.</abbr>
+        <abbr class="given-name" title="Jonathan">John</abbr>
+        <abbr class="additional-name" title="John">J</abbr>
+        <abbr class="family-name" title="Doe-Smith">Doe</abbr>
+        <abbr class="honorific-suffix" title="Medical Doctor">M.D</abbr>
+      </span>
+      <abbr class="nickname" title="JJ">jj</abbr>
+      <abbr class="bday" title="2006-04-04">April 4, 2006</abbr>
+      <span class="adr">
+        <abbr class="post-office-box" title="Box 1234">B. 1234</abbr>
+        <abbr class="extended-address" title="Suite 100">Ste. 100</abbr>
+        <abbr class="street-address" title="123 Fake Street">123 Fake St.</abbr>
+        <abbr class="locality" title="San Francisco">San Fran</abbr>
+        <abbr class="region" title="California">CA</abbr>
+        <abbr class="postal-code" title="12345-6789">12345</abbr>
+        <abbr class="country-name" title="United States of America">USA</abbr>
+        <abbr class="type" title="work">workplace</abbr>
+      </span>
+      <abbr class="tel" title="415.555.1234">1234</abbr>
+      <abbr class="tel-type-value" title="work">workplace</abbr>
+  <!--       mailer  -->
+      <abbr class="tz" title="-0700">Pacific Time</abbr>
+      <span class="geo">
+        <abbr class="latitude" title="37.77">Northern</abbr>
+        <abbr class="longitude" title="-122.41">California</abbr>
+      </span>
+      <abbr class="title" title="President">pres.</abbr> and
+      <abbr class="role" title="Chief">cat wrangler</abbr>
+  <!--       <span class="agent"></span> -->
+      <span class="org">
+        <abbr class="organization-name" title="Intellicorp">foo</abbr>
+        <abbr class="organization-unit" title="Intelligence">bar</abbr>
+      </span>
+  <!--       <abbr class="category" title=""></abbr> -->
+      <abbr class="note" title="this is a note">this is not a note</abbr>
+  <!--       <abbr class="rev" title=""></abbr>  (revision datetime) -->
+  <!--       <abbr class="sort-string" title=""></abbr> -->
+      <abbr class="uid" title="abcdefghijklmnopqrstuvwxyz">alpha</abbr>
+      <abbr class="class" title="public">pub</abbr>
+  <!--       <abbr class="key" title=""></abbr> -->
+    </p>
+
+    <!-- hCalendar -->
+    <frameset>
+      <frame id="frame1">
+        <div>
+          <span class="notAMicroformat" id="notme">
+            <abbr> class="foo">I am not a microformat</abbr>
+            <abbr> class="title">Foolish title, not a format</abbr>
+          </span>
+        </div>
+      </frame>
+      <frame id="frame3">
+        <span class="geo" id="02-geo-abbr-latlong" >
+          <abbr class="latitude" title="75.77">Far Northern</abbr>
+          <abbr class="longitude" title="-122.41">Canada</abbr>
+        </span>
+      <frame id="frame2">
+        <div class="vcalendar">
+          <span class="vevent" id="15-calendar-xml-lang">
+            <a class="url" href="http://www.web2con.com/">
+            <span class="summary">Web 2.0 Conference</span>: 
+            <abbr class="dtstart" title="2005-10-05">October 5</abbr>-
+            <abbr class="dtend" title="2005-10-08">7</abbr>,
+            at the <span class="location">Argent Hotel, San Francisco, CA</span>
+            </a>
+          </span>
+        </div>
+      </frame>
+    </frameset>
+
+    <div id="secondnode">
+      <span>some interesting content</span>
+
+      <!-- Geo Fire test once we know this is loaded.-->
+      <iframe src="geo.html" onload="test_MicroformatsAPI();">
+      </iframe>
+
+      <!-- adr -->
+      <div class="adr" id="01-extended-address">
+        <span class="extended-address">Park Bench</span>
+      </div>
+
+      <div class="vcalendar">
+        <span class="vevent" id="16-calendar-xml-lang">
+          <a class="url" href="http://www.foo.com/">
+          <span class="summary">Pseudo Conference</span>: 
+          <abbr class="dtstart" title="2008-04-01">April 1</abbr>-
+          <abbr class="dtend" title="2008-04-03">April 3</abbr>,
+          at the <span class="location">Argent Hotel, San Francisco, CA</span>
+          </a>
+        </span>
+      </div>
+    </div>
+  </div>
+  <!-- Ok, the test, here we go -->
+  <pre id="test">
+  <script class="testbody" type="text/javascript">
+
+  // Called from onload in iframe
+  function test_MicroformatsAPI() {
+    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
+    Components.utils.import("resource://gre/modules/Microformats.js");
+
+    // Test that we can get them all
+    var mfs = [];
+    mfs = Microformats.get("adr",
+                           document.getElementById("content"),
+                           {showHidden: true});
+
+    is(mfs.length, 2, "Two adr's in our array");
+
+    mfs = Microformats.get("geo",
+                           document.getElementById("content"),
+                           {recurseExternalFrames: true});
+    is(mfs.length, 3, "Three geo's in our array");
+
+    mfs = Microformats.get("hCalendar",
+                            document.getElementById("content"),
+                            {recurseExternalFrames: false});
+    // Should get the hCalendar whether we recurseExternalFrames or not.
+    is(mfs.length, 2, "Two hCalendar returned not recursing frames");
+
+    mfs = Microformats.get("hCalendar",
+                           document.getElementById("content"),
+                           {recurseExternalFrames: true});
+    is(mfs.length, 2, "Two hCalendars returned recursing frames");
+
+    mfs = Microformats.get("hCard",
+                           document.getElementById("content"),
+                           {recurseExternalFrames: true},
+                           mfs);
+    is(mfs.length, 3, "Two hCalendars and one hCard");
+
+    mfs = Microformats.get("hCalendar", document.getElementById("secondnode"));
+
+    is(mfs[0].summary, "Pseudo Conference", 
+       "Make sure we get the proper hCalendar from the second level node");
+    is(mfs.length, 1, "And we should only get one hCalendar not two from this node.");
+  }
+  </script>
+</body>
+</html>
diff --git a/toolkit/components/microformats/tests/test_Microformats_negative.html b/toolkit/components/microformats/tests/test_Microformats_negative.html
new file mode 100644
--- /dev/null
+++ b/toolkit/components/microformats/tests/test_Microformats_negative.html
@@ -0,0 +1,114 @@
+<html>
+<head>
+  <title>Testing Mixed Up Microformat APIs</title>
+  <script type="text/javascript" src="/MochiKit/MochiKit.js"></script>
+  <script type="text/javascript" src="/tests/SimpleTest/SimpleTest.js"></script>
+  <script type="text/javascript" src="/tests/SimpleTest/EventUtils.js"></script>
+  <link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css"></link>
+</head>
+<body id="contentbody">
+  <div id="testhere">
+    <!-- Frames -->
+    <frameset>
+      <frame id="frame1">
+        <div>
+          <span class="notAMicroformat" id="notme">
+            <abbr> class="foo">I am not a microformat</abbr>
+            <abbr> class="title">Foolish title, not a format</abbr>
+          </span>
+        </div>
+      </frame>
+      <frame id="frame2">
+        <div class="vcalendar">
+          <span class="vevent" id="15-calendar-xml-lang">
+            <a class="url" href="http://www.web2con.com/">
+            <span class="summary">Web 2.0 Conference</span>: 
+            <abbr class="dtend" title="2005-10-08">7</abbr>,
+            at the <span class="location">Argent Hotel, San Francisco, CA</span>
+            </a>
+          </span>
+        </div>
+      </frame>
+    </frameset>
+  </div>
+
+  <div id="content">
+    <!-- some really messed up markup-->
+    <p class="vcard" id="23-abbr-title-everything">
+      <div id="random div no ending div either">
+      <abbr class="fn" title="John Doe">foo</abbr>
+      <span class="n"/>
+      <abbr class="foo" title="JJ">jj</abbr>
+      <abbr class="free" title="2006-04-04">April 4, 2006</abbr>
+      <span class="adr">
+        <abbr class="invalid" title="Box 1234">B. 1234</abbr>
+        <abbr class="extended-address" title="Suite 100">Ste. 100</abbr>
+        <abbr class="street-address" title="123 Fake Street"/>
+        <abbr class="locality" title="San Francisco">San Fran</abbr>
+        <abbr class="region" title="California">CA</abbr>
+        <abbr class="postal-code" title="12345-6789">12345</abbr>
+        <abbr class="country-name" title="United States of America">USA</abbr>
+        <abbr class="typo" titl="work">workplace</abbr>
+      </span>
+      <span class="org">
+        <abbr class="organization-name" title="Intellicorp">foo</abbr>
+        <abbr class="organization-unit" title="Intelligence">bar</abbr>
+  <!--       <abbr class="category" title=""></abbr> -->
+      <abbr class="note" title="this is a note">this is not a note</abbr>
+  <!--       <abbr class="rev" title=""></abbr>  (revision datetime) -->
+  <!--       <abbr class="sort-string" title=""></abbr> -->
+      <abbr class="uid" title="abcdefghijklmnopqrstuvwxyz">alpha</abbr>
+      <abbr class="class" title="public">pub</abbr>
+  <!--       <abbr class="key" title=""></abbr> -->
+      </span>
+
+  <!-- Ok, the test, here we go -->
+  <pre id="test">
+  <script class="testbody" type="text/javascript">
+
+  test_MicroformatsAPI();
+
+  function test_MicroformatsAPI() {
+    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
+    Components.utils.import("resource://gre/modules/Microformats.js");
+
+    // Test to see if we can get the invalid vcard
+    var mfs = Microformats.get("hCard",
+                               document.getElementById("content"),
+                               { });
+
+    is(mfs.length, 0, "Check that we can't get invalid vcard");
+
+    // Invalid hCalendar - doesn't have a dtstart
+    mfs = Microformats.get("hCalendar",
+                           document.getElementById("testhere"),
+                           {recurseExternalFrames: true});
+    is(mfs.length, 0, "Check that we don't pick up invalid MFs.");
+
+    mfs = Microformats.get("notAMicroformat",
+                           document.getElementById("testhere"),
+                           {recurseExternalFrames: true});
+
+    is(mfs, null, "No microformat called notAMicroformat");
+
+    // What if we try another way?
+    is(Microformats.isMicroformat(document.getElementById("notme")), false,
+       "Check that the NotAMicroformat is still not a microformat");
+
+    // Attempt to physically add one to the object
+    try {
+      Microformats.push("notAMicroformat");
+    } catch (ex) {
+      ok(true, "Check thrown exception when adding to microformats object");
+    }
+
+    // Attempt to delete one from the object
+    try {
+      Microformats.pop();
+    } catch (ex) {
+      ok(true, "Check that exception thrown when removing items from Microformats");
+    }
+  }
+  </script>
+</body>
+</html>
diff --git a/toolkit/components/microformats/tests/test_framerecursion.html b/toolkit/components/microformats/tests/test_framerecursion.html
new file mode 100644
--- /dev/null
+++ b/toolkit/components/microformats/tests/test_framerecursion.html
@@ -0,0 +1,66 @@
+<!-- Demonstrates that we are always counting MF's in a <frame> tag, and NEVER
+     counting MF's in an <iframe> regardless of what the "frame recursion" bit
+     is set to. -->
+<html>
+<head>
+  <title>Testing Mixed Up Microformat APIs</title>
+  <script type="text/javascript" src="/MochiKit/MochiKit.js"></script>
+  <script type="text/javascript" src="/tests/SimpleTest/SimpleTest.js"></script>
+  <script type="text/javascript" src="/tests/SimpleTest/EventUtils.js"></script>
+  <link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css"></link>
+</head>
+<body id="contentbody">
+
+  <frameset>
+    <frame id="frame1">
+      <div>
+        <span class="notAMicroformat" id="notme">
+          <abbr class="foo">I am not a microformat</abbr>
+          <abbr class="title">Foolish title, not a format</abbr>
+        </span>
+      </div>
+    </frame>
+    <frame id="frame3">
+      <span class="geo" id="02-geo-abbr-latlong" >
+        <abbr class="latitude" title="75.77">Far Northern</abbr>
+        <abbr class="longitude" title="-122.41">Canada</abbr>
+      </span>
+    </frame>
+    <frame id="frame2">
+      <div class="stuff">
+        <span>Testing is Fun!</span>
+      </div>
+    </frame>
+  </frameset>
+
+  <!-- Geo -->
+  <iframe id="iframe" src="geo.html" onload="onLoad();">
+  </iframe>
+
+  <!-- Ok, the test, here we go -->
+  <pre id="test">
+  <script class="testbody" type="text/javascript">
+
+  // Start the test once the iFrame loads
+  function onLoad() {
+    test_MicroformatsAPI();
+  }
+
+  function test_MicroformatsAPI() {
+    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
+    Components.utils.import("resource://gre/modules/Microformats.js");
+
+    count = Microformats.count("geo",
+                              document.getElementById("contentbody"),
+                              {recurseExternalFrames: false},
+                              0);
+    is(count, 1, "Only one geo - we don't count external frames");
+
+    count = Microformats.count("geo",
+                              document.getElementById("contentbody"),
+                              {recurseExternalFrames: true});
+    is(count, 2, "Two Geo's - one in frame and one in iframe");
+  }
+  </script>
+</body>
+</html>
diff --git a/toolkit/components/url-classifier/content/url-crypto-key-manager.js b/toolkit/components/url-classifier/content/url-crypto-key-manager.js
--- a/toolkit/components/url-classifier/content/url-crypto-key-manager.js
+++ b/toolkit/components/url-classifier/content/url-crypto-key-manager.js
@@ -253,32 +253,37 @@ PROT_UrlCryptoKeyManager.prototype.dropK
 
 /**
  * @returns Boolean indicating if we have a key we can use 
  */
 PROT_UrlCryptoKeyManager.prototype.hasKey = function() {
   return this.clientKey_ != null && this.wrappedKey_ != null;
 }
 
+PROT_UrlCryptoKeyManager.prototype.unUrlSafe = function(key)
+{
+    return key.replace("-", "+").replace("_", "/");
+}
+
 /**
  * Set a new key and serialize it to disk.
  *
  * @param clientKey String containing the base64-encoded client key 
  *                  we wish to use
  *
  * @param wrappedKey String containing the opaque base64-encoded WrappedKey
  *                   the server gave us (i.e., K_C encrypted with K_S)
  */
 PROT_UrlCryptoKeyManager.prototype.replaceKey_ = function(clientKey, 
                                                           wrappedKey) {
   if (this.clientKey_)
     G_Debug(this, "Replacing " + this.clientKey_ + " with " + clientKey);
 
   this.clientKey_ = clientKey;
-  this.clientKeyArray_ = Array.map(atob(clientKey),
+  this.clientKeyArray_ = Array.map(atob(this.unUrlSafe(clientKey)),
                                    function(c) { return c.charCodeAt(0); });
   this.wrappedKey_ = wrappedKey;
 
   this.serializeKey_(this.clientKey_, this.wrappedKey_);
 
   if (this.onNewKey_) {
     this.onNewKey_();
   }
diff --git a/toolkit/crashreporter/client/crashreporter.cpp b/toolkit/crashreporter/client/crashreporter.cpp
--- a/toolkit/crashreporter/client/crashreporter.cpp
+++ b/toolkit/crashreporter/client/crashreporter.cpp
@@ -495,21 +495,29 @@ int main(int argc, char** argv)
 
     if (queryParameters.find("ServerURL") == queryParameters.end()) {
       UIError(gStrings[ST_ERROR_NOSERVERURL]);
       return 0;
     }
 
     // Hopefully the settings path exists in the environment. Try that before
     // asking the platform-specific code to guess.
+#ifdef XP_WIN32
+    static const wchar_t kDataDirKey[] = L"MOZ_CRASHREPORTER_DATA_DIRECTORY";
+    const wchar_t *settingsPath = _wgetenv(kDataDirKey);
+    if (settingsPath && *settingsPath) {
+      gSettingsPath = WideToUTF8(settingsPath);
+    }
+#else
     static const char kDataDirKey[] = "MOZ_CRASHREPORTER_DATA_DIRECTORY";
     const char *settingsPath = getenv(kDataDirKey);
     if (settingsPath && *settingsPath) {
       gSettingsPath = settingsPath;
     }
+#endif
     else {
       string product = queryParameters["ProductName"];
       string vendor = queryParameters["Vendor"];
       if (!UIGetSettingsPath(vendor, product, gSettingsPath)) {
         gSettingsPath.clear();
       }
     }
 
diff --git a/toolkit/crashreporter/client/crashreporter_osx.h b/toolkit/crashreporter/client/crashreporter_osx.h
--- a/toolkit/crashreporter/client/crashreporter_osx.h
+++ b/toolkit/crashreporter/client/crashreporter_osx.h
@@ -127,14 +127,15 @@
   NSAttributedString *mPlaceHolderString;
 }
 
 - (BOOL)becomeFirstResponder;
 - (void)drawRect:(NSRect)rect;
 - (BOOL)resignFirstResponder;  
 - (void)setPlaceholder:(NSString*)placeholder;
 - (void)insertTab:(id)sender;
+- (void)insertBacktab:(id)sender;
 - (void)setEnabled:(BOOL)enabled;
 - (void)dealloc;
 
 @end
 
 #endif
diff --git a/toolkit/crashreporter/client/crashreporter_osx.mm b/toolkit/crashreporter/client/crashreporter_osx.mm
--- a/toolkit/crashreporter/client/crashreporter_osx.mm
+++ b/toolkit/crashreporter/client/crashreporter_osx.mm
@@ -672,16 +672,21 @@ static bool RestartApplication()
 }
 
 - (void)insertTab:(id)sender
 {
   // don't actually want to insert tabs, just tab to next control
   [[self window] selectNextKeyView:sender];
 }
 
+- (void)insertBacktab:(id)sender
+{
+  [[self window] selectPreviousKeyView:sender];
+}
+
 - (void)setEnabled:(BOOL)enabled
 {
   [self setSelectable:enabled];
   [self setEditable:enabled];
   if (![[self string] isEqualToString:@""]) {
     NSAttributedString* colorString;
     NSColor* txtColor;
     if (enabled)
diff --git a/toolkit/crashreporter/nsExceptionHandler.cpp b/toolkit/crashreporter/nsExceptionHandler.cpp
--- a/toolkit/crashreporter/nsExceptionHandler.cpp
+++ b/toolkit/crashreporter/nsExceptionHandler.cpp
@@ -603,37 +603,41 @@ nsresult SetupExtraData(nsILocalFile* aA
   rv = dataDirectory->Exists(&exists);
   NS_ENSURE_SUCCESS(rv, rv);
 
   if (!exists) {
     rv = dataDirectory->Create(nsIFile::DIRECTORY_TYPE, 0700);
     NS_ENSURE_SUCCESS(rv, rv);
   }
 
-  // Save this path in the environment for the crash reporter application.
-  nsCAutoString dataDirEnv("MOZ_CRASHREPORTER_DATA_DIRECTORY=");
+#if defined(XP_WIN32)
+  nsAutoString dataDirEnv(NS_LITERAL_STRING("MOZ_CRASHREPORTER_DATA_DIRECTORY="));
 
-#if defined(XP_WIN32)
   nsAutoString dataDirectoryPath;
   rv = dataDirectory->GetPath(dataDirectoryPath);
   NS_ENSURE_SUCCESS(rv, rv);
 
-  AppendUTF16toUTF8(dataDirectoryPath, dataDirEnv);
+  dataDirEnv.Append(dataDirectoryPath);
+
+  _wputenv(dataDirEnv.get());
 #else
+  // Save this path in the environment for the crash reporter application.
+  nsCAutoString dataDirEnv("MOZ_CRASHREPORTER_DATA_DIRECTORY=");
+
   nsCAutoString dataDirectoryPath;
   rv = dataDirectory->GetNativePath(dataDirectoryPath);
   NS_ENSURE_SUCCESS(rv, rv);
 
   dataDirEnv.Append(dataDirectoryPath);
-#endif
 
   char* env = ToNewCString(dataDirEnv);
   NS_ENSURE_TRUE(env, NS_ERROR_OUT_OF_MEMORY);
 
   PR_SetEnv(env);
+#endif
 
   nsCAutoString data;
   if(NS_SUCCEEDED(GetOrInit(dataDirectory, NS_LITERAL_CSTRING("UserID"),
                             data, InitUserID)))
     AnnotateCrashReport(NS_LITERAL_CSTRING("UserID"), data);
 
   if(NS_SUCCEEDED(GetOrInit(dataDirectory,
                             NS_LITERAL_CSTRING("InstallTime") + aBuildID,
diff --git a/toolkit/library/Makefile.in b/toolkit/library/Makefile.in
--- a/toolkit/library/Makefile.in
+++ b/toolkit/library/Makefile.in
@@ -163,23 +163,16 @@ CPPSRCS += \
 CPPSRCS += \
 	$(RDF_UTIL_SRC_LCPPSRCS) \
 	$(NULL)
 
 GARBAGE += \
 	$(RDF_UTIL_SRC_LCPPSRCS) \
 	$(NULL)
 endif
-else
-ifdef NS_TRACE_MALLOC
-# In libxul builds, tracemalloc is part of libxul instead.
-ifndef MOZ_ENABLE_LIBXUL
-EXTRA_DSO_LIBS += tracemalloc
-endif
-endif
 endif
 
 ifneq (,$(filter OS2 WINCE WINNT,$(OS_ARCH)))
 SDK_LIBRARY = $(IMPORT_LIBRARY)
 else
 SDK_LIBRARY = $(SHARED_LIBRARY)
 endif
 
diff --git a/toolkit/library/libxul-config.mk b/toolkit/library/libxul-config.mk
--- a/toolkit/library/libxul-config.mk
+++ b/toolkit/library/libxul-config.mk
@@ -342,12 +342,8 @@ endif
 
 ifneq (,$(filter layout-debug,$(MOZ_EXTENSIONS)))
 COMPONENT_LIBS += gkdebug
 endif
 
 ifdef GC_LEAK_DETECTOR
 EXTRA_DSO_LIBS += boehm
 endif
-
-ifdef NS_TRACE_MALLOC
-STATIC_LIBS += tracemalloc
-endif
diff --git a/toolkit/locales/en-US/chrome/mozapps/xpinstall/xpinstallConfirm.dtd b/toolkit/locales/en-US/chrome/mozapps/xpinstall/xpinstallConfirm.dtd
--- a/toolkit/locales/en-US/chrome/mozapps/xpinstall/xpinstallConfirm.dtd
+++ b/toolkit/locales/en-US/chrome/mozapps/xpinstall/xpinstallConfirm.dtd
@@ -1,9 +1,9 @@
 <!-- extracted from institems.xul -->
 
 <!ENTITY dialog.title            "Software Installation">
 <!ENTITY dialog.style            "width: 45em">
-<!ENTITY warningMain.label       "Only install add-ons from authors whom you trust.">
+<!ENTITY warningPrimary.label    "Install add-ons only from authors whom you trust.">
 <!ENTITY warningSecondary.label  "Malicious software can damage your computer or violate your privacy.">
 
 <!ENTITY from.label "from:">
 
diff --git a/toolkit/mozapps/downloads/Makefile.in b/toolkit/mozapps/downloads/Makefile.in
--- a/toolkit/mozapps/downloads/Makefile.in
+++ b/toolkit/mozapps/downloads/Makefile.in
@@ -37,16 +37,15 @@
 
 DEPTH   = ../../..
 topsrcdir = @top_srcdir@
 srcdir    = @srcdir@
 VPATH   = @srcdir@
 
 include $(DEPTH)/config/autoconf.mk
 
-ifndef MOZ_SUITE
-# XXX Suite doesn't want these just yet
+ifndef SUITE_USING_XPFE_DM
 DIRS = src tests
 endif
 
 include $(topsrcdir)/config/rules.mk
 
 
diff --git a/toolkit/mozapps/update/src/updater/updater.cpp b/toolkit/mozapps/update/src/updater/updater.cpp
--- a/toolkit/mozapps/update/src/updater/updater.cpp
+++ b/toolkit/mozapps/update/src/updater/updater.cpp
@@ -16,16 +16,17 @@
  * The Initial Developer of the Original Code is
  * Benjamin Smedberg <benjamin@smedbergs.us>
  *
  * Portions created by the Initial Developer are Copyright (C) 2005
  * the Initial Developer. All Rights Reserved.
  *
  * Contributor(s):
  *  Darin Fisher <darin@meer.net>
+ *  Robert Strong <robert.bugzilla@gmail.com>
  *
  * Alternatively, the contents of this file may be used under the terms of
  * either the GNU General Public License Version 2 or later (the "GPL"), or
  * the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
  * in which case the provisions of the GPL or the LGPL are applicable instead
  * of those above. If you wish to allow use of your version of this file only
  * under the terms of either the GPL or the LGPL, and not to allow others to
  * use your version of this file under the terms of the MPL, indicate your
@@ -1096,17 +1097,17 @@ LaunchWinPostProcess(const WCHAR *appExe
 
   static int    argc = 2;
   static WCHAR* argv[3] = {
     L"argv0ignoredbywinlaunchchild",
     exearg,
     L"\0"
   };
 
-  WinLaunchChild(exefullpath, argc, argv, 1);
+  WinLaunchChild(exefullpath, argc, argv, 0);
   free(argv);
 }
 #endif
 
 static void
 LaunchCallbackApp(const NS_tchar *workingDir, int argc, NS_tchar **argv)
 {
   putenv("NO_EM_RESTART=");
@@ -1115,17 +1116,17 @@ LaunchCallbackApp(const NS_tchar *workin
   // Run from the specified working directory (see bug 312360).
   NS_tchdir(workingDir);
 
 #if defined(USE_EXECV)
   execv(argv[0], argv);
 #elif defined(XP_MACOSX)
   LaunchChild(argc, argv);
 #elif defined(XP_WIN)
-  WinLaunchChild(argv[0], argc, argv, -1);
+  WinLaunchChild(argv[0], argc, argv, 0);
 #else
 # warning "Need implementaton of LaunchCallbackApp"
 #endif
 }
 
 static void
 WriteStatusFile(int status)
 {
@@ -1207,16 +1208,101 @@ int NS_main(int argc, NS_tchar **argv)
       Sleep(50);
     }
 #else
     int status;
     waitpid(pid, &status, 0);
 #endif
   }
 
+#ifdef XP_WIN
+  // Launch a second instance of the updater with the runas verb on Windows
+  // when write access is denied to the installation directory.
+
+  NS_tchar updateLockFilePath[MAXPATHLEN];
+  NS_tsnprintf(updateLockFilePath, MAXPATHLEN,
+               NS_T("%s/update_in_progress.lock"), argv[3]);
+
+  // The update_in_progress.lock file should only exist during an update. In
+  // case it exists attempt to remove it and exit if that fails to prevent
+  // simultaneous updates occurring.
+  if (!_waccess(updateLockFilePath, F_OK) &&
+      NS_tremove(updateLockFilePath) != 0) {
+    fprintf(stderr, "Update already in progress! Exiting\n");
+    return 1;
+  }
+
+  HANDLE updateLockFileHandle;
+  updateLockFileHandle = CreateFileW(updateLockFilePath,
+                                     GENERIC_READ | GENERIC_WRITE,
+                                     0,
+                                     NULL,
+                                     OPEN_ALWAYS,
+                                     FILE_FLAG_DELETE_ON_CLOSE,
+                                     NULL);
+
+  NS_tchar elevatedLockFilePath[MAXPATHLEN];
+  NS_tsnprintf(elevatedLockFilePath, MAXPATHLEN,
+               NS_T("%s/update_elevated.lock"), argv[1]);
+
+  if (updateLockFileHandle == INVALID_HANDLE_VALUE) {
+    if (!_waccess(elevatedLockFilePath, F_OK) &&
+        NS_tremove(elevatedLockFilePath) != 0) {
+      fprintf(stderr, "Update already elevated! Exiting\n");
+      return 1;
+    }
+
+    HANDLE elevatedFileHandle;
+    elevatedFileHandle = CreateFileW(elevatedLockFilePath,
+                                     GENERIC_READ | GENERIC_WRITE,
+                                     0,
+                                     NULL,
+                                     OPEN_ALWAYS,
+                                     FILE_FLAG_DELETE_ON_CLOSE,
+                                     NULL);
+
+    if (elevatedFileHandle == INVALID_HANDLE_VALUE) {
+      fprintf(stderr, "Unable to create elevated lock file! Exiting\n");
+      return 1;
+    }
+
+    PRUnichar *cmdLine = MakeCommandLine(argc - 1, argv + 1);
+    if (!cmdLine) {
+      CloseHandle(elevatedFileHandle);
+      return 1;
+    }
+
+    SHELLEXECUTEINFO sinfo;
+    memset(&sinfo, 0, sizeof(SHELLEXECUTEINFO));
+    sinfo.cbSize       = sizeof(SHELLEXECUTEINFO);
+    sinfo.fMask        = SEE_MASK_FLAG_DDEWAIT |
+                         SEE_MASK_FLAG_NO_UI |
+                         SEE_MASK_NOCLOSEPROCESS;
+    sinfo.hwnd         = NULL;
+    sinfo.lpFile       = argv[0];
+    sinfo.lpParameters = cmdLine;
+    sinfo.lpVerb       = L"runas";
+    sinfo.nShow        = SW_SHOWNORMAL;
+
+    BOOL result = ShellExecuteEx(&sinfo);
+    free(cmdLine);
+
+    if (result) {
+      WaitForSingleObject(sinfo.hProcess, INFINITE);
+      CloseHandle(sinfo.hProcess);
+    }
+
+    if (argc > 4)
+      LaunchCallbackApp(argv[3], argc - 4, argv + 4);
+
+    CloseHandle(elevatedFileHandle);
+    return 0;
+  }
+#endif
+
   gSourcePath = argv[1];
 
   LogInit();
 
   // Run update process on a background thread.  ShowProgressUI may return
   // before QuitProgressUI has been called, so wait for UpdateThreadFunc to
   // terminate.
   Thread t;
@@ -1224,16 +1310,22 @@ int NS_main(int argc, NS_tchar **argv)
     ShowProgressUI();
   t.Join();
 
   LogFinish();
 
 #ifdef XP_WIN
   if (gSucceeded && argc > 4)
     LaunchWinPostProcess(argv[4]);
+  CloseHandle(updateLockFileHandle);
+  // If elevated return early and let the process that launched this process
+  // launch the callback application.
+  if (!_waccess(elevatedLockFilePath, F_OK) &&
+      NS_tremove(elevatedLockFilePath) != 0)
+    return 0;
 #endif
 
   // The callback to execute is given as the last N arguments of our command
   // line.  The first of those arguments specifies the working directory for
   // the callback.
   if (argc > 4)
     LaunchCallbackApp(argv[3], argc - 4, argv + 4);
 
diff --git a/toolkit/mozapps/update/src/updater/updater.exe.manifest b/toolkit/mozapps/update/src/updater/updater.exe.manifest
--- a/toolkit/mozapps/update/src/updater/updater.exe.manifest
+++ b/toolkit/mozapps/update/src/updater/updater.exe.manifest
@@ -14,9 +14,17 @@
                         name="Microsoft.Windows.Common-Controls"
                         version="6.0.0.0"
                         processorArchitecture="*"
                         publicKeyToken="6595b64144ccf1df"
                         language="*"
                 />
         </dependentAssembly>
 </dependency>
+<ms_asmv3:trustInfo xmlns:ms_asmv3="urn:schemas-microsoft-com:asm.v3">
+  <ms_asmv3:security>
+    <ms_asmv3:requestedPrivileges>
+      <ms_asmv3:requestedExecutionLevel level="asInvoker" uiAccess="false">
+      </ms_asmv3:requestedExecutionLevel>
+    </ms_asmv3:requestedPrivileges>
+  </ms_asmv3:security>
+</ms_asmv3:trustInfo>
 </assembly>
diff --git a/toolkit/mozapps/xpinstall/content/xpinstallConfirm.xul b/toolkit/mozapps/xpinstall/content/xpinstallConfirm.xul
--- a/toolkit/mozapps/xpinstall/content/xpinstallConfirm.xul
+++ b/toolkit/mozapps/xpinstall/content/xpinstallConfirm.xul
@@ -55,17 +55,17 @@
 
   <stringbundle id="xpinstallConfirmStrings" 
                 src="chrome://mozapps/locale/xpinstall/xpinstallConfirm.properties"/>
 
   <vbox flex="1" id="dialogContentBox">
     <hbox id="xpinstallheader" align="start">
       <image class="alert-icon"/>
       <vbox flex="1">
-        <description class="warning">&warningMain.label;</description>
+        <description class="warning">&warningPrimary.label;</description>
         <description>&warningSecondary.label;</description>
       </vbox>
     </hbox>
     <label id="itemWarningIntro"/>
     <vbox id="itemList" class="listbox" flex="1" style="overflow: auto;"/>
   </vbox>
 
 </dialog>
diff --git a/toolkit/toolkit-tiers.mk b/toolkit/toolkit-tiers.mk
--- a/toolkit/toolkit-tiers.mk
+++ b/toolkit/toolkit-tiers.mk
@@ -72,20 +72,16 @@ endif
 
 ifndef MOZ_NATIVE_LCMS
 tier_external_dirs	+= modules/lcms
 endif
 
 #
 # tier "gecko" - core components
 #
-
-ifdef NS_TRACE_MALLOC
-tier_gecko_dirs += tools/trace-malloc/lib
-endif
 
 tier_gecko_dirs += \
 		js/src/xpconnect \
 		intl/chardet \
 		$(NULL)
 
 ifdef MOZ_ENABLE_GTK2
 tier_gecko_dirs     += widget/src/gtkxtbin
diff --git a/toolkit/xre/nsAppRunner.cpp b/toolkit/xre/nsAppRunner.cpp
--- a/toolkit/xre/nsAppRunner.cpp
+++ b/toolkit/xre/nsAppRunner.cpp
@@ -1539,18 +1539,17 @@ int OS2LaunchChild(const char *aExePath,
   return 0;
 }
 #endif
 
 // If aBlankCommandLine is true, then the application will be launched with a
 // blank command line instead of being launched with the same command line that
 // it was initially started with.
 static nsresult LaunchChild(nsINativeAppSupport* aNative,
-                            PRBool aBlankCommandLine = PR_FALSE,
-                            int needElevation = 0)
+                            PRBool aBlankCommandLine = PR_FALSE)
 {
   aNative->Quit(); // release DDE mutex, if we're holding it
 
   // Restart this process by exec'ing it into the current process
   // if supported by the platform.  Otherwise, use NSPR.
  
   if (aBlankCommandLine) {
     gRestartArgc = 1;
@@ -1568,17 +1567,17 @@ static nsresult LaunchChild(nsINativeApp
     return rv;
 
 #if defined(XP_WIN)
   nsAutoString exePath;
   rv = lf->GetPath(exePath);
   if (NS_FAILED(rv))
     return rv;
 
-  if (!WinLaunchChild(exePath.get(), gRestartArgc, gRestartArgv, needElevation))
+  if (!WinLaunchChild(exePath.get(), gRestartArgc, gRestartArgv, 0))
     return NS_ERROR_FAILURE;
 
 #else
   nsCAutoString exePath;
   rv = lf->GetNativePath(exePath);
   if (NS_FAILED(rv))
     return rv;
 
@@ -3270,17 +3269,17 @@ XRE_main(int argc, char* argv[], const n
         }
       }
 #endif
 
 #ifdef MOZ_WIDGET_GTK2
       MOZ_gdk_display_close(display);
 #endif
 
-      rv = LaunchChild(nativeApp, appInitiatedRestart, upgraded ? -1 : 0);
+      rv = LaunchChild(nativeApp, appInitiatedRestart);
 
 #ifdef MOZ_CRASHREPORTER
       if (appData.flags & NS_XRE_ENABLE_CRASH_REPORTER)
         CrashReporter::UnsetExceptionHandler();
 #endif
 
       return rv == NS_ERROR_LAUNCHED_CHILD_PROCESS ? 0 : 1;
     }
diff --git a/toolkit/xre/nsUpdateDriver.cpp b/toolkit/xre/nsUpdateDriver.cpp
--- a/toolkit/xre/nsUpdateDriver.cpp
+++ b/toolkit/xre/nsUpdateDriver.cpp
@@ -469,17 +469,17 @@ ApplyUpdate(nsIFile *greDir, nsIFile *up
   LOG(("spawning updater process [%s]\n", updaterPath.get()));
 
 #if defined(USE_EXECV)
   chdir(applyToDir.get());
   execv(updaterPath.get(), argv);
 #elif defined(XP_WIN)
   _wchdir(applyToDir.get());
 
-  if (!WinLaunchChild(updaterPathW.get(), appArgc + 4, argv, 1))
+  if (!WinLaunchChild(updaterPathW.get(), appArgc + 4, argv, 0))
     return;
   _exit(0);
 #else
   PRStatus status;
   PRProcessAttr *attr;
   
   attr = PR_NewProcessAttr();
   if (!attr)
diff --git a/tools/trace-malloc/Makefile.in b/tools/trace-malloc/Makefile.in
--- a/tools/trace-malloc/Makefile.in
+++ b/tools/trace-malloc/Makefile.in
@@ -79,18 +79,16 @@ endif
 endif
 
 include $(topsrcdir)/config/config.mk
 
 ifdef MOZ_ENABLE_LIBXUL
 ifeq (,$(filter mac cocoa,$(MOZ_WIDGET_TOOLKIT)))
 EXTRA_DSO_LIBS	= xul
 endif
-else
-EXTRA_DSO_LIBS	= tracemalloc
 endif
 
 LIBS		+= \
 		$(LIBS_DIR) \
 		tmreader.$(OBJ_SUFFIX) \
 		adreader.$(OBJ_SUFFIX) \
 		$(EXTRA_DSO_LIBS) \
 		$(XPCOM_GLUE_LDOPTS) \
diff --git a/tools/trace-malloc/lib/Makefile.in b/tools/trace-malloc/lib/Makefile.in
--- a/tools/trace-malloc/lib/Makefile.in
+++ b/tools/trace-malloc/lib/Makefile.in
@@ -41,16 +41,19 @@ VPATH		= @srcdir@
 VPATH		= @srcdir@
 
 include $(DEPTH)/config/autoconf.mk
 
 MODULE		= tracemalloc
 LIBRARY_NAME	= tracemalloc
 EXPORT_LIBRARY	= 1
 DEFFILE		= $(win_srcdir)/tm.def
+
+FORCE_STATIC_LIB = 1
+
 LIBXUL_LIBRARY	= 1
 
 REQUIRES	= xpcom
 
 CSRCS		= \
 		nsTraceMalloc.c \
 		$(NULL)
 
diff --git a/widget/public/nsILookAndFeel.h b/widget/public/nsILookAndFeel.h
--- a/widget/public/nsILookAndFeel.h
+++ b/widget/public/nsILookAndFeel.h
@@ -295,17 +295,21 @@ public:
     eMetricFloat_TextFieldVerticalInsidePadding,
     eMetricFloat_TextFieldHorizontalInsidePadding,
     eMetricFloat_TextAreaVerticalInsidePadding,
     eMetricFloat_TextAreaHorizontalInsidePadding,
     eMetricFloat_ListVerticalInsidePadding,
     eMetricFloat_ListHorizontalInsidePadding,
     eMetricFloat_ButtonVerticalInsidePadding,
     eMetricFloat_ButtonHorizontalInsidePadding,
-    eMetricFloat_IMEUnderlineRelativeSize
+    eMetricFloat_IMEUnderlineRelativeSize,
+
+    // The width/height ratio of the cursor. If used, the CaretWidth int metric
+    // should be added to the calculated caret width.
+    eMetricFloat_CaretAspectRatio
   } nsMetricFloatID;
 
   NS_IMETHOD GetColor(const nsColorID aID, nscolor &aColor) = 0;
   NS_IMETHOD GetMetric(const nsMetricID aID, PRInt32 & aMetric) = 0;
   NS_IMETHOD GetMetric(const nsMetricFloatID aID, float & aMetric) = 0;
   virtual PRUnichar GetPasswordCharacter()
   {
     return PRUnichar('*');
diff --git a/widget/src/gtk2/gtk2drawing.c b/widget/src/gtk2/gtk2drawing.c
--- a/widget/src/gtk2/gtk2drawing.c
+++ b/widget/src/gtk2/gtk2drawing.c
@@ -1438,16 +1438,27 @@ moz_gtk_vpaned_paint(GdkDrawable* drawab
                      GTK_SHADOW_NONE, cliprect, gVPanedWidget, "paned",
                      rect->x, rect->y, rect->width, rect->height,
                      GTK_ORIENTATION_HORIZONTAL);
 
     return MOZ_GTK_SUCCESS;
 }
 
 static gint
+moz_gtk_caret_paint(GdkDrawable* drawable, GdkRectangle* rect,
+                    GdkRectangle* cliprect, GtkTextDirection direction)
+{
+    ensure_entry_widget();
+    gtk_draw_insertion_cursor(gEntryWidget, drawable, cliprect,
+                              rect, TRUE, direction, FALSE);
+
+    return MOZ_GTK_SUCCESS;
+}
+
+static gint
 moz_gtk_entry_paint(GdkDrawable* drawable, GdkRectangle* rect,
                     GdkRectangle* cliprect, GtkWidgetState* state,
                     GtkWidget* widget, GtkTextDirection direction)
 {
     GtkStateType bg_state = state->disabled ?
                                 GTK_STATE_INSENSITIVE : GTK_STATE_NORMAL;
     gint x, y, width = rect->width, height = rect->height;
     GtkStyle* style;
@@ -1470,17 +1481,17 @@ moz_gtk_entry_paint(GdkDrawable* drawabl
 
     TSOffsetStyleGCs(style, rect->x, rect->y);
 
     /* This gets us a lovely greyish disabledish look */
     gtk_widget_set_sensitive(widget, !state->disabled);
 
     /* Draw the default window background */
     gdk_draw_rectangle(drawable, style->base_gc[bg_state], TRUE,
-                       rect->x, rect->y, rect->width, rect->height);
+                       cliprect->x, cliprect->y, cliprect->width, cliprect->height);
 
     /* Get the position of the inner window, see _gtk_entry_get_borders */
     x = XTHICKNESS(style);
     y = YTHICKNESS(style);
 
     if (!interior_focus) {
         x += focus_width;
         y += focus_width;
@@ -2779,16 +2790,17 @@ moz_gtk_get_widget_border(GtkThemeWidget
     case MOZ_GTK_TOOLTIP:
     case MOZ_GTK_WINDOW:
     case MOZ_GTK_RESIZER:
     case MOZ_GTK_MENUARROW:
     case MOZ_GTK_TOOLBARBUTTON_ARROW:
     case MOZ_GTK_TOOLBAR:
     case MOZ_GTK_MENUBAR:
     case MOZ_GTK_TAB_SCROLLARROW:
+    case MOZ_GTK_ENTRY_CARET:
         *left = *top = *right = *bottom = 0;
         return MOZ_GTK_SUCCESS;
     default:
         g_warning("Unsupported widget type: %d", widget);
         return MOZ_GTK_UNKNOWN_WIDGET;
     }
 
     *right = *left = XTHICKNESS(w->style);
@@ -3047,16 +3059,19 @@ moz_gtk_widget_paint(GtkThemeWidgetType 
         return moz_gtk_expander_paint(drawable, rect, cliprect, state,
                                       (GtkExpanderStyle) flags, direction);
         break;
     case MOZ_GTK_ENTRY:
         ensure_entry_widget();
         return moz_gtk_entry_paint(drawable, rect, cliprect, state,
                                    gEntryWidget, direction);
         break;
+    case MOZ_GTK_ENTRY_CARET:
+        return moz_gtk_caret_paint(drawable, rect, cliprect, direction);
+        break;
     case MOZ_GTK_DROPDOWN:
         return moz_gtk_combo_box_paint(drawable, rect, cliprect, state,
                                        (gboolean) flags, direction);
         break;
     case MOZ_GTK_DROPDOWN_ARROW:
         return moz_gtk_combo_box_entry_button_paint(drawable, rect, cliprect,
                                                     state, flags, direction);
         break;
diff --git a/widget/src/gtk2/gtkdrawing.h b/widget/src/gtk2/gtkdrawing.h
--- a/widget/src/gtk2/gtkdrawing.h
+++ b/widget/src/gtk2/gtkdrawing.h
@@ -139,16 +139,18 @@ typedef enum {
   MOZ_GTK_SPINBUTTON,
   MOZ_GTK_SPINBUTTON_UP,
   MOZ_GTK_SPINBUTTON_DOWN,
   MOZ_GTK_SPINBUTTON_ENTRY,
   /* Paints the gripper of a GtkHandleBox. */
   MOZ_GTK_GRIPPER,
   /* Paints a GtkEntry. */
   MOZ_GTK_ENTRY,
+  /* Paints the native caret (or in GTK-speak: insertion cursor) */
+  MOZ_GTK_ENTRY_CARET,
   /* Paints a GtkOptionMenu. */
   MOZ_GTK_DROPDOWN,
   /* Paints a dropdown arrow (a GtkButton containing a down GtkArrow). */
   MOZ_GTK_DROPDOWN_ARROW,
   /* Paints an entry in an editable option menu */
   MOZ_GTK_DROPDOWN_ENTRY,
   /* Paints the container part of a GtkCheckButton. */
   MOZ_GTK_CHECKBUTTON_CONTAINER,
diff --git a/widget/src/gtk2/nsLookAndFeel.cpp b/widget/src/gtk2/nsLookAndFeel.cpp
--- a/widget/src/gtk2/nsLookAndFeel.cpp
+++ b/widget/src/gtk2/nsLookAndFeel.cpp
@@ -53,16 +53,17 @@ nscolor   nsLookAndFeel::sMenuHoverText 
 nscolor   nsLookAndFeel::sMenuHoverText = 0;
 nscolor   nsLookAndFeel::sMenuBackground = 0;
 nscolor   nsLookAndFeel::sButtonBackground = 0;
 nscolor   nsLookAndFeel::sButtonText = 0;
 nscolor   nsLookAndFeel::sButtonOuterLightBorder = 0;
 nscolor   nsLookAndFeel::sButtonInnerDarkBorder = 0;
 nscolor   nsLookAndFeel::sOddCellBackground = 0;
 PRUnichar nsLookAndFeel::sInvisibleCharacter = PRUnichar('*');
+float     nsLookAndFeel::sCaretRatio = 0;
 
 //-------------------------------------------------------------------------
 //
 // Query interface implementation
 //
 //-------------------------------------------------------------------------
 nsLookAndFeel::nsLookAndFeel() : nsXPLookAndFeel()
 {
@@ -604,16 +605,19 @@ NS_IMETHODIMP nsLookAndFeel::GetMetric(c
         aMetric = 0.25f;
         break;
     case eMetricFloat_ButtonHorizontalInsidePadding:
         aMetric = 0.25f;
         break;
     case eMetricFloat_IMEUnderlineRelativeSize:
         aMetric = 1.0f;
         break;
+    case eMetricFloat_CaretAspectRatio:
+        aMetric = sCaretRatio;
+        break;
     default:
         aMetric = -1.0;
         res = NS_ERROR_FAILURE;
     }
     return res;
 }
 
 void
@@ -728,16 +732,22 @@ nsLookAndFeel::InitLookAndFeel()
 
     gtk_widget_destroy(window);
 
     // invisible character styles
     GtkWidget *entry = gtk_entry_new();
     guint value;
     g_object_get (entry, "invisible-char", &value, NULL);
     sInvisibleCharacter = PRUnichar(value);
+
+    // caret styles
+    gtk_widget_style_get(entry,
+                         "cursor-aspect-ratio", &sCaretRatio,
+                         NULL);
+
     gtk_widget_destroy(entry);
 }
 
 // virtual
 PRUnichar
 nsLookAndFeel::GetPasswordCharacter()
 {
     return sInvisibleCharacter;
diff --git a/widget/src/gtk2/nsLookAndFeel.h b/widget/src/gtk2/nsLookAndFeel.h
--- a/widget/src/gtk2/nsLookAndFeel.h
+++ b/widget/src/gtk2/nsLookAndFeel.h
@@ -68,16 +68,17 @@ protected:
     static nscolor sMenuHover;
     static nscolor sMenuHoverText;
     static nscolor sButtonBackground;
     static nscolor sButtonText;
     static nscolor sButtonOuterLightBorder;
     static nscolor sButtonInnerDarkBorder;
     static nscolor sOddCellBackground;
     static PRUnichar sInvisibleCharacter;
+    static float   sCaretRatio;
 
     static void InitLookAndFeel();
     void InitWidget() {
         mWidget = gtk_invisible_new();
         gtk_object_ref(GTK_OBJECT(mWidget));
         gtk_object_sink(GTK_OBJECT(mWidget));
         gtk_widget_ensure_style(mWidget);
         mStyle = gtk_widget_get_style(mWidget);
diff --git a/widget/src/gtk2/nsNativeThemeGTK.cpp b/widget/src/gtk2/nsNativeThemeGTK.cpp
--- a/widget/src/gtk2/nsNativeThemeGTK.cpp
+++ b/widget/src/gtk2/nsNativeThemeGTK.cpp
@@ -433,16 +433,19 @@ nsNativeThemeGTK::GetGtkWidgetAndState(P
     aGtkWidgetType = MOZ_GTK_GRIPPER;
     break;
   case NS_THEME_RESIZER:
     aGtkWidgetType = MOZ_GTK_RESIZER;
     break;
   case NS_THEME_TEXTFIELD:
   case NS_THEME_TEXTFIELD_MULTILINE:
     aGtkWidgetType = MOZ_GTK_ENTRY;
+    break;
+  case NS_THEME_TEXTFIELD_CARET:
+    aGtkWidgetType = MOZ_GTK_ENTRY_CARET;
     break;
   case NS_THEME_LISTBOX:
   case NS_THEME_TREEVIEW:
     aGtkWidgetType = MOZ_GTK_TREEVIEW;
     break;
   case NS_THEME_TREEVIEW_HEADER_CELL:
     if (aWidgetFlags) {
       // In this case, the flag denotes whether the header is the sorted one or not
@@ -1321,17 +1324,17 @@ nsNativeThemeGTK::ThemeSupportsWidget(ns
   case NS_THEME_SCROLLBAR_TRACK_HORIZONTAL:
   case NS_THEME_SCROLLBAR_TRACK_VERTICAL:
   case NS_THEME_SCROLLBAR_THUMB_HORIZONTAL:
   case NS_THEME_SCROLLBAR_THUMB_VERTICAL:
     // case NS_THEME_SCROLLBAR_GRIPPER_HORIZONTAL:  (n/a for gtk)
     // case NS_THEME_SCROLLBAR_GRIPPER_VERTICAL:  (n/a for gtk)
   case NS_THEME_TEXTFIELD:
   case NS_THEME_TEXTFIELD_MULTILINE:
-    // case NS_THEME_TEXTFIELD_CARET:
+  case NS_THEME_TEXTFIELD_CARET:
   case NS_THEME_DROPDOWN_TEXTFIELD:
   case NS_THEME_SCALE_HORIZONTAL:
   case NS_THEME_SCALE_THUMB_HORIZONTAL:
   case NS_THEME_SCALE_VERTICAL:
   case NS_THEME_SCALE_THUMB_VERTICAL:
     // case NS_THEME_SCALE_THUMB_START:
     // case NS_THEME_SCALE_THUMB_END:
     // case NS_THEME_SCALE_TICK:
diff --git a/widget/src/xpwidgets/nsXPLookAndFeel.cpp b/widget/src/xpwidgets/nsXPLookAndFeel.cpp
--- a/widget/src/xpwidgets/nsXPLookAndFeel.cpp
+++ b/widget/src/xpwidgets/nsXPLookAndFeel.cpp
@@ -138,16 +138,18 @@ nsLookAndFeelFloatPref nsXPLookAndFeel::
   { "ui.listHorizontalInsidePadding",
     eMetricFloat_ListHorizontalInsidePadding, PR_FALSE, nsLookAndFeelTypeFloat, 0 },
   { "ui.buttonVerticalInsidePadding", eMetricFloat_ButtonVerticalInsidePadding,
     PR_FALSE, nsLookAndFeelTypeFloat, 0 },
   { "ui.buttonHorizontalInsidePadding", eMetricFloat_ButtonHorizontalInsidePadding,
     PR_FALSE, nsLookAndFeelTypeFloat, 0 },
   { "ui.IMEUnderlineRelativeSize", eMetricFloat_IMEUnderlineRelativeSize,
     PR_FALSE, nsLookAndFeelTypeFloat, 0 },
+  { "ui.caretAspectRatio", eMetricFloat_CaretAspectRatio, PR_FALSE,
+    nsLookAndFeelTypeFloat, 0 },
 };
 
 
 // This array MUST be kept in the same order as the color list in nsILookAndFeel.h.
 /* XXX If you add any strings longer than
  * "ui.IMESelectedConvertedTextBackground"
  * to the following array then you MUST update the
  * sizes of the sColorPrefs array in nsXPLookAndFeel.h
diff --git a/xpcom/base/nsCycleCollector.cpp b/xpcom/base/nsCycleCollector.cpp
--- a/xpcom/base/nsCycleCollector.cpp
+++ b/xpcom/base/nsCycleCollector.cpp
@@ -1441,18 +1441,24 @@ GCGraphBuilder::NoteScriptChild(PRUint32
 {
 #ifdef DEBUG_CC
     nsCString edgeName(mNextEdgeName);
     mNextEdgeName.Truncate();
 #endif
     if (!child)
         return;
 
-    if (langID > nsIProgrammingLanguage::MAX || !mRuntimes[langID]) {
-        Fault("traversing pointer for unregistered language", child);
+    if (langID > nsIProgrammingLanguage::MAX) {
+        Fault("traversing pointer for unknown language", child);
+        return;
+    }
+
+    if (!mRuntimes[langID]) {
+        NS_WARNING("Not collecting cycles involving objects for scripting "
+                   "languages that don't participate in cycle collection.");
         return;
     }
 
     nsCycleCollectionParticipant *cp = mRuntimes[langID]->ToParticipant(child);
     if (!cp)
         return;
 
     PtrInfo *childPi = AddNode(child, cp, langID);
diff --git a/xpcom/build.mk b/xpcom/build.mk
--- a/xpcom/build.mk
+++ b/xpcom/build.mk
@@ -32,9 +32,13 @@
 # and other provisions required by the GPL or the LGPL. If you do not delete
 # the provisions above, a recipient may use your version of this file under
 # the terms of any one of the MPL, the GPL or the LGPL.
 #
 # ***** END LICENSE BLOCK *****
 
 TIERS += xpcom
 
-tier_xpcom_dirs = xpcom
+ifdef NS_TRACE_MALLOC
+tier_xpcom_dirs = tools/trace-malloc/lib
+endif
+
+tier_xpcom_dirs += xpcom
diff --git a/xpcom/build/Makefile.in b/xpcom/build/Makefile.in
--- a/xpcom/build/Makefile.in
+++ b/xpcom/build/Makefile.in
@@ -73,16 +73,20 @@ REQUIRES	= string \
 REQUIRES	= string \
 		  $(NULL)
 
 # pull in MoreFiles for MacOSX
 ifneq (,$(filter mac cocoa,$(MOZ_WIDGET_TOOLKIT)))
 REQUIRES += macmorefiles
 endif
 
+ifdef NS_TRACE_MALLOC
+REQUIRES += tracemalloc
+endif
+
 CSRCS		= \
 		$(XPCOM_GLUE_SRC_LCSRCS) \
 		$(NULL)
 
 CPPSRCS		= \
 		$(XPCOM_GLUE_SRC_LCPPSRCS) \
 		$(XPCOM_GLUENS_SRC_LCPPSRCS) \
 		nsXPComInit.cpp \
@@ -113,16 +117,22 @@ SHARED_LIBRARY_LIBS = \
 		../proxy/src/$(LIB_PREFIX)xpcomproxy_s.$(LIB_SUFFIX) \
 		../base/$(LIB_PREFIX)xpcombase_s.$(LIB_SUFFIX) \
 		../reflect/xptcall/src/$(LIB_PREFIX)xptcall.$(LIB_SUFFIX) \
 		../reflect/xptcall/src/$(LIB_PREFIX)xptcmd.$(LIB_SUFFIX) \
 		../reflect/xptinfo/src/$(LIB_PREFIX)xptinfo.$(LIB_SUFFIX) \
 		$(DIST)/lib/$(LIB_PREFIX)xpt.$(LIB_SUFFIX) \
 		../string/src/$(LIB_PREFIX)string_s.$(LIB_SUFFIX) \
 		$(NULL)
+
+ifdef NS_TRACE_MALLOC
+SHARED_LIBRARY_LIBS += \
+		$(DEPTH)/tools/trace-malloc/lib/$(LIB_PREFIX)tracemalloc.$(LIB_SUFFIX) \
+		$(NULL)
+endif
 
 LOCAL_INCLUDES	= \
 		-I$(srcdir) \
 		-I.. \
 		-I$(srcdir)/../glue \
 		-I$(srcdir)/../base \
 		-I$(srcdir)/../ds \
 		-I$(srcdir)/../io \
diff --git a/xpcom/glue/Makefile.in b/xpcom/glue/Makefile.in
--- a/xpcom/glue/Makefile.in
+++ b/xpcom/glue/Makefile.in
@@ -49,16 +49,20 @@ DIRS            = standalone
 
 MODULE		= xpcom
 LIBRARY_NAME	= xpcomglue_s
 DIST_INSTALL	= 1
 
 REQUIRES = \
 		string \
 		$(NULL)
+
+ifdef NS_TRACE_MALLOC
+REQUIRES += tracemalloc
+endif
 
 LOCAL_INCLUDES	= \
 		-I$(srcdir)/../build \
 		$(NULL)
 
 CSRCS		= \
 		$(XPCOM_GLUE_SRC_LCSRCS) \
 		$(NULL)  
diff --git a/xpcom/glue/nsAutoLock.cpp b/xpcom/glue/nsAutoLock.cpp
--- a/xpcom/glue/nsAutoLock.cpp
+++ b/xpcom/glue/nsAutoLock.cpp
@@ -41,31 +41,31 @@
 
 #include "plhash.h"
 #include "prprf.h"
 #include "prlock.h"
 #include "prthread.h"
 #include "nsDebug.h"
 #include "nsVoidArray.h"
 
-#ifdef NS_TRACE_MALLOC_XXX
+#ifdef NS_TRACE_MALLOC
 # include <stdio.h>
 # include "nsTraceMalloc.h"
 #endif
 
 static PRUintn      LockStackTPI = (PRUintn)-1;
 static PLHashTable* OrderTable = 0;
 static PRLock*      OrderTableLock = 0;
 
 static const char* const LockTypeNames[] = {"Lock", "Monitor", "CMonitor"};
 
 struct nsNamedVector : public nsVoidArray {
     const char* mName;
 
-#ifdef NS_TRACE_MALLOC_XXX
+#ifdef NS_TRACE_MALLOC
     // Callsites for the inner locks/monitors stored in our base nsVoidArray.
     // This array parallels our base nsVoidArray.
     nsVoidArray mInnerSites;
 #endif
 
     nsNamedVector(const char* name = 0, PRUint32 initialSize = 0)
         : nsVoidArray(initialSize),
           mName(name)
@@ -252,17 +252,17 @@ static PRBool WellOrdered(const void* ad
                         break;
                     }
                 }
 
                 if (rv) {
                     // Assert (addr1 < addr2) into the order table.
                     // XXX fix plvector/nsVector to use const void*
                     vec1->AppendElement((void*) addr2);
-#ifdef NS_TRACE_MALLOC_XXX
+#ifdef NS_TRACE_MALLOC
                     vec1->mInnerSites.AppendElement((void*) callsite2);
 #endif
                 }
             }
         }
     }
 
     PR_Unlock(OrderTableLock);
@@ -280,18 +280,18 @@ nsAutoLockBase::nsAutoLockBase(void* add
         if (stackTop->mAddr == addr) {
             // Ignore reentry: it's legal for monitors, and NSPR will assert
             // if you reenter a PRLock.
         } else if (!addr) {
             // Ignore null addresses: the caller promises not to use the
             // lock at all, and NSPR will assert if you enter it.
         } else {
             const void* node =
-#ifdef NS_TRACE_MALLOC_XXX
-                NS_GetStackTrace(1)
+#ifdef NS_TRACE_MALLOC
+                (const void*)NS_TraceMallocGetStackTrace();
 #else
                 nsnull
 #endif
                 ;
             nsNamedVector* vec1;
             nsNamedVector* vec2;
             PRUint32 i2;
 
@@ -300,22 +300,24 @@ nsAutoLockBase::nsAutoLockBase(void* add
                 PR_snprintf(buf, sizeof buf,
                             "Potential deadlock between %s%s@%p and %s%s@%p",
                             vec1->mName ? vec1->mName : "",
                             LockTypeNames[stackTop->mType],
                             stackTop->mAddr,
                             vec2->mName ? vec2->mName : "",
                             LockTypeNames[type],
                             addr);
-#ifdef NS_TRACE_MALLOC_XXX
+#ifdef NS_TRACE_MALLOC
                 fprintf(stderr, "\n*** %s\n\nCurrent stack:\n", buf);
-                NS_DumpStackTrace(node, stderr);
+                NS_TraceMallocPrintStackTrace(stderr,
+                                              NS_TraceMallocGetStackTrace());
 
                 fputs("\nPrevious stack:\n", stderr);
-                NS_DumpStackTrace(vec2->mInnerSites.ElementAt(i2), stderr);
+                NS_TraceMallocPrintStackTrace(stderr,
+                    (nsTMStackTraceIDStruct *)vec2->mInnerSites.ElementAt(i2));
                 putc('\n', stderr);
 #endif
                 NS_ERROR(buf);
             }
         }
     }
 
     mAddr = addr;
diff --git a/xpcom/glue/nsTHashtable.h b/xpcom/glue/nsTHashtable.h
--- a/xpcom/glue/nsTHashtable.h
+++ b/xpcom/glue/nsTHashtable.h
@@ -124,16 +124,22 @@ public:
    */
   PRBool Init(PRUint32 initSize = PL_DHASH_MIN_SIZE);
 
   /**
    * Check whether the table has been initialized. This can be useful for static hashtables.
    * @return the initialization state of the class.
    */
   PRBool IsInitialized() const { return !!mTable.entrySize; }
+
+  /**
+   * Return the generation number for the table. This increments whenever
+   * the table data items are moved.
+   */
+  PRUint32 GetGeneration() const { return mTable.generation; }
 
   /**
    * KeyType is typedef'ed for ease of use.
    */
   typedef typename EntryType::KeyType KeyType;
 
   /**
    * KeyTypePointer is typedef'ed for ease of use.
diff --git a/xpfe/components/Makefile.in b/xpfe/components/Makefile.in
--- a/xpfe/components/Makefile.in
+++ b/xpfe/components/Makefile.in
@@ -83,19 +83,21 @@ DIRS += \
         $(NULL)
 
 ifndef MOZ_PHOENIX
 ifndef MOZ_XULRUNNER
 DIRS += \
         related \
         autocomplete \
         $(NULL)
-ifneq ($(MOZ_BUILD_APP),camino)
+        
+ifdef SUITE_USING_XPFE_DM
 DIRS += download-manager
 endif
+
 ifndef MOZ_XUL_APP
 DIRS += startup
 endif
 ifndef MOZ_PLACES
 DIRS += history
 endif
 endif
 endif
diff --git a/xpfe/components/build/Makefile.in b/xpfe/components/build/Makefile.in
--- a/xpfe/components/build/Makefile.in
+++ b/xpfe/components/build/Makefile.in
@@ -85,23 +85,26 @@ REQUIRES	+= \
 		intl \
 		mork \
 		widget \
 		mimetype \
 		autocomplete \
 		$(NULL)
 
 SHARED_LIBRARY_LIBS += \
-	../download-manager/src/$(LIB_PREFIX)downloadmanager_s.$(LIB_SUFFIX) \
 	../related/src/$(LIB_PREFIX)related_s.$(LIB_SUFFIX) \
 	$(NULL)
 LOCAL_INCLUDES += \
-	-I$(srcdir)/../download-manager/src \
 	-I$(srcdir)/../related/src       \
 	$(NULL)
+
+ifdef SUITE_USING_XPFE_DM
+SHARED_LIBRARY_LIBS += ../download-manager/src/$(LIB_PREFIX)downloadmanager_s.$(LIB_SUFFIX)
+LOCAL_INCLUDES += -I$(srcdir)/../download-manager/src
+endif
 
 ifndef MOZ_PLACES
 REQUIRES += history
 SHARED_LIBRARY_LIBS += \
 	../history/src/$(LIB_PREFIX)history_s.$(LIB_SUFFIX) \
 	$(NULL)
 LOCAL_INCLUDES += \
 	-I$(srcdir)/../history/src       \
diff --git a/xpfe/components/build/nsModule.cpp b/xpfe/components/build/nsModule.cpp
--- a/xpfe/components/build/nsModule.cpp
+++ b/xpfe/components/build/nsModule.cpp
@@ -43,18 +43,20 @@
 #ifdef MOZ_RDF
 #include "rdf.h"
 #include "nsRDFCID.h"
 #endif
 
 #ifdef MOZ_SUITE
 #include "nsRelatedLinksHandlerImpl.h"
 #include "nsDocShellCID.h"
+#ifdef SUITE_USING_XPFE_DM
 #include "nsDownloadManager.h"
 #include "nsDownloadProxy.h"
+#endif
 
 #if !defined(MOZ_PLACES)
 #include "nsGlobalHistory.h"
 #endif
 
 #if defined(XP_WIN)
 #include "nsWindowsHooks.h"
 #endif // Windows
@@ -85,18 +87,20 @@ NS_GENERIC_FACTORY_CONSTRUCTOR(nsDirecto
 
 #if !defined(MOZ_MACBROWSER)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsBrowserStatusFilter)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsBrowserInstance)
 #endif
 
 #ifdef MOZ_SUITE
 NS_GENERIC_FACTORY_CONSTRUCTOR_INIT(RelatedLinksHandlerImpl, Init)
+#ifdef SUITE_USING_XPFE_DM
 NS_GENERIC_FACTORY_CONSTRUCTOR_INIT(nsDownloadManager, Init)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsDownloadProxy)
+#endif
 
 #if !defined(MOZ_PLACES)
 NS_GENERIC_FACTORY_CONSTRUCTOR_INIT(nsGlobalHistory, Init)
 #endif
 
 #if defined(XP_WIN)
 NS_GENERIC_FACTORY_CONSTRUCTOR(nsWindowsHooks)
 #endif // Windows
@@ -149,20 +153,22 @@ static const nsModuleComponentInfo compo
 #ifdef MOZ_RDF
     { "Directory Viewer", NS_HTTPINDEX_SERVICE_CID, NS_HTTPINDEX_SERVICE_CONTRACTID,
       nsHTTPIndexConstructor },
     { "Directory Viewer", NS_HTTPINDEX_SERVICE_CID, NS_HTTPINDEX_DATASOURCE_CONTRACTID,
       nsHTTPIndexConstructor },
 #endif
 
 #ifdef MOZ_SUITE
+#ifdef SUITE_USING_XPFE_DM
     { "Download Manager", NS_DOWNLOADMANAGER_CID, NS_DOWNLOADMANAGER_CONTRACTID,
       nsDownloadManagerConstructor },
     { "Download", NS_DOWNLOAD_CID, NS_TRANSFER_CONTRACTID,
       nsDownloadProxyConstructor },
+#endif
     { "Related Links Handler", NS_RELATEDLINKSHANDLER_CID, NS_RELATEDLINKSHANDLER_CONTRACTID,
        RelatedLinksHandlerImplConstructor},
 
 #if !defined(MOZ_PLACES)
     { "Global History", NS_GLOBALHISTORY_CID, NS_GLOBALHISTORY2_CONTRACTID,
       nsGlobalHistoryConstructor },
     { "Global History", NS_GLOBALHISTORY_CID, NS_GLOBALHISTORY_DATASOURCE_CONTRACTID,
       nsGlobalHistoryConstructor },
diff --git a/xulrunner/app/Makefile.in b/xulrunner/app/Makefile.in
--- a/xulrunner/app/Makefile.in
+++ b/xulrunner/app/Makefile.in
@@ -141,20 +141,16 @@ NSDISTMODE = copy
 NSDISTMODE = copy
 
 include $(topsrcdir)/config/config.mk
 
 ifdef _MSC_VER
 # Always enter a Windows program through wmain, whether or not we're
 # a console application.
 WIN32_EXE_LDFLAGS += -ENTRY:wmainCRTStartup
-endif
-
-ifdef NS_TRACE_MALLOC
-EXTRA_DSO_LIBS += tracemalloc
 endif
 
 ifeq ($(OS_ARCH),WINNT)
 OS_LIBS += $(call EXPAND_LIBNAME,comctl32 comdlg32 uuid shell32 ole32 oleaut32 version winspool)
 RCINCLUDE = splash.rc
 ifndef GNU_CC
 RCFLAGS += -DMOZ_XULRUNNER -I$(srcdir)
 else
